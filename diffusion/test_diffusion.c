
// We need to define _GNU_SOURCE before
// _any_ headers files are imported to get
// the usage statistics of a thread (i.e. have RUSAGE_THREAD) on GNU/Linux
// https://manpages.courier-mta.org/htmlman2/getrusage.2.html
#ifndef _GNU_SOURCE // Avoid possible double-definition warning.
#define _GNU_SOURCE
#endif

#ifdef __clang__
#pragma clang diagnostic ignored "-Wunused-function"
#pragma clang diagnostic ignored "-Wunused-variable"
#pragma clang diagnostic ignored "-Wparentheses"
#pragma clang diagnostic ignored "-Wunused-label"
#elif __GNUC__
#pragma GCC diagnostic ignored "-Wunused-function"
#pragma GCC diagnostic ignored "-Wunused-variable"
#pragma GCC diagnostic ignored "-Wparentheses"
#pragma GCC diagnostic ignored "-Wunused-label"
#pragma GCC diagnostic ignored "-Wunused-but-set-variable"
#endif

// Headers
#include <stdint.h>
#include <stddef.h>
#include <stdbool.h>
#include <stdio.h>
#include <float.h>

#ifdef __cplusplus
extern "C" {
#endif

// Initialisation
struct futhark_context_config;
struct futhark_context_config *futhark_context_config_new(void);
void futhark_context_config_free(struct futhark_context_config *cfg);
void futhark_context_config_set_debugging(struct futhark_context_config *cfg,
                                          int flag);
void futhark_context_config_set_profiling(struct futhark_context_config *cfg,
                                          int flag);
void futhark_context_config_set_logging(struct futhark_context_config *cfg,
                                        int flag);
struct futhark_context;
struct futhark_context *futhark_context_new(struct futhark_context_config *cfg);
void futhark_context_free(struct futhark_context *ctx);
int futhark_context_config_set_tuning_param(struct futhark_context_config *cfg,
                                            const char *param_name,
                                            size_t param_value);
int futhark_get_tuning_param_count(void);
const char *futhark_get_tuning_param_name(int);
const char *futhark_get_tuning_param_class(int);

// Arrays
struct futhark_f64_1d;
struct futhark_f64_1d *futhark_new_f64_1d(struct futhark_context *ctx, const
                                          double *data, int64_t dim0);
struct futhark_f64_1d *futhark_new_raw_f64_1d(struct futhark_context *ctx, const
                                              unsigned char *data,
                                              int64_t offset, int64_t dim0);
int futhark_free_f64_1d(struct futhark_context *ctx,
                        struct futhark_f64_1d *arr);
int futhark_values_f64_1d(struct futhark_context *ctx,
                          struct futhark_f64_1d *arr, double *data);
unsigned char *futhark_values_raw_f64_1d(struct futhark_context *ctx,
                                         struct futhark_f64_1d *arr);
const int64_t *futhark_shape_f64_1d(struct futhark_context *ctx,
                                    struct futhark_f64_1d *arr);
struct futhark_f64_3d;
struct futhark_f64_3d *futhark_new_f64_3d(struct futhark_context *ctx, const
                                          double *data, int64_t dim0,
                                          int64_t dim1, int64_t dim2);
struct futhark_f64_3d *futhark_new_raw_f64_3d(struct futhark_context *ctx, const
                                              unsigned char *data,
                                              int64_t offset, int64_t dim0,
                                              int64_t dim1, int64_t dim2);
int futhark_free_f64_3d(struct futhark_context *ctx,
                        struct futhark_f64_3d *arr);
int futhark_values_f64_3d(struct futhark_context *ctx,
                          struct futhark_f64_3d *arr, double *data);
unsigned char *futhark_values_raw_f64_3d(struct futhark_context *ctx,
                                         struct futhark_f64_3d *arr);
const int64_t *futhark_shape_f64_3d(struct futhark_context *ctx,
                                    struct futhark_f64_3d *arr);
struct futhark_i32_2d;
struct futhark_i32_2d *futhark_new_i32_2d(struct futhark_context *ctx, const
                                          int32_t *data, int64_t dim0,
                                          int64_t dim1);
struct futhark_i32_2d *futhark_new_raw_i32_2d(struct futhark_context *ctx, const
                                              unsigned char *data,
                                              int64_t offset, int64_t dim0,
                                              int64_t dim1);
int futhark_free_i32_2d(struct futhark_context *ctx,
                        struct futhark_i32_2d *arr);
int futhark_values_i32_2d(struct futhark_context *ctx,
                          struct futhark_i32_2d *arr, int32_t *data);
unsigned char *futhark_values_raw_i32_2d(struct futhark_context *ctx,
                                         struct futhark_i32_2d *arr);
const int64_t *futhark_shape_i32_2d(struct futhark_context *ctx,
                                    struct futhark_i32_2d *arr);

// Opaque values



// Entry points
int futhark_entry_diffusion_sample(struct futhark_context *ctx,
                                   struct futhark_f64_3d **out0, const
                                   int64_t in0, const
                                   struct futhark_f64_1d *in1, const
                                   struct futhark_f64_1d *in2, const
                                   struct futhark_f64_1d *in3, const
                                   int32_t in4, const int32_t in5, const
                                   int64_t in6);
int futhark_entry_diffusion_train(struct futhark_context *ctx,
                                  struct futhark_f64_1d **out0, const
                                  struct futhark_f64_3d *in0, const
                                  struct futhark_f64_1d *in1, const int64_t in2,
                                  const struct futhark_i32_2d *in3, const
                                  struct futhark_i32_2d *in4);

// Miscellaneous
int futhark_context_sync(struct futhark_context *ctx);
void futhark_context_config_set_cache_file(struct futhark_context_config *cfg,
                                           const char *f);
char *futhark_context_report(struct futhark_context *ctx);
char *futhark_context_get_error(struct futhark_context *ctx);
void futhark_context_set_logging_file(struct futhark_context *ctx, FILE *f);
void futhark_context_pause_profiling(struct futhark_context *ctx);
void futhark_context_unpause_profiling(struct futhark_context *ctx);
int futhark_context_clear_caches(struct futhark_context *ctx);
#define FUTHARK_BACKEND_c
#define FUTHARK_SUCCESS 0
#define FUTHARK_PROGRAM_ERROR 2
#define FUTHARK_OUT_OF_MEMORY 3

#ifdef __cplusplus
}
#endif

#include <stdio.h>
#include <stdlib.h>
#include <stdbool.h>
#include <math.h>
#include <stdint.h>
// If NDEBUG is set, the assert() macro will do nothing. Since Futhark
// (unfortunately) makes use of assert() for error detection (and even some
// side effects), we want to avoid that.
#undef NDEBUG
#include <assert.h>
#include <stdarg.h>
// Start of util.h.
//
// Various helper functions that are useful in all generated C code.

#include <errno.h>
#include <string.h>

static const char *fut_progname = "(embedded Futhark)";

static void futhark_panic(int eval, const char *fmt, ...) __attribute__((noreturn));
static char* msgprintf(const char *s, ...);
static void* slurp_file(const char *filename, size_t *size);
static int dump_file(const char *file, const void *buf, size_t n);
struct str_builder;
static void str_builder_init(struct str_builder *b);
static void str_builder(struct str_builder *b, const char *s, ...);

static void futhark_panic(int eval, const char *fmt, ...) {
  va_list ap;
  va_start(ap, fmt);
  fprintf(stderr, "%s: ", fut_progname);
  vfprintf(stderr, fmt, ap);
  va_end(ap);
  exit(eval);
}

// For generating arbitrary-sized error messages.  It is the callers
// responsibility to free the buffer at some point.
static char* msgprintf(const char *s, ...) {
  va_list vl;
  va_start(vl, s);
  size_t needed = 1 + (size_t)vsnprintf(NULL, 0, s, vl);
  char *buffer = (char*) malloc(needed);
  va_start(vl, s); // Must re-init.
  vsnprintf(buffer, needed, s, vl);
  return buffer;
}

static inline void check_err(int errval, int sets_errno, const char *fun, int line,
                             const char *msg, ...) {
  if (errval) {
    char errnum[10];

    va_list vl;
    va_start(vl, msg);

    fprintf(stderr, "ERROR: ");
    vfprintf(stderr, msg, vl);
    fprintf(stderr, " in %s() at line %d with error code %s\n",
            fun, line,
            sets_errno ? strerror(errno) : errnum);
    exit(errval);
  }
}

#define CHECK_ERR(err, ...) check_err(err, 0, __func__, __LINE__, __VA_ARGS__)
#define CHECK_ERRNO(err, ...) check_err(err, 1, __func__, __LINE__, __VA_ARGS__)

// Read the rest of an open file into a NUL-terminated string; returns
// NULL on error.
static void* fslurp_file(FILE *f, size_t *size) {
  long start = ftell(f);
  fseek(f, 0, SEEK_END);
  long src_size = ftell(f)-start;
  fseek(f, start, SEEK_SET);
  unsigned char *s = (unsigned char*) malloc((size_t)src_size + 1);
  if (fread(s, 1, (size_t)src_size, f) != (size_t)src_size) {
    free(s);
    s = NULL;
  } else {
    s[src_size] = '\0';
  }

  if (size) {
    *size = (size_t)src_size;
  }

  return s;
}

// Read a file into a NUL-terminated string; returns NULL on error.
static void* slurp_file(const char *filename, size_t *size) {
  FILE *f = fopen(filename, "rb"); // To avoid Windows messing with linebreaks.
  if (f == NULL) return NULL;
  unsigned char *s = fslurp_file(f, size);
  fclose(f);
  return s;
}

// Dump 'n' bytes from 'buf' into the file at the designated location.
// Returns 0 on success.
static int dump_file(const char *file, const void *buf, size_t n) {
  FILE *f = fopen(file, "w");

  if (f == NULL) {
    return 1;
  }

  if (fwrite(buf, sizeof(char), n, f) != n) {
    return 1;
  }

  if (fclose(f) != 0) {
    return 1;
  }

  return 0;
}

struct str_builder {
  char *str;
  size_t capacity; // Size of buffer.
  size_t used; // Bytes used, *not* including final zero.
};

static void str_builder_init(struct str_builder *b) {
  b->capacity = 10;
  b->used = 0;
  b->str = malloc(b->capacity);
  b->str[0] = 0;
}

static void str_builder(struct str_builder *b, const char *s, ...) {
  va_list vl;
  va_start(vl, s);
  size_t needed = (size_t)vsnprintf(NULL, 0, s, vl);

  while (b->capacity < b->used + needed + 1) {
    b->capacity *= 2;
    b->str = realloc(b->str, b->capacity);
  }

  va_start(vl, s); // Must re-init.
  vsnprintf(b->str+b->used, b->capacity-b->used, s, vl);
  b->used += needed;
}

// End of util.h.
// Start of cache.h

#define CACHE_HASH_SIZE 8 // In 32-bit words.

struct cache_hash {
  uint32_t hash[CACHE_HASH_SIZE];
};

// Initialise a blank cache.
static void cache_hash_init(struct cache_hash *c);

// Hash some bytes and add them to the accumulated hash.
static void cache_hash(struct cache_hash *out, const char *in, size_t n);

// Try to restore cache contents from a file with the given name.
// Assumes the cache is invalid if it contains the given hash.
// Allocates memory and reads the cache conents, which is returned in
// *buf with size *buflen.  If the cache is successfully loaded, this
// function returns 0.  Otherwise it returns nonzero.  Errno is set if
// the failure to load the cache is due to anything except invalid
// cache conents.  Note that failing to restore the cache is not
// necessarily a problem: it might just be invalid or not created yet.
static int cache_restore(const char *fname, const struct cache_hash *hash,
                         unsigned char **buf, size_t *buflen);

// Store cache contents in the given file, with the given hash.
static int cache_store(const char *fname, const struct cache_hash *hash,
                       const unsigned char *buf, size_t buflen);

// Now for the implementation.

static void cache_hash_init(struct cache_hash *c) {
  memset(c->hash, 0, CACHE_HASH_SIZE * sizeof(uint32_t));
}

static void cache_hash(struct cache_hash *out, const char *in, size_t n) {
  // Adaptation of djb2 for larger output size by storing intermediate
  // states.
  uint32_t hash = 5381;
  for (size_t i = 0; i < n; i++) {
    hash = ((hash << 5) + hash) + in[i];
    out->hash[i % CACHE_HASH_SIZE] ^= hash;
  }
}

#define CACHE_HEADER_SIZE 8
static const char cache_header[CACHE_HEADER_SIZE] = "FUTHARK\0";

static int cache_restore(const char *fname, const struct cache_hash *hash,
                         unsigned char **buf, size_t *buflen) {
  FILE *f = fopen(fname, "rb");

  if (f == NULL) {
    return 1;
  }

  char f_header[CACHE_HEADER_SIZE];

  if (fread(f_header, sizeof(char), CACHE_HEADER_SIZE, f) != CACHE_HEADER_SIZE) {
    goto error;
  }

  if (memcmp(f_header, cache_header, CACHE_HEADER_SIZE) != 0) {
    goto error;
  }

  if (fseek(f, 0, SEEK_END) != 0) {
    goto error;
  }
  int64_t f_size = (int64_t)ftell(f);
  if (fseek(f, CACHE_HEADER_SIZE, SEEK_SET) != 0) {
    goto error;
  }

  int64_t expected_size;

  if (fread(&expected_size, sizeof(int64_t), 1, f) != 1) {
    goto error;
  }

  if (f_size != expected_size) {
    errno = 0;
    goto error;
  }

  int32_t f_hash[CACHE_HASH_SIZE];

  if (fread(f_hash, sizeof(int32_t), CACHE_HASH_SIZE, f) != CACHE_HASH_SIZE) {
    goto error;
  }

  if (memcmp(f_hash, hash->hash, CACHE_HASH_SIZE) != 0) {
    errno = 0;
    goto error;
  }

  *buflen = f_size - CACHE_HEADER_SIZE - sizeof(int64_t) - CACHE_HASH_SIZE*sizeof(int32_t);
  *buf = malloc(*buflen);
  if (fread(*buf, sizeof(char), *buflen, f) != *buflen) {
    free(*buf);
    goto error;
  }

  fclose(f);

  return 0;

 error:
  fclose(f);
  return 1;
}

static int cache_store(const char *fname, const struct cache_hash *hash,
                       const unsigned char *buf, size_t buflen) {
  FILE *f = fopen(fname, "wb");

  if (f == NULL) {
    return 1;
  }

  if (fwrite(cache_header, CACHE_HEADER_SIZE, 1, f) != 1) {
    goto error;
  }

  int64_t size = CACHE_HEADER_SIZE + sizeof(int64_t) + CACHE_HASH_SIZE*sizeof(int32_t) + buflen;

  if (fwrite(&size, sizeof(size), 1, f) != 1) {
    goto error;
  }

  if (fwrite(hash->hash, sizeof(int32_t), CACHE_HASH_SIZE, f) != CACHE_HASH_SIZE) {
    goto error;
  }

  if (fwrite(buf, sizeof(unsigned char), buflen, f) != buflen) {
    goto error;
  }

  fclose(f);

  return 0;

 error:
  fclose(f);
  return 1;
}

// End of cache.h
// Start of half.h.

// Conversion functions are from http://half.sourceforge.net/, but
// translated to C.
//
// Copyright (c) 2012-2021 Christian Rau
//
// Permission is hereby granted, free of charge, to any person obtaining a copy
// of this software and associated documentation files (the "Software"), to deal
// in the Software without restriction, including without limitation the rights
// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
// copies of the Software, and to permit persons to whom the Software is
// furnished to do so, subject to the following conditions:
//
// The above copyright notice and this permission notice shall be included in
// all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
// THE SOFTWARE.

#ifndef __OPENCL_VERSION__
#define __constant
#endif

__constant static const uint16_t base_table[512] = {
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0001, 0x0002, 0x0004, 0x0008, 0x0010, 0x0020, 0x0040, 0x0080, 0x0100,
  0x0200, 0x0400, 0x0800, 0x0C00, 0x1000, 0x1400, 0x1800, 0x1C00, 0x2000, 0x2400, 0x2800, 0x2C00, 0x3000, 0x3400, 0x3800, 0x3C00,
  0x4000, 0x4400, 0x4800, 0x4C00, 0x5000, 0x5400, 0x5800, 0x5C00, 0x6000, 0x6400, 0x6800, 0x6C00, 0x7000, 0x7400, 0x7800, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8001, 0x8002, 0x8004, 0x8008, 0x8010, 0x8020, 0x8040, 0x8080, 0x8100,
  0x8200, 0x8400, 0x8800, 0x8C00, 0x9000, 0x9400, 0x9800, 0x9C00, 0xA000, 0xA400, 0xA800, 0xAC00, 0xB000, 0xB400, 0xB800, 0xBC00,
  0xC000, 0xC400, 0xC800, 0xCC00, 0xD000, 0xD400, 0xD800, 0xDC00, 0xE000, 0xE400, 0xE800, 0xEC00, 0xF000, 0xF400, 0xF800, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00 };

__constant static const unsigned char shift_table[512] = {
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13,
  13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 13,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13,
  13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 13 };

__constant static const uint32_t mantissa_table[2048] = {
  0x00000000, 0x33800000, 0x34000000, 0x34400000, 0x34800000, 0x34A00000, 0x34C00000, 0x34E00000, 0x35000000, 0x35100000, 0x35200000, 0x35300000, 0x35400000, 0x35500000, 0x35600000, 0x35700000,
  0x35800000, 0x35880000, 0x35900000, 0x35980000, 0x35A00000, 0x35A80000, 0x35B00000, 0x35B80000, 0x35C00000, 0x35C80000, 0x35D00000, 0x35D80000, 0x35E00000, 0x35E80000, 0x35F00000, 0x35F80000,
  0x36000000, 0x36040000, 0x36080000, 0x360C0000, 0x36100000, 0x36140000, 0x36180000, 0x361C0000, 0x36200000, 0x36240000, 0x36280000, 0x362C0000, 0x36300000, 0x36340000, 0x36380000, 0x363C0000,
  0x36400000, 0x36440000, 0x36480000, 0x364C0000, 0x36500000, 0x36540000, 0x36580000, 0x365C0000, 0x36600000, 0x36640000, 0x36680000, 0x366C0000, 0x36700000, 0x36740000, 0x36780000, 0x367C0000,
  0x36800000, 0x36820000, 0x36840000, 0x36860000, 0x36880000, 0x368A0000, 0x368C0000, 0x368E0000, 0x36900000, 0x36920000, 0x36940000, 0x36960000, 0x36980000, 0x369A0000, 0x369C0000, 0x369E0000,
  0x36A00000, 0x36A20000, 0x36A40000, 0x36A60000, 0x36A80000, 0x36AA0000, 0x36AC0000, 0x36AE0000, 0x36B00000, 0x36B20000, 0x36B40000, 0x36B60000, 0x36B80000, 0x36BA0000, 0x36BC0000, 0x36BE0000,
  0x36C00000, 0x36C20000, 0x36C40000, 0x36C60000, 0x36C80000, 0x36CA0000, 0x36CC0000, 0x36CE0000, 0x36D00000, 0x36D20000, 0x36D40000, 0x36D60000, 0x36D80000, 0x36DA0000, 0x36DC0000, 0x36DE0000,
  0x36E00000, 0x36E20000, 0x36E40000, 0x36E60000, 0x36E80000, 0x36EA0000, 0x36EC0000, 0x36EE0000, 0x36F00000, 0x36F20000, 0x36F40000, 0x36F60000, 0x36F80000, 0x36FA0000, 0x36FC0000, 0x36FE0000,
  0x37000000, 0x37010000, 0x37020000, 0x37030000, 0x37040000, 0x37050000, 0x37060000, 0x37070000, 0x37080000, 0x37090000, 0x370A0000, 0x370B0000, 0x370C0000, 0x370D0000, 0x370E0000, 0x370F0000,
  0x37100000, 0x37110000, 0x37120000, 0x37130000, 0x37140000, 0x37150000, 0x37160000, 0x37170000, 0x37180000, 0x37190000, 0x371A0000, 0x371B0000, 0x371C0000, 0x371D0000, 0x371E0000, 0x371F0000,
  0x37200000, 0x37210000, 0x37220000, 0x37230000, 0x37240000, 0x37250000, 0x37260000, 0x37270000, 0x37280000, 0x37290000, 0x372A0000, 0x372B0000, 0x372C0000, 0x372D0000, 0x372E0000, 0x372F0000,
  0x37300000, 0x37310000, 0x37320000, 0x37330000, 0x37340000, 0x37350000, 0x37360000, 0x37370000, 0x37380000, 0x37390000, 0x373A0000, 0x373B0000, 0x373C0000, 0x373D0000, 0x373E0000, 0x373F0000,
  0x37400000, 0x37410000, 0x37420000, 0x37430000, 0x37440000, 0x37450000, 0x37460000, 0x37470000, 0x37480000, 0x37490000, 0x374A0000, 0x374B0000, 0x374C0000, 0x374D0000, 0x374E0000, 0x374F0000,
  0x37500000, 0x37510000, 0x37520000, 0x37530000, 0x37540000, 0x37550000, 0x37560000, 0x37570000, 0x37580000, 0x37590000, 0x375A0000, 0x375B0000, 0x375C0000, 0x375D0000, 0x375E0000, 0x375F0000,
  0x37600000, 0x37610000, 0x37620000, 0x37630000, 0x37640000, 0x37650000, 0x37660000, 0x37670000, 0x37680000, 0x37690000, 0x376A0000, 0x376B0000, 0x376C0000, 0x376D0000, 0x376E0000, 0x376F0000,
  0x37700000, 0x37710000, 0x37720000, 0x37730000, 0x37740000, 0x37750000, 0x37760000, 0x37770000, 0x37780000, 0x37790000, 0x377A0000, 0x377B0000, 0x377C0000, 0x377D0000, 0x377E0000, 0x377F0000,
  0x37800000, 0x37808000, 0x37810000, 0x37818000, 0x37820000, 0x37828000, 0x37830000, 0x37838000, 0x37840000, 0x37848000, 0x37850000, 0x37858000, 0x37860000, 0x37868000, 0x37870000, 0x37878000,
  0x37880000, 0x37888000, 0x37890000, 0x37898000, 0x378A0000, 0x378A8000, 0x378B0000, 0x378B8000, 0x378C0000, 0x378C8000, 0x378D0000, 0x378D8000, 0x378E0000, 0x378E8000, 0x378F0000, 0x378F8000,
  0x37900000, 0x37908000, 0x37910000, 0x37918000, 0x37920000, 0x37928000, 0x37930000, 0x37938000, 0x37940000, 0x37948000, 0x37950000, 0x37958000, 0x37960000, 0x37968000, 0x37970000, 0x37978000,
  0x37980000, 0x37988000, 0x37990000, 0x37998000, 0x379A0000, 0x379A8000, 0x379B0000, 0x379B8000, 0x379C0000, 0x379C8000, 0x379D0000, 0x379D8000, 0x379E0000, 0x379E8000, 0x379F0000, 0x379F8000,
  0x37A00000, 0x37A08000, 0x37A10000, 0x37A18000, 0x37A20000, 0x37A28000, 0x37A30000, 0x37A38000, 0x37A40000, 0x37A48000, 0x37A50000, 0x37A58000, 0x37A60000, 0x37A68000, 0x37A70000, 0x37A78000,
  0x37A80000, 0x37A88000, 0x37A90000, 0x37A98000, 0x37AA0000, 0x37AA8000, 0x37AB0000, 0x37AB8000, 0x37AC0000, 0x37AC8000, 0x37AD0000, 0x37AD8000, 0x37AE0000, 0x37AE8000, 0x37AF0000, 0x37AF8000,
  0x37B00000, 0x37B08000, 0x37B10000, 0x37B18000, 0x37B20000, 0x37B28000, 0x37B30000, 0x37B38000, 0x37B40000, 0x37B48000, 0x37B50000, 0x37B58000, 0x37B60000, 0x37B68000, 0x37B70000, 0x37B78000,
  0x37B80000, 0x37B88000, 0x37B90000, 0x37B98000, 0x37BA0000, 0x37BA8000, 0x37BB0000, 0x37BB8000, 0x37BC0000, 0x37BC8000, 0x37BD0000, 0x37BD8000, 0x37BE0000, 0x37BE8000, 0x37BF0000, 0x37BF8000,
  0x37C00000, 0x37C08000, 0x37C10000, 0x37C18000, 0x37C20000, 0x37C28000, 0x37C30000, 0x37C38000, 0x37C40000, 0x37C48000, 0x37C50000, 0x37C58000, 0x37C60000, 0x37C68000, 0x37C70000, 0x37C78000,
  0x37C80000, 0x37C88000, 0x37C90000, 0x37C98000, 0x37CA0000, 0x37CA8000, 0x37CB0000, 0x37CB8000, 0x37CC0000, 0x37CC8000, 0x37CD0000, 0x37CD8000, 0x37CE0000, 0x37CE8000, 0x37CF0000, 0x37CF8000,
  0x37D00000, 0x37D08000, 0x37D10000, 0x37D18000, 0x37D20000, 0x37D28000, 0x37D30000, 0x37D38000, 0x37D40000, 0x37D48000, 0x37D50000, 0x37D58000, 0x37D60000, 0x37D68000, 0x37D70000, 0x37D78000,
  0x37D80000, 0x37D88000, 0x37D90000, 0x37D98000, 0x37DA0000, 0x37DA8000, 0x37DB0000, 0x37DB8000, 0x37DC0000, 0x37DC8000, 0x37DD0000, 0x37DD8000, 0x37DE0000, 0x37DE8000, 0x37DF0000, 0x37DF8000,
  0x37E00000, 0x37E08000, 0x37E10000, 0x37E18000, 0x37E20000, 0x37E28000, 0x37E30000, 0x37E38000, 0x37E40000, 0x37E48000, 0x37E50000, 0x37E58000, 0x37E60000, 0x37E68000, 0x37E70000, 0x37E78000,
  0x37E80000, 0x37E88000, 0x37E90000, 0x37E98000, 0x37EA0000, 0x37EA8000, 0x37EB0000, 0x37EB8000, 0x37EC0000, 0x37EC8000, 0x37ED0000, 0x37ED8000, 0x37EE0000, 0x37EE8000, 0x37EF0000, 0x37EF8000,
  0x37F00000, 0x37F08000, 0x37F10000, 0x37F18000, 0x37F20000, 0x37F28000, 0x37F30000, 0x37F38000, 0x37F40000, 0x37F48000, 0x37F50000, 0x37F58000, 0x37F60000, 0x37F68000, 0x37F70000, 0x37F78000,
  0x37F80000, 0x37F88000, 0x37F90000, 0x37F98000, 0x37FA0000, 0x37FA8000, 0x37FB0000, 0x37FB8000, 0x37FC0000, 0x37FC8000, 0x37FD0000, 0x37FD8000, 0x37FE0000, 0x37FE8000, 0x37FF0000, 0x37FF8000,
  0x38000000, 0x38004000, 0x38008000, 0x3800C000, 0x38010000, 0x38014000, 0x38018000, 0x3801C000, 0x38020000, 0x38024000, 0x38028000, 0x3802C000, 0x38030000, 0x38034000, 0x38038000, 0x3803C000,
  0x38040000, 0x38044000, 0x38048000, 0x3804C000, 0x38050000, 0x38054000, 0x38058000, 0x3805C000, 0x38060000, 0x38064000, 0x38068000, 0x3806C000, 0x38070000, 0x38074000, 0x38078000, 0x3807C000,
  0x38080000, 0x38084000, 0x38088000, 0x3808C000, 0x38090000, 0x38094000, 0x38098000, 0x3809C000, 0x380A0000, 0x380A4000, 0x380A8000, 0x380AC000, 0x380B0000, 0x380B4000, 0x380B8000, 0x380BC000,
  0x380C0000, 0x380C4000, 0x380C8000, 0x380CC000, 0x380D0000, 0x380D4000, 0x380D8000, 0x380DC000, 0x380E0000, 0x380E4000, 0x380E8000, 0x380EC000, 0x380F0000, 0x380F4000, 0x380F8000, 0x380FC000,
  0x38100000, 0x38104000, 0x38108000, 0x3810C000, 0x38110000, 0x38114000, 0x38118000, 0x3811C000, 0x38120000, 0x38124000, 0x38128000, 0x3812C000, 0x38130000, 0x38134000, 0x38138000, 0x3813C000,
  0x38140000, 0x38144000, 0x38148000, 0x3814C000, 0x38150000, 0x38154000, 0x38158000, 0x3815C000, 0x38160000, 0x38164000, 0x38168000, 0x3816C000, 0x38170000, 0x38174000, 0x38178000, 0x3817C000,
  0x38180000, 0x38184000, 0x38188000, 0x3818C000, 0x38190000, 0x38194000, 0x38198000, 0x3819C000, 0x381A0000, 0x381A4000, 0x381A8000, 0x381AC000, 0x381B0000, 0x381B4000, 0x381B8000, 0x381BC000,
  0x381C0000, 0x381C4000, 0x381C8000, 0x381CC000, 0x381D0000, 0x381D4000, 0x381D8000, 0x381DC000, 0x381E0000, 0x381E4000, 0x381E8000, 0x381EC000, 0x381F0000, 0x381F4000, 0x381F8000, 0x381FC000,
  0x38200000, 0x38204000, 0x38208000, 0x3820C000, 0x38210000, 0x38214000, 0x38218000, 0x3821C000, 0x38220000, 0x38224000, 0x38228000, 0x3822C000, 0x38230000, 0x38234000, 0x38238000, 0x3823C000,
  0x38240000, 0x38244000, 0x38248000, 0x3824C000, 0x38250000, 0x38254000, 0x38258000, 0x3825C000, 0x38260000, 0x38264000, 0x38268000, 0x3826C000, 0x38270000, 0x38274000, 0x38278000, 0x3827C000,
  0x38280000, 0x38284000, 0x38288000, 0x3828C000, 0x38290000, 0x38294000, 0x38298000, 0x3829C000, 0x382A0000, 0x382A4000, 0x382A8000, 0x382AC000, 0x382B0000, 0x382B4000, 0x382B8000, 0x382BC000,
  0x382C0000, 0x382C4000, 0x382C8000, 0x382CC000, 0x382D0000, 0x382D4000, 0x382D8000, 0x382DC000, 0x382E0000, 0x382E4000, 0x382E8000, 0x382EC000, 0x382F0000, 0x382F4000, 0x382F8000, 0x382FC000,
  0x38300000, 0x38304000, 0x38308000, 0x3830C000, 0x38310000, 0x38314000, 0x38318000, 0x3831C000, 0x38320000, 0x38324000, 0x38328000, 0x3832C000, 0x38330000, 0x38334000, 0x38338000, 0x3833C000,
  0x38340000, 0x38344000, 0x38348000, 0x3834C000, 0x38350000, 0x38354000, 0x38358000, 0x3835C000, 0x38360000, 0x38364000, 0x38368000, 0x3836C000, 0x38370000, 0x38374000, 0x38378000, 0x3837C000,
  0x38380000, 0x38384000, 0x38388000, 0x3838C000, 0x38390000, 0x38394000, 0x38398000, 0x3839C000, 0x383A0000, 0x383A4000, 0x383A8000, 0x383AC000, 0x383B0000, 0x383B4000, 0x383B8000, 0x383BC000,
  0x383C0000, 0x383C4000, 0x383C8000, 0x383CC000, 0x383D0000, 0x383D4000, 0x383D8000, 0x383DC000, 0x383E0000, 0x383E4000, 0x383E8000, 0x383EC000, 0x383F0000, 0x383F4000, 0x383F8000, 0x383FC000,
  0x38400000, 0x38404000, 0x38408000, 0x3840C000, 0x38410000, 0x38414000, 0x38418000, 0x3841C000, 0x38420000, 0x38424000, 0x38428000, 0x3842C000, 0x38430000, 0x38434000, 0x38438000, 0x3843C000,
  0x38440000, 0x38444000, 0x38448000, 0x3844C000, 0x38450000, 0x38454000, 0x38458000, 0x3845C000, 0x38460000, 0x38464000, 0x38468000, 0x3846C000, 0x38470000, 0x38474000, 0x38478000, 0x3847C000,
  0x38480000, 0x38484000, 0x38488000, 0x3848C000, 0x38490000, 0x38494000, 0x38498000, 0x3849C000, 0x384A0000, 0x384A4000, 0x384A8000, 0x384AC000, 0x384B0000, 0x384B4000, 0x384B8000, 0x384BC000,
  0x384C0000, 0x384C4000, 0x384C8000, 0x384CC000, 0x384D0000, 0x384D4000, 0x384D8000, 0x384DC000, 0x384E0000, 0x384E4000, 0x384E8000, 0x384EC000, 0x384F0000, 0x384F4000, 0x384F8000, 0x384FC000,
  0x38500000, 0x38504000, 0x38508000, 0x3850C000, 0x38510000, 0x38514000, 0x38518000, 0x3851C000, 0x38520000, 0x38524000, 0x38528000, 0x3852C000, 0x38530000, 0x38534000, 0x38538000, 0x3853C000,
  0x38540000, 0x38544000, 0x38548000, 0x3854C000, 0x38550000, 0x38554000, 0x38558000, 0x3855C000, 0x38560000, 0x38564000, 0x38568000, 0x3856C000, 0x38570000, 0x38574000, 0x38578000, 0x3857C000,
  0x38580000, 0x38584000, 0x38588000, 0x3858C000, 0x38590000, 0x38594000, 0x38598000, 0x3859C000, 0x385A0000, 0x385A4000, 0x385A8000, 0x385AC000, 0x385B0000, 0x385B4000, 0x385B8000, 0x385BC000,
  0x385C0000, 0x385C4000, 0x385C8000, 0x385CC000, 0x385D0000, 0x385D4000, 0x385D8000, 0x385DC000, 0x385E0000, 0x385E4000, 0x385E8000, 0x385EC000, 0x385F0000, 0x385F4000, 0x385F8000, 0x385FC000,
  0x38600000, 0x38604000, 0x38608000, 0x3860C000, 0x38610000, 0x38614000, 0x38618000, 0x3861C000, 0x38620000, 0x38624000, 0x38628000, 0x3862C000, 0x38630000, 0x38634000, 0x38638000, 0x3863C000,
  0x38640000, 0x38644000, 0x38648000, 0x3864C000, 0x38650000, 0x38654000, 0x38658000, 0x3865C000, 0x38660000, 0x38664000, 0x38668000, 0x3866C000, 0x38670000, 0x38674000, 0x38678000, 0x3867C000,
  0x38680000, 0x38684000, 0x38688000, 0x3868C000, 0x38690000, 0x38694000, 0x38698000, 0x3869C000, 0x386A0000, 0x386A4000, 0x386A8000, 0x386AC000, 0x386B0000, 0x386B4000, 0x386B8000, 0x386BC000,
  0x386C0000, 0x386C4000, 0x386C8000, 0x386CC000, 0x386D0000, 0x386D4000, 0x386D8000, 0x386DC000, 0x386E0000, 0x386E4000, 0x386E8000, 0x386EC000, 0x386F0000, 0x386F4000, 0x386F8000, 0x386FC000,
  0x38700000, 0x38704000, 0x38708000, 0x3870C000, 0x38710000, 0x38714000, 0x38718000, 0x3871C000, 0x38720000, 0x38724000, 0x38728000, 0x3872C000, 0x38730000, 0x38734000, 0x38738000, 0x3873C000,
  0x38740000, 0x38744000, 0x38748000, 0x3874C000, 0x38750000, 0x38754000, 0x38758000, 0x3875C000, 0x38760000, 0x38764000, 0x38768000, 0x3876C000, 0x38770000, 0x38774000, 0x38778000, 0x3877C000,
  0x38780000, 0x38784000, 0x38788000, 0x3878C000, 0x38790000, 0x38794000, 0x38798000, 0x3879C000, 0x387A0000, 0x387A4000, 0x387A8000, 0x387AC000, 0x387B0000, 0x387B4000, 0x387B8000, 0x387BC000,
  0x387C0000, 0x387C4000, 0x387C8000, 0x387CC000, 0x387D0000, 0x387D4000, 0x387D8000, 0x387DC000, 0x387E0000, 0x387E4000, 0x387E8000, 0x387EC000, 0x387F0000, 0x387F4000, 0x387F8000, 0x387FC000,
  0x38000000, 0x38002000, 0x38004000, 0x38006000, 0x38008000, 0x3800A000, 0x3800C000, 0x3800E000, 0x38010000, 0x38012000, 0x38014000, 0x38016000, 0x38018000, 0x3801A000, 0x3801C000, 0x3801E000,
  0x38020000, 0x38022000, 0x38024000, 0x38026000, 0x38028000, 0x3802A000, 0x3802C000, 0x3802E000, 0x38030000, 0x38032000, 0x38034000, 0x38036000, 0x38038000, 0x3803A000, 0x3803C000, 0x3803E000,
  0x38040000, 0x38042000, 0x38044000, 0x38046000, 0x38048000, 0x3804A000, 0x3804C000, 0x3804E000, 0x38050000, 0x38052000, 0x38054000, 0x38056000, 0x38058000, 0x3805A000, 0x3805C000, 0x3805E000,
  0x38060000, 0x38062000, 0x38064000, 0x38066000, 0x38068000, 0x3806A000, 0x3806C000, 0x3806E000, 0x38070000, 0x38072000, 0x38074000, 0x38076000, 0x38078000, 0x3807A000, 0x3807C000, 0x3807E000,
  0x38080000, 0x38082000, 0x38084000, 0x38086000, 0x38088000, 0x3808A000, 0x3808C000, 0x3808E000, 0x38090000, 0x38092000, 0x38094000, 0x38096000, 0x38098000, 0x3809A000, 0x3809C000, 0x3809E000,
  0x380A0000, 0x380A2000, 0x380A4000, 0x380A6000, 0x380A8000, 0x380AA000, 0x380AC000, 0x380AE000, 0x380B0000, 0x380B2000, 0x380B4000, 0x380B6000, 0x380B8000, 0x380BA000, 0x380BC000, 0x380BE000,
  0x380C0000, 0x380C2000, 0x380C4000, 0x380C6000, 0x380C8000, 0x380CA000, 0x380CC000, 0x380CE000, 0x380D0000, 0x380D2000, 0x380D4000, 0x380D6000, 0x380D8000, 0x380DA000, 0x380DC000, 0x380DE000,
  0x380E0000, 0x380E2000, 0x380E4000, 0x380E6000, 0x380E8000, 0x380EA000, 0x380EC000, 0x380EE000, 0x380F0000, 0x380F2000, 0x380F4000, 0x380F6000, 0x380F8000, 0x380FA000, 0x380FC000, 0x380FE000,
  0x38100000, 0x38102000, 0x38104000, 0x38106000, 0x38108000, 0x3810A000, 0x3810C000, 0x3810E000, 0x38110000, 0x38112000, 0x38114000, 0x38116000, 0x38118000, 0x3811A000, 0x3811C000, 0x3811E000,
  0x38120000, 0x38122000, 0x38124000, 0x38126000, 0x38128000, 0x3812A000, 0x3812C000, 0x3812E000, 0x38130000, 0x38132000, 0x38134000, 0x38136000, 0x38138000, 0x3813A000, 0x3813C000, 0x3813E000,
  0x38140000, 0x38142000, 0x38144000, 0x38146000, 0x38148000, 0x3814A000, 0x3814C000, 0x3814E000, 0x38150000, 0x38152000, 0x38154000, 0x38156000, 0x38158000, 0x3815A000, 0x3815C000, 0x3815E000,
  0x38160000, 0x38162000, 0x38164000, 0x38166000, 0x38168000, 0x3816A000, 0x3816C000, 0x3816E000, 0x38170000, 0x38172000, 0x38174000, 0x38176000, 0x38178000, 0x3817A000, 0x3817C000, 0x3817E000,
  0x38180000, 0x38182000, 0x38184000, 0x38186000, 0x38188000, 0x3818A000, 0x3818C000, 0x3818E000, 0x38190000, 0x38192000, 0x38194000, 0x38196000, 0x38198000, 0x3819A000, 0x3819C000, 0x3819E000,
  0x381A0000, 0x381A2000, 0x381A4000, 0x381A6000, 0x381A8000, 0x381AA000, 0x381AC000, 0x381AE000, 0x381B0000, 0x381B2000, 0x381B4000, 0x381B6000, 0x381B8000, 0x381BA000, 0x381BC000, 0x381BE000,
  0x381C0000, 0x381C2000, 0x381C4000, 0x381C6000, 0x381C8000, 0x381CA000, 0x381CC000, 0x381CE000, 0x381D0000, 0x381D2000, 0x381D4000, 0x381D6000, 0x381D8000, 0x381DA000, 0x381DC000, 0x381DE000,
  0x381E0000, 0x381E2000, 0x381E4000, 0x381E6000, 0x381E8000, 0x381EA000, 0x381EC000, 0x381EE000, 0x381F0000, 0x381F2000, 0x381F4000, 0x381F6000, 0x381F8000, 0x381FA000, 0x381FC000, 0x381FE000,
  0x38200000, 0x38202000, 0x38204000, 0x38206000, 0x38208000, 0x3820A000, 0x3820C000, 0x3820E000, 0x38210000, 0x38212000, 0x38214000, 0x38216000, 0x38218000, 0x3821A000, 0x3821C000, 0x3821E000,
  0x38220000, 0x38222000, 0x38224000, 0x38226000, 0x38228000, 0x3822A000, 0x3822C000, 0x3822E000, 0x38230000, 0x38232000, 0x38234000, 0x38236000, 0x38238000, 0x3823A000, 0x3823C000, 0x3823E000,
  0x38240000, 0x38242000, 0x38244000, 0x38246000, 0x38248000, 0x3824A000, 0x3824C000, 0x3824E000, 0x38250000, 0x38252000, 0x38254000, 0x38256000, 0x38258000, 0x3825A000, 0x3825C000, 0x3825E000,
  0x38260000, 0x38262000, 0x38264000, 0x38266000, 0x38268000, 0x3826A000, 0x3826C000, 0x3826E000, 0x38270000, 0x38272000, 0x38274000, 0x38276000, 0x38278000, 0x3827A000, 0x3827C000, 0x3827E000,
  0x38280000, 0x38282000, 0x38284000, 0x38286000, 0x38288000, 0x3828A000, 0x3828C000, 0x3828E000, 0x38290000, 0x38292000, 0x38294000, 0x38296000, 0x38298000, 0x3829A000, 0x3829C000, 0x3829E000,
  0x382A0000, 0x382A2000, 0x382A4000, 0x382A6000, 0x382A8000, 0x382AA000, 0x382AC000, 0x382AE000, 0x382B0000, 0x382B2000, 0x382B4000, 0x382B6000, 0x382B8000, 0x382BA000, 0x382BC000, 0x382BE000,
  0x382C0000, 0x382C2000, 0x382C4000, 0x382C6000, 0x382C8000, 0x382CA000, 0x382CC000, 0x382CE000, 0x382D0000, 0x382D2000, 0x382D4000, 0x382D6000, 0x382D8000, 0x382DA000, 0x382DC000, 0x382DE000,
  0x382E0000, 0x382E2000, 0x382E4000, 0x382E6000, 0x382E8000, 0x382EA000, 0x382EC000, 0x382EE000, 0x382F0000, 0x382F2000, 0x382F4000, 0x382F6000, 0x382F8000, 0x382FA000, 0x382FC000, 0x382FE000,
  0x38300000, 0x38302000, 0x38304000, 0x38306000, 0x38308000, 0x3830A000, 0x3830C000, 0x3830E000, 0x38310000, 0x38312000, 0x38314000, 0x38316000, 0x38318000, 0x3831A000, 0x3831C000, 0x3831E000,
  0x38320000, 0x38322000, 0x38324000, 0x38326000, 0x38328000, 0x3832A000, 0x3832C000, 0x3832E000, 0x38330000, 0x38332000, 0x38334000, 0x38336000, 0x38338000, 0x3833A000, 0x3833C000, 0x3833E000,
  0x38340000, 0x38342000, 0x38344000, 0x38346000, 0x38348000, 0x3834A000, 0x3834C000, 0x3834E000, 0x38350000, 0x38352000, 0x38354000, 0x38356000, 0x38358000, 0x3835A000, 0x3835C000, 0x3835E000,
  0x38360000, 0x38362000, 0x38364000, 0x38366000, 0x38368000, 0x3836A000, 0x3836C000, 0x3836E000, 0x38370000, 0x38372000, 0x38374000, 0x38376000, 0x38378000, 0x3837A000, 0x3837C000, 0x3837E000,
  0x38380000, 0x38382000, 0x38384000, 0x38386000, 0x38388000, 0x3838A000, 0x3838C000, 0x3838E000, 0x38390000, 0x38392000, 0x38394000, 0x38396000, 0x38398000, 0x3839A000, 0x3839C000, 0x3839E000,
  0x383A0000, 0x383A2000, 0x383A4000, 0x383A6000, 0x383A8000, 0x383AA000, 0x383AC000, 0x383AE000, 0x383B0000, 0x383B2000, 0x383B4000, 0x383B6000, 0x383B8000, 0x383BA000, 0x383BC000, 0x383BE000,
  0x383C0000, 0x383C2000, 0x383C4000, 0x383C6000, 0x383C8000, 0x383CA000, 0x383CC000, 0x383CE000, 0x383D0000, 0x383D2000, 0x383D4000, 0x383D6000, 0x383D8000, 0x383DA000, 0x383DC000, 0x383DE000,
  0x383E0000, 0x383E2000, 0x383E4000, 0x383E6000, 0x383E8000, 0x383EA000, 0x383EC000, 0x383EE000, 0x383F0000, 0x383F2000, 0x383F4000, 0x383F6000, 0x383F8000, 0x383FA000, 0x383FC000, 0x383FE000,
  0x38400000, 0x38402000, 0x38404000, 0x38406000, 0x38408000, 0x3840A000, 0x3840C000, 0x3840E000, 0x38410000, 0x38412000, 0x38414000, 0x38416000, 0x38418000, 0x3841A000, 0x3841C000, 0x3841E000,
  0x38420000, 0x38422000, 0x38424000, 0x38426000, 0x38428000, 0x3842A000, 0x3842C000, 0x3842E000, 0x38430000, 0x38432000, 0x38434000, 0x38436000, 0x38438000, 0x3843A000, 0x3843C000, 0x3843E000,
  0x38440000, 0x38442000, 0x38444000, 0x38446000, 0x38448000, 0x3844A000, 0x3844C000, 0x3844E000, 0x38450000, 0x38452000, 0x38454000, 0x38456000, 0x38458000, 0x3845A000, 0x3845C000, 0x3845E000,
  0x38460000, 0x38462000, 0x38464000, 0x38466000, 0x38468000, 0x3846A000, 0x3846C000, 0x3846E000, 0x38470000, 0x38472000, 0x38474000, 0x38476000, 0x38478000, 0x3847A000, 0x3847C000, 0x3847E000,
  0x38480000, 0x38482000, 0x38484000, 0x38486000, 0x38488000, 0x3848A000, 0x3848C000, 0x3848E000, 0x38490000, 0x38492000, 0x38494000, 0x38496000, 0x38498000, 0x3849A000, 0x3849C000, 0x3849E000,
  0x384A0000, 0x384A2000, 0x384A4000, 0x384A6000, 0x384A8000, 0x384AA000, 0x384AC000, 0x384AE000, 0x384B0000, 0x384B2000, 0x384B4000, 0x384B6000, 0x384B8000, 0x384BA000, 0x384BC000, 0x384BE000,
  0x384C0000, 0x384C2000, 0x384C4000, 0x384C6000, 0x384C8000, 0x384CA000, 0x384CC000, 0x384CE000, 0x384D0000, 0x384D2000, 0x384D4000, 0x384D6000, 0x384D8000, 0x384DA000, 0x384DC000, 0x384DE000,
  0x384E0000, 0x384E2000, 0x384E4000, 0x384E6000, 0x384E8000, 0x384EA000, 0x384EC000, 0x384EE000, 0x384F0000, 0x384F2000, 0x384F4000, 0x384F6000, 0x384F8000, 0x384FA000, 0x384FC000, 0x384FE000,
  0x38500000, 0x38502000, 0x38504000, 0x38506000, 0x38508000, 0x3850A000, 0x3850C000, 0x3850E000, 0x38510000, 0x38512000, 0x38514000, 0x38516000, 0x38518000, 0x3851A000, 0x3851C000, 0x3851E000,
  0x38520000, 0x38522000, 0x38524000, 0x38526000, 0x38528000, 0x3852A000, 0x3852C000, 0x3852E000, 0x38530000, 0x38532000, 0x38534000, 0x38536000, 0x38538000, 0x3853A000, 0x3853C000, 0x3853E000,
  0x38540000, 0x38542000, 0x38544000, 0x38546000, 0x38548000, 0x3854A000, 0x3854C000, 0x3854E000, 0x38550000, 0x38552000, 0x38554000, 0x38556000, 0x38558000, 0x3855A000, 0x3855C000, 0x3855E000,
  0x38560000, 0x38562000, 0x38564000, 0x38566000, 0x38568000, 0x3856A000, 0x3856C000, 0x3856E000, 0x38570000, 0x38572000, 0x38574000, 0x38576000, 0x38578000, 0x3857A000, 0x3857C000, 0x3857E000,
  0x38580000, 0x38582000, 0x38584000, 0x38586000, 0x38588000, 0x3858A000, 0x3858C000, 0x3858E000, 0x38590000, 0x38592000, 0x38594000, 0x38596000, 0x38598000, 0x3859A000, 0x3859C000, 0x3859E000,
  0x385A0000, 0x385A2000, 0x385A4000, 0x385A6000, 0x385A8000, 0x385AA000, 0x385AC000, 0x385AE000, 0x385B0000, 0x385B2000, 0x385B4000, 0x385B6000, 0x385B8000, 0x385BA000, 0x385BC000, 0x385BE000,
  0x385C0000, 0x385C2000, 0x385C4000, 0x385C6000, 0x385C8000, 0x385CA000, 0x385CC000, 0x385CE000, 0x385D0000, 0x385D2000, 0x385D4000, 0x385D6000, 0x385D8000, 0x385DA000, 0x385DC000, 0x385DE000,
  0x385E0000, 0x385E2000, 0x385E4000, 0x385E6000, 0x385E8000, 0x385EA000, 0x385EC000, 0x385EE000, 0x385F0000, 0x385F2000, 0x385F4000, 0x385F6000, 0x385F8000, 0x385FA000, 0x385FC000, 0x385FE000,
  0x38600000, 0x38602000, 0x38604000, 0x38606000, 0x38608000, 0x3860A000, 0x3860C000, 0x3860E000, 0x38610000, 0x38612000, 0x38614000, 0x38616000, 0x38618000, 0x3861A000, 0x3861C000, 0x3861E000,
  0x38620000, 0x38622000, 0x38624000, 0x38626000, 0x38628000, 0x3862A000, 0x3862C000, 0x3862E000, 0x38630000, 0x38632000, 0x38634000, 0x38636000, 0x38638000, 0x3863A000, 0x3863C000, 0x3863E000,
  0x38640000, 0x38642000, 0x38644000, 0x38646000, 0x38648000, 0x3864A000, 0x3864C000, 0x3864E000, 0x38650000, 0x38652000, 0x38654000, 0x38656000, 0x38658000, 0x3865A000, 0x3865C000, 0x3865E000,
  0x38660000, 0x38662000, 0x38664000, 0x38666000, 0x38668000, 0x3866A000, 0x3866C000, 0x3866E000, 0x38670000, 0x38672000, 0x38674000, 0x38676000, 0x38678000, 0x3867A000, 0x3867C000, 0x3867E000,
  0x38680000, 0x38682000, 0x38684000, 0x38686000, 0x38688000, 0x3868A000, 0x3868C000, 0x3868E000, 0x38690000, 0x38692000, 0x38694000, 0x38696000, 0x38698000, 0x3869A000, 0x3869C000, 0x3869E000,
  0x386A0000, 0x386A2000, 0x386A4000, 0x386A6000, 0x386A8000, 0x386AA000, 0x386AC000, 0x386AE000, 0x386B0000, 0x386B2000, 0x386B4000, 0x386B6000, 0x386B8000, 0x386BA000, 0x386BC000, 0x386BE000,
  0x386C0000, 0x386C2000, 0x386C4000, 0x386C6000, 0x386C8000, 0x386CA000, 0x386CC000, 0x386CE000, 0x386D0000, 0x386D2000, 0x386D4000, 0x386D6000, 0x386D8000, 0x386DA000, 0x386DC000, 0x386DE000,
  0x386E0000, 0x386E2000, 0x386E4000, 0x386E6000, 0x386E8000, 0x386EA000, 0x386EC000, 0x386EE000, 0x386F0000, 0x386F2000, 0x386F4000, 0x386F6000, 0x386F8000, 0x386FA000, 0x386FC000, 0x386FE000,
  0x38700000, 0x38702000, 0x38704000, 0x38706000, 0x38708000, 0x3870A000, 0x3870C000, 0x3870E000, 0x38710000, 0x38712000, 0x38714000, 0x38716000, 0x38718000, 0x3871A000, 0x3871C000, 0x3871E000,
  0x38720000, 0x38722000, 0x38724000, 0x38726000, 0x38728000, 0x3872A000, 0x3872C000, 0x3872E000, 0x38730000, 0x38732000, 0x38734000, 0x38736000, 0x38738000, 0x3873A000, 0x3873C000, 0x3873E000,
  0x38740000, 0x38742000, 0x38744000, 0x38746000, 0x38748000, 0x3874A000, 0x3874C000, 0x3874E000, 0x38750000, 0x38752000, 0x38754000, 0x38756000, 0x38758000, 0x3875A000, 0x3875C000, 0x3875E000,
  0x38760000, 0x38762000, 0x38764000, 0x38766000, 0x38768000, 0x3876A000, 0x3876C000, 0x3876E000, 0x38770000, 0x38772000, 0x38774000, 0x38776000, 0x38778000, 0x3877A000, 0x3877C000, 0x3877E000,
  0x38780000, 0x38782000, 0x38784000, 0x38786000, 0x38788000, 0x3878A000, 0x3878C000, 0x3878E000, 0x38790000, 0x38792000, 0x38794000, 0x38796000, 0x38798000, 0x3879A000, 0x3879C000, 0x3879E000,
  0x387A0000, 0x387A2000, 0x387A4000, 0x387A6000, 0x387A8000, 0x387AA000, 0x387AC000, 0x387AE000, 0x387B0000, 0x387B2000, 0x387B4000, 0x387B6000, 0x387B8000, 0x387BA000, 0x387BC000, 0x387BE000,
  0x387C0000, 0x387C2000, 0x387C4000, 0x387C6000, 0x387C8000, 0x387CA000, 0x387CC000, 0x387CE000, 0x387D0000, 0x387D2000, 0x387D4000, 0x387D6000, 0x387D8000, 0x387DA000, 0x387DC000, 0x387DE000,
  0x387E0000, 0x387E2000, 0x387E4000, 0x387E6000, 0x387E8000, 0x387EA000, 0x387EC000, 0x387EE000, 0x387F0000, 0x387F2000, 0x387F4000, 0x387F6000, 0x387F8000, 0x387FA000, 0x387FC000, 0x387FE000 };
__constant static const uint32_t exponent_table[64] = {
  0x00000000, 0x00800000, 0x01000000, 0x01800000, 0x02000000, 0x02800000, 0x03000000, 0x03800000, 0x04000000, 0x04800000, 0x05000000, 0x05800000, 0x06000000, 0x06800000, 0x07000000, 0x07800000,
  0x08000000, 0x08800000, 0x09000000, 0x09800000, 0x0A000000, 0x0A800000, 0x0B000000, 0x0B800000, 0x0C000000, 0x0C800000, 0x0D000000, 0x0D800000, 0x0E000000, 0x0E800000, 0x0F000000, 0x47800000,
  0x80000000, 0x80800000, 0x81000000, 0x81800000, 0x82000000, 0x82800000, 0x83000000, 0x83800000, 0x84000000, 0x84800000, 0x85000000, 0x85800000, 0x86000000, 0x86800000, 0x87000000, 0x87800000,
  0x88000000, 0x88800000, 0x89000000, 0x89800000, 0x8A000000, 0x8A800000, 0x8B000000, 0x8B800000, 0x8C000000, 0x8C800000, 0x8D000000, 0x8D800000, 0x8E000000, 0x8E800000, 0x8F000000, 0xC7800000 };
__constant static const unsigned short offset_table[64] = {
  0, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024,
  0, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024 };

static uint16_t float2halfbits(float value) {
  union { float x; uint32_t y; } u;
  u.x = value;
  uint32_t bits = u.y;

  uint16_t hbits = base_table[bits>>23] + (uint16_t)((bits&0x7FFFFF)>>shift_table[bits>>23]);;

  return hbits;
}

static float halfbits2float(uint16_t value) {
  uint32_t bits = mantissa_table[offset_table[value>>10]+(value&0x3FF)] + exponent_table[value>>10];

  union { uint32_t x; float y; } u;
  u.x = bits;
  return u.y;
}

// End of half.h.
// Start of timing.h.

// The function get_wall_time() returns the wall time in microseconds
// (with an unspecified offset).

#ifdef _WIN32

#include <windows.h>

static int64_t get_wall_time(void) {
  LARGE_INTEGER time,freq;
  assert(QueryPerformanceFrequency(&freq));
  assert(QueryPerformanceCounter(&time));
  return ((double)time.QuadPart / freq.QuadPart) * 1000000;
}

#else
// Assuming POSIX

#include <time.h>
#include <sys/time.h>

static int64_t get_wall_time(void) {
  struct timeval time;
  assert(gettimeofday(&time,NULL) == 0);
  return time.tv_sec * 1000000 + time.tv_usec;
}

static int64_t get_wall_time_ns(void) {
  struct timespec time;
  assert(clock_gettime(CLOCK_REALTIME, &time) == 0);
  return time.tv_sec * 1000000000 + time.tv_nsec;
}

#endif

// End of timing.h.
#include <getopt.h>
#include <ctype.h>
#include <inttypes.h>
#include <unistd.h>
// Start of values.h.

//// Text I/O

typedef int (*writer)(FILE*, const void*);
typedef int (*bin_reader)(void*);
typedef int (*str_reader)(const char *, void*);

struct array_reader {
  char* elems;
  int64_t n_elems_space;
  int64_t elem_size;
  int64_t n_elems_used;
  int64_t *shape;
  str_reader elem_reader;
};

static void skipspaces(FILE *f) {
  int c;
  do {
    c = getc(f);
  } while (isspace(c));

  if (c != EOF) {
    ungetc(c, f);
  }
}

static int constituent(char c) {
  return isalnum(c) || c == '.' || c == '-' || c == '+' || c == '_';
}

// Produces an empty token only on EOF.
static void next_token(FILE *f, char *buf, int bufsize) {
 start:
  skipspaces(f);

  int i = 0;
  while (i < bufsize) {
    int c = getc(f);
    buf[i] = (char)c;

    if (c == EOF) {
      buf[i] = 0;
      return;
    } else if (c == '-' && i == 1 && buf[0] == '-') {
      // Line comment, so skip to end of line and start over.
      for (; c != '\n' && c != EOF; c = getc(f));
      goto start;
    } else if (!constituent((char)c)) {
      if (i == 0) {
        // We permit single-character tokens that are not
        // constituents; this lets things like ']' and ',' be
        // tokens.
        buf[i+1] = 0;
        return;
      } else {
        ungetc(c, f);
        buf[i] = 0;
        return;
      }
    }

    i++;
  }

  buf[bufsize-1] = 0;
}

static int next_token_is(FILE *f, char *buf, int bufsize, const char* expected) {
  next_token(f, buf, bufsize);
  return strcmp(buf, expected) == 0;
}

static void remove_underscores(char *buf) {
  char *w = buf;

  for (char *r = buf; *r; r++) {
    if (*r != '_') {
      *w++ = *r;
    }
  }

  *w++ = 0;
}

static int read_str_elem(char *buf, struct array_reader *reader) {
  int ret;
  if (reader->n_elems_used == reader->n_elems_space) {
    reader->n_elems_space *= 2;
    reader->elems = (char*) realloc(reader->elems,
                                    (size_t)(reader->n_elems_space * reader->elem_size));
  }

  ret = reader->elem_reader(buf, reader->elems + reader->n_elems_used * reader->elem_size);

  if (ret == 0) {
    reader->n_elems_used++;
  }

  return ret;
}

static int read_str_array_elems(FILE *f,
                                char *buf, int bufsize,
                                struct array_reader *reader, int64_t dims) {
  int ret;
  int first = 1;
  char *knows_dimsize = (char*) calloc((size_t)dims, sizeof(char));
  int cur_dim = (int)dims-1;
  int64_t *elems_read_in_dim = (int64_t*) calloc((size_t)dims, sizeof(int64_t));

  while (1) {
    next_token(f, buf, bufsize);

    if (strcmp(buf, "]") == 0) {
      if (knows_dimsize[cur_dim]) {
        if (reader->shape[cur_dim] != elems_read_in_dim[cur_dim]) {
          ret = 1;
          break;
        }
      } else {
        knows_dimsize[cur_dim] = 1;
        reader->shape[cur_dim] = elems_read_in_dim[cur_dim];
      }
      if (cur_dim == 0) {
        ret = 0;
        break;
      } else {
        cur_dim--;
        elems_read_in_dim[cur_dim]++;
      }
    } else if (strcmp(buf, ",") == 0) {
      next_token(f, buf, bufsize);
      if (strcmp(buf, "[") == 0) {
        if (cur_dim == dims - 1) {
          ret = 1;
          break;
        }
        first = 1;
        cur_dim++;
        elems_read_in_dim[cur_dim] = 0;
      } else if (cur_dim == dims - 1) {
        ret = read_str_elem(buf, reader);
        if (ret != 0) {
          break;
        }
        elems_read_in_dim[cur_dim]++;
      } else {
        ret = 1;
        break;
      }
    } else if (strlen(buf) == 0) {
      // EOF
      ret = 1;
      break;
    } else if (first) {
      if (strcmp(buf, "[") == 0) {
        if (cur_dim == dims - 1) {
          ret = 1;
          break;
        }
        cur_dim++;
        elems_read_in_dim[cur_dim] = 0;
      } else {
        ret = read_str_elem(buf, reader);
        if (ret != 0) {
          break;
        }
        elems_read_in_dim[cur_dim]++;
        first = 0;
      }
    } else {
      ret = 1;
      break;
    }
  }

  free(knows_dimsize);
  free(elems_read_in_dim);
  return ret;
}

static int read_str_empty_array(FILE *f, char *buf, int bufsize,
                                const char *type_name, int64_t *shape, int64_t dims) {
  if (strlen(buf) == 0) {
    // EOF
    return 1;
  }

  if (strcmp(buf, "empty") != 0) {
    return 1;
  }

  if (!next_token_is(f, buf, bufsize, "(")) {
    return 1;
  }

  for (int i = 0; i < dims; i++) {
    if (!next_token_is(f, buf, bufsize, "[")) {
      return 1;
    }

    next_token(f, buf, bufsize);

    if (sscanf(buf, "%"SCNu64, (uint64_t*)&shape[i]) != 1) {
      return 1;
    }

    if (!next_token_is(f, buf, bufsize, "]")) {
      return 1;
    }
  }

  if (!next_token_is(f, buf, bufsize, type_name)) {
    return 1;
  }


  if (!next_token_is(f, buf, bufsize, ")")) {
    return 1;
  }

  // Check whether the array really is empty.
  for (int i = 0; i < dims; i++) {
    if (shape[i] == 0) {
      return 0;
    }
  }

  // Not an empty array!
  return 1;
}

static int read_str_array(FILE *f,
                          int64_t elem_size, str_reader elem_reader,
                          const char *type_name,
                          void **data, int64_t *shape, int64_t dims) {
  int ret;
  struct array_reader reader;
  char buf[100];

  int dims_seen;
  for (dims_seen = 0; dims_seen < dims; dims_seen++) {
    if (!next_token_is(f, buf, sizeof(buf), "[")) {
      break;
    }
  }

  if (dims_seen == 0) {
    return read_str_empty_array(f, buf, sizeof(buf), type_name, shape, dims);
  }

  if (dims_seen != dims) {
    return 1;
  }

  reader.shape = shape;
  reader.n_elems_used = 0;
  reader.elem_size = elem_size;
  reader.n_elems_space = 16;
  reader.elems = (char*) realloc(*data, (size_t)(elem_size*reader.n_elems_space));
  reader.elem_reader = elem_reader;

  ret = read_str_array_elems(f, buf, sizeof(buf), &reader, dims);

  *data = reader.elems;

  return ret;
}

#define READ_STR(MACRO, PTR, SUFFIX)                                   \
  remove_underscores(buf);                                              \
  int j;                                                                \
  if (sscanf(buf, "%"MACRO"%n", (PTR*)dest, &j) == 1) {                 \
    return !(strcmp(buf+j, "") == 0 || strcmp(buf+j, SUFFIX) == 0);     \
  } else {                                                              \
    return 1;                                                           \
  }

static int read_str_i8(char *buf, void* dest) {
  // Some platforms (WINDOWS) does not support scanf %hhd or its
  // cousin, %SCNi8.  Read into int first to avoid corrupting
  // memory.
  //
  // https://gcc.gnu.org/bugzilla/show_bug.cgi?id=63417
  remove_underscores(buf);
  int j, x;
  if (sscanf(buf, "%i%n", &x, &j) == 1) {
    *(int8_t*)dest = (int8_t)x;
    return !(strcmp(buf+j, "") == 0 || strcmp(buf+j, "i8") == 0);
  } else {
    return 1;
  }
}

static int read_str_u8(char *buf, void* dest) {
  // Some platforms (WINDOWS) does not support scanf %hhd or its
  // cousin, %SCNu8.  Read into int first to avoid corrupting
  // memory.
  //
  // https://gcc.gnu.org/bugzilla/show_bug.cgi?id=63417
  remove_underscores(buf);
  int j, x;
  if (sscanf(buf, "%i%n", &x, &j) == 1) {
    *(uint8_t*)dest = (uint8_t)x;
    return !(strcmp(buf+j, "") == 0 || strcmp(buf+j, "u8") == 0);
  } else {
    return 1;
  }
}

static int read_str_i16(char *buf, void* dest) {
  READ_STR(SCNi16, int16_t, "i16");
}

static int read_str_u16(char *buf, void* dest) {
  READ_STR(SCNi16, int16_t, "u16");
}

static int read_str_i32(char *buf, void* dest) {
  READ_STR(SCNi32, int32_t, "i32");
}

static int read_str_u32(char *buf, void* dest) {
  READ_STR(SCNi32, int32_t, "u32");
}

static int read_str_i64(char *buf, void* dest) {
  READ_STR(SCNi64, int64_t, "i64");
}

static int read_str_u64(char *buf, void* dest) {
  // FIXME: This is not correct, as SCNu64 only permits decimal
  // literals.  However, SCNi64 does not handle very large numbers
  // correctly (it's really for signed numbers, so that's fair).
  READ_STR(SCNu64, uint64_t, "u64");
}

static int read_str_f16(char *buf, void* dest) {
  remove_underscores(buf);
  if (strcmp(buf, "f16.nan") == 0) {
    *(uint16_t*)dest = float2halfbits(NAN);
    return 0;
  } else if (strcmp(buf, "f16.inf") == 0) {
    *(uint16_t*)dest = float2halfbits(INFINITY);
    return 0;
  } else if (strcmp(buf, "-f16.inf") == 0) {
    *(uint16_t*)dest = float2halfbits(-INFINITY);
    return 0;
  } else {
    int j;
    float x;
    if (sscanf(buf, "%f%n", &x, &j) == 1) {
      if (strcmp(buf+j, "") == 0 || strcmp(buf+j, "f16") == 0) {
        *(uint16_t*)dest = float2halfbits(x);
        return 0;
      }
    }
    return 1;
  }
}

static int read_str_f32(char *buf, void* dest) {
  remove_underscores(buf);
  if (strcmp(buf, "f32.nan") == 0) {
    *(float*)dest = (float)NAN;
    return 0;
  } else if (strcmp(buf, "f32.inf") == 0) {
    *(float*)dest = (float)INFINITY;
    return 0;
  } else if (strcmp(buf, "-f32.inf") == 0) {
    *(float*)dest = (float)-INFINITY;
    return 0;
  } else {
    READ_STR("f", float, "f32");
  }
}

static int read_str_f64(char *buf, void* dest) {
  remove_underscores(buf);
  if (strcmp(buf, "f64.nan") == 0) {
    *(double*)dest = (double)NAN;
    return 0;
  } else if (strcmp(buf, "f64.inf") == 0) {
    *(double*)dest = (double)INFINITY;
    return 0;
  } else if (strcmp(buf, "-f64.inf") == 0) {
    *(double*)dest = (double)-INFINITY;
    return 0;
  } else {
    READ_STR("lf", double, "f64");
  }
}

static int read_str_bool(char *buf, void* dest) {
  if (strcmp(buf, "true") == 0) {
    *(char*)dest = 1;
    return 0;
  } else if (strcmp(buf, "false") == 0) {
    *(char*)dest = 0;
    return 0;
  } else {
    return 1;
  }
}

static int write_str_i8(FILE *out, int8_t *src) {
  return fprintf(out, "%hhdi8", *src);
}

static int write_str_u8(FILE *out, uint8_t *src) {
  return fprintf(out, "%hhuu8", *src);
}

static int write_str_i16(FILE *out, int16_t *src) {
  return fprintf(out, "%hdi16", *src);
}

static int write_str_u16(FILE *out, uint16_t *src) {
  return fprintf(out, "%huu16", *src);
}

static int write_str_i32(FILE *out, int32_t *src) {
  return fprintf(out, "%di32", *src);
}

static int write_str_u32(FILE *out, uint32_t *src) {
  return fprintf(out, "%uu32", *src);
}

static int write_str_i64(FILE *out, int64_t *src) {
  return fprintf(out, "%"PRIi64"i64", *src);
}

static int write_str_u64(FILE *out, uint64_t *src) {
  return fprintf(out, "%"PRIu64"u64", *src);
}

static int write_str_f16(FILE *out, uint16_t *src) {
  float x = halfbits2float(*src);
  if (isnan(x)) {
    return fprintf(out, "f16.nan");
  } else if (isinf(x) && x >= 0) {
    return fprintf(out, "f16.inf");
  } else if (isinf(x)) {
    return fprintf(out, "-f16.inf");
  } else {
    return fprintf(out, "%.6ff16", x);
  }
}

static int write_str_f32(FILE *out, float *src) {
  float x = *src;
  if (isnan(x)) {
    return fprintf(out, "f32.nan");
  } else if (isinf(x) && x >= 0) {
    return fprintf(out, "f32.inf");
  } else if (isinf(x)) {
    return fprintf(out, "-f32.inf");
  } else {
    return fprintf(out, "%.6ff32", x);
  }
}

static int write_str_f64(FILE *out, double *src) {
  double x = *src;
  if (isnan(x)) {
    return fprintf(out, "f64.nan");
  } else if (isinf(x) && x >= 0) {
    return fprintf(out, "f64.inf");
  } else if (isinf(x)) {
    return fprintf(out, "-f64.inf");
  } else {
    return fprintf(out, "%.6ff64", *src);
  }
}

static int write_str_bool(FILE *out, void *src) {
  return fprintf(out, *(char*)src ? "true" : "false");
}

//// Binary I/O

#define BINARY_FORMAT_VERSION 2
#define IS_BIG_ENDIAN (!*(unsigned char *)&(uint16_t){1})

static void flip_bytes(size_t elem_size, unsigned char *elem) {
  for (size_t j=0; j<elem_size/2; j++) {
    unsigned char head = elem[j];
    size_t tail_index = elem_size-1-j;
    elem[j] = elem[tail_index];
    elem[tail_index] = head;
  }
}

// On Windows we need to explicitly set the file mode to not mangle
// newline characters.  On *nix there is no difference.
#ifdef _WIN32
#include <io.h>
#include <fcntl.h>
static void set_binary_mode(FILE *f) {
  setmode(fileno(f), O_BINARY);
}
#else
static void set_binary_mode(FILE *f) {
  (void)f;
}
#endif

static int read_byte(FILE *f, void* dest) {
  size_t num_elems_read = fread(dest, 1, 1, f);
  return num_elems_read == 1 ? 0 : 1;
}

//// Types

struct primtype_info_t {
  const char binname[4]; // Used for parsing binary data.
  const char* type_name; // Same name as in Futhark.
  const int64_t size; // in bytes
  const writer write_str; // Write in text format.
  const str_reader read_str; // Read in text format.
};

static const struct primtype_info_t i8_info =
  {.binname = "  i8", .type_name = "i8",   .size = 1,
   .write_str = (writer)write_str_i8, .read_str = (str_reader)read_str_i8};
static const struct primtype_info_t i16_info =
  {.binname = " i16", .type_name = "i16",  .size = 2,
   .write_str = (writer)write_str_i16, .read_str = (str_reader)read_str_i16};
static const struct primtype_info_t i32_info =
  {.binname = " i32", .type_name = "i32",  .size = 4,
   .write_str = (writer)write_str_i32, .read_str = (str_reader)read_str_i32};
static const struct primtype_info_t i64_info =
  {.binname = " i64", .type_name = "i64",  .size = 8,
   .write_str = (writer)write_str_i64, .read_str = (str_reader)read_str_i64};
static const struct primtype_info_t u8_info =
  {.binname = "  u8", .type_name = "u8",   .size = 1,
   .write_str = (writer)write_str_u8, .read_str = (str_reader)read_str_u8};
static const struct primtype_info_t u16_info =
  {.binname = " u16", .type_name = "u16",  .size = 2,
   .write_str = (writer)write_str_u16, .read_str = (str_reader)read_str_u16};
static const struct primtype_info_t u32_info =
  {.binname = " u32", .type_name = "u32",  .size = 4,
   .write_str = (writer)write_str_u32, .read_str = (str_reader)read_str_u32};
static const struct primtype_info_t u64_info =
  {.binname = " u64", .type_name = "u64",  .size = 8,
   .write_str = (writer)write_str_u64, .read_str = (str_reader)read_str_u64};
static const struct primtype_info_t f16_info =
  {.binname = " f16", .type_name = "f16",  .size = 2,
   .write_str = (writer)write_str_f16, .read_str = (str_reader)read_str_f16};
static const struct primtype_info_t f32_info =
  {.binname = " f32", .type_name = "f32",  .size = 4,
   .write_str = (writer)write_str_f32, .read_str = (str_reader)read_str_f32};
static const struct primtype_info_t f64_info =
  {.binname = " f64", .type_name = "f64",  .size = 8,
   .write_str = (writer)write_str_f64, .read_str = (str_reader)read_str_f64};
static const struct primtype_info_t bool_info =
  {.binname = "bool", .type_name = "bool", .size = 1,
   .write_str = (writer)write_str_bool, .read_str = (str_reader)read_str_bool};

static const struct primtype_info_t* primtypes[] = {
  &i8_info, &i16_info, &i32_info, &i64_info,
  &u8_info, &u16_info, &u32_info, &u64_info,
  &f16_info, &f32_info, &f64_info,
  &bool_info,
  NULL // NULL-terminated
};

// General value interface.  All endian business taken care of at
// lower layers.

static int read_is_binary(FILE *f) {
  skipspaces(f);
  int c = getc(f);
  if (c == 'b') {
    int8_t bin_version;
    int ret = read_byte(f, &bin_version);

    if (ret != 0) { futhark_panic(1, "binary-input: could not read version.\n"); }

    if (bin_version != BINARY_FORMAT_VERSION) {
      futhark_panic(1, "binary-input: File uses version %i, but I only understand version %i.\n",
            bin_version, BINARY_FORMAT_VERSION);
    }

    return 1;
  }
  ungetc(c, f);
  return 0;
}

static const struct primtype_info_t* read_bin_read_type_enum(FILE *f) {
  char read_binname[4];

  int num_matched = fscanf(f, "%4c", read_binname);
  if (num_matched != 1) { futhark_panic(1, "binary-input: Couldn't read element type.\n"); }

  const struct primtype_info_t **type = primtypes;

  for (; *type != NULL; type++) {
    // I compare the 4 characters manually instead of using strncmp because
    // this allows any value to be used, also NULL bytes
    if (memcmp(read_binname, (*type)->binname, 4) == 0) {
      return *type;
    }
  }
  futhark_panic(1, "binary-input: Did not recognize the type '%s'.\n", read_binname);
  return NULL;
}

static void read_bin_ensure_scalar(FILE *f, const struct primtype_info_t *expected_type) {
  int8_t bin_dims;
  int ret = read_byte(f, &bin_dims);
  if (ret != 0) { futhark_panic(1, "binary-input: Couldn't get dims.\n"); }

  if (bin_dims != 0) {
    futhark_panic(1, "binary-input: Expected scalar (0 dimensions), but got array with %i dimensions.\n",
          bin_dims);
  }

  const struct primtype_info_t *bin_type = read_bin_read_type_enum(f);
  if (bin_type != expected_type) {
    futhark_panic(1, "binary-input: Expected scalar of type %s but got scalar of type %s.\n",
          expected_type->type_name,
          bin_type->type_name);
  }
}

//// High-level interface

static int read_bin_array(FILE *f,
                          const struct primtype_info_t *expected_type, void **data, int64_t *shape, int64_t dims) {
  int ret;

  int8_t bin_dims;
  ret = read_byte(f, &bin_dims);
  if (ret != 0) { futhark_panic(1, "binary-input: Couldn't get dims.\n"); }

  if (bin_dims != dims) {
    futhark_panic(1, "binary-input: Expected %i dimensions, but got array with %i dimensions.\n",
          dims, bin_dims);
  }

  const struct primtype_info_t *bin_primtype = read_bin_read_type_enum(f);
  if (expected_type != bin_primtype) {
    futhark_panic(1, "binary-input: Expected %iD-array with element type '%s' but got %iD-array with element type '%s'.\n",
          dims, expected_type->type_name, dims, bin_primtype->type_name);
  }

  int64_t elem_count = 1;
  for (int i=0; i<dims; i++) {
    int64_t bin_shape;
    ret = (int)fread(&bin_shape, sizeof(bin_shape), 1, f);
    if (ret != 1) {
      futhark_panic(1, "binary-input: Couldn't read size for dimension %i of array.\n", i);
    }
    if (IS_BIG_ENDIAN) {
      flip_bytes(sizeof(bin_shape), (unsigned char*) &bin_shape);
    }
    elem_count *= bin_shape;
    shape[i] = bin_shape;
  }

  int64_t elem_size = expected_type->size;
  void* tmp = realloc(*data, (size_t)(elem_count * elem_size));
  if (tmp == NULL) {
    futhark_panic(1, "binary-input: Failed to allocate array of size %i.\n",
          elem_count * elem_size);
  }
  *data = tmp;

  int64_t num_elems_read = (int64_t)fread(*data, (size_t)elem_size, (size_t)elem_count, f);
  if (num_elems_read != elem_count) {
    futhark_panic(1, "binary-input: tried to read %i elements of an array, but only got %i elements.\n",
          elem_count, num_elems_read);
  }

  // If we're on big endian platform we must change all multibyte elements
  // from using little endian to big endian
  if (IS_BIG_ENDIAN && elem_size != 1) {
    flip_bytes((size_t)elem_size, (unsigned char*) *data);
  }

  return 0;
}

static int read_array(FILE *f, const struct primtype_info_t *expected_type, void **data, int64_t *shape, int64_t dims) {
  if (!read_is_binary(f)) {
    return read_str_array(f, expected_type->size, (str_reader)expected_type->read_str, expected_type->type_name, data, shape, dims);
  } else {
    return read_bin_array(f, expected_type, data, shape, dims);
  }
}

static int end_of_input(FILE *f) {
  skipspaces(f);
  char token[2];
  next_token(f, token, sizeof(token));
  if (strcmp(token, "") == 0) {
    return 0;
  } else {
    return 1;
  }
}

static int write_str_array(FILE *out,
                           const struct primtype_info_t *elem_type,
                           const unsigned char *data,
                           const int64_t *shape,
                           int8_t rank) {
  if (rank==0) {
    elem_type->write_str(out, (const void*)data);
  } else {
    int64_t len = (int64_t)shape[0];
    int64_t slice_size = 1;

    int64_t elem_size = elem_type->size;
    for (int8_t i = 1; i < rank; i++) {
      slice_size *= shape[i];
    }

    if (len*slice_size == 0) {
      fprintf(out, "empty(");
      for (int64_t i = 0; i < rank; i++) {
        fprintf(out, "[%"PRIi64"]", shape[i]);
      }
      fprintf(out, "%s", elem_type->type_name);
      fprintf(out, ")");
    } else if (rank==1) {
      fputc('[', out);
      for (int64_t i = 0; i < len; i++) {
        elem_type->write_str(out, (const void*) (data + i * elem_size));
        if (i != len-1) {
          fprintf(out, ", ");
        }
      }
      fputc(']', out);
    } else {
      fputc('[', out);
      for (int64_t i = 0; i < len; i++) {
        write_str_array(out, elem_type, data + i * slice_size * elem_size, shape+1, rank-1);
        if (i != len-1) {
          fprintf(out, ", ");
        }
      }
      fputc(']', out);
    }
  }
  return 0;
}

static int write_bin_array(FILE *out,
                           const struct primtype_info_t *elem_type,
                           const unsigned char *data,
                           const int64_t *shape,
                           int8_t rank) {
  int64_t num_elems = 1;
  for (int64_t i = 0; i < rank; i++) {
    num_elems *= shape[i];
  }

  fputc('b', out);
  fputc((char)BINARY_FORMAT_VERSION, out);
  fwrite(&rank, sizeof(int8_t), 1, out);
  fwrite(elem_type->binname, 4, 1, out);
  if (shape != NULL) {
    fwrite(shape, sizeof(int64_t), (size_t)rank, out);
  }

  if (IS_BIG_ENDIAN) {
    for (int64_t i = 0; i < num_elems; i++) {
      const unsigned char *elem = data+i*elem_type->size;
      for (int64_t j = 0; j < elem_type->size; j++) {
        fwrite(&elem[elem_type->size-j], 1, 1, out);
      }
    }
  } else {
    fwrite(data, (size_t)elem_type->size, (size_t)num_elems, out);
  }

  return 0;
}

static int write_array(FILE *out, int write_binary,
                       const struct primtype_info_t *elem_type,
                       const void *data,
                       const int64_t *shape,
                       const int8_t rank) {
  if (write_binary) {
    return write_bin_array(out, elem_type, data, shape, rank);
  } else {
    return write_str_array(out, elem_type, data, shape, rank);
  }
}

static int read_scalar(FILE *f,
                       const struct primtype_info_t *expected_type, void *dest) {
  if (!read_is_binary(f)) {
    char buf[100];
    next_token(f, buf, sizeof(buf));
    return expected_type->read_str(buf, dest);
  } else {
    read_bin_ensure_scalar(f, expected_type);
    size_t elem_size = (size_t)expected_type->size;
    size_t num_elems_read = fread(dest, elem_size, 1, f);
    if (IS_BIG_ENDIAN) {
      flip_bytes(elem_size, (unsigned char*) dest);
    }
    return num_elems_read == 1 ? 0 : 1;
  }
}

static int write_scalar(FILE *out, int write_binary, const struct primtype_info_t *type, void *src) {
  if (write_binary) {
    return write_bin_array(out, type, src, NULL, 0);
  } else {
    return type->write_str(out, src);
  }
}

// End of values.h.

static int binary_output = 0;
static int print_result = 1;
static int print_report = 0;
static FILE *runtime_file;
static int perform_warmup = 0;
static int num_runs = 1;
static const char *entry_point = "main";
// Start of tuning.h.

static char* load_tuning_file(const char *fname,
                              void *cfg,
                              int (*set_tuning_param)(void*, const char*, size_t)) {
  const int max_line_len = 1024;
  char* line = (char*) malloc(max_line_len);

  FILE *f = fopen(fname, "r");

  if (f == NULL) {
    snprintf(line, max_line_len, "Cannot open file: %s", strerror(errno));
    return line;
  }

  int lineno = 0;
  while (fgets(line, max_line_len, f) != NULL) {
    lineno++;
    char *eql = strstr(line, "=");
    if (eql) {
      *eql = 0;
      int value = atoi(eql+1);
      if (set_tuning_param(cfg, line, (size_t)value) != 0) {
        char* err = (char*) malloc(max_line_len + 50);
        snprintf(err, max_line_len + 50, "Unknown name '%s' on line %d.", line, lineno);
        free(line);
        return err;
      }
    } else {
      snprintf(line, max_line_len, "Invalid line %d (must be of form 'name=int').",
               lineno);
      return line;
    }
  }

  free(line);

  return NULL;
}

// End of tuning.h.

int parse_options(struct futhark_context_config *cfg, int argc,
                  char *const argv[])
{
    int ch;
    static struct option long_options[] = {{"write-runtime-to",
                                            required_argument, NULL, 1},
                                           {"runs", required_argument, NULL, 2},
                                           {"debugging", no_argument, NULL, 3},
                                           {"log", no_argument, NULL, 4},
                                           {"entry-point", required_argument,
                                            NULL, 5}, {"binary-output",
                                                       no_argument, NULL, 6},
                                           {"no-print-result", no_argument,
                                            NULL, 7}, {"help", no_argument,
                                                       NULL, 8},
                                           {"print-params", no_argument, NULL,
                                            9}, {"param", required_argument,
                                                 NULL, 10}, {"tuning",
                                                             required_argument,
                                                             NULL, 11},
                                           {"cache-file", required_argument,
                                            NULL, 12}, {0, 0, 0, 0}};
    static char *option_descriptions =
                "  -t/--write-runtime-to FILE Print the time taken to execute the program to the indicated file, an integral number of microseconds.\n  -r/--runs INT              Perform NUM runs of the program.\n  -D/--debugging             Perform possibly expensive internal correctness checks and verbose logging.\n  -L/--log                   Print various low-overhead logging information to stderr while running.\n  -e/--entry-point NAME      The entry point to run. Defaults to main.\n  -b/--binary-output         Print the program result in the binary output format.\n  -n/--no-print-result       Do not print the program result.\n  -h/--help                  Print help information and exit.\n  --print-params             Print all tuning parameters that can be set with --param or --tuning.\n  --param ASSIGNMENT         Set a tuning parameter to the given value.\n  --tuning FILE              Read size=value assignments from the given file.\n  --cache-file FILE          Store program cache here.\n";
    
    while ((ch = getopt_long(argc, argv, ":t:r:DLe:bnh", long_options, NULL)) !=
           -1) {
        if (ch == 1 || ch == 't') {
            runtime_file = fopen(optarg, "w");
            if (runtime_file == NULL)
                futhark_panic(1, "Cannot open %s: %s\n", optarg,
                              strerror(errno));
        }
        if (ch == 2 || ch == 'r') {
            num_runs = atoi(optarg);
            perform_warmup = 1;
            if (num_runs <= 0)
                futhark_panic(1, "Need a positive number of runs, not %s\n",
                              optarg);
        }
        if (ch == 3 || ch == 'D') {
            futhark_context_config_set_debugging(cfg, 1);
            print_report = 1;
        }
        if (ch == 4 || ch == 'L') {
            futhark_context_config_set_logging(cfg, 1);
            print_report = 1;
        }
        if (ch == 5 || ch == 'e') {
            if (entry_point != NULL)
                entry_point = optarg;
        }
        if (ch == 6 || ch == 'b')
            binary_output = 1;
        if (ch == 7 || ch == 'n')
            print_result = 0;
        if (ch == 8 || ch == 'h') {
            printf("Usage: %s [OPTION]...\nOptions:\n\n%s\nFor more information, consult the Futhark User's Guide or the man pages.\n",
                   fut_progname, option_descriptions);
            exit(0);
        }
        if (ch == 9) {
            int n = futhark_get_tuning_param_count();
            
            for (int i = 0; i < n; i++)
                printf("%s (%s)\n", futhark_get_tuning_param_name(i),
                       futhark_get_tuning_param_class(i));
            exit(0);
        }
        if (ch == 10) {
            char *name = optarg;
            char *equals = strstr(optarg, "=");
            char *value_str = equals != NULL ? equals + 1 : optarg;
            int value = atoi(value_str);
            
            if (equals != NULL) {
                *equals = 0;
                if (futhark_context_config_set_tuning_param(cfg, name,
                                                            (size_t) value) !=
                    0)
                    futhark_panic(1, "Unknown size: %s\n", name);
            } else
                futhark_panic(1, "Invalid argument for size option: %s\n",
                              optarg);
        }
        if (ch == 11) {
            char *ret = load_tuning_file(optarg, cfg, (int (*)(void *, const
                                                               char *,
                                                               size_t)) futhark_context_config_set_tuning_param);
            
            if (ret != NULL)
                futhark_panic(1, "When loading tuning from '%s': %s\n", optarg,
                              ret);
        }
        if (ch == 12)
            futhark_context_config_set_cache_file(cfg, optarg);
        if (ch == ':')
            futhark_panic(-1, "Missing argument for option %s\n", argv[optind -
                                                                       1]);
        if (ch == '?') {
            fprintf(stderr, "Usage: %s [OPTIONS]...\nOptions:\n\n%s\n",
                    fut_progname,
                    "  -t/--write-runtime-to FILE Print the time taken to execute the program to the indicated file, an integral number of microseconds.\n  -r/--runs INT              Perform NUM runs of the program.\n  -D/--debugging             Perform possibly expensive internal correctness checks and verbose logging.\n  -L/--log                   Print various low-overhead logging information to stderr while running.\n  -e/--entry-point NAME      The entry point to run. Defaults to main.\n  -b/--binary-output         Print the program result in the binary output format.\n  -n/--no-print-result       Do not print the program result.\n  -h/--help                  Print help information and exit.\n  --print-params             Print all tuning parameters that can be set with --param or --tuning.\n  --param ASSIGNMENT         Set a tuning parameter to the given value.\n  --tuning FILE              Read size=value assignments from the given file.\n  --cache-file FILE          Store program cache here.\n");
            futhark_panic(1, "Unknown option: %s\n", argv[optind - 1]);
        }
    }
    return optind;
}
static void futrts_cli_entry_diffusion_sample(struct futhark_context *ctx)
{
    int64_t t_start, t_end;
    int time_runs = 0, profile_run = 0;
    
    // We do not want to profile all the initialisation.
    futhark_context_pause_profiling(ctx);
    // Declare and read input.
    set_binary_mode(stdin);
    
    int64_t read_value_0;
    
    if (read_scalar(stdin, &i64_info, &read_value_0) != 0)
        futhark_panic(1,
                      "Error when reading input #%d of type %s (errno: %s).\n",
                      0, "i64", strerror(errno));
    ;
    
    struct futhark_f64_1d * read_value_1;
    int64_t read_shape_1[1];
    double *read_arr_1 = NULL;
    
    errno = 0;
    if (read_array(stdin, &f64_info, (void **) &read_arr_1, read_shape_1, 1) !=
        0)
        futhark_panic(1, "Cannot read input #%d of type %s (errno: %s).\n", 1,
                      "[]f64", strerror(errno));
    
    struct futhark_f64_1d * read_value_2;
    int64_t read_shape_2[1];
    double *read_arr_2 = NULL;
    
    errno = 0;
    if (read_array(stdin, &f64_info, (void **) &read_arr_2, read_shape_2, 1) !=
        0)
        futhark_panic(1, "Cannot read input #%d of type %s (errno: %s).\n", 2,
                      "[]f64", strerror(errno));
    
    struct futhark_f64_1d * read_value_3;
    int64_t read_shape_3[1];
    double *read_arr_3 = NULL;
    
    errno = 0;
    if (read_array(stdin, &f64_info, (void **) &read_arr_3, read_shape_3, 1) !=
        0)
        futhark_panic(1, "Cannot read input #%d of type %s (errno: %s).\n", 3,
                      "[]f64", strerror(errno));
    
    int32_t read_value_4;
    
    if (read_scalar(stdin, &i32_info, &read_value_4) != 0)
        futhark_panic(1,
                      "Error when reading input #%d of type %s (errno: %s).\n",
                      4, "i32", strerror(errno));
    ;
    
    int32_t read_value_5;
    
    if (read_scalar(stdin, &i32_info, &read_value_5) != 0)
        futhark_panic(1,
                      "Error when reading input #%d of type %s (errno: %s).\n",
                      5, "i32", strerror(errno));
    ;
    
    int64_t read_value_6;
    
    if (read_scalar(stdin, &i64_info, &read_value_6) != 0)
        futhark_panic(1,
                      "Error when reading input #%d of type %s (errno: %s).\n",
                      6, "i64", strerror(errno));
    ;
    if (end_of_input(stdin) != 0)
        futhark_panic(1,
                      "Expected EOF on stdin after reading input for \"%s\".\n",
                      "diffusion_sample");
    
    struct futhark_f64_3d * result_0;
    
    if (perform_warmup) {
        int r;
        
        ;
        assert((read_value_1 = futhark_new_f64_1d(ctx, read_arr_1,
                                                  read_shape_1[0])) != NULL);
        assert((read_value_2 = futhark_new_f64_1d(ctx, read_arr_2,
                                                  read_shape_2[0])) != NULL);
        assert((read_value_3 = futhark_new_f64_1d(ctx, read_arr_3,
                                                  read_shape_3[0])) != NULL);
        ;
        ;
        ;
        if (futhark_context_sync(ctx) != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        ;
        // Only profile last run.
        if (profile_run)
            futhark_context_unpause_profiling(ctx);
        t_start = get_wall_time();
        r = futhark_entry_diffusion_sample(ctx, &result_0, read_value_0,
                                           read_value_1, read_value_2,
                                           read_value_3, read_value_4,
                                           read_value_5, read_value_6);
        if (r != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        if (futhark_context_sync(ctx) != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        ;
        if (profile_run)
            futhark_context_pause_profiling(ctx);
        t_end = get_wall_time();
        
        long elapsed_usec = t_end - t_start;
        
        if (time_runs && runtime_file != NULL) {
            fprintf(runtime_file, "%lld\n", (long long) elapsed_usec);
            fflush(runtime_file);
        }
        ;
        assert(futhark_free_f64_1d(ctx, read_value_1) == 0);
        assert(futhark_free_f64_1d(ctx, read_value_2) == 0);
        assert(futhark_free_f64_1d(ctx, read_value_3) == 0);
        ;
        ;
        ;
        assert(futhark_free_f64_3d(ctx, result_0) == 0);
    }
    time_runs = 1;
    // Proper run.
    for (int run = 0; run < num_runs; run++) {
        // Only profile last run.
        profile_run = run == num_runs - 1;
        
        int r;
        
        ;
        assert((read_value_1 = futhark_new_f64_1d(ctx, read_arr_1,
                                                  read_shape_1[0])) != NULL);
        assert((read_value_2 = futhark_new_f64_1d(ctx, read_arr_2,
                                                  read_shape_2[0])) != NULL);
        assert((read_value_3 = futhark_new_f64_1d(ctx, read_arr_3,
                                                  read_shape_3[0])) != NULL);
        ;
        ;
        ;
        if (futhark_context_sync(ctx) != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        ;
        // Only profile last run.
        if (profile_run)
            futhark_context_unpause_profiling(ctx);
        t_start = get_wall_time();
        r = futhark_entry_diffusion_sample(ctx, &result_0, read_value_0,
                                           read_value_1, read_value_2,
                                           read_value_3, read_value_4,
                                           read_value_5, read_value_6);
        if (r != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        if (futhark_context_sync(ctx) != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        ;
        if (profile_run)
            futhark_context_pause_profiling(ctx);
        t_end = get_wall_time();
        
        long elapsed_usec = t_end - t_start;
        
        if (time_runs && runtime_file != NULL) {
            fprintf(runtime_file, "%lld\n", (long long) elapsed_usec);
            fflush(runtime_file);
        }
        ;
        assert(futhark_free_f64_1d(ctx, read_value_1) == 0);
        assert(futhark_free_f64_1d(ctx, read_value_2) == 0);
        assert(futhark_free_f64_1d(ctx, read_value_3) == 0);
        ;
        ;
        ;
        if (run < num_runs - 1) {
            assert(futhark_free_f64_3d(ctx, result_0) == 0);
        }
    }
    ;
    free(read_arr_1);
    free(read_arr_2);
    free(read_arr_3);
    ;
    ;
    ;
    if (print_result) {
        // Print the final result.
        if (binary_output)
            set_binary_mode(stdout);
        {
            double *arr = calloc(futhark_shape_f64_3d(ctx, result_0)[0] *
                                 futhark_shape_f64_3d(ctx, result_0)[1] *
                                 futhark_shape_f64_3d(ctx, result_0)[2],
                                 f64_info.size);
            
            assert(arr != NULL);
            assert(futhark_values_f64_3d(ctx, result_0, arr) == 0);
            write_array(stdout, binary_output, &f64_info, arr,
                        futhark_shape_f64_3d(ctx, result_0), 3);
            free(arr);
        }
        printf("\n");
    }
    assert(futhark_free_f64_3d(ctx, result_0) == 0);
}
static void futrts_cli_entry_diffusion_train(struct futhark_context *ctx)
{
    int64_t t_start, t_end;
    int time_runs = 0, profile_run = 0;
    
    // We do not want to profile all the initialisation.
    futhark_context_pause_profiling(ctx);
    // Declare and read input.
    set_binary_mode(stdin);
    
    struct futhark_f64_3d * read_value_0;
    int64_t read_shape_0[3];
    double *read_arr_0 = NULL;
    
    errno = 0;
    if (read_array(stdin, &f64_info, (void **) &read_arr_0, read_shape_0, 3) !=
        0)
        futhark_panic(1, "Cannot read input #%d of type %s (errno: %s).\n", 0,
                      "[][][]f64", strerror(errno));
    
    struct futhark_f64_1d * read_value_1;
    int64_t read_shape_1[1];
    double *read_arr_1 = NULL;
    
    errno = 0;
    if (read_array(stdin, &f64_info, (void **) &read_arr_1, read_shape_1, 1) !=
        0)
        futhark_panic(1, "Cannot read input #%d of type %s (errno: %s).\n", 1,
                      "[]f64", strerror(errno));
    
    int64_t read_value_2;
    
    if (read_scalar(stdin, &i64_info, &read_value_2) != 0)
        futhark_panic(1,
                      "Error when reading input #%d of type %s (errno: %s).\n",
                      2, "i64", strerror(errno));
    ;
    
    struct futhark_i32_2d * read_value_3;
    int64_t read_shape_3[2];
    int32_t *read_arr_3 = NULL;
    
    errno = 0;
    if (read_array(stdin, &i32_info, (void **) &read_arr_3, read_shape_3, 2) !=
        0)
        futhark_panic(1, "Cannot read input #%d of type %s (errno: %s).\n", 3,
                      "[][]i32", strerror(errno));
    
    struct futhark_i32_2d * read_value_4;
    int64_t read_shape_4[2];
    int32_t *read_arr_4 = NULL;
    
    errno = 0;
    if (read_array(stdin, &i32_info, (void **) &read_arr_4, read_shape_4, 2) !=
        0)
        futhark_panic(1, "Cannot read input #%d of type %s (errno: %s).\n", 4,
                      "[][]i32", strerror(errno));
    if (end_of_input(stdin) != 0)
        futhark_panic(1,
                      "Expected EOF on stdin after reading input for \"%s\".\n",
                      "diffusion_train");
    
    struct futhark_f64_1d * result_0;
    
    if (perform_warmup) {
        int r;
        
        assert((read_value_0 = futhark_new_f64_3d(ctx, read_arr_0,
                                                  read_shape_0[0],
                                                  read_shape_0[1],
                                                  read_shape_0[2])) != NULL);
        assert((read_value_1 = futhark_new_f64_1d(ctx, read_arr_1,
                                                  read_shape_1[0])) != NULL);
        ;
        assert((read_value_3 = futhark_new_i32_2d(ctx, read_arr_3,
                                                  read_shape_3[0],
                                                  read_shape_3[1])) != NULL);
        assert((read_value_4 = futhark_new_i32_2d(ctx, read_arr_4,
                                                  read_shape_4[0],
                                                  read_shape_4[1])) != NULL);
        if (futhark_context_sync(ctx) != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        ;
        // Only profile last run.
        if (profile_run)
            futhark_context_unpause_profiling(ctx);
        t_start = get_wall_time();
        r = futhark_entry_diffusion_train(ctx, &result_0, read_value_0,
                                          read_value_1, read_value_2,
                                          read_value_3, read_value_4);
        if (r != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        if (futhark_context_sync(ctx) != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        ;
        if (profile_run)
            futhark_context_pause_profiling(ctx);
        t_end = get_wall_time();
        
        long elapsed_usec = t_end - t_start;
        
        if (time_runs && runtime_file != NULL) {
            fprintf(runtime_file, "%lld\n", (long long) elapsed_usec);
            fflush(runtime_file);
        }
        assert(futhark_free_f64_3d(ctx, read_value_0) == 0);
        assert(futhark_free_f64_1d(ctx, read_value_1) == 0);
        ;
        assert(futhark_free_i32_2d(ctx, read_value_3) == 0);
        assert(futhark_free_i32_2d(ctx, read_value_4) == 0);
        assert(futhark_free_f64_1d(ctx, result_0) == 0);
    }
    time_runs = 1;
    // Proper run.
    for (int run = 0; run < num_runs; run++) {
        // Only profile last run.
        profile_run = run == num_runs - 1;
        
        int r;
        
        assert((read_value_0 = futhark_new_f64_3d(ctx, read_arr_0,
                                                  read_shape_0[0],
                                                  read_shape_0[1],
                                                  read_shape_0[2])) != NULL);
        assert((read_value_1 = futhark_new_f64_1d(ctx, read_arr_1,
                                                  read_shape_1[0])) != NULL);
        ;
        assert((read_value_3 = futhark_new_i32_2d(ctx, read_arr_3,
                                                  read_shape_3[0],
                                                  read_shape_3[1])) != NULL);
        assert((read_value_4 = futhark_new_i32_2d(ctx, read_arr_4,
                                                  read_shape_4[0],
                                                  read_shape_4[1])) != NULL);
        if (futhark_context_sync(ctx) != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        ;
        // Only profile last run.
        if (profile_run)
            futhark_context_unpause_profiling(ctx);
        t_start = get_wall_time();
        r = futhark_entry_diffusion_train(ctx, &result_0, read_value_0,
                                          read_value_1, read_value_2,
                                          read_value_3, read_value_4);
        if (r != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        if (futhark_context_sync(ctx) != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        ;
        if (profile_run)
            futhark_context_pause_profiling(ctx);
        t_end = get_wall_time();
        
        long elapsed_usec = t_end - t_start;
        
        if (time_runs && runtime_file != NULL) {
            fprintf(runtime_file, "%lld\n", (long long) elapsed_usec);
            fflush(runtime_file);
        }
        assert(futhark_free_f64_3d(ctx, read_value_0) == 0);
        assert(futhark_free_f64_1d(ctx, read_value_1) == 0);
        ;
        assert(futhark_free_i32_2d(ctx, read_value_3) == 0);
        assert(futhark_free_i32_2d(ctx, read_value_4) == 0);
        if (run < num_runs - 1) {
            assert(futhark_free_f64_1d(ctx, result_0) == 0);
        }
    }
    free(read_arr_0);
    free(read_arr_1);
    ;
    free(read_arr_3);
    free(read_arr_4);
    if (print_result) {
        // Print the final result.
        if (binary_output)
            set_binary_mode(stdout);
        {
            double *arr = calloc(futhark_shape_f64_1d(ctx, result_0)[0],
                                 f64_info.size);
            
            assert(arr != NULL);
            assert(futhark_values_f64_1d(ctx, result_0, arr) == 0);
            write_array(stdout, binary_output, &f64_info, arr,
                        futhark_shape_f64_1d(ctx, result_0), 1);
            free(arr);
        }
        printf("\n");
    }
    assert(futhark_free_f64_1d(ctx, result_0) == 0);
}
typedef void entry_point_fun(struct futhark_context *);
struct entry_point_entry {
    const char *name;
    entry_point_fun *fun;
};
int main(int argc, char **argv)
{
    fut_progname = argv[0];
    
    struct futhark_context_config *cfg = futhark_context_config_new();
    
    assert(cfg != NULL);
    
    int parsed_options = parse_options(cfg, argc, argv);
    
    argc -= parsed_options;
    argv += parsed_options;
    if (argc != 0)
        futhark_panic(1, "Excess non-option: %s\n", argv[0]);
    
    struct futhark_context *ctx = futhark_context_new(cfg);
    
    assert(ctx != NULL);
    
    char *error = futhark_context_get_error(ctx);
    
    if (error != NULL)
        futhark_panic(1, "%s", error);
    
    struct entry_point_entry entry_points[] = {{.name ="diffusion_sample",
                                                .fun =
                                                futrts_cli_entry_diffusion_sample},
                                               {.name ="diffusion_train", .fun =
                                                futrts_cli_entry_diffusion_train}};
    
    if (entry_point != NULL) {
        int num_entry_points = sizeof(entry_points) / sizeof(entry_points[0]);
        entry_point_fun *entry_point_fun = NULL;
        
        for (int i = 0; i < num_entry_points; i++) {
            if (strcmp(entry_points[i].name, entry_point) == 0) {
                entry_point_fun = entry_points[i].fun;
                break;
            }
        }
        if (entry_point_fun == NULL) {
            fprintf(stderr,
                    "No entry point '%s'.  Select another with --entry-point.  Options are:\n",
                    entry_point);
            for (int i = 0; i < num_entry_points; i++)
                fprintf(stderr, "%s\n", entry_points[i].name);
            return 1;
        }
        if (isatty(fileno(stdin))) {
            fprintf(stderr, "Reading input from TTY.\n");
            fprintf(stderr,
                    "Send EOF (CTRL-d) after typing all input values.\n");
        }
        entry_point_fun(ctx);
        if (runtime_file != NULL)
            fclose(runtime_file);
        if (print_report) {
            char *report = futhark_context_report(ctx);
            
            fputs(report, stderr);
            free(report);
        }
    }
    futhark_context_free(ctx);
    futhark_context_config_free(cfg);
    return 0;
}

#ifdef _MSC_VER
#define inline __inline
#endif
#include <string.h>
#include <string.h>
#include <errno.h>
#include <assert.h>
#include <ctype.h>



// Start of lock.h.

// A very simple cross-platform implementation of locks.  Uses
// pthreads on Unix and some Windows thing there.  Futhark's
// host-level code is not multithreaded, but user code may be, so we
// need some mechanism for ensuring atomic access to API functions.
// This is that mechanism.  It is not exposed to user code at all, so
// we do not have to worry about name collisions.

#ifdef _WIN32

typedef HANDLE lock_t;

static void create_lock(lock_t *lock) {
  *lock = CreateMutex(NULL,  // Default security attributes.
                      FALSE, // Initially unlocked.
                      NULL); // Unnamed.
}

static void lock_lock(lock_t *lock) {
  assert(WaitForSingleObject(*lock, INFINITE) == WAIT_OBJECT_0);
}

static void lock_unlock(lock_t *lock) {
  assert(ReleaseMutex(*lock));
}

static void free_lock(lock_t *lock) {
  CloseHandle(*lock);
}

#else
// Assuming POSIX

#include <pthread.h>

typedef pthread_mutex_t lock_t;

static void create_lock(lock_t *lock) {
  int r = pthread_mutex_init(lock, NULL);
  assert(r == 0);
}

static void lock_lock(lock_t *lock) {
  int r = pthread_mutex_lock(lock);
  assert(r == 0);
}

static void lock_unlock(lock_t *lock) {
  int r = pthread_mutex_unlock(lock);
  assert(r == 0);
}

static void free_lock(lock_t *lock) {
  // Nothing to do for pthreads.
  (void)lock;
}

#endif

// End of lock.h.

#define FUTHARK_F64_ENABLED

// Start of scalar.h.

// Implementation of the primitive scalar operations.  Very
// repetitive.  This code is inserted directly into both CUDA and
// OpenCL programs, as well as the CPU code, so it has some #ifdefs to
// work everywhere.  Some operations are defined as macros because
// this allows us to use them as constant expressions in things like
// array sizes and static initialisers.

// Some of the #ifdefs are because OpenCL uses type-generic functions
// for some operations (e.g. sqrt), while C and CUDA sensibly use
// distinct functions for different precisions (e.g. sqrtf() and
// sqrt()).  This is quite annoying.  Due to C's unfortunate casting
// rules, it is also really easy to accidentally implement
// floating-point functions in the wrong precision, so be careful.

// Double-precision definitions are only included if the preprocessor
// macro FUTHARK_F64_ENABLED is set.

static inline uint8_t add8(uint8_t x, uint8_t y) {
  return x + y;
}

static inline uint16_t add16(uint16_t x, uint16_t y) {
  return x + y;
}

static inline uint32_t add32(uint32_t x, uint32_t y) {
  return x + y;
}

static inline uint64_t add64(uint64_t x, uint64_t y) {
  return x + y;
}

static inline uint8_t sub8(uint8_t x, uint8_t y) {
  return x - y;
}

static inline uint16_t sub16(uint16_t x, uint16_t y) {
  return x - y;
}

static inline uint32_t sub32(uint32_t x, uint32_t y) {
  return x - y;
}

static inline uint64_t sub64(uint64_t x, uint64_t y) {
  return x - y;
}

static inline uint8_t mul8(uint8_t x, uint8_t y) {
  return x * y;
}

static inline uint16_t mul16(uint16_t x, uint16_t y) {
  return x * y;
}

static inline uint32_t mul32(uint32_t x, uint32_t y) {
  return x * y;
}

static inline uint64_t mul64(uint64_t x, uint64_t y) {
  return x * y;
}

#if ISPC

static inline uint8_t udiv8(uint8_t x, uint8_t y) {
  // This strange pattern is used to prevent the ISPC compiler from
  // causing SIGFPEs and bogus results on divisions where inactive lanes
  // have 0-valued divisors. It ensures that any inactive lane instead
  // has a divisor of 1. https://github.com/ispc/ispc/issues/2292
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x / ys;
}

static inline uint16_t udiv16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return x / ys;
}

static inline uint32_t udiv32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  

  return x / ys;
}

static inline uint64_t udiv64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  

  return x / ys;
}

static inline uint8_t udiv_up8(uint8_t x, uint8_t y) {
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  

  return (x + y - 1) / ys;
}

static inline uint16_t udiv_up16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return (x + y - 1) / ys;
}

static inline uint32_t udiv_up32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return (x + y - 1) / ys;
}

static inline uint64_t udiv_up64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return (x + y - 1) / ys;
}

static inline uint8_t umod8(uint8_t x, uint8_t y) {
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return x % ys;
}

static inline uint16_t umod16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  

  return x % ys;
}

static inline uint32_t umod32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return x % ys;
}

static inline uint64_t umod64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return x % ys;
}

static inline uint8_t udiv_safe8(uint8_t x, uint8_t y) {
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return y == 0 ? 0 : x / ys;
}

static inline uint16_t udiv_safe16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return y == 0 ? 0 : x / ys;
}

static inline uint32_t udiv_safe32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return y == 0 ? 0 : x / ys;
}

static inline uint64_t udiv_safe64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return y == 0 ? 0 : x / ys;
}

static inline uint8_t udiv_up_safe8(uint8_t x, uint8_t y) {
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return y == 0 ? 0 : (x + y - 1) / ys;
}

static inline uint16_t udiv_up_safe16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return y == 0 ? 0 : (x + y - 1) / ys;
}

static inline uint32_t udiv_up_safe32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return y == 0 ? 0 : (x + y - 1) / ys;
}

static inline uint64_t udiv_up_safe64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return y == 0 ? 0 : (x + y - 1) / ys;
}

static inline uint8_t umod_safe8(uint8_t x, uint8_t y) {
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return y == 0 ? 0 : x % ys;
}

static inline uint16_t umod_safe16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return y == 0 ? 0 : x % ys;
}

static inline uint32_t umod_safe32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return y == 0 ? 0 : x % ys;
}

static inline uint64_t umod_safe64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return y == 0 ? 0 : x % ys;
}

static inline int8_t sdiv8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  int8_t q = x / ys;
  int8_t r = x % ys;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

static inline int16_t sdiv16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  int16_t q = x / ys;
  int16_t r = x % ys;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

static inline int32_t sdiv32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  int32_t q = x / ys;
  int32_t r = x % ys;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

static inline int64_t sdiv64(int64_t x, int64_t y) {
  int64_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  int64_t q = x / ys;
  int64_t r = x % ys;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

static inline int8_t sdiv_up8(int8_t x, int8_t y) {
  return sdiv8(x + y - 1, y);
}

static inline int16_t sdiv_up16(int16_t x, int16_t y) {
  return sdiv16(x + y - 1, y);
}

static inline int32_t sdiv_up32(int32_t x, int32_t y) {
  return sdiv32(x + y - 1, y);
}

static inline int64_t sdiv_up64(int64_t x, int64_t y) {
  return sdiv64(x + y - 1, y);
}

static inline int8_t smod8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  int8_t r = x % ys;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

static inline int16_t smod16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  int16_t r = x % ys;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

static inline int32_t smod32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  int32_t r = x % ys;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

static inline int64_t smod64(int64_t x, int64_t y) {
  int64_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  int64_t r = x % ys;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

static inline int8_t sdiv_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : sdiv8(x, y);
}

static inline int16_t sdiv_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : sdiv16(x, y);
}

static inline int32_t sdiv_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : sdiv32(x, y);
}

static inline int64_t sdiv_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : sdiv64(x, y);
}

static inline int8_t sdiv_up_safe8(int8_t x, int8_t y) {
  return sdiv_safe8(x + y - 1, y);
}

static inline int16_t sdiv_up_safe16(int16_t x, int16_t y) {
  return sdiv_safe16(x + y - 1, y);
}

static inline int32_t sdiv_up_safe32(int32_t x, int32_t y) {
  return sdiv_safe32(x + y - 1, y);
}

static inline int64_t sdiv_up_safe64(int64_t x, int64_t y) {
  return sdiv_safe64(x + y - 1, y);
}

static inline int8_t smod_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : smod8(x, y);
}

static inline int16_t smod_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : smod16(x, y);
}

static inline int32_t smod_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : smod32(x, y);
}

static inline int64_t smod_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : smod64(x, y);
}

static inline int8_t squot8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return x / ys;
}

static inline int16_t squot16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return x / ys;
}

static inline int32_t squot32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return x / ys;
}

static inline int64_t squot64(int64_t x, int64_t y) {
  int64_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return x / ys;
}

static inline int8_t srem8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return x % ys;
}

static inline int16_t srem16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return x % ys;
}

static inline int32_t srem32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return x % ys;
}

static inline int64_t srem64(int64_t x, int64_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return x % ys;
}

static inline int8_t squot_safe8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return y == 0 ? 0 : x / ys;
}

static inline int16_t squot_safe16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return y == 0 ? 0 : x / ys;
}

static inline int32_t squot_safe32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return y == 0 ? 0 : x / ys;
}

static inline int64_t squot_safe64(int64_t x, int64_t y) {
  int64_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return y == 0 ? 0 : x / ys;
}

static inline int8_t srem_safe8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return y == 0 ? 0 : x % ys;
}

static inline int16_t srem_safe16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return y == 0 ? 0 : x % ys;
}

static inline int32_t srem_safe32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return y == 0 ? 0 : x % ys;
}

static inline int64_t srem_safe64(int64_t x, int64_t y) {
  int64_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return y == 0 ? 0 : x % ys;
}

#else

static inline uint8_t udiv8(uint8_t x, uint8_t y) {
  return x / y;
}

static inline uint16_t udiv16(uint16_t x, uint16_t y) {
  return x / y;
}

static inline uint32_t udiv32(uint32_t x, uint32_t y) {
  return x / y;
}

static inline uint64_t udiv64(uint64_t x, uint64_t y) {
  return x / y;
}

static inline uint8_t udiv_up8(uint8_t x, uint8_t y) {
  return (x + y - 1) / y;
}

static inline uint16_t udiv_up16(uint16_t x, uint16_t y) {
  return (x + y - 1) / y;
}

static inline uint32_t udiv_up32(uint32_t x, uint32_t y) {
  return (x + y - 1) / y;
}

static inline uint64_t udiv_up64(uint64_t x, uint64_t y) {
  return (x + y - 1) / y;
}

static inline uint8_t umod8(uint8_t x, uint8_t y) {
  return x % y;
}

static inline uint16_t umod16(uint16_t x, uint16_t y) {
  return x % y;
}

static inline uint32_t umod32(uint32_t x, uint32_t y) {
  return x % y;
}

static inline uint64_t umod64(uint64_t x, uint64_t y) {
  return x % y;
}

static inline uint8_t udiv_safe8(uint8_t x, uint8_t y) {
  return y == 0 ? 0 : x / y;
}

static inline uint16_t udiv_safe16(uint16_t x, uint16_t y) {
  return y == 0 ? 0 : x / y;
}

static inline uint32_t udiv_safe32(uint32_t x, uint32_t y) {
  return y == 0 ? 0 : x / y;
}

static inline uint64_t udiv_safe64(uint64_t x, uint64_t y) {
  return y == 0 ? 0 : x / y;
}

static inline uint8_t udiv_up_safe8(uint8_t x, uint8_t y) {
  return y == 0 ? 0 : (x + y - 1) / y;
}

static inline uint16_t udiv_up_safe16(uint16_t x, uint16_t y) {
  return y == 0 ? 0 : (x + y - 1) / y;
}

static inline uint32_t udiv_up_safe32(uint32_t x, uint32_t y) {
  return y == 0 ? 0 : (x + y - 1) / y;
}

static inline uint64_t udiv_up_safe64(uint64_t x, uint64_t y) {
  return y == 0 ? 0 : (x + y - 1) / y;
}

static inline uint8_t umod_safe8(uint8_t x, uint8_t y) {
  return y == 0 ? 0 : x % y;
}

static inline uint16_t umod_safe16(uint16_t x, uint16_t y) {
  return y == 0 ? 0 : x % y;
}

static inline uint32_t umod_safe32(uint32_t x, uint32_t y) {
  return y == 0 ? 0 : x % y;
}

static inline uint64_t umod_safe64(uint64_t x, uint64_t y) {
  return y == 0 ? 0 : x % y;
}

static inline int8_t sdiv8(int8_t x, int8_t y) {
  int8_t q = x / y;
  int8_t r = x % y;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

static inline int16_t sdiv16(int16_t x, int16_t y) {
  int16_t q = x / y;
  int16_t r = x % y;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

static inline int32_t sdiv32(int32_t x, int32_t y) {
  int32_t q = x / y;
  int32_t r = x % y;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

static inline int64_t sdiv64(int64_t x, int64_t y) {
  int64_t q = x / y;
  int64_t r = x % y;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

static inline int8_t sdiv_up8(int8_t x, int8_t y) {
  return sdiv8(x + y - 1, y);
}

static inline int16_t sdiv_up16(int16_t x, int16_t y) {
  return sdiv16(x + y - 1, y);
}

static inline int32_t sdiv_up32(int32_t x, int32_t y) {
  return sdiv32(x + y - 1, y);
}

static inline int64_t sdiv_up64(int64_t x, int64_t y) {
  return sdiv64(x + y - 1, y);
}

static inline int8_t smod8(int8_t x, int8_t y) {
  int8_t r = x % y;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

static inline int16_t smod16(int16_t x, int16_t y) {
  int16_t r = x % y;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

static inline int32_t smod32(int32_t x, int32_t y) {
  int32_t r = x % y;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

static inline int64_t smod64(int64_t x, int64_t y) {
  int64_t r = x % y;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

static inline int8_t sdiv_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : sdiv8(x, y);
}

static inline int16_t sdiv_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : sdiv16(x, y);
}

static inline int32_t sdiv_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : sdiv32(x, y);
}

static inline int64_t sdiv_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : sdiv64(x, y);
}

static inline int8_t sdiv_up_safe8(int8_t x, int8_t y) {
  return sdiv_safe8(x + y - 1, y);
}

static inline int16_t sdiv_up_safe16(int16_t x, int16_t y) {
  return sdiv_safe16(x + y - 1, y);
}

static inline int32_t sdiv_up_safe32(int32_t x, int32_t y) {
  return sdiv_safe32(x + y - 1, y);
}

static inline int64_t sdiv_up_safe64(int64_t x, int64_t y) {
  return sdiv_safe64(x + y - 1, y);
}

static inline int8_t smod_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : smod8(x, y);
}

static inline int16_t smod_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : smod16(x, y);
}

static inline int32_t smod_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : smod32(x, y);
}

static inline int64_t smod_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : smod64(x, y);
}

static inline int8_t squot8(int8_t x, int8_t y) {
  return x / y;
}

static inline int16_t squot16(int16_t x, int16_t y) {
  return x / y;
}

static inline int32_t squot32(int32_t x, int32_t y) {
  return x / y;
}

static inline int64_t squot64(int64_t x, int64_t y) {
  return x / y;
}

static inline int8_t srem8(int8_t x, int8_t y) {
  return x % y;
}

static inline int16_t srem16(int16_t x, int16_t y) {
  return x % y;
}

static inline int32_t srem32(int32_t x, int32_t y) {
  return x % y;
}

static inline int64_t srem64(int64_t x, int64_t y) {
  return x % y;
}

static inline int8_t squot_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : x / y;
}

static inline int16_t squot_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : x / y;
}

static inline int32_t squot_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : x / y;
}

static inline int64_t squot_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : x / y;
}

static inline int8_t srem_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : x % y;
}

static inline int16_t srem_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : x % y;
}

static inline int32_t srem_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : x % y;
}

static inline int64_t srem_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : x % y;
}

#endif

static inline int8_t smin8(int8_t x, int8_t y) {
  return x < y ? x : y;
}

static inline int16_t smin16(int16_t x, int16_t y) {
  return x < y ? x : y;
}

static inline int32_t smin32(int32_t x, int32_t y) {
  return x < y ? x : y;
}

static inline int64_t smin64(int64_t x, int64_t y) {
  return x < y ? x : y;
}

static inline uint8_t umin8(uint8_t x, uint8_t y) {
  return x < y ? x : y;
}

static inline uint16_t umin16(uint16_t x, uint16_t y) {
  return x < y ? x : y;
}

static inline uint32_t umin32(uint32_t x, uint32_t y) {
  return x < y ? x : y;
}

static inline uint64_t umin64(uint64_t x, uint64_t y) {
  return x < y ? x : y;
}

static inline int8_t smax8(int8_t x, int8_t y) {
  return x < y ? y : x;
}

static inline int16_t smax16(int16_t x, int16_t y) {
  return x < y ? y : x;
}

static inline int32_t smax32(int32_t x, int32_t y) {
  return x < y ? y : x;
}

static inline int64_t smax64(int64_t x, int64_t y) {
  return x < y ? y : x;
}

static inline uint8_t umax8(uint8_t x, uint8_t y) {
  return x < y ? y : x;
}

static inline uint16_t umax16(uint16_t x, uint16_t y) {
  return x < y ? y : x;
}

static inline uint32_t umax32(uint32_t x, uint32_t y) {
  return x < y ? y : x;
}

static inline uint64_t umax64(uint64_t x, uint64_t y) {
  return x < y ? y : x;
}

static inline uint8_t shl8(uint8_t x, uint8_t y) {
  return (uint8_t)(x << y);
}

static inline uint16_t shl16(uint16_t x, uint16_t y) {
  return (uint16_t)(x << y);
}

static inline uint32_t shl32(uint32_t x, uint32_t y) {
  return x << y;
}

static inline uint64_t shl64(uint64_t x, uint64_t y) {
  return x << y;
}

static inline uint8_t lshr8(uint8_t x, uint8_t y) {
  return x >> y;
}

static inline uint16_t lshr16(uint16_t x, uint16_t y) {
  return x >> y;
}

static inline uint32_t lshr32(uint32_t x, uint32_t y) {
  return x >> y;
}

static inline uint64_t lshr64(uint64_t x, uint64_t y) {
  return x >> y;
}

static inline int8_t ashr8(int8_t x, int8_t y) {
  return x >> y;
}

static inline int16_t ashr16(int16_t x, int16_t y) {
  return x >> y;
}

static inline int32_t ashr32(int32_t x, int32_t y) {
  return x >> y;
}

static inline int64_t ashr64(int64_t x, int64_t y) {
  return x >> y;
}

static inline uint8_t and8(uint8_t x, uint8_t y) {
  return x & y;
}

static inline uint16_t and16(uint16_t x, uint16_t y) {
  return x & y;
}

static inline uint32_t and32(uint32_t x, uint32_t y) {
  return x & y;
}

static inline uint64_t and64(uint64_t x, uint64_t y) {
  return x & y;
}

static inline uint8_t or8(uint8_t x, uint8_t y) {
  return x | y;
}

static inline uint16_t or16(uint16_t x, uint16_t y) {
  return x | y;
}

static inline uint32_t or32(uint32_t x, uint32_t y) {
  return x | y;
}

static inline uint64_t or64(uint64_t x, uint64_t y) {
  return x | y;
}

static inline uint8_t xor8(uint8_t x, uint8_t y) {
  return x ^ y;
}

static inline uint16_t xor16(uint16_t x, uint16_t y) {
  return x ^ y;
}

static inline uint32_t xor32(uint32_t x, uint32_t y) {
  return x ^ y;
}

static inline uint64_t xor64(uint64_t x, uint64_t y) {
  return x ^ y;
}

static inline bool ult8(uint8_t x, uint8_t y) {
  return x < y;
}

static inline bool ult16(uint16_t x, uint16_t y) {
  return x < y;
}

static inline bool ult32(uint32_t x, uint32_t y) {
  return x < y;
}

static inline bool ult64(uint64_t x, uint64_t y) {
  return x < y;
}

static inline bool ule8(uint8_t x, uint8_t y) {
  return x <= y;
}

static inline bool ule16(uint16_t x, uint16_t y) {
  return x <= y;
}

static inline bool ule32(uint32_t x, uint32_t y) {
  return x <= y;
}

static inline bool ule64(uint64_t x, uint64_t y) {
  return x <= y;
}

static inline bool slt8(int8_t x, int8_t y) {
  return x < y;
}

static inline bool slt16(int16_t x, int16_t y) {
  return x < y;
}

static inline bool slt32(int32_t x, int32_t y) {
  return x < y;
}

static inline bool slt64(int64_t x, int64_t y) {
  return x < y;
}

static inline bool sle8(int8_t x, int8_t y) {
  return x <= y;
}

static inline bool sle16(int16_t x, int16_t y) {
  return x <= y;
}

static inline bool sle32(int32_t x, int32_t y) {
  return x <= y;
}

static inline bool sle64(int64_t x, int64_t y) {
  return x <= y;
}

static inline uint8_t pow8(uint8_t x, uint8_t y) {
  uint8_t res = 1, rem = y;

  while (rem != 0) {
    if (rem & 1)
      res *= x;
    rem >>= 1;
    x *= x;
  }
  return res;
}

static inline uint16_t pow16(uint16_t x, uint16_t y) {
  uint16_t res = 1, rem = y;

  while (rem != 0) {
    if (rem & 1)
      res *= x;
    rem >>= 1;
    x *= x;
  }
  return res;
}

static inline uint32_t pow32(uint32_t x, uint32_t y) {
  uint32_t res = 1, rem = y;

  while (rem != 0) {
    if (rem & 1)
      res *= x;
    rem >>= 1;
    x *= x;
  }
  return res;
}

static inline uint64_t pow64(uint64_t x, uint64_t y) {
  uint64_t res = 1, rem = y;

  while (rem != 0) {
    if (rem & 1)
      res *= x;
    rem >>= 1;
    x *= x;
  }
  return res;
}

static inline bool itob_i8_bool(int8_t x) {
  return x != 0;
}

static inline bool itob_i16_bool(int16_t x) {
  return x != 0;
}

static inline bool itob_i32_bool(int32_t x) {
  return x != 0;
}

static inline bool itob_i64_bool(int64_t x) {
  return x != 0;
}

static inline int8_t btoi_bool_i8(bool x) {
  return x;
}

static inline int16_t btoi_bool_i16(bool x) {
  return x;
}

static inline int32_t btoi_bool_i32(bool x) {
  return x;
}

static inline int64_t btoi_bool_i64(bool x) {
  return x;
}

#define sext_i8_i8(x) ((int8_t) (int8_t) (x))
#define sext_i8_i16(x) ((int16_t) (int8_t) (x))
#define sext_i8_i32(x) ((int32_t) (int8_t) (x))
#define sext_i8_i64(x) ((int64_t) (int8_t) (x))
#define sext_i16_i8(x) ((int8_t) (int16_t) (x))
#define sext_i16_i16(x) ((int16_t) (int16_t) (x))
#define sext_i16_i32(x) ((int32_t) (int16_t) (x))
#define sext_i16_i64(x) ((int64_t) (int16_t) (x))
#define sext_i32_i8(x) ((int8_t) (int32_t) (x))
#define sext_i32_i16(x) ((int16_t) (int32_t) (x))
#define sext_i32_i32(x) ((int32_t) (int32_t) (x))
#define sext_i32_i64(x) ((int64_t) (int32_t) (x))
#define sext_i64_i8(x) ((int8_t) (int64_t) (x))
#define sext_i64_i16(x) ((int16_t) (int64_t) (x))
#define sext_i64_i32(x) ((int32_t) (int64_t) (x))
#define sext_i64_i64(x) ((int64_t) (int64_t) (x))
#define zext_i8_i8(x) ((int8_t) (uint8_t) (x))
#define zext_i8_i16(x) ((int16_t) (uint8_t) (x))
#define zext_i8_i32(x) ((int32_t) (uint8_t) (x))
#define zext_i8_i64(x) ((int64_t) (uint8_t) (x))
#define zext_i16_i8(x) ((int8_t) (uint16_t) (x))
#define zext_i16_i16(x) ((int16_t) (uint16_t) (x))
#define zext_i16_i32(x) ((int32_t) (uint16_t) (x))
#define zext_i16_i64(x) ((int64_t) (uint16_t) (x))
#define zext_i32_i8(x) ((int8_t) (uint32_t) (x))
#define zext_i32_i16(x) ((int16_t) (uint32_t) (x))
#define zext_i32_i32(x) ((int32_t) (uint32_t) (x))
#define zext_i32_i64(x) ((int64_t) (uint32_t) (x))
#define zext_i64_i8(x) ((int8_t) (uint64_t) (x))
#define zext_i64_i16(x) ((int16_t) (uint64_t) (x))
#define zext_i64_i32(x) ((int32_t) (uint64_t) (x))
#define zext_i64_i64(x) ((int64_t) (uint64_t) (x))

static int8_t abs8(int8_t x) {
  return (int8_t)abs(x);
}

static int16_t abs16(int16_t x) {
  return (int16_t)abs(x);
}

static int32_t abs32(int32_t x) {
  return abs(x);
}

static int64_t abs64(int64_t x) {
#if defined(__OPENCL_VERSION__) || defined(ISPC)
  return abs(x);
#else
  return llabs(x);
#endif
}

#if defined(__OPENCL_VERSION__)
static int32_t futrts_popc8(int8_t x) {
  return popcount(x);
}

static int32_t futrts_popc16(int16_t x) {
  return popcount(x);
}

static int32_t futrts_popc32(int32_t x) {
  return popcount(x);
}

static int32_t futrts_popc64(int64_t x) {
  return popcount(x);
}
#elif defined(__CUDA_ARCH__)

static int32_t futrts_popc8(int8_t x) {
  return __popc(zext_i8_i32(x));
}

static int32_t futrts_popc16(int16_t x) {
  return __popc(zext_i16_i32(x));
}

static int32_t futrts_popc32(int32_t x) {
  return __popc(x);
}

static int32_t futrts_popc64(int64_t x) {
  return __popcll(x);
}

#else // Not OpenCL or CUDA, but plain C.

static int32_t futrts_popc8(uint8_t x) {
  int c = 0;
  for (; x; ++c) { x &= x - 1; }
  return c;
}

static int32_t futrts_popc16(uint16_t x) {
  int c = 0;
  for (; x; ++c) { x &= x - 1; }
  return c;
}

static int32_t futrts_popc32(uint32_t x) {
  int c = 0;
  for (; x; ++c) { x &= x - 1; }
  return c;
}

static int32_t futrts_popc64(uint64_t x) {
  int c = 0;
  for (; x; ++c) { x &= x - 1; }
  return c;
}
#endif

#if defined(__OPENCL_VERSION__)
static uint8_t futrts_mul_hi8(uint8_t a, uint8_t b) {
  return mul_hi(a, b);
}

static uint16_t futrts_mul_hi16(uint16_t a, uint16_t b) {
  return mul_hi(a, b);
}

static uint32_t futrts_mul_hi32(uint32_t a, uint32_t b) {
  return mul_hi(a, b);
}

static uint64_t futrts_mul_hi64(uint64_t a, uint64_t b) {
  return mul_hi(a, b);
}

#elif defined(__CUDA_ARCH__)

static uint8_t futrts_mul_hi8(uint8_t a, uint8_t b) {
  uint16_t aa = a;
  uint16_t bb = b;

  return aa * bb >> 8;
}

static uint16_t futrts_mul_hi16(uint16_t a, uint16_t b) {
  uint32_t aa = a;
  uint32_t bb = b;

  return aa * bb >> 16;
}

static uint32_t futrts_mul_hi32(uint32_t a, uint32_t b) {
  return mulhi(a, b);
}

static uint64_t futrts_mul_hi64(uint64_t a, uint64_t b) {
  return mul64hi(a, b);
}

#elif ISPC

static uint8_t futrts_mul_hi8(uint8_t a, uint8_t b) {
  uint16_t aa = a;
  uint16_t bb = b;

  return aa * bb >> 8;
}

static uint16_t futrts_mul_hi16(uint16_t a, uint16_t b) {
  uint32_t aa = a;
  uint32_t bb = b;

  return aa * bb >> 16;
}

static uint32_t futrts_mul_hi32(uint32_t a, uint32_t b) {
  uint64_t aa = a;
  uint64_t bb = b;

  return aa * bb >> 32;
}

static uint64_t futrts_mul_hi64(uint64_t a, uint64_t b) {
  uint64_t ah = a >> 32;
  uint64_t al = a & 0xffffffff;
  uint64_t bh = b >> 32;
  uint64_t bl = b & 0xffffffff;

  uint64_t p1 = al * bl;
  uint64_t p2 = al * bh;
  uint64_t p3 = ah * bl;
  uint64_t p4 = ah * bh;

  uint64_t p1h = p1 >> 32;
  uint64_t p2h = p2 >> 32;
  uint64_t p3h = p3 >> 32;
  uint64_t p2l = p2 & 0xffffffff;
  uint64_t p3l = p3 & 0xffffffff;

  uint64_t l = p1h + p2l  + p3l;
  uint64_t m = (p2 >> 32) + (p3 >> 32);
  uint64_t h = (l >> 32) + m + p4;

  return h;
}

#else // Not OpenCL, ISPC, or CUDA, but plain C.

static uint8_t futrts_mul_hi8(uint8_t a, uint8_t b) {
  uint16_t aa = a;
  uint16_t bb = b;

  return aa * bb >> 8;
}

static uint16_t futrts_mul_hi16(uint16_t a, uint16_t b) {
  uint32_t aa = a;
  uint32_t bb = b;

  return aa * bb >> 16;
}

static uint32_t futrts_mul_hi32(uint32_t a, uint32_t b) {
  uint64_t aa = a;
  uint64_t bb = b;

  return aa * bb >> 32;
}

static uint64_t futrts_mul_hi64(uint64_t a, uint64_t b) {
  __uint128_t aa = a;
  __uint128_t bb = b;

  return aa * bb >> 64;
}
#endif

#if defined(__OPENCL_VERSION__)
static uint8_t futrts_mad_hi8(uint8_t a, uint8_t b, uint8_t c) {
  return mad_hi(a, b, c);
}

static uint16_t futrts_mad_hi16(uint16_t a, uint16_t b, uint16_t c) {
  return mad_hi(a, b, c);
}

static uint32_t futrts_mad_hi32(uint32_t a, uint32_t b, uint32_t c) {
  return mad_hi(a, b, c);
}

static uint64_t futrts_mad_hi64(uint64_t a, uint64_t b, uint64_t c) {
  return mad_hi(a, b, c);
}

#else // Not OpenCL

static uint8_t futrts_mad_hi8(uint8_t a, uint8_t b, uint8_t c) {
  return futrts_mul_hi8(a, b) + c;
}

static uint16_t futrts_mad_hi16(uint16_t a, uint16_t b, uint16_t c) {
  return futrts_mul_hi16(a, b) + c;
}

static uint32_t futrts_mad_hi32(uint32_t a, uint32_t b, uint32_t c) {
  return futrts_mul_hi32(a, b) + c;
}

static uint64_t futrts_mad_hi64(uint64_t a, uint64_t b, uint64_t c) {
  return futrts_mul_hi64(a, b) + c;
}
#endif

#if defined(__OPENCL_VERSION__)
static int32_t futrts_clzz8(int8_t x) {
  return clz(x);
}

static int32_t futrts_clzz16(int16_t x) {
  return clz(x);
}

static int32_t futrts_clzz32(int32_t x) {
  return clz(x);
}

static int32_t futrts_clzz64(int64_t x) {
  return clz(x);
}

#elif defined(__CUDA_ARCH__)

static int32_t futrts_clzz8(int8_t x) {
  return __clz(zext_i8_i32(x)) - 24;
}

static int32_t futrts_clzz16(int16_t x) {
  return __clz(zext_i16_i32(x)) - 16;
}

static int32_t futrts_clzz32(int32_t x) {
  return __clz(x);
}

static int32_t futrts_clzz64(int64_t x) {
  return __clzll(x);
}

#elif ISPC

static int32_t futrts_clzz8(int8_t x) {
  return count_leading_zeros((int32_t)(uint8_t)x)-24;
}

static int32_t futrts_clzz16(int16_t x) {
  return count_leading_zeros((int32_t)(uint16_t)x)-16;
}

static int32_t futrts_clzz32(int32_t x) {
  return count_leading_zeros(x);
}

static int32_t futrts_clzz64(int64_t x) {
  return count_leading_zeros(x);
}

#else // Not OpenCL, ISPC or CUDA, but plain C.

static int32_t futrts_clzz8(int8_t x) {
  return x == 0 ? 8 : __builtin_clz((uint32_t)zext_i8_i32(x)) - 24;
}

static int32_t futrts_clzz16(int16_t x) {
  return x == 0 ? 16 : __builtin_clz((uint32_t)zext_i16_i32(x)) - 16;
}

static int32_t futrts_clzz32(int32_t x) {
  return x == 0 ? 32 : __builtin_clz((uint32_t)x);
}

static int32_t futrts_clzz64(int64_t x) {
  return x == 0 ? 64 : __builtin_clzll((uint64_t)x);
}
#endif

#if defined(__OPENCL_VERSION__)
static int32_t futrts_ctzz8(int8_t x) {
  int i = 0;
  for (; i < 8 && (x & 1) == 0; i++, x >>= 1)
    ;
  return i;
}

static int32_t futrts_ctzz16(int16_t x) {
  int i = 0;
  for (; i < 16 && (x & 1) == 0; i++, x >>= 1)
    ;
  return i;
}

static int32_t futrts_ctzz32(int32_t x) {
  int i = 0;
  for (; i < 32 && (x & 1) == 0; i++, x >>= 1)
    ;
  return i;
}

static int32_t futrts_ctzz64(int64_t x) {
  int i = 0;
  for (; i < 64 && (x & 1) == 0; i++, x >>= 1)
    ;
  return i;
}

#elif defined(__CUDA_ARCH__)

static int32_t futrts_ctzz8(int8_t x) {
  int y = __ffs(x);
  return y == 0 ? 8 : y - 1;
}

static int32_t futrts_ctzz16(int16_t x) {
  int y = __ffs(x);
  return y == 0 ? 16 : y - 1;
}

static int32_t futrts_ctzz32(int32_t x) {
  int y = __ffs(x);
  return y == 0 ? 32 : y - 1;
}

static int32_t futrts_ctzz64(int64_t x) {
  int y = __ffsll(x);
  return y == 0 ? 64 : y - 1;
}

#elif ISPC

static int32_t futrts_ctzz8(int8_t x) {
  return x == 0 ? 8 : count_trailing_zeros((int32_t)x);
}

static int32_t futrts_ctzz16(int16_t x) {
  return x == 0 ? 16 : count_trailing_zeros((int32_t)x);
}

static int32_t futrts_ctzz32(int32_t x) {
  return count_trailing_zeros(x);
}

static int32_t futrts_ctzz64(int64_t x) {
  return count_trailing_zeros(x);
}

#else // Not OpenCL or CUDA, but plain C.

static int32_t futrts_ctzz8(int8_t x) {
  return x == 0 ? 8 : __builtin_ctz((uint32_t)x);
}

static int32_t futrts_ctzz16(int16_t x) {
  return x == 0 ? 16 : __builtin_ctz((uint32_t)x);
}

static int32_t futrts_ctzz32(int32_t x) {
  return x == 0 ? 32 : __builtin_ctz((uint32_t)x);
}

static int32_t futrts_ctzz64(int64_t x) {
  return x == 0 ? 64 : __builtin_ctzll((uint64_t)x);
}
#endif

static inline float fdiv32(float x, float y) {
  return x / y;
}

static inline float fadd32(float x, float y) {
  return x + y;
}

static inline float fsub32(float x, float y) {
  return x - y;
}

static inline float fmul32(float x, float y) {
  return x * y;
}

static inline bool cmplt32(float x, float y) {
  return x < y;
}

static inline bool cmple32(float x, float y) {
  return x <= y;
}

static inline float sitofp_i8_f32(int8_t x) {
  return (float) x;
}

static inline float sitofp_i16_f32(int16_t x) {
  return (float) x;
}

static inline float sitofp_i32_f32(int32_t x) {
  return (float) x;
}

static inline float sitofp_i64_f32(int64_t x) {
  return (float) x;
}

static inline float uitofp_i8_f32(uint8_t x) {
  return (float) x;
}

static inline float uitofp_i16_f32(uint16_t x) {
  return (float) x;
}

static inline float uitofp_i32_f32(uint32_t x) {
  return (float) x;
}

static inline float uitofp_i64_f32(uint64_t x) {
  return (float) x;
}

#ifdef __OPENCL_VERSION__
static inline float fabs32(float x) {
  return fabs(x);
}

static inline float fmax32(float x, float y) {
  return fmax(x, y);
}

static inline float fmin32(float x, float y) {
  return fmin(x, y);
}

static inline float fpow32(float x, float y) {
  return pow(x, y);
}

#elif ISPC

static inline float fabs32(float x) {
  return abs(x);
}

static inline float fmax32(float x, float y) {
  return isnan(x) ? y : isnan(y) ? x : max(x, y);
}

static inline float fmin32(float x, float y) {
  return isnan(x) ? y : isnan(y) ? x : min(x, y);
}

static inline float fpow32(float a, float b) {
  float ret;
  foreach_active (i) {
      uniform float r = __stdlib_powf(extract(a, i), extract(b, i));
      ret = insert(ret, i, r);
  }
  return ret;
}

#else // Not OpenCL, but CUDA or plain C.

static inline float fabs32(float x) {
  return fabsf(x);
}

static inline float fmax32(float x, float y) {
  return fmaxf(x, y);
}

static inline float fmin32(float x, float y) {
  return fminf(x, y);
}

static inline float fpow32(float x, float y) {
  return powf(x, y);
}
#endif

static inline bool futrts_isnan32(float x) {
  return isnan(x);
}

#if ISPC

static inline bool futrts_isinf32(float x) {
  return !isnan(x) && isnan(x - x);
}

static inline bool futrts_isfinite32(float x) {
  return !isnan(x) && !futrts_isinf32(x);
}

#else

static inline bool futrts_isinf32(float x) {
  return isinf(x);
}

#endif

static inline int8_t fptosi_f32_i8(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (int8_t) x;
  }
}

static inline int16_t fptosi_f32_i16(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (int16_t) x;
  }
}

static inline int32_t fptosi_f32_i32(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (int32_t) x;
  }
}

static inline int64_t fptosi_f32_i64(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (int64_t) x;
  };
}

static inline uint8_t fptoui_f32_i8(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (uint8_t) (int8_t) x;
  }
}

static inline uint16_t fptoui_f32_i16(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (uint16_t) (int16_t) x;
  }
}

static inline uint32_t fptoui_f32_i32(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (uint32_t) (int32_t) x;
  }
}

static inline uint64_t fptoui_f32_i64(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (uint64_t) (int64_t) x;
  }
}

static inline bool ftob_f32_bool(float x) {
  return x != 0;
}

static inline float btof_bool_f32(bool x) {
  return x ? 1 : 0;
}

#ifdef __OPENCL_VERSION__
static inline float futrts_log32(float x) {
  return log(x);
}

static inline float futrts_log2_32(float x) {
  return log2(x);
}

static inline float futrts_log10_32(float x) {
  return log10(x);
}

static inline float futrts_sqrt32(float x) {
  return sqrt(x);
}

static inline float futrts_cbrt32(float x) {
  return cbrt(x);
}

static inline float futrts_exp32(float x) {
  return exp(x);
}

static inline float futrts_cos32(float x) {
  return cos(x);
}

static inline float futrts_sin32(float x) {
  return sin(x);
}

static inline float futrts_tan32(float x) {
  return tan(x);
}

static inline float futrts_acos32(float x) {
  return acos(x);
}

static inline float futrts_asin32(float x) {
  return asin(x);
}

static inline float futrts_atan32(float x) {
  return atan(x);
}

static inline float futrts_cosh32(float x) {
  return cosh(x);
}

static inline float futrts_sinh32(float x) {
  return sinh(x);
}

static inline float futrts_tanh32(float x) {
  return tanh(x);
}

static inline float futrts_acosh32(float x) {
  return acosh(x);
}

static inline float futrts_asinh32(float x) {
  return asinh(x);
}

static inline float futrts_atanh32(float x) {
  return atanh(x);
}

static inline float futrts_atan2_32(float x, float y) {
  return atan2(x, y);
}

static inline float futrts_hypot32(float x, float y) {
  return hypot(x, y);
}

static inline float futrts_gamma32(float x) {
  return tgamma(x);
}

static inline float futrts_lgamma32(float x) {
  return lgamma(x);
}

static inline float futrts_erf32(float x) {
  return erf(x);
}

static inline float futrts_erfc32(float x) {
  return erfc(x);
}

static inline float fmod32(float x, float y) {
  return fmod(x, y);
}

static inline float futrts_round32(float x) {
  return rint(x);
}

static inline float futrts_floor32(float x) {
  return floor(x);
}

static inline float futrts_ceil32(float x) {
  return ceil(x);
}

static inline float futrts_lerp32(float v0, float v1, float t) {
  return mix(v0, v1, t);
}

static inline float futrts_mad32(float a, float b, float c) {
  return mad(a, b, c);
}

static inline float futrts_fma32(float a, float b, float c) {
  return fma(a, b, c);
}

#elif ISPC

static inline float futrts_log32(float x) {
  return futrts_isfinite32(x) || (futrts_isinf32(x) && x < 0)? log(x) : x;
}

static inline float futrts_log2_32(float x) {
  return futrts_log32(x) / log(2.0f);
}

static inline float futrts_log10_32(float x) {
  return futrts_log32(x) / log(10.0f);
}

static inline float futrts_sqrt32(float x) {
  return sqrt(x);
}

extern "C" unmasked uniform float cbrtf(uniform float);
static inline float futrts_cbrt32(float x) {
  float res;
  foreach_active (i) {
    uniform float r = cbrtf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

static inline float futrts_exp32(float x) {
  return exp(x);
}

static inline float futrts_cos32(float x) {
  return cos(x);
}

static inline float futrts_sin32(float x) {
  return sin(x);
}

static inline float futrts_tan32(float x) {
  return tan(x);
}

static inline float futrts_acos32(float x) {
  return acos(x);
}

static inline float futrts_asin32(float x) {
  return asin(x);
}

static inline float futrts_atan32(float x) {
  return atan(x);
}

static inline float futrts_cosh32(float x) {
  return (exp(x)+exp(-x)) / 2.0f;
}

static inline float futrts_sinh32(float x) {
  return (exp(x)-exp(-x)) / 2.0f;
}

static inline float futrts_tanh32(float x) {
  return futrts_sinh32(x)/futrts_cosh32(x);
}

static inline float futrts_acosh32(float x) {
  float f = x+sqrt(x*x-1);
  if(futrts_isfinite32(f)) return log(f);
  return f;
}

static inline float futrts_asinh32(float x) {
  float f = x+sqrt(x*x+1);
  if(futrts_isfinite32(f)) return log(f);
  return f;

}

static inline float futrts_atanh32(float x) {
  float f = (1+x)/(1-x);
  if(futrts_isfinite32(f)) return log(f)/2.0f;
  return f;

}

static inline float futrts_atan2_32(float x, float y) {
  return (x == 0.0f && y == 0.0f) ? 0.0f : atan2(x, y);
}

static inline float futrts_hypot32(float x, float y) {
  if (futrts_isfinite32(x) && futrts_isfinite32(y)) {
    x = abs(x);
    y = abs(y);
    float a;
    float b;
    if (x >= y){
        a = x;
        b = y;
    } else {
        a = y;
        b = x;
    }
    if(b == 0){
      return a;
    }

    int e;
    float an;
    float bn;
    an = frexp (a, &e);
    bn = ldexp (b, - e);
    float cn;
    cn = sqrt (an * an + bn * bn);
    return ldexp (cn, e);
  } else {
    if (futrts_isinf32(x) || futrts_isinf32(y)) return INFINITY;
    else return x + y;
  }

}

extern "C" unmasked uniform float tgammaf(uniform float x);
static inline float futrts_gamma32(float x) {
  float res;
  foreach_active (i) {
    uniform float r = tgammaf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform float lgammaf(uniform float x);
static inline float futrts_lgamma32(float x) {
  float res;
  foreach_active (i) {
    uniform float r = lgammaf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform float erff(uniform float x);
static inline float futrts_erf32(float x) {
  float res;
  foreach_active (i) {
    uniform float r = erff(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform float erfcf(uniform float x);
static inline float futrts_erfc32(float x) {
  float res;
  foreach_active (i) {
    uniform float r = erfcf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

static inline float fmod32(float x, float y) {
  return x - y * trunc(x/y);
}

static inline float futrts_round32(float x) {
  return round(x);
}

static inline float futrts_floor32(float x) {
  return floor(x);
}

static inline float futrts_ceil32(float x) {
  return ceil(x);
}

static inline float futrts_lerp32(float v0, float v1, float t) {
  return v0 + (v1 - v0) * t;
}

static inline float futrts_mad32(float a, float b, float c) {
  return a * b + c;
}

static inline float futrts_fma32(float a, float b, float c) {
  return a * b + c;
}

#else // Not OpenCL or ISPC, but CUDA or plain C.

static inline float futrts_log32(float x) {
  return logf(x);
}

static inline float futrts_log2_32(float x) {
  return log2f(x);
}

static inline float futrts_log10_32(float x) {
  return log10f(x);
}

static inline float futrts_sqrt32(float x) {
  return sqrtf(x);
}

static inline float futrts_cbrt32(float x) {
  return cbrtf(x);
}

static inline float futrts_exp32(float x) {
  return expf(x);
}

static inline float futrts_cos32(float x) {
  return cosf(x);
}

static inline float futrts_sin32(float x) {
  return sinf(x);
}

static inline float futrts_tan32(float x) {
  return tanf(x);
}

static inline float futrts_acos32(float x) {
  return acosf(x);
}

static inline float futrts_asin32(float x) {
  return asinf(x);
}

static inline float futrts_atan32(float x) {
  return atanf(x);
}

static inline float futrts_cosh32(float x) {
  return coshf(x);
}

static inline float futrts_sinh32(float x) {
  return sinhf(x);
}

static inline float futrts_tanh32(float x) {
  return tanhf(x);
}

static inline float futrts_acosh32(float x) {
  return acoshf(x);
}

static inline float futrts_asinh32(float x) {
  return asinhf(x);
}

static inline float futrts_atanh32(float x) {
  return atanhf(x);
}

static inline float futrts_atan2_32(float x, float y) {
  return atan2f(x, y);
}

static inline float futrts_hypot32(float x, float y) {
  return hypotf(x, y);
}

static inline float futrts_gamma32(float x) {
  return tgammaf(x);
}

static inline float futrts_lgamma32(float x) {
  return lgammaf(x);
}

static inline float futrts_erf32(float x) {
  return erff(x);
}

static inline float futrts_erfc32(float x) {
  return erfcf(x);
}

static inline float fmod32(float x, float y) {
  return fmodf(x, y);
}

static inline float futrts_round32(float x) {
  return rintf(x);
}

static inline float futrts_floor32(float x) {
  return floorf(x);
}

static inline float futrts_ceil32(float x) {
  return ceilf(x);
}

static inline float futrts_lerp32(float v0, float v1, float t) {
  return v0 + (v1 - v0) * t;
}

static inline float futrts_mad32(float a, float b, float c) {
  return a * b + c;
}

static inline float futrts_fma32(float a, float b, float c) {
  return fmaf(a, b, c);
}
#endif

#if ISPC
static inline int32_t futrts_to_bits32(float x) {
  return intbits(x);
}

static inline float futrts_from_bits32(int32_t x) {
  return floatbits(x);
}
#else
static inline int32_t futrts_to_bits32(float x) {
  union {
    float f;
    int32_t t;
  } p;

  p.f = x;
  return p.t;
}

static inline float futrts_from_bits32(int32_t x) {
  union {
    int32_t f;
    float t;
  } p;

  p.f = x;
  return p.t;
}
#endif

static inline float fsignum32(float x) {
  return futrts_isnan32(x) ? x : (x > 0 ? 1 : 0) - (x < 0 ? 1 : 0);
}

#ifdef FUTHARK_F64_ENABLED

#if ISPC
static inline bool futrts_isinf64(float x) {
  return !isnan(x) && isnan(x - x);
}

static inline bool futrts_isfinite64(float x) {
  return !isnan(x) && !futrts_isinf64(x);
}

static inline double fdiv64(double x, double y) {
  return x / y;
}

static inline double fadd64(double x, double y) {
  return x + y;
}

static inline double fsub64(double x, double y) {
  return x - y;
}

static inline double fmul64(double x, double y) {
  return x * y;
}

static inline bool cmplt64(double x, double y) {
  return x < y;
}

static inline bool cmple64(double x, double y) {
  return x <= y;
}

static inline double sitofp_i8_f64(int8_t x) {
  return (double) x;
}

static inline double sitofp_i16_f64(int16_t x) {
  return (double) x;
}

static inline double sitofp_i32_f64(int32_t x) {
  return (double) x;
}

static inline double sitofp_i64_f64(int64_t x) {
  return (double) x;
}

static inline double uitofp_i8_f64(uint8_t x) {
  return (double) x;
}

static inline double uitofp_i16_f64(uint16_t x) {
  return (double) x;
}

static inline double uitofp_i32_f64(uint32_t x) {
  return (double) x;
}

static inline double uitofp_i64_f64(uint64_t x) {
  return (double) x;
}

static inline double fabs64(double x) {
  return abs(x);
}

static inline double fmax64(double x, double y) {
  return isnan(x) ? y : isnan(y) ? x : max(x, y);
}

static inline double fmin64(double x, double y) {
  return isnan(x) ? y : isnan(y) ? x : min(x, y);
}

static inline double fpow64(double a, double b) {
  float ret;
  foreach_active (i) {
      uniform float r = __stdlib_powf(extract(a, i), extract(b, i));
      ret = insert(ret, i, r);
  }
  return ret;
}

static inline double futrts_log64(double x) {
  return futrts_isfinite64(x) || (futrts_isinf64(x) && x < 0)? log(x) : x;
}

static inline double futrts_log2_64(double x) {
  return futrts_log64(x)/log(2.0d);
}

static inline double futrts_log10_64(double x) {
  return futrts_log64(x)/log(10.0d);
}

static inline double futrts_sqrt64(double x) {
  return sqrt(x);
}

extern "C" unmasked uniform double cbrt(uniform double);
static inline double futrts_cbrt64(double x) {
  double res;
  foreach_active (i) {
    uniform double r = cbrtf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

static inline double futrts_exp64(double x) {
  return exp(x);
}

static inline double futrts_cos64(double x) {
  return cos(x);
}

static inline double futrts_sin64(double x) {
  return sin(x);
}

static inline double futrts_tan64(double x) {
  return tan(x);
}

static inline double futrts_acos64(double x) {
  return acos(x);
}

static inline double futrts_asin64(double x) {
  return asin(x);
}

static inline double futrts_atan64(double x) {
  return atan(x);
}

static inline double futrts_cosh64(double x) {
  return (exp(x)+exp(-x)) / 2.0d;
}

static inline double futrts_sinh64(double x) {
  return (exp(x)-exp(-x)) / 2.0d;
}

static inline double futrts_tanh64(double x) {
  return futrts_sinh64(x)/futrts_cosh64(x);
}

static inline double futrts_acosh64(double x) {
  double f = x+sqrt(x*x-1.0d);
  if(futrts_isfinite64(f)) return log(f);
  return f;
}

static inline double futrts_asinh64(double x) {
  double f = x+sqrt(x*x+1.0d);
  if(futrts_isfinite64(f)) return log(f);
  return f;
}

static inline double futrts_atanh64(double x) {
  double f = (1.0d+x)/(1.0d-x);
  if(futrts_isfinite64(f)) return log(f)/2.0d;
  return f;

}

static inline double futrts_atan2_64(double x, double y) {
  return atan2(x, y);
}

extern "C" unmasked uniform double hypot(uniform double x, uniform double y);
static inline double futrts_hypot64(double x, double y) {
  double res;
  foreach_active (i) {
    uniform double r = hypot(extract(x, i), extract(y, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform double tgamma(uniform double x);
static inline double futrts_gamma64(double x) {
  double res;
  foreach_active (i) {
    uniform double r = tgamma(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform double lgamma(uniform double x);
static inline double futrts_lgamma64(double x) {
  double res;
  foreach_active (i) {
    uniform double r = lgamma(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform double erf(uniform double x);
static inline double futrts_erf64(double x) {
  double res;
  foreach_active (i) {
    uniform double r = erf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform double erfc(uniform double x);
static inline double futrts_erfc64(double x) {
  double res;
  foreach_active (i) {
    uniform double r = erfc(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

static inline double futrts_fma64(double a, double b, double c) {
  return a * b + c;
}

static inline double futrts_round64(double x) {
  return round(x);
}

static inline double futrts_ceil64(double x) {
  return ceil(x);
}

static inline double futrts_floor64(double x) {
  return floor(x);
}

static inline bool futrts_isnan64(double x) {
  return isnan(x);
}

static inline int8_t fptosi_f64_i8(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int8_t) x;
  }
}

static inline int16_t fptosi_f64_i16(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int16_t) x;
  }
}

static inline int32_t fptosi_f64_i32(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int32_t) x;
  }
}

static inline int64_t fptosi_f64_i64(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int64_t) x;
  }
}

static inline uint8_t fptoui_f64_i8(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint8_t) (int8_t) x;
  }
}

static inline uint16_t fptoui_f64_i16(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint16_t) (int16_t) x;
  }
}

static inline uint32_t fptoui_f64_i32(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint32_t) (int32_t) x;
  }
}

static inline uint64_t fptoui_f64_i64(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint64_t) (int64_t) x;
  }
}

static inline bool ftob_f64_bool(double x) {
  return x != 0.0;
}

static inline double btof_bool_f64(bool x) {
  return x ? 1.0 : 0.0;
}

static inline int64_t futrts_to_bits64(double x) {
  int64_t res;
  foreach_active (i) {
    uniform double tmp = extract(x, i);
    uniform int64_t r = *((uniform int64_t* uniform)&tmp);
    res = insert(res, i, r);
  }
  return res;
}

static inline double futrts_from_bits64(int64_t x) {
  double res;
  foreach_active (i) {
    uniform int64_t tmp = extract(x, i);
    uniform double r = *((uniform double* uniform)&tmp);
    res = insert(res, i, r);
  }
  return res;
}

static inline double fmod64(double x, double y) {
  return x - y * trunc(x/y);
}

static inline double fsignum64(double x) {
  return futrts_isnan64(x) ? x : (x > 0 ? 1.0d : 0.0d) - (x < 0 ? 1.0d : 0.0d);
}

static inline double futrts_lerp64(double v0, double v1, double t) {
  return v0 + (v1 - v0) * t;
}

static inline double futrts_mad64(double a, double b, double c) {
  return a * b + c;
}

static inline float fpconv_f32_f32(float x) {
  return (float) x;
}

static inline double fpconv_f32_f64(float x) {
  return (double) x;
}

static inline float fpconv_f64_f32(double x) {
  return (float) x;
}

static inline double fpconv_f64_f64(double x) {
  return (double) x;
}

#else

static inline double fdiv64(double x, double y) {
  return x / y;
}

static inline double fadd64(double x, double y) {
  return x + y;
}

static inline double fsub64(double x, double y) {
  return x - y;
}

static inline double fmul64(double x, double y) {
  return x * y;
}

static inline bool cmplt64(double x, double y) {
  return x < y;
}

static inline bool cmple64(double x, double y) {
  return x <= y;
}

static inline double sitofp_i8_f64(int8_t x) {
  return (double) x;
}

static inline double sitofp_i16_f64(int16_t x) {
  return (double) x;
}

static inline double sitofp_i32_f64(int32_t x) {
  return (double) x;
}

static inline double sitofp_i64_f64(int64_t x) {
  return (double) x;
}

static inline double uitofp_i8_f64(uint8_t x) {
  return (double) x;
}

static inline double uitofp_i16_f64(uint16_t x) {
  return (double) x;
}

static inline double uitofp_i32_f64(uint32_t x) {
  return (double) x;
}

static inline double uitofp_i64_f64(uint64_t x) {
  return (double) x;
}

static inline double fabs64(double x) {
  return fabs(x);
}

static inline double fmax64(double x, double y) {
  return fmax(x, y);
}

static inline double fmin64(double x, double y) {
  return fmin(x, y);
}

static inline double fpow64(double x, double y) {
  return pow(x, y);
}

static inline double futrts_log64(double x) {
  return log(x);
}

static inline double futrts_log2_64(double x) {
  return log2(x);
}

static inline double futrts_log10_64(double x) {
  return log10(x);
}

static inline double futrts_sqrt64(double x) {
  return sqrt(x);
}

static inline double futrts_cbrt64(double x) {
  return cbrt(x);
}

static inline double futrts_exp64(double x) {
  return exp(x);
}

static inline double futrts_cos64(double x) {
  return cos(x);
}

static inline double futrts_sin64(double x) {
  return sin(x);
}

static inline double futrts_tan64(double x) {
  return tan(x);
}

static inline double futrts_acos64(double x) {
  return acos(x);
}

static inline double futrts_asin64(double x) {
  return asin(x);
}

static inline double futrts_atan64(double x) {
  return atan(x);
}

static inline double futrts_cosh64(double x) {
  return cosh(x);
}

static inline double futrts_sinh64(double x) {
  return sinh(x);
}

static inline double futrts_tanh64(double x) {
  return tanh(x);
}

static inline double futrts_acosh64(double x) {
  return acosh(x);
}

static inline double futrts_asinh64(double x) {
  return asinh(x);
}

static inline double futrts_atanh64(double x) {
  return atanh(x);
}

static inline double futrts_atan2_64(double x, double y) {
  return atan2(x, y);
}

static inline double futrts_hypot64(double x, double y) {
  return hypot(x, y);
}

static inline double futrts_gamma64(double x) {
  return tgamma(x);
}

static inline double futrts_lgamma64(double x) {
  return lgamma(x);
}

static inline double futrts_erf64(double x) {
  return erf(x);
}

static inline double futrts_erfc64(double x) {
  return erfc(x);
}

static inline double futrts_fma64(double a, double b, double c) {
  return fma(a, b, c);
}

static inline double futrts_round64(double x) {
  return rint(x);
}

static inline double futrts_ceil64(double x) {
  return ceil(x);
}

static inline double futrts_floor64(double x) {
  return floor(x);
}

static inline bool futrts_isnan64(double x) {
  return isnan(x);
}

static inline bool futrts_isinf64(double x) {
  return isinf(x);
}

static inline int8_t fptosi_f64_i8(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int8_t) x;
  }
}

static inline int16_t fptosi_f64_i16(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int16_t) x;
  }
}

static inline int32_t fptosi_f64_i32(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int32_t) x;
  }
}

static inline int64_t fptosi_f64_i64(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int64_t) x;
  }
}

static inline uint8_t fptoui_f64_i8(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint8_t) (int8_t) x;
  }
}

static inline uint16_t fptoui_f64_i16(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint16_t) (int16_t) x;
  }
}

static inline uint32_t fptoui_f64_i32(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint32_t) (int32_t) x;
  }
}

static inline uint64_t fptoui_f64_i64(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint64_t) (int64_t) x;
  }
}

static inline bool ftob_f64_bool(double x) {
  return x != 0;
}

static inline double btof_bool_f64(bool x) {
  return x ? 1 : 0;
}

static inline int64_t futrts_to_bits64(double x) {
  union {
    double f;
    int64_t t;
  } p;

  p.f = x;
  return p.t;
}

static inline double futrts_from_bits64(int64_t x) {
  union {
    int64_t f;
    double t;
  } p;

  p.f = x;
  return p.t;
}

static inline double fmod64(double x, double y) {
  return fmod(x, y);
}

static inline double fsignum64(double x) {
  return futrts_isnan64(x) ? x : (x > 0) - (x < 0);
}

static inline double futrts_lerp64(double v0, double v1, double t) {
#ifdef __OPENCL_VERSION__
  return mix(v0, v1, t);
#else
  return v0 + (v1 - v0) * t;
#endif
}

static inline double futrts_mad64(double a, double b, double c) {
#ifdef __OPENCL_VERSION__
  return mad(a, b, c);
#else
  return a * b + c;
#endif
}

static inline float fpconv_f32_f32(float x) {
  return (float) x;
}

static inline double fpconv_f32_f64(float x) {
  return (double) x;
}

static inline float fpconv_f64_f32(double x) {
  return (float) x;
}

static inline double fpconv_f64_f64(double x) {
  return (double) x;
}

#endif

#endif

// End of scalar.h.
// Start of scalar_f16.h.

// Half-precision is emulated if needed (e.g. in straight C) with the
// native type used if possible.  The emulation works by typedef'ing
// 'float' to 'f16', and then implementing all operations on single
// precision.  To cut down on duplication, we use the same code for
// those Futhark functions that require just operators or casts.  The
// in-memory representation for arrays will still be 16 bits even
// under emulation, so the compiler will have to be careful when
// generating reads or writes.

#if !defined(cl_khr_fp16) && !(defined(__CUDA_ARCH__) && __CUDA_ARCH__ >= 600) && !(defined(ISPC))
#define EMULATE_F16
#endif

#if !defined(EMULATE_F16) && defined(__OPENCL_VERSION__)
#pragma OPENCL EXTENSION cl_khr_fp16 : enable
#endif

#ifdef EMULATE_F16

// Note that the half-precision storage format is still 16 bits - the
// compiler will have to be real careful!
typedef float f16;

#elif ISPC
typedef float16 f16;

#else

#ifdef __CUDA_ARCH__
#include <cuda_fp16.h>
#endif

typedef half f16;

#endif

// Some of these functions convert to single precision because half
// precision versions are not available.

static inline f16 fadd16(f16 x, f16 y) {
  return x + y;
}

static inline f16 fsub16(f16 x, f16 y) {
  return x - y;
}

static inline f16 fmul16(f16 x, f16 y) {
  return x * y;
}

static inline bool cmplt16(f16 x, f16 y) {
  return x < y;
}

static inline bool cmple16(f16 x, f16 y) {
  return x <= y;
}

static inline f16 sitofp_i8_f16(int8_t x) {
  return (f16) x;
}

static inline f16 sitofp_i16_f16(int16_t x) {
  return (f16) x;
}

static inline f16 sitofp_i32_f16(int32_t x) {
  return (f16) x;
}

static inline f16 sitofp_i64_f16(int64_t x) {
  return (f16) x;
}

static inline f16 uitofp_i8_f16(uint8_t x) {
  return (f16) x;
}

static inline f16 uitofp_i16_f16(uint16_t x) {
  return (f16) x;
}

static inline f16 uitofp_i32_f16(uint32_t x) {
  return (f16) x;
}

static inline f16 uitofp_i64_f16(uint64_t x) {
  return (f16) x;
}

static inline int8_t fptosi_f16_i8(f16 x) {
  return (int8_t) (float) x;
}

static inline int16_t fptosi_f16_i16(f16 x) {
  return (int16_t) x;
}

static inline int32_t fptosi_f16_i32(f16 x) {
  return (int32_t) x;
}

static inline int64_t fptosi_f16_i64(f16 x) {
  return (int64_t) x;
}

static inline uint8_t fptoui_f16_i8(f16 x) {
  return (uint8_t) (float) x;
}

static inline uint16_t fptoui_f16_i16(f16 x) {
  return (uint16_t) x;
}

static inline uint32_t fptoui_f16_i32(f16 x) {
  return (uint32_t) x;
}

static inline uint64_t fptoui_f16_i64(f16 x) {
  return (uint64_t) x;
}

static inline bool ftob_f16_bool(f16 x) {
  return x != (f16)0;
}

static inline f16 btof_bool_f16(bool x) {
  return x ? 1 : 0;
}

#ifndef EMULATE_F16
static inline bool futrts_isnan16(f16 x) {
  return isnan((float)x);
}

#ifdef __OPENCL_VERSION__

static inline f16 fabs16(f16 x) {
  return fabs(x);
}

static inline f16 fmax16(f16 x, f16 y) {
  return fmax(x, y);
}

static inline f16 fmin16(f16 x, f16 y) {
  return fmin(x, y);
}

static inline f16 fpow16(f16 x, f16 y) {
  return pow(x, y);
}

#elif ISPC
static inline f16 fabs16(f16 x) {
  return abs(x);
}

static inline f16 fmax16(f16 x, f16 y) {
  return futrts_isnan16(x) ? y : futrts_isnan16(y) ? x : max(x, y);
}

static inline f16 fmin16(f16 x, f16 y) {
  return futrts_isnan16(x) ? y : futrts_isnan16(y) ? x : min(x, y);
}

static inline f16 fpow16(f16 x, f16 y) {
  return pow(x, y);
}
#else // Assuming CUDA.

static inline f16 fabs16(f16 x) {
  return fabsf(x);
}

static inline f16 fmax16(f16 x, f16 y) {
  return fmaxf(x, y);
}

static inline f16 fmin16(f16 x, f16 y) {
  return fminf(x, y);
}

static inline f16 fpow16(f16 x, f16 y) {
  return powf(x, y);
}
#endif

#if ISPC
static inline bool futrts_isinf16(float x) {
  return !futrts_isnan16(x) && futrts_isnan16(x - x);
}
static inline bool futrts_isfinite16(float x) {
  return !futrts_isnan16(x) && !futrts_isinf16(x);
}

#else

static inline bool futrts_isinf16(f16 x) {
  return isinf((float)x);
}
#endif

#ifdef __OPENCL_VERSION__
static inline f16 futrts_log16(f16 x) {
  return log(x);
}

static inline f16 futrts_log2_16(f16 x) {
  return log2(x);
}

static inline f16 futrts_log10_16(f16 x) {
  return log10(x);
}

static inline f16 futrts_sqrt16(f16 x) {
  return sqrt(x);
}

static inline f16 futrts_cbrt16(f16 x) {
  return cbrt(x);
}

static inline f16 futrts_exp16(f16 x) {
  return exp(x);
}

static inline f16 futrts_cos16(f16 x) {
  return cos(x);
}

static inline f16 futrts_sin16(f16 x) {
  return sin(x);
}

static inline f16 futrts_tan16(f16 x) {
  return tan(x);
}

static inline f16 futrts_acos16(f16 x) {
  return acos(x);
}

static inline f16 futrts_asin16(f16 x) {
  return asin(x);
}

static inline f16 futrts_atan16(f16 x) {
  return atan(x);
}

static inline f16 futrts_cosh16(f16 x) {
  return cosh(x);
}

static inline f16 futrts_sinh16(f16 x) {
  return sinh(x);
}

static inline f16 futrts_tanh16(f16 x) {
  return tanh(x);
}

static inline f16 futrts_acosh16(f16 x) {
  return acosh(x);
}

static inline f16 futrts_asinh16(f16 x) {
  return asinh(x);
}

static inline f16 futrts_atanh16(f16 x) {
  return atanh(x);
}

static inline f16 futrts_atan2_16(f16 x, f16 y) {
  return atan2(x, y);
}

static inline f16 futrts_hypot16(f16 x, f16 y) {
  return hypot(x, y);
}

static inline f16 futrts_gamma16(f16 x) {
  return tgamma(x);
}

static inline f16 futrts_lgamma16(f16 x) {
  return lgamma(x);
}

static inline f16 futrts_erf16(f16 x) {
  return erf(x);
}

static inline f16 futrts_erfc16(f16 x) {
  return erfc(x);
}

static inline f16 fmod16(f16 x, f16 y) {
  return fmod(x, y);
}

static inline f16 futrts_round16(f16 x) {
  return rint(x);
}

static inline f16 futrts_floor16(f16 x) {
  return floor(x);
}

static inline f16 futrts_ceil16(f16 x) {
  return ceil(x);
}

static inline f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {
  return mix(v0, v1, t);
}

static inline f16 futrts_mad16(f16 a, f16 b, f16 c) {
  return mad(a, b, c);
}

static inline f16 futrts_fma16(f16 a, f16 b, f16 c) {
  return fma(a, b, c);
}
#elif ISPC

static inline f16 futrts_log16(f16 x) {
  return futrts_isfinite16(x) || (futrts_isinf16(x) && x < 0) ? log(x) : x;
}

static inline f16 futrts_log2_16(f16 x) {
  return futrts_log16(x) / log(2.0f16);
}

static inline f16 futrts_log10_16(f16 x) {
  return futrts_log16(x) / log(10.0f16);
}

static inline f16 futrts_sqrt16(f16 x) {
  return (float16)sqrt((float)x);
}

static inline f16 futrts_exp16(f16 x) {
  return exp(x);
}

static inline f16 futrts_cos16(f16 x) {
  return (float16)cos((float)x);
}

static inline f16 futrts_sin16(f16 x) {
  return (float16)sin((float)x);
}

static inline f16 futrts_tan16(f16 x) {
  return (float16)tan((float)x);
}

static inline f16 futrts_acos16(f16 x) {
  return (float16)acos((float)x);
}

static inline f16 futrts_asin16(f16 x) {
  return (float16)asin((float)x);
}

static inline f16 futrts_atan16(f16 x) {
  return (float16)atan((float)x);
}

static inline f16 futrts_cosh16(f16 x) {
  return (exp(x)+exp(-x)) / 2.0f16;
}

static inline f16 futrts_sinh16(f16 x) {
  return (exp(x)-exp(-x)) / 2.0f16;
}

static inline f16 futrts_tanh16(f16 x) {
  return futrts_sinh16(x)/futrts_cosh16(x);
}

static inline f16 futrts_acosh16(f16 x) {
  float16 f = x+(float16)sqrt((float)(x*x-1));
  if(futrts_isfinite16(f)) return log(f);
  return f;
}

static inline f16 futrts_asinh16(f16 x) {
  float16 f = x+(float16)sqrt((float)(x*x+1));
  if(futrts_isfinite16(f)) return log(f);
  return f;
}

static inline f16 futrts_atanh16(f16 x) {
  float16 f = (1+x)/(1-x);
  if(futrts_isfinite16(f)) return log(f)/2.0f16;
  return f;
}

static inline f16 futrts_atan2_16(f16 x, f16 y) {
  return (float16)atan2((float)x, (float)y);
}

static inline f16 futrts_hypot16(f16 x, f16 y) {
  return (float16)futrts_hypot32((float)x, (float)y);
}

extern "C" unmasked uniform float tgammaf(uniform float x);
static inline f16 futrts_gamma16(f16 x) {
  f16 res;
  foreach_active (i) {
    uniform f16 r = (f16)tgammaf(extract((float)x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform float lgammaf(uniform float x);
static inline f16 futrts_lgamma16(f16 x) {
  f16 res;
  foreach_active (i) {
    uniform f16 r = (f16)lgammaf(extract((float)x, i));
    res = insert(res, i, r);
  }
  return res;
}

static inline f16 futrts_cbrt16(f16 x) {
  f16 res = (f16)futrts_cbrt32((float)x);
  return res;
}

static inline f16 futrts_erf16(f16 x) {
  f16 res = (f16)futrts_erf32((float)x);
  return res;
}

static inline f16 futrts_erfc16(f16 x) {
  f16 res = (f16)futrts_erfc32((float)x);
  return res;
}

static inline f16 fmod16(f16 x, f16 y) {
  return x - y * (float16)trunc((float) (x/y));
}

static inline f16 futrts_round16(f16 x) {
  return (float16)round((float)x);
}

static inline f16 futrts_floor16(f16 x) {
  return (float16)floor((float)x);
}

static inline f16 futrts_ceil16(f16 x) {
  return (float16)ceil((float)x);
}

static inline f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {
  return v0 + (v1 - v0) * t;
}

static inline f16 futrts_mad16(f16 a, f16 b, f16 c) {
  return a * b + c;
}

static inline f16 futrts_fma16(f16 a, f16 b, f16 c) {
  return a * b + c;
}

#else // Assume CUDA.

static inline f16 futrts_log16(f16 x) {
  return hlog(x);
}

static inline f16 futrts_log2_16(f16 x) {
  return hlog2(x);
}

static inline f16 futrts_log10_16(f16 x) {
  return hlog10(x);
}

static inline f16 futrts_sqrt16(f16 x) {
  return hsqrt(x);
}

static inline f16 futrts_cbrt16(f16 x) {
  return cbrtf(x);
}

static inline f16 futrts_exp16(f16 x) {
  return hexp(x);
}

static inline f16 futrts_cos16(f16 x) {
  return hcos(x);
}

static inline f16 futrts_sin16(f16 x) {
  return hsin(x);
}

static inline f16 futrts_tan16(f16 x) {
  return tanf(x);
}

static inline f16 futrts_acos16(f16 x) {
  return acosf(x);
}

static inline f16 futrts_asin16(f16 x) {
  return asinf(x);
}

static inline f16 futrts_atan16(f16 x) {
  return atanf(x);
}

static inline f16 futrts_cosh16(f16 x) {
  return coshf(x);
}

static inline f16 futrts_sinh16(f16 x) {
  return sinhf(x);
}

static inline f16 futrts_tanh16(f16 x) {
  return tanhf(x);
}

static inline f16 futrts_acosh16(f16 x) {
  return acoshf(x);
}

static inline f16 futrts_asinh16(f16 x) {
  return asinhf(x);
}

static inline f16 futrts_atanh16(f16 x) {
  return atanhf(x);
}

static inline f16 futrts_atan2_16(f16 x, f16 y) {
  return atan2f(x, y);
}

static inline f16 futrts_hypot16(f16 x, f16 y) {
  return hypotf(x, y);
}

static inline f16 futrts_gamma16(f16 x) {
  return tgammaf(x);
}

static inline f16 futrts_lgamma16(f16 x) {
  return lgammaf(x);
}

static inline f16 futrts_erf16(f16 x) {
  return erff(x);
}

static inline f16 futrts_erfc16(f16 x) {
  return erfcf(x);
}

static inline f16 fmod16(f16 x, f16 y) {
  return fmodf(x, y);
}

static inline f16 futrts_round16(f16 x) {
  return rintf(x);
}

static inline f16 futrts_floor16(f16 x) {
  return hfloor(x);
}

static inline f16 futrts_ceil16(f16 x) {
  return hceil(x);
}

static inline f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {
  return v0 + (v1 - v0) * t;
}

static inline f16 futrts_mad16(f16 a, f16 b, f16 c) {
  return a * b + c;
}

static inline f16 futrts_fma16(f16 a, f16 b, f16 c) {
  return fmaf(a, b, c);
}

#endif

// The CUDA __half type cannot be put in unions for some reason, so we
// use bespoke conversion functions instead.
#ifdef __CUDA_ARCH__
static inline int16_t futrts_to_bits16(f16 x) {
  return __half_as_ushort(x);
}
static inline f16 futrts_from_bits16(int16_t x) {
  return __ushort_as_half(x);
}
#elif ISPC

static inline int16_t futrts_to_bits16(f16 x) {
  varying int16_t y = *((varying int16_t * uniform)&x);
  return y;
}

static inline f16 futrts_from_bits16(int16_t x) {
  varying f16 y = *((varying f16 * uniform)&x);
  return y;
}
#else
static inline int16_t futrts_to_bits16(f16 x) {
  union {
    f16 f;
    int16_t t;
  } p;

  p.f = x;
  return p.t;
}

static inline f16 futrts_from_bits16(int16_t x) {
  union {
    int16_t f;
    f16 t;
  } p;

  p.f = x;
  return p.t;
}
#endif

#else // No native f16 - emulate.

static inline f16 fabs16(f16 x) {
  return fabs32(x);
}

static inline f16 fmax16(f16 x, f16 y) {
  return fmax32(x, y);
}

static inline f16 fmin16(f16 x, f16 y) {
  return fmin32(x, y);
}

static inline f16 fpow16(f16 x, f16 y) {
  return fpow32(x, y);
}

static inline bool futrts_isnan16(f16 x) {
  return futrts_isnan32(x);
}

static inline bool futrts_isinf16(f16 x) {
  return futrts_isinf32(x);
}

static inline f16 futrts_log16(f16 x) {
  return futrts_log32(x);
}

static inline f16 futrts_log2_16(f16 x) {
  return futrts_log2_32(x);
}

static inline f16 futrts_log10_16(f16 x) {
  return futrts_log10_32(x);
}

static inline f16 futrts_sqrt16(f16 x) {
  return futrts_sqrt32(x);
}

static inline f16 futrts_cbrt16(f16 x) {
  return futrts_cbrt32(x);
}

static inline f16 futrts_exp16(f16 x) {
  return futrts_exp32(x);
}

static inline f16 futrts_cos16(f16 x) {
  return futrts_cos32(x);
}

static inline f16 futrts_sin16(f16 x) {
  return futrts_sin32(x);
}

static inline f16 futrts_tan16(f16 x) {
  return futrts_tan32(x);
}

static inline f16 futrts_acos16(f16 x) {
  return futrts_acos32(x);
}

static inline f16 futrts_asin16(f16 x) {
  return futrts_asin32(x);
}

static inline f16 futrts_atan16(f16 x) {
  return futrts_atan32(x);
}

static inline f16 futrts_cosh16(f16 x) {
  return futrts_cosh32(x);
}

static inline f16 futrts_sinh16(f16 x) {
  return futrts_sinh32(x);
}

static inline f16 futrts_tanh16(f16 x) {
  return futrts_tanh32(x);
}

static inline f16 futrts_acosh16(f16 x) {
  return futrts_acosh32(x);
}

static inline f16 futrts_asinh16(f16 x) {
  return futrts_asinh32(x);
}

static inline f16 futrts_atanh16(f16 x) {
  return futrts_atanh32(x);
}

static inline f16 futrts_atan2_16(f16 x, f16 y) {
  return futrts_atan2_32(x, y);
}

static inline f16 futrts_hypot16(f16 x, f16 y) {
  return futrts_hypot32(x, y);
}

static inline f16 futrts_gamma16(f16 x) {
  return futrts_gamma32(x);
}

static inline f16 futrts_lgamma16(f16 x) {
  return futrts_lgamma32(x);
}

static inline f16 futrts_erf16(f16 x) {
  return futrts_erf32(x);
}

static inline f16 futrts_erfc16(f16 x) {
  return futrts_erfc32(x);
}

static inline f16 fmod16(f16 x, f16 y) {
  return fmod32(x, y);
}

static inline f16 futrts_round16(f16 x) {
  return futrts_round32(x);
}

static inline f16 futrts_floor16(f16 x) {
  return futrts_floor32(x);
}

static inline f16 futrts_ceil16(f16 x) {
  return futrts_ceil32(x);
}

static inline f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {
  return futrts_lerp32(v0, v1, t);
}

static inline f16 futrts_mad16(f16 a, f16 b, f16 c) {
  return futrts_mad32(a, b, c);
}

static inline f16 futrts_fma16(f16 a, f16 b, f16 c) {
  return futrts_fma32(a, b, c);
}

// Even when we are using an OpenCL that does not support cl_khr_fp16,
// it must still support vload_half for actually creating a
// half-precision number, which can then be efficiently converted to a
// float.  Similarly for vstore_half.
#ifdef __OPENCL_VERSION__

static inline int16_t futrts_to_bits16(f16 x) {
  int16_t y;
  // Violating strict aliasing here.
  vstore_half((float)x, 0, (half*)&y);
  return y;
}

static inline f16 futrts_from_bits16(int16_t x) {
  return (f16)vload_half(0, (half*)&x);
}

#else

static inline int16_t futrts_to_bits16(f16 x) {
  return (int16_t)float2halfbits(x);
}

static inline f16 futrts_from_bits16(int16_t x) {
  return halfbits2float((uint16_t)x);
}

static inline f16 fsignum16(f16 x) {
  return futrts_isnan16(x) ? x : (x > 0 ? 1 : 0) - (x < 0 ? 1 : 0);
}

#endif

#endif

static inline float fpconv_f16_f16(f16 x) {
  return x;
}

static inline float fpconv_f16_f32(f16 x) {
  return x;
}

static inline f16 fpconv_f32_f16(float x) {
  return (f16) x;
}

#ifdef FUTHARK_F64_ENABLED

static inline double fpconv_f16_f64(f16 x) {
  return (double) x;
}

#if ISPC
static inline f16 fpconv_f64_f16(double x) {
  return (f16) ((float)x);
}
#else
static inline f16 fpconv_f64_f16(double x) {
  return (f16) x;
}
#endif
#endif


// End of scalar_f16.h.

// Start of context_prototypes.h
//
// Prototypes for the functions in prototypes.h that need to be
// available very early.

struct futhark_context_config;
struct futhark_context;

static void set_error(struct futhark_context* ctx, char *error);

// End of of context_prototypes.h

static int init_constants(struct futhark_context *);
static int free_constants(struct futhark_context *);
struct memblock {
    int *references;
    unsigned char *mem;
    int64_t size;
    const char *desc;
};
struct futhark_context_config {
    int debugging;
    int in_use;
    const char *cache_fname;
};
struct futhark_context_config *futhark_context_config_new(void)
{
    struct futhark_context_config *cfg =
                                  (struct futhark_context_config *) malloc(sizeof(struct futhark_context_config));
    
    if (cfg == NULL)
        return NULL;
    cfg->in_use = 0;
    cfg->debugging = 0;
    cfg->cache_fname = NULL;
    return cfg;
}
void futhark_context_config_free(struct futhark_context_config *cfg)
{
    assert(!cfg->in_use);
    free(cfg);
}
void futhark_context_config_set_debugging(struct futhark_context_config *cfg,
                                          int detail)
{
    cfg->debugging = detail;
}
void futhark_context_config_set_profiling(struct futhark_context_config *cfg,
                                          int flag)
{
    (void) cfg;
    (void) flag;
}
void futhark_context_config_set_logging(struct futhark_context_config *cfg,
                                        int detail)
{
    // Does nothing for this backend.
    (void) cfg;
    (void) detail;
}
struct futhark_context {
    struct futhark_context_config *cfg;
    int detail_memory;
    int debugging;
    int profiling;
    int logging;
    lock_t lock;
    char *error;
    lock_t error_lock;
    FILE *log;
    int profiling_paused;
    int64_t peak_mem_usage_default;
    int64_t cur_mem_usage_default;
    struct {
        struct memblock mem_95769;
        struct memblock mem_95781;
        struct memblock mem_95783;
        struct memblock mem_95785;
        struct memblock mem_95787;
        struct memblock mem_95789;
        struct memblock mem_95841;
        struct memblock mem_95853;
        struct memblock mem_95855;
        struct memblock mem_95857;
        struct memblock mem_95859;
        struct memblock mem_95861;
        struct memblock mem_95863;
        struct memblock mem_95925;
        struct memblock mem_95927;
        struct memblock mem_95949;
        struct memblock mem_95951;
        struct memblock mem_95953;
        struct memblock mem_95985;
        struct memblock mem_95997;
        struct memblock mem_95999;
        struct memblock mem_96001;
        struct memblock mem_96033;
        struct memblock mem_96045;
        struct memblock mem_96047;
        struct memblock mem_96069;
        struct memblock mem_96081;
        double zp_res_61110;
        struct memblock mem_96093;
        struct memblock mem_96095;
        struct memblock mem_96097;
        struct memblock mem_96099;
        struct memblock mem_96101;
        struct memblock mem_96103;
        struct memblock mem_96105;
        struct memblock mem_96107;
        struct memblock mem_96109;
        struct memblock mem_96111;
        struct memblock mem_96113;
        struct memblock mem_96115;
        struct memblock mem_96117;
        struct memblock mem_96119;
        struct memblock mem_96121;
        struct memblock mem_96123;
        struct memblock mem_96125;
    } constants;
};
struct futhark_context *futhark_context_new(struct futhark_context_config *cfg)
{
    assert(!cfg->in_use);
    
    struct futhark_context *ctx =
                           (struct futhark_context *) malloc(sizeof(struct futhark_context));
    
    if (ctx == NULL)
        return NULL;
    ctx->cfg = cfg;
    ctx->cfg->in_use = 1;
    ctx->detail_memory = cfg->debugging;
    ctx->debugging = cfg->debugging;
    ctx->profiling = cfg->debugging;
    ctx->logging = cfg->debugging;
    ctx->error = NULL;
    create_lock(&ctx->error_lock);
    ctx->log = stderr;
    create_lock(&ctx->lock);
    ctx->peak_mem_usage_default = 0;
    ctx->cur_mem_usage_default = 0;
    init_constants(ctx);
    return ctx;
}
void futhark_context_free(struct futhark_context *ctx)
{
    free_constants(ctx);
    free_lock(&ctx->lock);
    ctx->cfg->in_use = 0;
    free(ctx);
}
int futhark_context_sync(struct futhark_context *ctx)
{
    (void) ctx;
    return 0;
}
static const char *tuning_param_names[0];
static const char *tuning_param_vars[0];
static const char *tuning_param_classes[0];
int futhark_context_config_set_tuning_param(struct futhark_context_config *cfg,
                                            const char *param_name,
                                            size_t param_value)
{
    (void) cfg;
    (void) param_name;
    (void) param_value;
    return 1;
}
int memblock_unref(struct futhark_context *ctx, struct memblock *block, const
                   char *desc)
{
    if (block->references != NULL) {
        *block->references -= 1;
        if (ctx->detail_memory)
            fprintf(ctx->log,
                    "Unreferencing block %s (allocated as %s) in %s: %d references remaining.\n",
                    desc, block->desc, "default space", *block->references);
        if (*block->references == 0) {
            ctx->cur_mem_usage_default -= block->size;
            free(block->mem);
            free(block->references);
            if (ctx->detail_memory)
                fprintf(ctx->log,
                        "%lld bytes freed (now allocated: %lld bytes)\n",
                        (long long) block->size,
                        (long long) ctx->cur_mem_usage_default);
        }
        block->references = NULL;
    }
    return 0;
}
int memblock_alloc(struct futhark_context *ctx, struct memblock *block,
                   int64_t size, const char *desc)
{
    if (size < 0)
        futhark_panic(1,
                      "Negative allocation of %lld bytes attempted for %s in %s.\n",
                      (long long) size, desc, "default space",
                      ctx->cur_mem_usage_default);
    
    int ret = memblock_unref(ctx, block, desc);
    
    if (ret != FUTHARK_SUCCESS)
        return ret;
    if (ctx->detail_memory)
        fprintf(ctx->log,
                "Allocating %lld bytes for %s in %s (then allocated: %lld bytes)",
                (long long) size, desc, "default space",
                (long long) ctx->cur_mem_usage_default + size);
    if (ctx->cur_mem_usage_default > ctx->peak_mem_usage_default) {
        ctx->peak_mem_usage_default = ctx->cur_mem_usage_default;
        if (ctx->detail_memory)
            fprintf(ctx->log, " (new peak).\n");
    } else if (ctx->detail_memory)
        fprintf(ctx->log, ".\n");
    block->mem = (unsigned char *) malloc((size_t) size);
    if (ctx->error == NULL) {
        block->references = (int *) malloc(sizeof(int));
        *block->references = 1;
        block->size = size;
        block->desc = desc;
        ctx->cur_mem_usage_default += size;
        return FUTHARK_SUCCESS;
    } else {
        // We are naively assuming that any memory allocation error is due to OOM.
        lock_lock(&ctx->error_lock);
        
        char *old_error = ctx->error;
        
        ctx->error =
            msgprintf("Failed to allocate memory in %s.\nAttempted allocation: %12lld bytes\nCurrently allocated:  %12lld bytes\n%s",
                      "default space", (long long) size,
                      (long long) ctx->cur_mem_usage_default, old_error);
        free(old_error);
        lock_unlock(&ctx->error_lock);
        return FUTHARK_OUT_OF_MEMORY;
    }
}
int memblock_set(struct futhark_context *ctx, struct memblock *lhs,
                 struct memblock *rhs, const char *lhs_desc)
{
    int ret = memblock_unref(ctx, lhs, lhs_desc);
    
    if (rhs->references != NULL)
        (*rhs->references)++;
    *lhs = *rhs;
    return ret;
}
void futhark_context_config_set_cache_file(struct futhark_context_config *cfg,
                                           const char *f)
{
    cfg->cache_fname = f;
}
int futhark_get_tuning_param_count(void)
{
    return sizeof(tuning_param_names) / sizeof(tuning_param_names[0]);
}
const char *futhark_get_tuning_param_name(int i)
{
    return tuning_param_names[i];
}
const char *futhark_get_tuning_param_class(int i)
{
    return tuning_param_classes[i];
}
char *futhark_context_report(struct futhark_context *ctx)
{
    if (futhark_context_sync(ctx) != 0)
        return NULL;
    
    struct str_builder builder;
    
    str_builder_init(&builder);
    { }
    if (ctx->profiling) { }
    return builder.str;
}
char *futhark_context_get_error(struct futhark_context *ctx)
{
    char *error = ctx->error;
    
    ctx->error = NULL;
    return error;
}
void futhark_context_set_logging_file(struct futhark_context *ctx, FILE *f)
{
    ctx->log = f;
}
void futhark_context_pause_profiling(struct futhark_context *ctx)
{
    ctx->profiling_paused = 1;
}
void futhark_context_unpause_profiling(struct futhark_context *ctx)
{
    ctx->profiling_paused = 0;
}
int futhark_context_clear_caches(struct futhark_context *ctx)
{
    lock_lock(&ctx->lock);
    ctx->peak_mem_usage_default = 0;
    lock_unlock(&ctx->lock);
    return ctx->error != NULL;
}

// Start of context.h

// Eventually it would be nice to move the context definition in here
// instead of generating it in the compiler.  For now it defines
// various helper functions that must be available.

// Internal functions.

static void set_error(struct futhark_context* ctx, char *error) {
  lock_lock(&ctx->error_lock);
  if (ctx->error == NULL) {
    ctx->error = error;
  } else {
    free(error);
  }
  lock_unlock(&ctx->error_lock);
}

// XXX: should be static, but used in ispc_util.h
void lexical_realloc_error(struct futhark_context* ctx, size_t new_size) {
  set_error(ctx,
            msgprintf("Failed to allocate memory.\nAttempted allocation: %12lld bytes\n",
                      (long long) new_size));
}

static int lexical_realloc(struct futhark_context *ctx,
                           unsigned char **ptr,
                           int64_t *old_size,
                           int64_t new_size) {
  unsigned char *new = realloc(*ptr, (size_t)new_size);
  if (new == NULL) {
    lexical_realloc_error(ctx, new_size);
    return FUTHARK_OUT_OF_MEMORY;
  } else {
    *ptr = new;
    *old_size = new_size;
    return FUTHARK_SUCCESS;
  }
}

// End of context.h

static int futrts_entry_diffusion_sample(struct futhark_context *ctx,
                                         struct memblock *mem_out_p_114731,
                                         struct memblock beta_mem_96126,
                                         struct memblock alpha_mem_96127,
                                         struct memblock alpha_bar_mem_96128,
                                         int64_t dz2082U_51162,
                                         int64_t num_imgs_51163,
                                         int32_t x_seed_51167,
                                         int32_t eps_seed_51168,
                                         int64_t denoise_steps_51169);
static int futrts_entry_diffusion_train(struct futhark_context *ctx,
                                        struct memblock *mem_out_p_114811,
                                        int64_t *out_prim_out_114812,
                                        struct memblock images_mem_96126,
                                        struct memblock alpha_bar_mem_96127,
                                        struct memblock time_seeds_mem_96128,
                                        struct memblock noise_seeds_mem_96129,
                                        int64_t l_49204, int64_t m_49205,
                                        int64_t n_49206, int64_t dz2080U_49207,
                                        int64_t epochs_49210);

static int init_constants(struct futhark_context *ctx)
{
    (void) ctx;
    
    int err = 0;
    
    #define mem_95769 (ctx->constants.mem_95769)
    #define mem_95781 (ctx->constants.mem_95781)
    #define mem_95783 (ctx->constants.mem_95783)
    #define mem_95785 (ctx->constants.mem_95785)
    #define mem_95787 (ctx->constants.mem_95787)
    #define mem_95789 (ctx->constants.mem_95789)
    #define mem_95841 (ctx->constants.mem_95841)
    #define mem_95853 (ctx->constants.mem_95853)
    #define mem_95855 (ctx->constants.mem_95855)
    #define mem_95857 (ctx->constants.mem_95857)
    #define mem_95859 (ctx->constants.mem_95859)
    #define mem_95861 (ctx->constants.mem_95861)
    #define mem_95863 (ctx->constants.mem_95863)
    #define mem_95925 (ctx->constants.mem_95925)
    #define mem_95927 (ctx->constants.mem_95927)
    #define mem_95949 (ctx->constants.mem_95949)
    #define mem_95951 (ctx->constants.mem_95951)
    #define mem_95953 (ctx->constants.mem_95953)
    #define mem_95985 (ctx->constants.mem_95985)
    #define mem_95997 (ctx->constants.mem_95997)
    #define mem_95999 (ctx->constants.mem_95999)
    #define mem_96001 (ctx->constants.mem_96001)
    #define mem_96033 (ctx->constants.mem_96033)
    #define mem_96045 (ctx->constants.mem_96045)
    #define mem_96047 (ctx->constants.mem_96047)
    #define mem_96069 (ctx->constants.mem_96069)
    #define mem_96081 (ctx->constants.mem_96081)
    #define zp_res_61110 (ctx->constants.zp_res_61110)
    #define mem_96093 (ctx->constants.mem_96093)
    #define mem_96095 (ctx->constants.mem_96095)
    #define mem_96097 (ctx->constants.mem_96097)
    #define mem_96099 (ctx->constants.mem_96099)
    #define mem_96101 (ctx->constants.mem_96101)
    #define mem_96103 (ctx->constants.mem_96103)
    #define mem_96105 (ctx->constants.mem_96105)
    #define mem_96107 (ctx->constants.mem_96107)
    #define mem_96109 (ctx->constants.mem_96109)
    #define mem_96111 (ctx->constants.mem_96111)
    #define mem_96113 (ctx->constants.mem_96113)
    #define mem_96115 (ctx->constants.mem_96115)
    #define mem_96117 (ctx->constants.mem_96117)
    #define mem_96119 (ctx->constants.mem_96119)
    #define mem_96121 (ctx->constants.mem_96121)
    #define mem_96123 (ctx->constants.mem_96123)
    #define mem_96125 (ctx->constants.mem_96125)
    
    struct memblock mem_95627;
    
    mem_95627.references = NULL;
    
    struct memblock mem_95625;
    
    mem_95625.references = NULL;
    
    struct memblock mem_95623;
    
    mem_95623.references = NULL;
    
    struct memblock mem_95621;
    
    mem_95621.references = NULL;
    
    struct memblock mem_95619;
    
    mem_95619.references = NULL;
    
    struct memblock mem_95617;
    
    mem_95617.references = NULL;
    
    struct memblock mem_95615;
    
    mem_95615.references = NULL;
    
    struct memblock mem_95613;
    
    mem_95613.references = NULL;
    
    struct memblock mem_95611;
    
    mem_95611.references = NULL;
    
    struct memblock mem_95609;
    
    mem_95609.references = NULL;
    
    struct memblock mem_95607;
    
    mem_95607.references = NULL;
    
    struct memblock mem_95605;
    
    mem_95605.references = NULL;
    
    struct memblock mem_95603;
    
    mem_95603.references = NULL;
    
    struct memblock mem_95601;
    
    mem_95601.references = NULL;
    
    struct memblock mem_95559;
    
    mem_95559.references = NULL;
    
    struct memblock mem_95557;
    
    mem_95557.references = NULL;
    
    struct memblock mem_95555;
    
    mem_95555.references = NULL;
    
    struct memblock mem_95553;
    
    mem_95553.references = NULL;
    
    struct memblock mem_95541;
    
    mem_95541.references = NULL;
    mem_95769.references = NULL;
    mem_95781.references = NULL;
    mem_95783.references = NULL;
    mem_95785.references = NULL;
    mem_95787.references = NULL;
    mem_95789.references = NULL;
    mem_95841.references = NULL;
    mem_95853.references = NULL;
    mem_95855.references = NULL;
    mem_95857.references = NULL;
    mem_95859.references = NULL;
    mem_95861.references = NULL;
    mem_95863.references = NULL;
    mem_95925.references = NULL;
    mem_95927.references = NULL;
    mem_95949.references = NULL;
    mem_95951.references = NULL;
    mem_95953.references = NULL;
    mem_95985.references = NULL;
    mem_95997.references = NULL;
    mem_95999.references = NULL;
    mem_96001.references = NULL;
    mem_96033.references = NULL;
    mem_96045.references = NULL;
    mem_96047.references = NULL;
    mem_96069.references = NULL;
    mem_96081.references = NULL;
    mem_96093.references = NULL;
    mem_96095.references = NULL;
    mem_96097.references = NULL;
    mem_96099.references = NULL;
    mem_96101.references = NULL;
    mem_96103.references = NULL;
    mem_96105.references = NULL;
    mem_96107.references = NULL;
    mem_96109.references = NULL;
    mem_96111.references = NULL;
    mem_96113.references = NULL;
    mem_96115.references = NULL;
    mem_96117.references = NULL;
    mem_96119.references = NULL;
    mem_96121.references = NULL;
    mem_96123.references = NULL;
    mem_96125.references = NULL;
    if (memblock_alloc(ctx, &mem_95541, (int64_t) 24, "mem_95541")) {
        err = 1;
        goto cleanup;
    }
    for (int32_t i_86715 = 0; i_86715 < 6; i_86715++) {
        int64_t i_84550 = sext_i32_i64(i_86715);
        int32_t x_67017 = lshr32(i_86715, 16);
        int32_t x_67018 = x_67017 ^ i_86715;
        int32_t x_67019 = mul32(73244475, x_67018);
        int32_t x_67020 = lshr32(x_67019, 16);
        int32_t x_67021 = x_67019 ^ x_67020;
        int32_t x_67022 = mul32(73244475, x_67021);
        int32_t x_67023 = lshr32(x_67022, 16);
        int32_t x_67024 = x_67022 ^ x_67023;
        int32_t unsign_arg_67025 = 1384350791 ^ x_67024;
        int32_t unsign_arg_67027 = mul32(48271, unsign_arg_67025);
        int32_t unsign_arg_67028 = umod32(unsign_arg_67027, 2147483647);
        bool zgze_res_67029 = ule32(2147000000, unsign_arg_67028);
        bool defunc_0_f_res_f_res_67030;
        int32_t defunc_0_f_res_f_res_67031;
        int32_t defunc_0_f_res_f_res_67032;
        bool loop_while_67033;
        int32_t rng_67034;
        int32_t x_67035;
        
        loop_while_67033 = zgze_res_67029;
        rng_67034 = unsign_arg_67028;
        x_67035 = unsign_arg_67028;
        while (loop_while_67033) {
            int32_t unsign_arg_67036 = mul32(48271, rng_67034);
            int32_t unsign_arg_67037 = umod32(unsign_arg_67036, 2147483647);
            bool zgze_res_67038 = ule32(2147000000, unsign_arg_67037);
            bool loop_while_tmp_114582 = zgze_res_67038;
            int32_t rng_tmp_114583 = unsign_arg_67037;
            int32_t x_tmp_114584 = unsign_arg_67037;
            
            loop_while_67033 = loop_while_tmp_114582;
            rng_67034 = rng_tmp_114583;
            x_67035 = x_tmp_114584;
        }
        defunc_0_f_res_f_res_67030 = loop_while_67033;
        defunc_0_f_res_f_res_67031 = rng_67034;
        defunc_0_f_res_f_res_67032 = x_67035;
        
        int32_t unsign_arg_67039 = umod32(defunc_0_f_res_f_res_67032, 1000000);
        int64_t to_i64_res_67040 = zext_i32_i64(unsign_arg_67039);
        int32_t defunc_0_f_res_67042 = sext_i64_i32(to_i64_res_67040);
        
        ((int32_t *) mem_95541.mem)[i_84550] = defunc_0_f_res_67042;
    }
    
    int32_t mk_conv_wandb_arg_51229 = ((int32_t *) mem_95541.mem)[(int64_t) 0];
    int32_t unsign_arg_60886 = 5460 ^ mk_conv_wandb_arg_51229;
    int32_t unsign_arg_60887 = mul32(48271, unsign_arg_60886);
    int32_t unsign_arg_60888 = umod32(unsign_arg_60887, 2147483647);
    int32_t unsign_arg_60889 = mul32(48271, unsign_arg_60888);
    int32_t unsign_arg_60890 = umod32(unsign_arg_60889, 2147483647);
    int32_t mk_conv_wandb_arg_51260 = ((int32_t *) mem_95541.mem)[(int64_t) 5];
    int32_t unsign_arg_61001 = 5460 ^ mk_conv_wandb_arg_51260;
    int32_t unsign_arg_61002 = mul32(48271, unsign_arg_61001);
    int32_t unsign_arg_61003 = umod32(unsign_arg_61002, 2147483647);
    int32_t unsign_arg_61004 = mul32(48271, unsign_arg_61003);
    int32_t unsign_arg_61005 = umod32(unsign_arg_61004, 2147483647);
    int32_t mk_block_wandb_arg_51253 = ((int32_t *) mem_95541.mem)[(int64_t) 4];
    int32_t unsign_arg_65165 = 5460 ^ mk_block_wandb_arg_51253;
    int32_t unsign_arg_65166 = mul32(48271, unsign_arg_65165);
    int32_t unsign_arg_65167 = umod32(unsign_arg_65166, 2147483647);
    int32_t unsign_arg_65168 = mul32(48271, unsign_arg_65167);
    int32_t unsign_arg_65169 = umod32(unsign_arg_65168, 2147483647);
    int32_t mk_block_wandb_arg_51246 = ((int32_t *) mem_95541.mem)[(int64_t) 3];
    int32_t unsign_arg_64785 = 5460 ^ mk_block_wandb_arg_51246;
    int32_t unsign_arg_64786 = mul32(48271, unsign_arg_64785);
    int32_t unsign_arg_64787 = umod32(unsign_arg_64786, 2147483647);
    int32_t unsign_arg_64788 = mul32(48271, unsign_arg_64787);
    int32_t unsign_arg_64789 = umod32(unsign_arg_64788, 2147483647);
    int32_t mk_block_wandb_arg_51239 = ((int32_t *) mem_95541.mem)[(int64_t) 2];
    int32_t unsign_arg_64405 = 5460 ^ mk_block_wandb_arg_51239;
    int32_t unsign_arg_64406 = mul32(48271, unsign_arg_64405);
    int32_t unsign_arg_64407 = umod32(unsign_arg_64406, 2147483647);
    int32_t unsign_arg_64408 = mul32(48271, unsign_arg_64407);
    int32_t unsign_arg_64409 = umod32(unsign_arg_64408, 2147483647);
    int32_t mk_block_wandb_arg_51232 = ((int32_t *) mem_95541.mem)[(int64_t) 1];
    
    if (memblock_unref(ctx, &mem_95541, "mem_95541") != 0)
        return 1;
    
    int32_t unsign_arg_64025 = 5460 ^ mk_block_wandb_arg_51232;
    int32_t unsign_arg_64026 = mul32(48271, unsign_arg_64025);
    int32_t unsign_arg_64027 = umod32(unsign_arg_64026, 2147483647);
    int32_t unsign_arg_64028 = mul32(48271, unsign_arg_64027);
    int32_t unsign_arg_64029 = umod32(unsign_arg_64028, 2147483647);
    
    if (memblock_alloc(ctx, &mem_95553, (int64_t) 12, "mem_95553")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_95555, (int64_t) 12, "mem_95555")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_95557, (int64_t) 12, "mem_95557")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_95559, (int64_t) 12, "mem_95559")) {
        err = 1;
        goto cleanup;
    }
    for (int32_t i_86716 = 0; i_86716 < 3; i_86716++) {
        int64_t i_84560 = sext_i32_i64(i_86716);
        int32_t x_70938 = lshr32(i_86716, 16);
        int32_t x_70939 = x_70938 ^ i_86716;
        int32_t x_70940 = mul32(73244475, x_70939);
        int32_t x_70941 = lshr32(x_70940, 16);
        int32_t x_70942 = x_70940 ^ x_70941;
        int32_t x_70943 = mul32(73244475, x_70942);
        int32_t x_70944 = lshr32(x_70943, 16);
        int32_t x_70945 = x_70943 ^ x_70944;
        int32_t unsign_arg_70946 = unsign_arg_64029 ^ x_70945;
        int32_t unsign_arg_70948 = mul32(48271, unsign_arg_70946);
        int32_t unsign_arg_70949 = umod32(unsign_arg_70948, 2147483647);
        bool zgze_res_70950 = ule32(2147000000, unsign_arg_70949);
        bool defunc_0_f_res_f_res_70951;
        int32_t defunc_0_f_res_f_res_70952;
        int32_t defunc_0_f_res_f_res_70953;
        bool loop_while_70954;
        int32_t rng_70955;
        int32_t x_70956;
        
        loop_while_70954 = zgze_res_70950;
        rng_70955 = unsign_arg_70949;
        x_70956 = unsign_arg_70949;
        while (loop_while_70954) {
            int32_t unsign_arg_70957 = mul32(48271, rng_70955);
            int32_t unsign_arg_70958 = umod32(unsign_arg_70957, 2147483647);
            bool zgze_res_70959 = ule32(2147000000, unsign_arg_70958);
            bool loop_while_tmp_114589 = zgze_res_70959;
            int32_t rng_tmp_114590 = unsign_arg_70958;
            int32_t x_tmp_114591 = unsign_arg_70958;
            
            loop_while_70954 = loop_while_tmp_114589;
            rng_70955 = rng_tmp_114590;
            x_70956 = x_tmp_114591;
        }
        defunc_0_f_res_f_res_70951 = loop_while_70954;
        defunc_0_f_res_f_res_70952 = rng_70955;
        defunc_0_f_res_f_res_70953 = x_70956;
        
        int32_t unsign_arg_70960 = umod32(defunc_0_f_res_f_res_70953, 1000000);
        int64_t to_i64_res_70961 = zext_i32_i64(unsign_arg_70960);
        int32_t defunc_0_f_res_70963 = sext_i64_i32(to_i64_res_70961);
        int32_t unsign_arg_70974 = unsign_arg_64409 ^ x_70945;
        int32_t unsign_arg_70976 = mul32(48271, unsign_arg_70974);
        int32_t unsign_arg_70977 = umod32(unsign_arg_70976, 2147483647);
        bool zgze_res_70978 = ule32(2147000000, unsign_arg_70977);
        bool defunc_0_f_res_f_res_70979;
        int32_t defunc_0_f_res_f_res_70980;
        int32_t defunc_0_f_res_f_res_70981;
        bool loop_while_70982;
        int32_t rng_70983;
        int32_t x_70984;
        
        loop_while_70982 = zgze_res_70978;
        rng_70983 = unsign_arg_70977;
        x_70984 = unsign_arg_70977;
        while (loop_while_70982) {
            int32_t unsign_arg_70985 = mul32(48271, rng_70983);
            int32_t unsign_arg_70986 = umod32(unsign_arg_70985, 2147483647);
            bool zgze_res_70987 = ule32(2147000000, unsign_arg_70986);
            bool loop_while_tmp_114592 = zgze_res_70987;
            int32_t rng_tmp_114593 = unsign_arg_70986;
            int32_t x_tmp_114594 = unsign_arg_70986;
            
            loop_while_70982 = loop_while_tmp_114592;
            rng_70983 = rng_tmp_114593;
            x_70984 = x_tmp_114594;
        }
        defunc_0_f_res_f_res_70979 = loop_while_70982;
        defunc_0_f_res_f_res_70980 = rng_70983;
        defunc_0_f_res_f_res_70981 = x_70984;
        
        int32_t unsign_arg_70988 = umod32(defunc_0_f_res_f_res_70981, 1000000);
        int64_t to_i64_res_70989 = zext_i32_i64(unsign_arg_70988);
        int32_t defunc_0_f_res_70991 = sext_i64_i32(to_i64_res_70989);
        int32_t unsign_arg_71003 = unsign_arg_64789 ^ x_70945;
        int32_t unsign_arg_71005 = mul32(48271, unsign_arg_71003);
        int32_t unsign_arg_71006 = umod32(unsign_arg_71005, 2147483647);
        bool zgze_res_71007 = ule32(2147000000, unsign_arg_71006);
        bool defunc_0_f_res_f_res_71008;
        int32_t defunc_0_f_res_f_res_71009;
        int32_t defunc_0_f_res_f_res_71010;
        bool loop_while_71011;
        int32_t rng_71012;
        int32_t x_71013;
        
        loop_while_71011 = zgze_res_71007;
        rng_71012 = unsign_arg_71006;
        x_71013 = unsign_arg_71006;
        while (loop_while_71011) {
            int32_t unsign_arg_71014 = mul32(48271, rng_71012);
            int32_t unsign_arg_71015 = umod32(unsign_arg_71014, 2147483647);
            bool zgze_res_71016 = ule32(2147000000, unsign_arg_71015);
            bool loop_while_tmp_114595 = zgze_res_71016;
            int32_t rng_tmp_114596 = unsign_arg_71015;
            int32_t x_tmp_114597 = unsign_arg_71015;
            
            loop_while_71011 = loop_while_tmp_114595;
            rng_71012 = rng_tmp_114596;
            x_71013 = x_tmp_114597;
        }
        defunc_0_f_res_f_res_71008 = loop_while_71011;
        defunc_0_f_res_f_res_71009 = rng_71012;
        defunc_0_f_res_f_res_71010 = x_71013;
        
        int32_t unsign_arg_71017 = umod32(defunc_0_f_res_f_res_71010, 1000000);
        int64_t to_i64_res_71018 = zext_i32_i64(unsign_arg_71017);
        int32_t defunc_0_f_res_71020 = sext_i64_i32(to_i64_res_71018);
        int32_t unsign_arg_71033 = unsign_arg_65169 ^ x_70945;
        int32_t unsign_arg_71035 = mul32(48271, unsign_arg_71033);
        int32_t unsign_arg_71036 = umod32(unsign_arg_71035, 2147483647);
        bool zgze_res_71037 = ule32(2147000000, unsign_arg_71036);
        bool defunc_0_f_res_f_res_71038;
        int32_t defunc_0_f_res_f_res_71039;
        int32_t defunc_0_f_res_f_res_71040;
        bool loop_while_71041;
        int32_t rng_71042;
        int32_t x_71043;
        
        loop_while_71041 = zgze_res_71037;
        rng_71042 = unsign_arg_71036;
        x_71043 = unsign_arg_71036;
        while (loop_while_71041) {
            int32_t unsign_arg_71044 = mul32(48271, rng_71042);
            int32_t unsign_arg_71045 = umod32(unsign_arg_71044, 2147483647);
            bool zgze_res_71046 = ule32(2147000000, unsign_arg_71045);
            bool loop_while_tmp_114598 = zgze_res_71046;
            int32_t rng_tmp_114599 = unsign_arg_71045;
            int32_t x_tmp_114600 = unsign_arg_71045;
            
            loop_while_71041 = loop_while_tmp_114598;
            rng_71042 = rng_tmp_114599;
            x_71043 = x_tmp_114600;
        }
        defunc_0_f_res_f_res_71038 = loop_while_71041;
        defunc_0_f_res_f_res_71039 = rng_71042;
        defunc_0_f_res_f_res_71040 = x_71043;
        
        int32_t unsign_arg_71047 = umod32(defunc_0_f_res_f_res_71040, 1000000);
        int64_t to_i64_res_71048 = zext_i32_i64(unsign_arg_71047);
        int32_t defunc_0_f_res_71050 = sext_i64_i32(to_i64_res_71048);
        
        ((int32_t *) mem_95553.mem)[i_84560] = defunc_0_f_res_71050;
        ((int32_t *) mem_95555.mem)[i_84560] = defunc_0_f_res_71020;
        ((int32_t *) mem_95557.mem)[i_84560] = defunc_0_f_res_70991;
        ((int32_t *) mem_95559.mem)[i_84560] = defunc_0_f_res_70963;
    }
    
    int32_t mk_conv_wandb_arg_65423 = ((int32_t *) mem_95553.mem)[(int64_t) 2];
    int32_t unsign_arg_65424 = 5460 ^ mk_conv_wandb_arg_65423;
    int32_t unsign_arg_65425 = mul32(48271, unsign_arg_65424);
    int32_t unsign_arg_65426 = umod32(unsign_arg_65425, 2147483647);
    int32_t unsign_arg_65427 = mul32(48271, unsign_arg_65426);
    int32_t unsign_arg_65428 = umod32(unsign_arg_65427, 2147483647);
    int32_t mk_dense_wandb_arg_65316 = ((int32_t *) mem_95553.mem)[(int64_t) 1];
    int32_t unsign_arg_65317 = 5460 ^ mk_dense_wandb_arg_65316;
    int32_t unsign_arg_65318 = mul32(48271, unsign_arg_65317);
    int32_t unsign_arg_65319 = umod32(unsign_arg_65318, 2147483647);
    int32_t unsign_arg_65320 = mul32(48271, unsign_arg_65319);
    int32_t unsign_arg_65321 = umod32(unsign_arg_65320, 2147483647);
    int32_t mk_conv_wandb_arg_65205 = ((int32_t *) mem_95553.mem)[(int64_t) 0];
    
    if (memblock_unref(ctx, &mem_95553, "mem_95553") != 0)
        return 1;
    
    int32_t unsign_arg_65206 = 5460 ^ mk_conv_wandb_arg_65205;
    int32_t unsign_arg_65207 = mul32(48271, unsign_arg_65206);
    int32_t unsign_arg_65208 = umod32(unsign_arg_65207, 2147483647);
    int32_t unsign_arg_65209 = mul32(48271, unsign_arg_65208);
    int32_t unsign_arg_65210 = umod32(unsign_arg_65209, 2147483647);
    int32_t mk_conv_wandb_arg_65043 = ((int32_t *) mem_95555.mem)[(int64_t) 2];
    int32_t unsign_arg_65044 = 5460 ^ mk_conv_wandb_arg_65043;
    int32_t unsign_arg_65045 = mul32(48271, unsign_arg_65044);
    int32_t unsign_arg_65046 = umod32(unsign_arg_65045, 2147483647);
    int32_t unsign_arg_65047 = mul32(48271, unsign_arg_65046);
    int32_t unsign_arg_65048 = umod32(unsign_arg_65047, 2147483647);
    int32_t mk_dense_wandb_arg_64936 = ((int32_t *) mem_95555.mem)[(int64_t) 1];
    int32_t unsign_arg_64937 = 5460 ^ mk_dense_wandb_arg_64936;
    int32_t unsign_arg_64938 = mul32(48271, unsign_arg_64937);
    int32_t unsign_arg_64939 = umod32(unsign_arg_64938, 2147483647);
    int32_t unsign_arg_64940 = mul32(48271, unsign_arg_64939);
    int32_t unsign_arg_64941 = umod32(unsign_arg_64940, 2147483647);
    int32_t mk_conv_wandb_arg_64825 = ((int32_t *) mem_95555.mem)[(int64_t) 0];
    
    if (memblock_unref(ctx, &mem_95555, "mem_95555") != 0)
        return 1;
    
    int32_t unsign_arg_64826 = 5460 ^ mk_conv_wandb_arg_64825;
    int32_t unsign_arg_64827 = mul32(48271, unsign_arg_64826);
    int32_t unsign_arg_64828 = umod32(unsign_arg_64827, 2147483647);
    int32_t unsign_arg_64829 = mul32(48271, unsign_arg_64828);
    int32_t unsign_arg_64830 = umod32(unsign_arg_64829, 2147483647);
    int32_t mk_conv_wandb_arg_64663 = ((int32_t *) mem_95557.mem)[(int64_t) 2];
    int32_t unsign_arg_64664 = 5460 ^ mk_conv_wandb_arg_64663;
    int32_t unsign_arg_64665 = mul32(48271, unsign_arg_64664);
    int32_t unsign_arg_64666 = umod32(unsign_arg_64665, 2147483647);
    int32_t unsign_arg_64667 = mul32(48271, unsign_arg_64666);
    int32_t unsign_arg_64668 = umod32(unsign_arg_64667, 2147483647);
    int32_t mk_dense_wandb_arg_64556 = ((int32_t *) mem_95557.mem)[(int64_t) 1];
    int32_t unsign_arg_64557 = 5460 ^ mk_dense_wandb_arg_64556;
    int32_t unsign_arg_64558 = mul32(48271, unsign_arg_64557);
    int32_t unsign_arg_64559 = umod32(unsign_arg_64558, 2147483647);
    int32_t unsign_arg_64560 = mul32(48271, unsign_arg_64559);
    int32_t unsign_arg_64561 = umod32(unsign_arg_64560, 2147483647);
    int32_t mk_conv_wandb_arg_64445 = ((int32_t *) mem_95557.mem)[(int64_t) 0];
    
    if (memblock_unref(ctx, &mem_95557, "mem_95557") != 0)
        return 1;
    
    int32_t unsign_arg_64446 = 5460 ^ mk_conv_wandb_arg_64445;
    int32_t unsign_arg_64447 = mul32(48271, unsign_arg_64446);
    int32_t unsign_arg_64448 = umod32(unsign_arg_64447, 2147483647);
    int32_t unsign_arg_64449 = mul32(48271, unsign_arg_64448);
    int32_t unsign_arg_64450 = umod32(unsign_arg_64449, 2147483647);
    int32_t mk_conv_wandb_arg_64283 = ((int32_t *) mem_95559.mem)[(int64_t) 2];
    int32_t unsign_arg_64284 = 5460 ^ mk_conv_wandb_arg_64283;
    int32_t unsign_arg_64285 = mul32(48271, unsign_arg_64284);
    int32_t unsign_arg_64286 = umod32(unsign_arg_64285, 2147483647);
    int32_t unsign_arg_64287 = mul32(48271, unsign_arg_64286);
    int32_t unsign_arg_64288 = umod32(unsign_arg_64287, 2147483647);
    int32_t mk_dense_wandb_arg_64176 = ((int32_t *) mem_95559.mem)[(int64_t) 1];
    int32_t unsign_arg_64177 = 5460 ^ mk_dense_wandb_arg_64176;
    int32_t unsign_arg_64178 = mul32(48271, unsign_arg_64177);
    int32_t unsign_arg_64179 = umod32(unsign_arg_64178, 2147483647);
    int32_t unsign_arg_64180 = mul32(48271, unsign_arg_64179);
    int32_t unsign_arg_64181 = umod32(unsign_arg_64180, 2147483647);
    int32_t mk_conv_wandb_arg_64065 = ((int32_t *) mem_95559.mem)[(int64_t) 0];
    
    if (memblock_unref(ctx, &mem_95559, "mem_95559") != 0)
        return 1;
    
    int32_t unsign_arg_64066 = 5460 ^ mk_conv_wandb_arg_64065;
    int32_t unsign_arg_64067 = mul32(48271, unsign_arg_64066);
    int32_t unsign_arg_64068 = umod32(unsign_arg_64067, 2147483647);
    int32_t unsign_arg_64069 = mul32(48271, unsign_arg_64068);
    int32_t unsign_arg_64070 = umod32(unsign_arg_64069, 2147483647);
    
    if (memblock_alloc(ctx, &mem_95601, (int64_t) 8, "mem_95601")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_95603, (int64_t) 8, "mem_95603")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_95605, (int64_t) 8, "mem_95605")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_95607, (int64_t) 8, "mem_95607")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_95609, (int64_t) 8, "mem_95609")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_95611, (int64_t) 8, "mem_95611")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_95613, (int64_t) 8, "mem_95613")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_95615, (int64_t) 8, "mem_95615")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_95617, (int64_t) 8, "mem_95617")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_95619, (int64_t) 8, "mem_95619")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_95621, (int64_t) 8, "mem_95621")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_95623, (int64_t) 8, "mem_95623")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_95625, (int64_t) 8, "mem_95625")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_95627, (int64_t) 8, "mem_95627")) {
        err = 1;
        goto cleanup;
    }
    for (int32_t i_86717 = 0; i_86717 < 2; i_86717++) {
        int64_t i_84593 = sext_i32_i64(i_86717);
        int32_t x_70033 = lshr32(i_86717, 16);
        int32_t x_70034 = x_70033 ^ i_86717;
        int32_t x_70035 = mul32(73244475, x_70034);
        int32_t x_70036 = lshr32(x_70035, 16);
        int32_t x_70037 = x_70035 ^ x_70036;
        int32_t x_70038 = mul32(73244475, x_70037);
        int32_t x_70039 = lshr32(x_70038, 16);
        int32_t x_70040 = x_70038 ^ x_70039;
        int32_t unsign_arg_70041 = unsign_arg_60890 ^ x_70040;
        int32_t unsign_arg_70043 = mul32(48271, unsign_arg_70041);
        int32_t unsign_arg_70044 = umod32(unsign_arg_70043, 2147483647);
        bool zgze_res_70045 = ule32(2147000000, unsign_arg_70044);
        bool defunc_0_f_res_f_res_70046;
        int32_t defunc_0_f_res_f_res_70047;
        int32_t defunc_0_f_res_f_res_70048;
        bool loop_while_70049;
        int32_t rng_70050;
        int32_t x_70051;
        
        loop_while_70049 = zgze_res_70045;
        rng_70050 = unsign_arg_70044;
        x_70051 = unsign_arg_70044;
        while (loop_while_70049) {
            int32_t unsign_arg_70052 = mul32(48271, rng_70050);
            int32_t unsign_arg_70053 = umod32(unsign_arg_70052, 2147483647);
            bool zgze_res_70054 = ule32(2147000000, unsign_arg_70053);
            bool loop_while_tmp_114615 = zgze_res_70054;
            int32_t rng_tmp_114616 = unsign_arg_70053;
            int32_t x_tmp_114617 = unsign_arg_70053;
            
            loop_while_70049 = loop_while_tmp_114615;
            rng_70050 = rng_tmp_114616;
            x_70051 = x_tmp_114617;
        }
        defunc_0_f_res_f_res_70046 = loop_while_70049;
        defunc_0_f_res_f_res_70047 = rng_70050;
        defunc_0_f_res_f_res_70048 = x_70051;
        
        int32_t unsign_arg_70055 = umod32(defunc_0_f_res_f_res_70048, 1000000);
        int64_t to_i64_res_70056 = zext_i32_i64(unsign_arg_70055);
        int32_t defunc_0_f_res_70058 = sext_i64_i32(to_i64_res_70056);
        int32_t unsign_arg_70069 = unsign_arg_64070 ^ x_70040;
        int32_t unsign_arg_70071 = mul32(48271, unsign_arg_70069);
        int32_t unsign_arg_70072 = umod32(unsign_arg_70071, 2147483647);
        bool zgze_res_70073 = ule32(2147000000, unsign_arg_70072);
        bool defunc_0_f_res_f_res_70074;
        int32_t defunc_0_f_res_f_res_70075;
        int32_t defunc_0_f_res_f_res_70076;
        bool loop_while_70077;
        int32_t rng_70078;
        int32_t x_70079;
        
        loop_while_70077 = zgze_res_70073;
        rng_70078 = unsign_arg_70072;
        x_70079 = unsign_arg_70072;
        while (loop_while_70077) {
            int32_t unsign_arg_70080 = mul32(48271, rng_70078);
            int32_t unsign_arg_70081 = umod32(unsign_arg_70080, 2147483647);
            bool zgze_res_70082 = ule32(2147000000, unsign_arg_70081);
            bool loop_while_tmp_114618 = zgze_res_70082;
            int32_t rng_tmp_114619 = unsign_arg_70081;
            int32_t x_tmp_114620 = unsign_arg_70081;
            
            loop_while_70077 = loop_while_tmp_114618;
            rng_70078 = rng_tmp_114619;
            x_70079 = x_tmp_114620;
        }
        defunc_0_f_res_f_res_70074 = loop_while_70077;
        defunc_0_f_res_f_res_70075 = rng_70078;
        defunc_0_f_res_f_res_70076 = x_70079;
        
        int32_t unsign_arg_70083 = umod32(defunc_0_f_res_f_res_70076, 1000000);
        int64_t to_i64_res_70084 = zext_i32_i64(unsign_arg_70083);
        int32_t defunc_0_f_res_70086 = sext_i64_i32(to_i64_res_70084);
        int32_t unsign_arg_70098 = unsign_arg_64181 ^ x_70040;
        int32_t unsign_arg_70100 = mul32(48271, unsign_arg_70098);
        int32_t unsign_arg_70101 = umod32(unsign_arg_70100, 2147483647);
        bool zgze_res_70102 = ule32(2147000000, unsign_arg_70101);
        bool defunc_0_f_res_f_res_70103;
        int32_t defunc_0_f_res_f_res_70104;
        int32_t defunc_0_f_res_f_res_70105;
        bool loop_while_70106;
        int32_t rng_70107;
        int32_t x_70108;
        
        loop_while_70106 = zgze_res_70102;
        rng_70107 = unsign_arg_70101;
        x_70108 = unsign_arg_70101;
        while (loop_while_70106) {
            int32_t unsign_arg_70109 = mul32(48271, rng_70107);
            int32_t unsign_arg_70110 = umod32(unsign_arg_70109, 2147483647);
            bool zgze_res_70111 = ule32(2147000000, unsign_arg_70110);
            bool loop_while_tmp_114621 = zgze_res_70111;
            int32_t rng_tmp_114622 = unsign_arg_70110;
            int32_t x_tmp_114623 = unsign_arg_70110;
            
            loop_while_70106 = loop_while_tmp_114621;
            rng_70107 = rng_tmp_114622;
            x_70108 = x_tmp_114623;
        }
        defunc_0_f_res_f_res_70103 = loop_while_70106;
        defunc_0_f_res_f_res_70104 = rng_70107;
        defunc_0_f_res_f_res_70105 = x_70108;
        
        int32_t unsign_arg_70112 = umod32(defunc_0_f_res_f_res_70105, 1000000);
        int64_t to_i64_res_70113 = zext_i32_i64(unsign_arg_70112);
        int32_t defunc_0_f_res_70115 = sext_i64_i32(to_i64_res_70113);
        int32_t unsign_arg_70128 = unsign_arg_64288 ^ x_70040;
        int32_t unsign_arg_70130 = mul32(48271, unsign_arg_70128);
        int32_t unsign_arg_70131 = umod32(unsign_arg_70130, 2147483647);
        bool zgze_res_70132 = ule32(2147000000, unsign_arg_70131);
        bool defunc_0_f_res_f_res_70133;
        int32_t defunc_0_f_res_f_res_70134;
        int32_t defunc_0_f_res_f_res_70135;
        bool loop_while_70136;
        int32_t rng_70137;
        int32_t x_70138;
        
        loop_while_70136 = zgze_res_70132;
        rng_70137 = unsign_arg_70131;
        x_70138 = unsign_arg_70131;
        while (loop_while_70136) {
            int32_t unsign_arg_70139 = mul32(48271, rng_70137);
            int32_t unsign_arg_70140 = umod32(unsign_arg_70139, 2147483647);
            bool zgze_res_70141 = ule32(2147000000, unsign_arg_70140);
            bool loop_while_tmp_114624 = zgze_res_70141;
            int32_t rng_tmp_114625 = unsign_arg_70140;
            int32_t x_tmp_114626 = unsign_arg_70140;
            
            loop_while_70136 = loop_while_tmp_114624;
            rng_70137 = rng_tmp_114625;
            x_70138 = x_tmp_114626;
        }
        defunc_0_f_res_f_res_70133 = loop_while_70136;
        defunc_0_f_res_f_res_70134 = rng_70137;
        defunc_0_f_res_f_res_70135 = x_70138;
        
        int32_t unsign_arg_70142 = umod32(defunc_0_f_res_f_res_70135, 1000000);
        int64_t to_i64_res_70143 = zext_i32_i64(unsign_arg_70142);
        int32_t defunc_0_f_res_70145 = sext_i64_i32(to_i64_res_70143);
        int32_t unsign_arg_70159 = unsign_arg_64450 ^ x_70040;
        int32_t unsign_arg_70161 = mul32(48271, unsign_arg_70159);
        int32_t unsign_arg_70162 = umod32(unsign_arg_70161, 2147483647);
        bool zgze_res_70163 = ule32(2147000000, unsign_arg_70162);
        bool defunc_0_f_res_f_res_70164;
        int32_t defunc_0_f_res_f_res_70165;
        int32_t defunc_0_f_res_f_res_70166;
        bool loop_while_70167;
        int32_t rng_70168;
        int32_t x_70169;
        
        loop_while_70167 = zgze_res_70163;
        rng_70168 = unsign_arg_70162;
        x_70169 = unsign_arg_70162;
        while (loop_while_70167) {
            int32_t unsign_arg_70170 = mul32(48271, rng_70168);
            int32_t unsign_arg_70171 = umod32(unsign_arg_70170, 2147483647);
            bool zgze_res_70172 = ule32(2147000000, unsign_arg_70171);
            bool loop_while_tmp_114627 = zgze_res_70172;
            int32_t rng_tmp_114628 = unsign_arg_70171;
            int32_t x_tmp_114629 = unsign_arg_70171;
            
            loop_while_70167 = loop_while_tmp_114627;
            rng_70168 = rng_tmp_114628;
            x_70169 = x_tmp_114629;
        }
        defunc_0_f_res_f_res_70164 = loop_while_70167;
        defunc_0_f_res_f_res_70165 = rng_70168;
        defunc_0_f_res_f_res_70166 = x_70169;
        
        int32_t unsign_arg_70173 = umod32(defunc_0_f_res_f_res_70166, 1000000);
        int64_t to_i64_res_70174 = zext_i32_i64(unsign_arg_70173);
        int32_t defunc_0_f_res_70176 = sext_i64_i32(to_i64_res_70174);
        int32_t unsign_arg_70191 = unsign_arg_64561 ^ x_70040;
        int32_t unsign_arg_70193 = mul32(48271, unsign_arg_70191);
        int32_t unsign_arg_70194 = umod32(unsign_arg_70193, 2147483647);
        bool zgze_res_70195 = ule32(2147000000, unsign_arg_70194);
        bool defunc_0_f_res_f_res_70196;
        int32_t defunc_0_f_res_f_res_70197;
        int32_t defunc_0_f_res_f_res_70198;
        bool loop_while_70199;
        int32_t rng_70200;
        int32_t x_70201;
        
        loop_while_70199 = zgze_res_70195;
        rng_70200 = unsign_arg_70194;
        x_70201 = unsign_arg_70194;
        while (loop_while_70199) {
            int32_t unsign_arg_70202 = mul32(48271, rng_70200);
            int32_t unsign_arg_70203 = umod32(unsign_arg_70202, 2147483647);
            bool zgze_res_70204 = ule32(2147000000, unsign_arg_70203);
            bool loop_while_tmp_114630 = zgze_res_70204;
            int32_t rng_tmp_114631 = unsign_arg_70203;
            int32_t x_tmp_114632 = unsign_arg_70203;
            
            loop_while_70199 = loop_while_tmp_114630;
            rng_70200 = rng_tmp_114631;
            x_70201 = x_tmp_114632;
        }
        defunc_0_f_res_f_res_70196 = loop_while_70199;
        defunc_0_f_res_f_res_70197 = rng_70200;
        defunc_0_f_res_f_res_70198 = x_70201;
        
        int32_t unsign_arg_70205 = umod32(defunc_0_f_res_f_res_70198, 1000000);
        int64_t to_i64_res_70206 = zext_i32_i64(unsign_arg_70205);
        int32_t defunc_0_f_res_70208 = sext_i64_i32(to_i64_res_70206);
        int32_t unsign_arg_70224 = unsign_arg_64668 ^ x_70040;
        int32_t unsign_arg_70226 = mul32(48271, unsign_arg_70224);
        int32_t unsign_arg_70227 = umod32(unsign_arg_70226, 2147483647);
        bool zgze_res_70228 = ule32(2147000000, unsign_arg_70227);
        bool defunc_0_f_res_f_res_70229;
        int32_t defunc_0_f_res_f_res_70230;
        int32_t defunc_0_f_res_f_res_70231;
        bool loop_while_70232;
        int32_t rng_70233;
        int32_t x_70234;
        
        loop_while_70232 = zgze_res_70228;
        rng_70233 = unsign_arg_70227;
        x_70234 = unsign_arg_70227;
        while (loop_while_70232) {
            int32_t unsign_arg_70235 = mul32(48271, rng_70233);
            int32_t unsign_arg_70236 = umod32(unsign_arg_70235, 2147483647);
            bool zgze_res_70237 = ule32(2147000000, unsign_arg_70236);
            bool loop_while_tmp_114633 = zgze_res_70237;
            int32_t rng_tmp_114634 = unsign_arg_70236;
            int32_t x_tmp_114635 = unsign_arg_70236;
            
            loop_while_70232 = loop_while_tmp_114633;
            rng_70233 = rng_tmp_114634;
            x_70234 = x_tmp_114635;
        }
        defunc_0_f_res_f_res_70229 = loop_while_70232;
        defunc_0_f_res_f_res_70230 = rng_70233;
        defunc_0_f_res_f_res_70231 = x_70234;
        
        int32_t unsign_arg_70238 = umod32(defunc_0_f_res_f_res_70231, 1000000);
        int64_t to_i64_res_70239 = zext_i32_i64(unsign_arg_70238);
        int32_t defunc_0_f_res_70241 = sext_i64_i32(to_i64_res_70239);
        int32_t unsign_arg_70258 = unsign_arg_64830 ^ x_70040;
        int32_t unsign_arg_70260 = mul32(48271, unsign_arg_70258);
        int32_t unsign_arg_70261 = umod32(unsign_arg_70260, 2147483647);
        bool zgze_res_70262 = ule32(2147000000, unsign_arg_70261);
        bool defunc_0_f_res_f_res_70263;
        int32_t defunc_0_f_res_f_res_70264;
        int32_t defunc_0_f_res_f_res_70265;
        bool loop_while_70266;
        int32_t rng_70267;
        int32_t x_70268;
        
        loop_while_70266 = zgze_res_70262;
        rng_70267 = unsign_arg_70261;
        x_70268 = unsign_arg_70261;
        while (loop_while_70266) {
            int32_t unsign_arg_70269 = mul32(48271, rng_70267);
            int32_t unsign_arg_70270 = umod32(unsign_arg_70269, 2147483647);
            bool zgze_res_70271 = ule32(2147000000, unsign_arg_70270);
            bool loop_while_tmp_114636 = zgze_res_70271;
            int32_t rng_tmp_114637 = unsign_arg_70270;
            int32_t x_tmp_114638 = unsign_arg_70270;
            
            loop_while_70266 = loop_while_tmp_114636;
            rng_70267 = rng_tmp_114637;
            x_70268 = x_tmp_114638;
        }
        defunc_0_f_res_f_res_70263 = loop_while_70266;
        defunc_0_f_res_f_res_70264 = rng_70267;
        defunc_0_f_res_f_res_70265 = x_70268;
        
        int32_t unsign_arg_70272 = umod32(defunc_0_f_res_f_res_70265, 1000000);
        int64_t to_i64_res_70273 = zext_i32_i64(unsign_arg_70272);
        int32_t defunc_0_f_res_70275 = sext_i64_i32(to_i64_res_70273);
        int32_t unsign_arg_70293 = unsign_arg_64941 ^ x_70040;
        int32_t unsign_arg_70295 = mul32(48271, unsign_arg_70293);
        int32_t unsign_arg_70296 = umod32(unsign_arg_70295, 2147483647);
        bool zgze_res_70297 = ule32(2147000000, unsign_arg_70296);
        bool defunc_0_f_res_f_res_70298;
        int32_t defunc_0_f_res_f_res_70299;
        int32_t defunc_0_f_res_f_res_70300;
        bool loop_while_70301;
        int32_t rng_70302;
        int32_t x_70303;
        
        loop_while_70301 = zgze_res_70297;
        rng_70302 = unsign_arg_70296;
        x_70303 = unsign_arg_70296;
        while (loop_while_70301) {
            int32_t unsign_arg_70304 = mul32(48271, rng_70302);
            int32_t unsign_arg_70305 = umod32(unsign_arg_70304, 2147483647);
            bool zgze_res_70306 = ule32(2147000000, unsign_arg_70305);
            bool loop_while_tmp_114639 = zgze_res_70306;
            int32_t rng_tmp_114640 = unsign_arg_70305;
            int32_t x_tmp_114641 = unsign_arg_70305;
            
            loop_while_70301 = loop_while_tmp_114639;
            rng_70302 = rng_tmp_114640;
            x_70303 = x_tmp_114641;
        }
        defunc_0_f_res_f_res_70298 = loop_while_70301;
        defunc_0_f_res_f_res_70299 = rng_70302;
        defunc_0_f_res_f_res_70300 = x_70303;
        
        int32_t unsign_arg_70307 = umod32(defunc_0_f_res_f_res_70300, 1000000);
        int64_t to_i64_res_70308 = zext_i32_i64(unsign_arg_70307);
        int32_t defunc_0_f_res_70310 = sext_i64_i32(to_i64_res_70308);
        int32_t unsign_arg_70329 = unsign_arg_65048 ^ x_70040;
        int32_t unsign_arg_70331 = mul32(48271, unsign_arg_70329);
        int32_t unsign_arg_70332 = umod32(unsign_arg_70331, 2147483647);
        bool zgze_res_70333 = ule32(2147000000, unsign_arg_70332);
        bool defunc_0_f_res_f_res_70334;
        int32_t defunc_0_f_res_f_res_70335;
        int32_t defunc_0_f_res_f_res_70336;
        bool loop_while_70337;
        int32_t rng_70338;
        int32_t x_70339;
        
        loop_while_70337 = zgze_res_70333;
        rng_70338 = unsign_arg_70332;
        x_70339 = unsign_arg_70332;
        while (loop_while_70337) {
            int32_t unsign_arg_70340 = mul32(48271, rng_70338);
            int32_t unsign_arg_70341 = umod32(unsign_arg_70340, 2147483647);
            bool zgze_res_70342 = ule32(2147000000, unsign_arg_70341);
            bool loop_while_tmp_114642 = zgze_res_70342;
            int32_t rng_tmp_114643 = unsign_arg_70341;
            int32_t x_tmp_114644 = unsign_arg_70341;
            
            loop_while_70337 = loop_while_tmp_114642;
            rng_70338 = rng_tmp_114643;
            x_70339 = x_tmp_114644;
        }
        defunc_0_f_res_f_res_70334 = loop_while_70337;
        defunc_0_f_res_f_res_70335 = rng_70338;
        defunc_0_f_res_f_res_70336 = x_70339;
        
        int32_t unsign_arg_70343 = umod32(defunc_0_f_res_f_res_70336, 1000000);
        int64_t to_i64_res_70344 = zext_i32_i64(unsign_arg_70343);
        int32_t defunc_0_f_res_70346 = sext_i64_i32(to_i64_res_70344);
        int32_t unsign_arg_70366 = unsign_arg_65210 ^ x_70040;
        int32_t unsign_arg_70368 = mul32(48271, unsign_arg_70366);
        int32_t unsign_arg_70369 = umod32(unsign_arg_70368, 2147483647);
        bool zgze_res_70370 = ule32(2147000000, unsign_arg_70369);
        bool defunc_0_f_res_f_res_70371;
        int32_t defunc_0_f_res_f_res_70372;
        int32_t defunc_0_f_res_f_res_70373;
        bool loop_while_70374;
        int32_t rng_70375;
        int32_t x_70376;
        
        loop_while_70374 = zgze_res_70370;
        rng_70375 = unsign_arg_70369;
        x_70376 = unsign_arg_70369;
        while (loop_while_70374) {
            int32_t unsign_arg_70377 = mul32(48271, rng_70375);
            int32_t unsign_arg_70378 = umod32(unsign_arg_70377, 2147483647);
            bool zgze_res_70379 = ule32(2147000000, unsign_arg_70378);
            bool loop_while_tmp_114645 = zgze_res_70379;
            int32_t rng_tmp_114646 = unsign_arg_70378;
            int32_t x_tmp_114647 = unsign_arg_70378;
            
            loop_while_70374 = loop_while_tmp_114645;
            rng_70375 = rng_tmp_114646;
            x_70376 = x_tmp_114647;
        }
        defunc_0_f_res_f_res_70371 = loop_while_70374;
        defunc_0_f_res_f_res_70372 = rng_70375;
        defunc_0_f_res_f_res_70373 = x_70376;
        
        int32_t unsign_arg_70380 = umod32(defunc_0_f_res_f_res_70373, 1000000);
        int64_t to_i64_res_70381 = zext_i32_i64(unsign_arg_70380);
        int32_t defunc_0_f_res_70383 = sext_i64_i32(to_i64_res_70381);
        int32_t unsign_arg_70404 = unsign_arg_65321 ^ x_70040;
        int32_t unsign_arg_70406 = mul32(48271, unsign_arg_70404);
        int32_t unsign_arg_70407 = umod32(unsign_arg_70406, 2147483647);
        bool zgze_res_70408 = ule32(2147000000, unsign_arg_70407);
        bool defunc_0_f_res_f_res_70409;
        int32_t defunc_0_f_res_f_res_70410;
        int32_t defunc_0_f_res_f_res_70411;
        bool loop_while_70412;
        int32_t rng_70413;
        int32_t x_70414;
        
        loop_while_70412 = zgze_res_70408;
        rng_70413 = unsign_arg_70407;
        x_70414 = unsign_arg_70407;
        while (loop_while_70412) {
            int32_t unsign_arg_70415 = mul32(48271, rng_70413);
            int32_t unsign_arg_70416 = umod32(unsign_arg_70415, 2147483647);
            bool zgze_res_70417 = ule32(2147000000, unsign_arg_70416);
            bool loop_while_tmp_114648 = zgze_res_70417;
            int32_t rng_tmp_114649 = unsign_arg_70416;
            int32_t x_tmp_114650 = unsign_arg_70416;
            
            loop_while_70412 = loop_while_tmp_114648;
            rng_70413 = rng_tmp_114649;
            x_70414 = x_tmp_114650;
        }
        defunc_0_f_res_f_res_70409 = loop_while_70412;
        defunc_0_f_res_f_res_70410 = rng_70413;
        defunc_0_f_res_f_res_70411 = x_70414;
        
        int32_t unsign_arg_70418 = umod32(defunc_0_f_res_f_res_70411, 1000000);
        int64_t to_i64_res_70419 = zext_i32_i64(unsign_arg_70418);
        int32_t defunc_0_f_res_70421 = sext_i64_i32(to_i64_res_70419);
        int32_t unsign_arg_70443 = unsign_arg_65428 ^ x_70040;
        int32_t unsign_arg_70445 = mul32(48271, unsign_arg_70443);
        int32_t unsign_arg_70446 = umod32(unsign_arg_70445, 2147483647);
        bool zgze_res_70447 = ule32(2147000000, unsign_arg_70446);
        bool defunc_0_f_res_f_res_70448;
        int32_t defunc_0_f_res_f_res_70449;
        int32_t defunc_0_f_res_f_res_70450;
        bool loop_while_70451;
        int32_t rng_70452;
        int32_t x_70453;
        
        loop_while_70451 = zgze_res_70447;
        rng_70452 = unsign_arg_70446;
        x_70453 = unsign_arg_70446;
        while (loop_while_70451) {
            int32_t unsign_arg_70454 = mul32(48271, rng_70452);
            int32_t unsign_arg_70455 = umod32(unsign_arg_70454, 2147483647);
            bool zgze_res_70456 = ule32(2147000000, unsign_arg_70455);
            bool loop_while_tmp_114651 = zgze_res_70456;
            int32_t rng_tmp_114652 = unsign_arg_70455;
            int32_t x_tmp_114653 = unsign_arg_70455;
            
            loop_while_70451 = loop_while_tmp_114651;
            rng_70452 = rng_tmp_114652;
            x_70453 = x_tmp_114653;
        }
        defunc_0_f_res_f_res_70448 = loop_while_70451;
        defunc_0_f_res_f_res_70449 = rng_70452;
        defunc_0_f_res_f_res_70450 = x_70453;
        
        int32_t unsign_arg_70457 = umod32(defunc_0_f_res_f_res_70450, 1000000);
        int64_t to_i64_res_70458 = zext_i32_i64(unsign_arg_70457);
        int32_t defunc_0_f_res_70460 = sext_i64_i32(to_i64_res_70458);
        int32_t unsign_arg_70483 = unsign_arg_61005 ^ x_70040;
        int32_t unsign_arg_70485 = mul32(48271, unsign_arg_70483);
        int32_t unsign_arg_70486 = umod32(unsign_arg_70485, 2147483647);
        bool zgze_res_70487 = ule32(2147000000, unsign_arg_70486);
        bool defunc_0_f_res_f_res_70488;
        int32_t defunc_0_f_res_f_res_70489;
        int32_t defunc_0_f_res_f_res_70490;
        bool loop_while_70491;
        int32_t rng_70492;
        int32_t x_70493;
        
        loop_while_70491 = zgze_res_70487;
        rng_70492 = unsign_arg_70486;
        x_70493 = unsign_arg_70486;
        while (loop_while_70491) {
            int32_t unsign_arg_70494 = mul32(48271, rng_70492);
            int32_t unsign_arg_70495 = umod32(unsign_arg_70494, 2147483647);
            bool zgze_res_70496 = ule32(2147000000, unsign_arg_70495);
            bool loop_while_tmp_114654 = zgze_res_70496;
            int32_t rng_tmp_114655 = unsign_arg_70495;
            int32_t x_tmp_114656 = unsign_arg_70495;
            
            loop_while_70491 = loop_while_tmp_114654;
            rng_70492 = rng_tmp_114655;
            x_70493 = x_tmp_114656;
        }
        defunc_0_f_res_f_res_70488 = loop_while_70491;
        defunc_0_f_res_f_res_70489 = rng_70492;
        defunc_0_f_res_f_res_70490 = x_70493;
        
        int32_t unsign_arg_70497 = umod32(defunc_0_f_res_f_res_70490, 1000000);
        int64_t to_i64_res_70498 = zext_i32_i64(unsign_arg_70497);
        int32_t defunc_0_f_res_70500 = sext_i64_i32(to_i64_res_70498);
        
        ((int32_t *) mem_95601.mem)[i_84593] = defunc_0_f_res_70500;
        ((int32_t *) mem_95603.mem)[i_84593] = defunc_0_f_res_70460;
        ((int32_t *) mem_95605.mem)[i_84593] = defunc_0_f_res_70421;
        ((int32_t *) mem_95607.mem)[i_84593] = defunc_0_f_res_70383;
        ((int32_t *) mem_95609.mem)[i_84593] = defunc_0_f_res_70346;
        ((int32_t *) mem_95611.mem)[i_84593] = defunc_0_f_res_70310;
        ((int32_t *) mem_95613.mem)[i_84593] = defunc_0_f_res_70275;
        ((int32_t *) mem_95615.mem)[i_84593] = defunc_0_f_res_70241;
        ((int32_t *) mem_95617.mem)[i_84593] = defunc_0_f_res_70208;
        ((int32_t *) mem_95619.mem)[i_84593] = defunc_0_f_res_70176;
        ((int32_t *) mem_95621.mem)[i_84593] = defunc_0_f_res_70145;
        ((int32_t *) mem_95623.mem)[i_84593] = defunc_0_f_res_70115;
        ((int32_t *) mem_95625.mem)[i_84593] = defunc_0_f_res_70086;
        ((int32_t *) mem_95627.mem)[i_84593] = defunc_0_f_res_70058;
    }
    
    int32_t mk_conv_weights_arg_60926 =
            ((int32_t *) mem_95627.mem)[(int64_t) 0];
    int32_t unsign_arg_60931 = 5460 ^ mk_conv_weights_arg_60926;
    int32_t unsign_arg_60932 = mul32(48271, unsign_arg_60931);
    int32_t unsign_arg_60933 = umod32(unsign_arg_60932, 2147483647);
    int32_t unsign_arg_60937 = mul32(48271, unsign_arg_60933);
    int32_t unsign_arg_60938 = umod32(unsign_arg_60937, 2147483647);
    
    if (memblock_alloc(ctx, &mem_95769, (int64_t) 4608, "mem_95769")) {
        err = 1;
        goto cleanup;
    }
    for (int32_t i_86718 = 0; i_86718 < 576; i_86718++) {
        int64_t i_84610 = sext_i32_i64(i_86718);
        int32_t x_66933 = lshr32(i_86718, 16);
        int32_t x_66934 = x_66933 ^ i_86718;
        int32_t x_66935 = mul32(73244475, x_66934);
        int32_t x_66936 = lshr32(x_66935, 16);
        int32_t x_66937 = x_66935 ^ x_66936;
        int32_t x_66938 = mul32(73244475, x_66937);
        int32_t x_66939 = lshr32(x_66938, 16);
        int32_t x_66940 = x_66938 ^ x_66939;
        int32_t unsign_arg_66941 = unsign_arg_60938 ^ x_66940;
        int32_t unsign_arg_66943 = mul32(48271, unsign_arg_66941);
        int32_t unsign_arg_66944 = umod32(unsign_arg_66943, 2147483647);
        double u64_res_66945 = uitofp_i32_f64(unsign_arg_66944);
        double zs_res_66946 = u64_res_66945 / 2.147483647e9;
        double zt_res_66947 = 0.6666666666666666 * zs_res_66946;
        double zp_res_66948 = -0.3333333333333333 + zt_res_66947;
        
        ((double *) mem_95769.mem)[i_84610] = zp_res_66948;
    }
    
    int32_t mk_conv_biases_arg_60969 = ((int32_t *) mem_95627.mem)[(int64_t) 1];
    
    if (memblock_unref(ctx, &mem_95627, "mem_95627") != 0)
        return 1;
    
    int32_t unsign_arg_60970 = 5460 ^ mk_conv_biases_arg_60969;
    int32_t unsign_arg_60971 = mul32(48271, unsign_arg_60970);
    int32_t unsign_arg_60972 = umod32(unsign_arg_60971, 2147483647);
    int32_t unsign_arg_60973 = mul32(48271, unsign_arg_60972);
    int32_t unsign_arg_60974 = umod32(unsign_arg_60973, 2147483647);
    int32_t mk_conv_weights_arg_61041 =
            ((int32_t *) mem_95601.mem)[(int64_t) 0];
    int32_t unsign_arg_61046 = 5460 ^ mk_conv_weights_arg_61041;
    int32_t unsign_arg_61047 = mul32(48271, unsign_arg_61046);
    int32_t unsign_arg_61048 = umod32(unsign_arg_61047, 2147483647);
    int32_t unsign_arg_61052 = mul32(48271, unsign_arg_61048);
    int32_t unsign_arg_61053 = umod32(unsign_arg_61052, 2147483647);
    int32_t mk_conv_biases_arg_65507 = ((int32_t *) mem_95603.mem)[(int64_t) 1];
    int32_t unsign_arg_65508 = 5460 ^ mk_conv_biases_arg_65507;
    int32_t unsign_arg_65509 = mul32(48271, unsign_arg_65508);
    int32_t unsign_arg_65510 = umod32(unsign_arg_65509, 2147483647);
    int32_t unsign_arg_65511 = mul32(48271, unsign_arg_65510);
    int32_t unsign_arg_65512 = umod32(unsign_arg_65511, 2147483647);
    int32_t mk_dense_biases_arg_65396 =
            ((int32_t *) mem_95605.mem)[(int64_t) 1];
    int32_t unsign_arg_65397 = 5460 ^ mk_dense_biases_arg_65396;
    int32_t unsign_arg_65398 = mul32(48271, unsign_arg_65397);
    int32_t unsign_arg_65399 = umod32(unsign_arg_65398, 2147483647);
    int32_t unsign_arg_65400 = mul32(48271, unsign_arg_65399);
    int32_t unsign_arg_65401 = umod32(unsign_arg_65400, 2147483647);
    int32_t mk_conv_biases_arg_65289 = ((int32_t *) mem_95607.mem)[(int64_t) 1];
    int32_t unsign_arg_65290 = 5460 ^ mk_conv_biases_arg_65289;
    int32_t unsign_arg_65291 = mul32(48271, unsign_arg_65290);
    int32_t unsign_arg_65292 = umod32(unsign_arg_65291, 2147483647);
    int32_t unsign_arg_65293 = mul32(48271, unsign_arg_65292);
    int32_t unsign_arg_65294 = umod32(unsign_arg_65293, 2147483647);
    
    if (memblock_alloc(ctx, &mem_95781, (int64_t) 512, "mem_95781")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_95783, (int64_t) 512, "mem_95783")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_95785, (int64_t) 512, "mem_95785")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_95787, (int64_t) 512, "mem_95787")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_95789, (int64_t) 512, "mem_95789")) {
        err = 1;
        goto cleanup;
    }
    for (int32_t i_86719 = 0; i_86719 < 64; i_86719++) {
        int64_t i_84622 = sext_i32_i64(i_86719);
        int32_t x_70689 = lshr32(i_86719, 16);
        int32_t x_70690 = x_70689 ^ i_86719;
        int32_t x_70691 = mul32(73244475, x_70690);
        int32_t x_70692 = lshr32(x_70691, 16);
        int32_t x_70693 = x_70691 ^ x_70692;
        int32_t x_70694 = mul32(73244475, x_70693);
        int32_t x_70695 = lshr32(x_70694, 16);
        int32_t x_70696 = x_70694 ^ x_70695;
        int32_t unsign_arg_70697 = unsign_arg_60974 ^ x_70696;
        int32_t unsign_arg_70699 = mul32(48271, unsign_arg_70697);
        int32_t unsign_arg_70700 = umod32(unsign_arg_70699, 2147483647);
        double u64_res_70701 = uitofp_i32_f64(unsign_arg_70700);
        double zs_res_70702 = u64_res_70701 / 2.147483647e9;
        double zt_res_70703 = 0.6666666666666666 * zs_res_70702;
        double zp_res_70704 = -0.3333333333333333 + zt_res_70703;
        int32_t unsign_arg_70715 = unsign_arg_65294 ^ x_70696;
        int32_t unsign_arg_70717 = mul32(48271, unsign_arg_70715);
        int32_t unsign_arg_70718 = umod32(unsign_arg_70717, 2147483647);
        double u64_res_70719 = uitofp_i32_f64(unsign_arg_70718);
        double zs_res_70720 = u64_res_70719 / 2.147483647e9;
        double zt_res_70721 = 4.1666666666666664e-2 * zs_res_70720;
        double zp_res_70722 = -2.0833333333333332e-2 + zt_res_70721;
        int32_t unsign_arg_70734 = unsign_arg_65401 ^ x_70696;
        int32_t unsign_arg_70736 = mul32(48271, unsign_arg_70734);
        int32_t unsign_arg_70737 = umod32(unsign_arg_70736, 2147483647);
        double u64_res_70738 = uitofp_i32_f64(unsign_arg_70737);
        double zs_res_70739 = u64_res_70738 / 2.147483647e9;
        double zt_res_70740 = 0.125 * zs_res_70739;
        double zp_res_70741 = -6.25e-2 + zt_res_70740;
        int32_t unsign_arg_70754 = unsign_arg_65512 ^ x_70696;
        int32_t unsign_arg_70756 = mul32(48271, unsign_arg_70754);
        int32_t unsign_arg_70757 = umod32(unsign_arg_70756, 2147483647);
        double u64_res_70758 = uitofp_i32_f64(unsign_arg_70757);
        double zs_res_70759 = u64_res_70758 / 2.147483647e9;
        double zt_res_70760 = 8.333333333333333e-2 * zs_res_70759;
        double zp_res_70761 = -4.1666666666666664e-2 + zt_res_70760;
        int32_t unsign_arg_70775 = unsign_arg_61053 ^ x_70696;
        int32_t unsign_arg_70777 = mul32(48271, unsign_arg_70775);
        int32_t unsign_arg_70778 = umod32(unsign_arg_70777, 2147483647);
        double u64_res_70779 = uitofp_i32_f64(unsign_arg_70778);
        double zs_res_70780 = u64_res_70779 / 2.147483647e9;
        double zt_res_70781 = 0.25 * zs_res_70780;
        double zp_res_70782 = -0.125 + zt_res_70781;
        
        ((double *) mem_95781.mem)[i_84622] = zp_res_70782;
        ((double *) mem_95783.mem)[i_84622] = zp_res_70761;
        ((double *) mem_95785.mem)[i_84622] = zp_res_70741;
        ((double *) mem_95787.mem)[i_84622] = zp_res_70722;
        ((double *) mem_95789.mem)[i_84622] = zp_res_70704;
    }
    
    int32_t mk_conv_weights_arg_64106 =
            ((int32_t *) mem_95625.mem)[(int64_t) 0];
    int32_t unsign_arg_64111 = 5460 ^ mk_conv_weights_arg_64106;
    int32_t unsign_arg_64112 = mul32(48271, unsign_arg_64111);
    int32_t unsign_arg_64113 = umod32(unsign_arg_64112, 2147483647);
    int32_t unsign_arg_64117 = mul32(48271, unsign_arg_64113);
    int32_t unsign_arg_64118 = umod32(unsign_arg_64117, 2147483647);
    
    if (memblock_alloc(ctx, &mem_95841, (int64_t) 589824, "mem_95841")) {
        err = 1;
        goto cleanup;
    }
    for (int32_t i_86720 = 0; i_86720 < 73728; i_86720++) {
        int64_t i_84630 = sext_i32_i64(i_86720);
        int32_t x_66801 = lshr32(i_86720, 16);
        int32_t x_66802 = x_66801 ^ i_86720;
        int32_t x_66803 = mul32(73244475, x_66802);
        int32_t x_66804 = lshr32(x_66803, 16);
        int32_t x_66805 = x_66803 ^ x_66804;
        int32_t x_66806 = mul32(73244475, x_66805);
        int32_t x_66807 = lshr32(x_66806, 16);
        int32_t x_66808 = x_66806 ^ x_66807;
        int32_t unsign_arg_66809 = unsign_arg_64118 ^ x_66808;
        int32_t unsign_arg_66811 = mul32(48271, unsign_arg_66809);
        int32_t unsign_arg_66812 = umod32(unsign_arg_66811, 2147483647);
        double u64_res_66813 = uitofp_i32_f64(unsign_arg_66812);
        double zs_res_66814 = u64_res_66813 / 2.147483647e9;
        double zt_res_66815 = 8.333333333333333e-2 * zs_res_66814;
        double zp_res_66816 = -4.1666666666666664e-2 + zt_res_66815;
        
        ((double *) mem_95841.mem)[i_84630] = zp_res_66816;
    }
    
    int32_t mk_conv_biases_arg_64149 = ((int32_t *) mem_95625.mem)[(int64_t) 1];
    
    if (memblock_unref(ctx, &mem_95625, "mem_95625") != 0)
        return 1;
    
    int32_t unsign_arg_64150 = 5460 ^ mk_conv_biases_arg_64149;
    int32_t unsign_arg_64151 = mul32(48271, unsign_arg_64150);
    int32_t unsign_arg_64152 = umod32(unsign_arg_64151, 2147483647);
    int32_t unsign_arg_64153 = mul32(48271, unsign_arg_64152);
    int32_t unsign_arg_64154 = umod32(unsign_arg_64153, 2147483647);
    int32_t mk_conv_biases_arg_65127 = ((int32_t *) mem_95609.mem)[(int64_t) 1];
    int32_t unsign_arg_65128 = 5460 ^ mk_conv_biases_arg_65127;
    int32_t unsign_arg_65129 = mul32(48271, unsign_arg_65128);
    int32_t unsign_arg_65130 = umod32(unsign_arg_65129, 2147483647);
    int32_t unsign_arg_65131 = mul32(48271, unsign_arg_65130);
    int32_t unsign_arg_65132 = umod32(unsign_arg_65131, 2147483647);
    int32_t mk_dense_biases_arg_65016 =
            ((int32_t *) mem_95611.mem)[(int64_t) 1];
    int32_t unsign_arg_65017 = 5460 ^ mk_dense_biases_arg_65016;
    int32_t unsign_arg_65018 = mul32(48271, unsign_arg_65017);
    int32_t unsign_arg_65019 = umod32(unsign_arg_65018, 2147483647);
    int32_t unsign_arg_65020 = mul32(48271, unsign_arg_65019);
    int32_t unsign_arg_65021 = umod32(unsign_arg_65020, 2147483647);
    int32_t mk_conv_biases_arg_64909 = ((int32_t *) mem_95613.mem)[(int64_t) 1];
    int32_t unsign_arg_64910 = 5460 ^ mk_conv_biases_arg_64909;
    int32_t unsign_arg_64911 = mul32(48271, unsign_arg_64910);
    int32_t unsign_arg_64912 = umod32(unsign_arg_64911, 2147483647);
    int32_t unsign_arg_64913 = mul32(48271, unsign_arg_64912);
    int32_t unsign_arg_64914 = umod32(unsign_arg_64913, 2147483647);
    int32_t mk_conv_biases_arg_64367 = ((int32_t *) mem_95621.mem)[(int64_t) 1];
    int32_t unsign_arg_64368 = 5460 ^ mk_conv_biases_arg_64367;
    int32_t unsign_arg_64369 = mul32(48271, unsign_arg_64368);
    int32_t unsign_arg_64370 = umod32(unsign_arg_64369, 2147483647);
    int32_t unsign_arg_64371 = mul32(48271, unsign_arg_64370);
    int32_t unsign_arg_64372 = umod32(unsign_arg_64371, 2147483647);
    int32_t mk_dense_biases_arg_64256 =
            ((int32_t *) mem_95623.mem)[(int64_t) 1];
    int32_t unsign_arg_64257 = 5460 ^ mk_dense_biases_arg_64256;
    int32_t unsign_arg_64258 = mul32(48271, unsign_arg_64257);
    int32_t unsign_arg_64259 = umod32(unsign_arg_64258, 2147483647);
    int32_t unsign_arg_64260 = mul32(48271, unsign_arg_64259);
    int32_t unsign_arg_64261 = umod32(unsign_arg_64260, 2147483647);
    
    if (memblock_alloc(ctx, &mem_95853, (int64_t) 1024, "mem_95853")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_95855, (int64_t) 1024, "mem_95855")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_95857, (int64_t) 1024, "mem_95857")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_95859, (int64_t) 1024, "mem_95859")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_95861, (int64_t) 1024, "mem_95861")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_95863, (int64_t) 1024, "mem_95863")) {
        err = 1;
        goto cleanup;
    }
    for (int32_t i_86721 = 0; i_86721 < 128; i_86721++) {
        int64_t i_84644 = sext_i32_i64(i_86721);
        int32_t x_71345 = lshr32(i_86721, 16);
        int32_t x_71346 = x_71345 ^ i_86721;
        int32_t x_71347 = mul32(73244475, x_71346);
        int32_t x_71348 = lshr32(x_71347, 16);
        int32_t x_71349 = x_71347 ^ x_71348;
        int32_t x_71350 = mul32(73244475, x_71349);
        int32_t x_71351 = lshr32(x_71350, 16);
        int32_t x_71352 = x_71350 ^ x_71351;
        int32_t unsign_arg_71353 = unsign_arg_64154 ^ x_71352;
        int32_t unsign_arg_71355 = mul32(48271, unsign_arg_71353);
        int32_t unsign_arg_71356 = umod32(unsign_arg_71355, 2147483647);
        double u64_res_71357 = uitofp_i32_f64(unsign_arg_71356);
        double zs_res_71358 = u64_res_71357 / 2.147483647e9;
        double zt_res_71359 = 8.333333333333333e-2 * zs_res_71358;
        double zp_res_71360 = -4.1666666666666664e-2 + zt_res_71359;
        int32_t unsign_arg_71371 = unsign_arg_64261 ^ x_71352;
        int32_t unsign_arg_71373 = mul32(48271, unsign_arg_71371);
        int32_t unsign_arg_71374 = umod32(unsign_arg_71373, 2147483647);
        double u64_res_71375 = uitofp_i32_f64(unsign_arg_71374);
        double zs_res_71376 = u64_res_71375 / 2.147483647e9;
        double zt_res_71377 = 0.125 * zs_res_71376;
        double zp_res_71378 = -6.25e-2 + zt_res_71377;
        int32_t unsign_arg_71390 = unsign_arg_64372 ^ x_71352;
        int32_t unsign_arg_71392 = mul32(48271, unsign_arg_71390);
        int32_t unsign_arg_71393 = umod32(unsign_arg_71392, 2147483647);
        double u64_res_71394 = uitofp_i32_f64(unsign_arg_71393);
        double zs_res_71395 = u64_res_71394 / 2.147483647e9;
        double zt_res_71396 = 5.892556509887896e-2 * zs_res_71395;
        double zp_res_71397 = -2.946278254943948e-2 + zt_res_71396;
        int32_t unsign_arg_71410 = unsign_arg_64914 ^ x_71352;
        int32_t unsign_arg_71412 = mul32(48271, unsign_arg_71410);
        int32_t unsign_arg_71413 = umod32(unsign_arg_71412, 2147483647);
        double u64_res_71414 = uitofp_i32_f64(unsign_arg_71413);
        double zs_res_71415 = u64_res_71414 / 2.147483647e9;
        double zt_res_71416 = 2.946278254943948e-2 * zs_res_71415;
        double zp_res_71417 = -1.473139127471974e-2 + zt_res_71416;
        int32_t unsign_arg_71431 = unsign_arg_65021 ^ x_71352;
        int32_t unsign_arg_71433 = mul32(48271, unsign_arg_71431);
        int32_t unsign_arg_71434 = umod32(unsign_arg_71433, 2147483647);
        double u64_res_71435 = uitofp_i32_f64(unsign_arg_71434);
        double zs_res_71436 = u64_res_71435 / 2.147483647e9;
        double zt_res_71437 = 0.125 * zs_res_71436;
        double zp_res_71438 = -6.25e-2 + zt_res_71437;
        int32_t unsign_arg_71453 = unsign_arg_65132 ^ x_71352;
        int32_t unsign_arg_71455 = mul32(48271, unsign_arg_71453);
        int32_t unsign_arg_71456 = umod32(unsign_arg_71455, 2147483647);
        double u64_res_71457 = uitofp_i32_f64(unsign_arg_71456);
        double zs_res_71458 = u64_res_71457 / 2.147483647e9;
        double zt_res_71459 = 5.892556509887896e-2 * zs_res_71458;
        double zp_res_71460 = -2.946278254943948e-2 + zt_res_71459;
        
        ((double *) mem_95853.mem)[i_84644] = zp_res_71460;
        ((double *) mem_95855.mem)[i_84644] = zp_res_71438;
        ((double *) mem_95857.mem)[i_84644] = zp_res_71417;
        ((double *) mem_95859.mem)[i_84644] = zp_res_71397;
        ((double *) mem_95861.mem)[i_84644] = zp_res_71378;
        ((double *) mem_95863.mem)[i_84644] = zp_res_71360;
    }
    
    int32_t mk_dense_weights_arg_64217 =
            ((int32_t *) mem_95623.mem)[(int64_t) 0];
    
    if (memblock_unref(ctx, &mem_95623, "mem_95623") != 0)
        return 1;
    
    int32_t unsign_arg_64220 = 5460 ^ mk_dense_weights_arg_64217;
    int32_t unsign_arg_64221 = mul32(48271, unsign_arg_64220);
    int32_t unsign_arg_64222 = umod32(unsign_arg_64221, 2147483647);
    int32_t unsign_arg_64224 = mul32(48271, unsign_arg_64222);
    int32_t unsign_arg_64225 = umod32(unsign_arg_64224, 2147483647);
    int32_t mk_dense_weights_arg_64977 =
            ((int32_t *) mem_95611.mem)[(int64_t) 0];
    
    if (memblock_unref(ctx, &mem_95611, "mem_95611") != 0)
        return 1;
    
    int32_t unsign_arg_64980 = 5460 ^ mk_dense_weights_arg_64977;
    int32_t unsign_arg_64981 = mul32(48271, unsign_arg_64980);
    int32_t unsign_arg_64982 = umod32(unsign_arg_64981, 2147483647);
    int32_t unsign_arg_64984 = mul32(48271, unsign_arg_64982);
    int32_t unsign_arg_64985 = umod32(unsign_arg_64984, 2147483647);
    
    if (memblock_alloc(ctx, &mem_95925, (int64_t) 262144, "mem_95925")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_95927, (int64_t) 262144, "mem_95927")) {
        err = 1;
        goto cleanup;
    }
    for (int32_t i_86722 = 0; i_86722 < 32768; i_86722++) {
        int64_t i_84655 = sext_i32_i64(i_86722);
        int32_t x_71465 = lshr32(i_86722, 16);
        int32_t x_71466 = x_71465 ^ i_86722;
        int32_t x_71467 = mul32(73244475, x_71466);
        int32_t x_71468 = lshr32(x_71467, 16);
        int32_t x_71469 = x_71467 ^ x_71468;
        int32_t x_71470 = mul32(73244475, x_71469);
        int32_t x_71471 = lshr32(x_71470, 16);
        int32_t x_71472 = x_71470 ^ x_71471;
        int32_t unsign_arg_71473 = unsign_arg_64225 ^ x_71472;
        int32_t unsign_arg_71475 = mul32(48271, unsign_arg_71473);
        int32_t unsign_arg_71476 = umod32(unsign_arg_71475, 2147483647);
        double u64_res_71477 = uitofp_i32_f64(unsign_arg_71476);
        double zs_res_71478 = u64_res_71477 / 2.147483647e9;
        double zt_res_71479 = 0.125 * zs_res_71478;
        double zp_res_71480 = -6.25e-2 + zt_res_71479;
        int32_t unsign_arg_71491 = unsign_arg_64985 ^ x_71472;
        int32_t unsign_arg_71493 = mul32(48271, unsign_arg_71491);
        int32_t unsign_arg_71494 = umod32(unsign_arg_71493, 2147483647);
        double u64_res_71495 = uitofp_i32_f64(unsign_arg_71494);
        double zs_res_71496 = u64_res_71495 / 2.147483647e9;
        double zt_res_71497 = 0.125 * zs_res_71496;
        double zp_res_71498 = -6.25e-2 + zt_res_71497;
        
        ((double *) mem_95925.mem)[i_84655] = zp_res_71498;
        ((double *) mem_95927.mem)[i_84655] = zp_res_71480;
    }
    
    int32_t mk_conv_weights_arg_64324 =
            ((int32_t *) mem_95621.mem)[(int64_t) 0];
    
    if (memblock_unref(ctx, &mem_95621, "mem_95621") != 0)
        return 1;
    
    int32_t unsign_arg_64329 = 5460 ^ mk_conv_weights_arg_64324;
    int32_t unsign_arg_64330 = mul32(48271, unsign_arg_64329);
    int32_t unsign_arg_64331 = umod32(unsign_arg_64330, 2147483647);
    int32_t unsign_arg_64335 = mul32(48271, unsign_arg_64331);
    int32_t unsign_arg_64336 = umod32(unsign_arg_64335, 2147483647);
    int32_t mk_conv_weights_arg_65246 =
            ((int32_t *) mem_95607.mem)[(int64_t) 0];
    
    if (memblock_unref(ctx, &mem_95607, "mem_95607") != 0)
        return 1;
    
    int32_t unsign_arg_65251 = 5460 ^ mk_conv_weights_arg_65246;
    int32_t unsign_arg_65252 = mul32(48271, unsign_arg_65251);
    int32_t unsign_arg_65253 = umod32(unsign_arg_65252, 2147483647);
    int32_t unsign_arg_65257 = mul32(48271, unsign_arg_65253);
    int32_t unsign_arg_65258 = umod32(unsign_arg_65257, 2147483647);
    int32_t mk_conv_weights_arg_65084 =
            ((int32_t *) mem_95609.mem)[(int64_t) 0];
    
    if (memblock_unref(ctx, &mem_95609, "mem_95609") != 0)
        return 1;
    
    int32_t unsign_arg_65089 = 5460 ^ mk_conv_weights_arg_65084;
    int32_t unsign_arg_65090 = mul32(48271, unsign_arg_65089);
    int32_t unsign_arg_65091 = umod32(unsign_arg_65090, 2147483647);
    int32_t unsign_arg_65095 = mul32(48271, unsign_arg_65091);
    int32_t unsign_arg_65096 = umod32(unsign_arg_65095, 2147483647);
    
    if (memblock_alloc(ctx, &mem_95949, (int64_t) 1179648, "mem_95949")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_95951, (int64_t) 1179648, "mem_95951")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_95953, (int64_t) 1179648, "mem_95953")) {
        err = 1;
        goto cleanup;
    }
    for (int32_t i_86723 = 0; i_86723 < 147456; i_86723++) {
        int64_t i_84664 = sext_i32_i64(i_86723);
        int32_t x_71543 = lshr32(i_86723, 16);
        int32_t x_71544 = x_71543 ^ i_86723;
        int32_t x_71545 = mul32(73244475, x_71544);
        int32_t x_71546 = lshr32(x_71545, 16);
        int32_t x_71547 = x_71545 ^ x_71546;
        int32_t x_71548 = mul32(73244475, x_71547);
        int32_t x_71549 = lshr32(x_71548, 16);
        int32_t x_71550 = x_71548 ^ x_71549;
        int32_t unsign_arg_71551 = unsign_arg_64336 ^ x_71550;
        int32_t unsign_arg_71553 = mul32(48271, unsign_arg_71551);
        int32_t unsign_arg_71554 = umod32(unsign_arg_71553, 2147483647);
        double u64_res_71555 = uitofp_i32_f64(unsign_arg_71554);
        double zs_res_71556 = u64_res_71555 / 2.147483647e9;
        double zt_res_71557 = 5.892556509887896e-2 * zs_res_71556;
        double zp_res_71558 = -2.946278254943948e-2 + zt_res_71557;
        int32_t unsign_arg_71569 = unsign_arg_65096 ^ x_71550;
        int32_t unsign_arg_71571 = mul32(48271, unsign_arg_71569);
        int32_t unsign_arg_71572 = umod32(unsign_arg_71571, 2147483647);
        double u64_res_71573 = uitofp_i32_f64(unsign_arg_71572);
        double zs_res_71574 = u64_res_71573 / 2.147483647e9;
        double zt_res_71575 = 5.892556509887896e-2 * zs_res_71574;
        double zp_res_71576 = -2.946278254943948e-2 + zt_res_71575;
        int32_t unsign_arg_71588 = unsign_arg_65258 ^ x_71550;
        int32_t unsign_arg_71590 = mul32(48271, unsign_arg_71588);
        int32_t unsign_arg_71591 = umod32(unsign_arg_71590, 2147483647);
        double u64_res_71592 = uitofp_i32_f64(unsign_arg_71591);
        double zs_res_71593 = u64_res_71592 / 2.147483647e9;
        double zt_res_71594 = 4.1666666666666664e-2 * zs_res_71593;
        double zp_res_71595 = -2.0833333333333332e-2 + zt_res_71594;
        
        ((double *) mem_95949.mem)[i_84664] = zp_res_71595;
        ((double *) mem_95951.mem)[i_84664] = zp_res_71576;
        ((double *) mem_95953.mem)[i_84664] = zp_res_71558;
    }
    
    int32_t mk_conv_weights_arg_64486 =
            ((int32_t *) mem_95619.mem)[(int64_t) 0];
    int32_t unsign_arg_64491 = 5460 ^ mk_conv_weights_arg_64486;
    int32_t unsign_arg_64492 = mul32(48271, unsign_arg_64491);
    int32_t unsign_arg_64493 = umod32(unsign_arg_64492, 2147483647);
    int32_t unsign_arg_64497 = mul32(48271, unsign_arg_64493);
    int32_t unsign_arg_64498 = umod32(unsign_arg_64497, 2147483647);
    
    if (memblock_alloc(ctx, &mem_95985, (int64_t) 2359296, "mem_95985")) {
        err = 1;
        goto cleanup;
    }
    for (int32_t i_86724 = 0; i_86724 < 294912; i_86724++) {
        int64_t i_84670 = sext_i32_i64(i_86724);
        int32_t x_66499 = lshr32(i_86724, 16);
        int32_t x_66500 = x_66499 ^ i_86724;
        int32_t x_66501 = mul32(73244475, x_66500);
        int32_t x_66502 = lshr32(x_66501, 16);
        int32_t x_66503 = x_66501 ^ x_66502;
        int32_t x_66504 = mul32(73244475, x_66503);
        int32_t x_66505 = lshr32(x_66504, 16);
        int32_t x_66506 = x_66504 ^ x_66505;
        int32_t unsign_arg_66507 = unsign_arg_64498 ^ x_66506;
        int32_t unsign_arg_66509 = mul32(48271, unsign_arg_66507);
        int32_t unsign_arg_66510 = umod32(unsign_arg_66509, 2147483647);
        double u64_res_66511 = uitofp_i32_f64(unsign_arg_66510);
        double zs_res_66512 = u64_res_66511 / 2.147483647e9;
        double zt_res_66513 = 5.892556509887896e-2 * zs_res_66512;
        double zp_res_66514 = -2.946278254943948e-2 + zt_res_66513;
        
        ((double *) mem_95985.mem)[i_84670] = zp_res_66514;
    }
    
    int32_t mk_conv_biases_arg_64529 = ((int32_t *) mem_95619.mem)[(int64_t) 1];
    
    if (memblock_unref(ctx, &mem_95619, "mem_95619") != 0)
        return 1;
    
    int32_t unsign_arg_64530 = 5460 ^ mk_conv_biases_arg_64529;
    int32_t unsign_arg_64531 = mul32(48271, unsign_arg_64530);
    int32_t unsign_arg_64532 = umod32(unsign_arg_64531, 2147483647);
    int32_t unsign_arg_64533 = mul32(48271, unsign_arg_64532);
    int32_t unsign_arg_64534 = umod32(unsign_arg_64533, 2147483647);
    int32_t mk_conv_biases_arg_64747 = ((int32_t *) mem_95615.mem)[(int64_t) 1];
    int32_t unsign_arg_64748 = 5460 ^ mk_conv_biases_arg_64747;
    int32_t unsign_arg_64749 = mul32(48271, unsign_arg_64748);
    int32_t unsign_arg_64750 = umod32(unsign_arg_64749, 2147483647);
    int32_t unsign_arg_64751 = mul32(48271, unsign_arg_64750);
    int32_t unsign_arg_64752 = umod32(unsign_arg_64751, 2147483647);
    int32_t mk_dense_biases_arg_64636 =
            ((int32_t *) mem_95617.mem)[(int64_t) 1];
    int32_t unsign_arg_64637 = 5460 ^ mk_dense_biases_arg_64636;
    int32_t unsign_arg_64638 = mul32(48271, unsign_arg_64637);
    int32_t unsign_arg_64639 = umod32(unsign_arg_64638, 2147483647);
    int32_t unsign_arg_64640 = mul32(48271, unsign_arg_64639);
    int32_t unsign_arg_64641 = umod32(unsign_arg_64640, 2147483647);
    
    if (memblock_alloc(ctx, &mem_95997, (int64_t) 2048, "mem_95997")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_95999, (int64_t) 2048, "mem_95999")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_96001, (int64_t) 2048, "mem_96001")) {
        err = 1;
        goto cleanup;
    }
    for (int32_t i_86725 = 0; i_86725 < 256; i_86725++) {
        int64_t i_84678 = sext_i32_i64(i_86725);
        int32_t x_71640 = lshr32(i_86725, 16);
        int32_t x_71641 = x_71640 ^ i_86725;
        int32_t x_71642 = mul32(73244475, x_71641);
        int32_t x_71643 = lshr32(x_71642, 16);
        int32_t x_71644 = x_71642 ^ x_71643;
        int32_t x_71645 = mul32(73244475, x_71644);
        int32_t x_71646 = lshr32(x_71645, 16);
        int32_t x_71647 = x_71645 ^ x_71646;
        int32_t unsign_arg_71648 = unsign_arg_64534 ^ x_71647;
        int32_t unsign_arg_71650 = mul32(48271, unsign_arg_71648);
        int32_t unsign_arg_71651 = umod32(unsign_arg_71650, 2147483647);
        double u64_res_71652 = uitofp_i32_f64(unsign_arg_71651);
        double zs_res_71653 = u64_res_71652 / 2.147483647e9;
        double zt_res_71654 = 5.892556509887896e-2 * zs_res_71653;
        double zp_res_71655 = -2.946278254943948e-2 + zt_res_71654;
        int32_t unsign_arg_71666 = unsign_arg_64641 ^ x_71647;
        int32_t unsign_arg_71668 = mul32(48271, unsign_arg_71666);
        int32_t unsign_arg_71669 = umod32(unsign_arg_71668, 2147483647);
        double u64_res_71670 = uitofp_i32_f64(unsign_arg_71669);
        double zs_res_71671 = u64_res_71670 / 2.147483647e9;
        double zt_res_71672 = 0.125 * zs_res_71671;
        double zp_res_71673 = -6.25e-2 + zt_res_71672;
        int32_t unsign_arg_71685 = unsign_arg_64752 ^ x_71647;
        int32_t unsign_arg_71687 = mul32(48271, unsign_arg_71685);
        int32_t unsign_arg_71688 = umod32(unsign_arg_71687, 2147483647);
        double u64_res_71689 = uitofp_i32_f64(unsign_arg_71688);
        double zs_res_71690 = u64_res_71689 / 2.147483647e9;
        double zt_res_71691 = 4.1666666666666664e-2 * zs_res_71690;
        double zp_res_71692 = -2.0833333333333332e-2 + zt_res_71691;
        
        ((double *) mem_95997.mem)[i_84678] = zp_res_71692;
        ((double *) mem_95999.mem)[i_84678] = zp_res_71673;
        ((double *) mem_96001.mem)[i_84678] = zp_res_71655;
    }
    
    int32_t mk_dense_weights_arg_64597 =
            ((int32_t *) mem_95617.mem)[(int64_t) 0];
    
    if (memblock_unref(ctx, &mem_95617, "mem_95617") != 0)
        return 1;
    
    int32_t unsign_arg_64600 = 5460 ^ mk_dense_weights_arg_64597;
    int32_t unsign_arg_64601 = mul32(48271, unsign_arg_64600);
    int32_t unsign_arg_64602 = umod32(unsign_arg_64601, 2147483647);
    int32_t unsign_arg_64604 = mul32(48271, unsign_arg_64602);
    int32_t unsign_arg_64605 = umod32(unsign_arg_64604, 2147483647);
    
    if (memblock_alloc(ctx, &mem_96033, (int64_t) 524288, "mem_96033")) {
        err = 1;
        goto cleanup;
    }
    for (int32_t i_86726 = 0; i_86726 < 65536; i_86726++) {
        int64_t i_84684 = sext_i32_i64(i_86726);
        int32_t x_66414 = lshr32(i_86726, 16);
        int32_t x_66415 = x_66414 ^ i_86726;
        int32_t x_66416 = mul32(73244475, x_66415);
        int32_t x_66417 = lshr32(x_66416, 16);
        int32_t x_66418 = x_66416 ^ x_66417;
        int32_t x_66419 = mul32(73244475, x_66418);
        int32_t x_66420 = lshr32(x_66419, 16);
        int32_t x_66421 = x_66419 ^ x_66420;
        int32_t unsign_arg_66422 = unsign_arg_64605 ^ x_66421;
        int32_t unsign_arg_66424 = mul32(48271, unsign_arg_66422);
        int32_t unsign_arg_66425 = umod32(unsign_arg_66424, 2147483647);
        double u64_res_66426 = uitofp_i32_f64(unsign_arg_66425);
        double zs_res_66427 = u64_res_66426 / 2.147483647e9;
        double zt_res_66428 = 0.125 * zs_res_66427;
        double zp_res_66429 = -6.25e-2 + zt_res_66428;
        
        ((double *) mem_96033.mem)[i_84684] = zp_res_66429;
    }
    
    int32_t mk_conv_weights_arg_64704 =
            ((int32_t *) mem_95615.mem)[(int64_t) 0];
    
    if (memblock_unref(ctx, &mem_95615, "mem_95615") != 0)
        return 1;
    
    int32_t unsign_arg_64709 = 5460 ^ mk_conv_weights_arg_64704;
    int32_t unsign_arg_64710 = mul32(48271, unsign_arg_64709);
    int32_t unsign_arg_64711 = umod32(unsign_arg_64710, 2147483647);
    int32_t unsign_arg_64715 = mul32(48271, unsign_arg_64711);
    int32_t unsign_arg_64716 = umod32(unsign_arg_64715, 2147483647);
    int32_t mk_conv_weights_arg_64866 =
            ((int32_t *) mem_95613.mem)[(int64_t) 0];
    
    if (memblock_unref(ctx, &mem_95613, "mem_95613") != 0)
        return 1;
    
    int32_t unsign_arg_64871 = 5460 ^ mk_conv_weights_arg_64866;
    int32_t unsign_arg_64872 = mul32(48271, unsign_arg_64871);
    int32_t unsign_arg_64873 = umod32(unsign_arg_64872, 2147483647);
    int32_t unsign_arg_64877 = mul32(48271, unsign_arg_64873);
    int32_t unsign_arg_64878 = umod32(unsign_arg_64877, 2147483647);
    
    if (memblock_alloc(ctx, &mem_96045, (int64_t) 4718592, "mem_96045")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_96047, (int64_t) 4718592, "mem_96047")) {
        err = 1;
        goto cleanup;
    }
    for (int32_t i_86727 = 0; i_86727 < 589824; i_86727++) {
        int64_t i_84690 = sext_i32_i64(i_86727);
        int32_t x_71697 = lshr32(i_86727, 16);
        int32_t x_71698 = x_71697 ^ i_86727;
        int32_t x_71699 = mul32(73244475, x_71698);
        int32_t x_71700 = lshr32(x_71699, 16);
        int32_t x_71701 = x_71699 ^ x_71700;
        int32_t x_71702 = mul32(73244475, x_71701);
        int32_t x_71703 = lshr32(x_71702, 16);
        int32_t x_71704 = x_71702 ^ x_71703;
        int32_t unsign_arg_71705 = unsign_arg_64716 ^ x_71704;
        int32_t unsign_arg_71707 = mul32(48271, unsign_arg_71705);
        int32_t unsign_arg_71708 = umod32(unsign_arg_71707, 2147483647);
        double u64_res_71709 = uitofp_i32_f64(unsign_arg_71708);
        double zs_res_71710 = u64_res_71709 / 2.147483647e9;
        double zt_res_71711 = 4.1666666666666664e-2 * zs_res_71710;
        double zp_res_71712 = -2.0833333333333332e-2 + zt_res_71711;
        int32_t unsign_arg_71723 = unsign_arg_64878 ^ x_71704;
        int32_t unsign_arg_71725 = mul32(48271, unsign_arg_71723);
        int32_t unsign_arg_71726 = umod32(unsign_arg_71725, 2147483647);
        double u64_res_71727 = uitofp_i32_f64(unsign_arg_71726);
        double zs_res_71728 = u64_res_71727 / 2.147483647e9;
        double zt_res_71729 = 2.946278254943948e-2 * zs_res_71728;
        double zp_res_71730 = -1.473139127471974e-2 + zt_res_71729;
        
        ((double *) mem_96045.mem)[i_84690] = zp_res_71730;
        ((double *) mem_96047.mem)[i_84690] = zp_res_71712;
    }
    
    int32_t mk_dense_weights_arg_65357 =
            ((int32_t *) mem_95605.mem)[(int64_t) 0];
    
    if (memblock_unref(ctx, &mem_95605, "mem_95605") != 0)
        return 1;
    
    int32_t unsign_arg_65360 = 5460 ^ mk_dense_weights_arg_65357;
    int32_t unsign_arg_65361 = mul32(48271, unsign_arg_65360);
    int32_t unsign_arg_65362 = umod32(unsign_arg_65361, 2147483647);
    int32_t unsign_arg_65364 = mul32(48271, unsign_arg_65362);
    int32_t unsign_arg_65365 = umod32(unsign_arg_65364, 2147483647);
    
    if (memblock_alloc(ctx, &mem_96069, (int64_t) 131072, "mem_96069")) {
        err = 1;
        goto cleanup;
    }
    for (int32_t i_86728 = 0; i_86728 < 16384; i_86728++) {
        int64_t i_84695 = sext_i32_i64(i_86728);
        int32_t x_65810 = lshr32(i_86728, 16);
        int32_t x_65811 = x_65810 ^ i_86728;
        int32_t x_65812 = mul32(73244475, x_65811);
        int32_t x_65813 = lshr32(x_65812, 16);
        int32_t x_65814 = x_65812 ^ x_65813;
        int32_t x_65815 = mul32(73244475, x_65814);
        int32_t x_65816 = lshr32(x_65815, 16);
        int32_t x_65817 = x_65815 ^ x_65816;
        int32_t unsign_arg_65818 = unsign_arg_65365 ^ x_65817;
        int32_t unsign_arg_65820 = mul32(48271, unsign_arg_65818);
        int32_t unsign_arg_65821 = umod32(unsign_arg_65820, 2147483647);
        double u64_res_65822 = uitofp_i32_f64(unsign_arg_65821);
        double zs_res_65823 = u64_res_65822 / 2.147483647e9;
        double zt_res_65824 = 0.125 * zs_res_65823;
        double zp_res_65825 = -6.25e-2 + zt_res_65824;
        
        ((double *) mem_96069.mem)[i_84695] = zp_res_65825;
    }
    
    int32_t mk_conv_weights_arg_65464 =
            ((int32_t *) mem_95603.mem)[(int64_t) 0];
    
    if (memblock_unref(ctx, &mem_95603, "mem_95603") != 0)
        return 1;
    
    int32_t unsign_arg_65469 = 5460 ^ mk_conv_weights_arg_65464;
    int32_t unsign_arg_65470 = mul32(48271, unsign_arg_65469);
    int32_t unsign_arg_65471 = umod32(unsign_arg_65470, 2147483647);
    int32_t unsign_arg_65475 = mul32(48271, unsign_arg_65471);
    int32_t unsign_arg_65476 = umod32(unsign_arg_65475, 2147483647);
    
    if (memblock_alloc(ctx, &mem_96081, (int64_t) 294912, "mem_96081")) {
        err = 1;
        goto cleanup;
    }
    for (int32_t i_86729 = 0; i_86729 < 36864; i_86729++) {
        int64_t i_84699 = sext_i32_i64(i_86729);
        int32_t x_65725 = lshr32(i_86729, 16);
        int32_t x_65726 = x_65725 ^ i_86729;
        int32_t x_65727 = mul32(73244475, x_65726);
        int32_t x_65728 = lshr32(x_65727, 16);
        int32_t x_65729 = x_65727 ^ x_65728;
        int32_t x_65730 = mul32(73244475, x_65729);
        int32_t x_65731 = lshr32(x_65730, 16);
        int32_t x_65732 = x_65730 ^ x_65731;
        int32_t unsign_arg_65733 = unsign_arg_65476 ^ x_65732;
        int32_t unsign_arg_65735 = mul32(48271, unsign_arg_65733);
        int32_t unsign_arg_65736 = umod32(unsign_arg_65735, 2147483647);
        double u64_res_65737 = uitofp_i32_f64(unsign_arg_65736);
        double zs_res_65738 = u64_res_65737 / 2.147483647e9;
        double zt_res_65739 = 8.333333333333333e-2 * zs_res_65738;
        double zp_res_65740 = -4.1666666666666664e-2 + zt_res_65739;
        
        ((double *) mem_96081.mem)[i_84699] = zp_res_65740;
    }
    
    int32_t mk_conv_biases_arg_61084 = ((int32_t *) mem_95601.mem)[(int64_t) 1];
    
    if (memblock_unref(ctx, &mem_95601, "mem_95601") != 0)
        return 1;
    
    int32_t unsign_arg_61085 = 5460 ^ mk_conv_biases_arg_61084;
    int32_t unsign_arg_61086 = mul32(48271, unsign_arg_61085);
    int32_t unsign_arg_61087 = umod32(unsign_arg_61086, 2147483647);
    int32_t unsign_arg_61088 = mul32(48271, unsign_arg_61087);
    int32_t unsign_arg_61089 = umod32(unsign_arg_61088, 2147483647);
    int32_t unsign_arg_61105 = mul32(48271, unsign_arg_61089);
    int32_t unsign_arg_61106 = umod32(unsign_arg_61105, 2147483647);
    double u64_res_61107 = uitofp_i32_f64(unsign_arg_61106);
    double zs_res_61108 = u64_res_61107 / 2.147483647e9;
    double zt_res_61109 = 0.25 * zs_res_61108;
    
    zp_res_61110 = -0.125 + zt_res_61109;
    if (memblock_alloc(ctx, &mem_96093, (int64_t) 8, "mem_96093")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_114684 = 0; i_114684 < (int64_t) 1; i_114684++) {
        ((double *) mem_96093.mem)[i_114684] = zp_res_61110;
    }
    if (memblock_alloc(ctx, &mem_96095, (int64_t) 4608, "mem_96095")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_114685 = 0; i_114685 < (int64_t) 64; i_114685++) {
        for (int64_t i_114686 = 0; i_114686 < (int64_t) 1; i_114686++) {
            for (int64_t i_114687 = 0; i_114687 < (int64_t) 3; i_114687++) {
                for (int64_t i_114688 = 0; i_114688 < (int64_t) 3; i_114688++) {
                    ((double *) mem_96095.mem)[i_114685 * (int64_t) 9 +
                                               i_114686 * (int64_t) 9 +
                                               i_114687 * (int64_t) 3 +
                                               i_114688] = 0.0;
                }
            }
        }
    }
    if (memblock_alloc(ctx, &mem_96097, (int64_t) 512, "mem_96097")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_114689 = 0; i_114689 < (int64_t) 64; i_114689++) {
        ((double *) mem_96097.mem)[i_114689] = 0.0;
    }
    if (memblock_alloc(ctx, &mem_96099, (int64_t) 589824, "mem_96099")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_114690 = 0; i_114690 < (int64_t) 128; i_114690++) {
        for (int64_t i_114691 = 0; i_114691 < (int64_t) 64; i_114691++) {
            for (int64_t i_114692 = 0; i_114692 < (int64_t) 3; i_114692++) {
                for (int64_t i_114693 = 0; i_114693 < (int64_t) 3; i_114693++) {
                    ((double *) mem_96099.mem)[i_114690 * (int64_t) 576 +
                                               i_114691 * (int64_t) 9 +
                                               i_114692 * (int64_t) 3 +
                                               i_114693] = 0.0;
                }
            }
        }
    }
    if (memblock_alloc(ctx, &mem_96101, (int64_t) 1024, "mem_96101")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_114694 = 0; i_114694 < (int64_t) 128; i_114694++) {
        ((double *) mem_96101.mem)[i_114694] = 0.0;
    }
    if (memblock_alloc(ctx, &mem_96103, (int64_t) 1179648, "mem_96103")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_114695 = 0; i_114695 < (int64_t) 128; i_114695++) {
        for (int64_t i_114696 = 0; i_114696 < (int64_t) 128; i_114696++) {
            for (int64_t i_114697 = 0; i_114697 < (int64_t) 3; i_114697++) {
                for (int64_t i_114698 = 0; i_114698 < (int64_t) 3; i_114698++) {
                    ((double *) mem_96103.mem)[i_114695 * (int64_t) 1152 +
                                               i_114696 * (int64_t) 9 +
                                               i_114697 * (int64_t) 3 +
                                               i_114698] = 0.0;
                }
            }
        }
    }
    if (memblock_alloc(ctx, &mem_96105, (int64_t) 2048, "mem_96105")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_114699 = 0; i_114699 < (int64_t) 256; i_114699++) {
        ((double *) mem_96105.mem)[i_114699] = 0.0;
    }
    if (memblock_alloc(ctx, &mem_96107, (int64_t) 262144, "mem_96107")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_114700 = 0; i_114700 < (int64_t) 128; i_114700++) {
        for (int64_t i_114701 = 0; i_114701 < (int64_t) 256; i_114701++) {
            ((double *) mem_96107.mem)[i_114700 * (int64_t) 256 + i_114701] =
                0.0;
        }
    }
    if (memblock_alloc(ctx, &mem_96109, (int64_t) 2359296, "mem_96109")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_114702 = 0; i_114702 < (int64_t) 256; i_114702++) {
        for (int64_t i_114703 = 0; i_114703 < (int64_t) 128; i_114703++) {
            for (int64_t i_114704 = 0; i_114704 < (int64_t) 3; i_114704++) {
                for (int64_t i_114705 = 0; i_114705 < (int64_t) 3; i_114705++) {
                    ((double *) mem_96109.mem)[i_114702 * (int64_t) 1152 +
                                               i_114703 * (int64_t) 9 +
                                               i_114704 * (int64_t) 3 +
                                               i_114705] = 0.0;
                }
            }
        }
    }
    if (memblock_alloc(ctx, &mem_96111, (int64_t) 4718592, "mem_96111")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_114706 = 0; i_114706 < (int64_t) 256; i_114706++) {
        for (int64_t i_114707 = 0; i_114707 < (int64_t) 256; i_114707++) {
            for (int64_t i_114708 = 0; i_114708 < (int64_t) 3; i_114708++) {
                for (int64_t i_114709 = 0; i_114709 < (int64_t) 3; i_114709++) {
                    ((double *) mem_96111.mem)[i_114706 * (int64_t) 2304 +
                                               i_114707 * (int64_t) 9 +
                                               i_114708 * (int64_t) 3 +
                                               i_114709] = 0.0;
                }
            }
        }
    }
    if (memblock_alloc(ctx, &mem_96113, (int64_t) 524288, "mem_96113")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_114710 = 0; i_114710 < (int64_t) 256; i_114710++) {
        for (int64_t i_114711 = 0; i_114711 < (int64_t) 256; i_114711++) {
            ((double *) mem_96113.mem)[i_114710 * (int64_t) 256 + i_114711] =
                0.0;
        }
    }
    if (memblock_alloc(ctx, &mem_96115, (int64_t) 4718592, "mem_96115")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_114712 = 0; i_114712 < (int64_t) 128; i_114712++) {
        for (int64_t i_114713 = 0; i_114713 < (int64_t) 512; i_114713++) {
            for (int64_t i_114714 = 0; i_114714 < (int64_t) 3; i_114714++) {
                for (int64_t i_114715 = 0; i_114715 < (int64_t) 3; i_114715++) {
                    ((double *) mem_96115.mem)[i_114712 * (int64_t) 4608 +
                                               i_114713 * (int64_t) 9 +
                                               i_114714 * (int64_t) 3 +
                                               i_114715] = 0.0;
                }
            }
        }
    }
    if (memblock_alloc(ctx, &mem_96117, (int64_t) 1179648, "mem_96117")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_114716 = 0; i_114716 < (int64_t) 64; i_114716++) {
        for (int64_t i_114717 = 0; i_114717 < (int64_t) 256; i_114717++) {
            for (int64_t i_114718 = 0; i_114718 < (int64_t) 3; i_114718++) {
                for (int64_t i_114719 = 0; i_114719 < (int64_t) 3; i_114719++) {
                    ((double *) mem_96117.mem)[i_114716 * (int64_t) 2304 +
                                               i_114717 * (int64_t) 9 +
                                               i_114718 * (int64_t) 3 +
                                               i_114719] = 0.0;
                }
            }
        }
    }
    if (memblock_alloc(ctx, &mem_96119, (int64_t) 294912, "mem_96119")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_114720 = 0; i_114720 < (int64_t) 64; i_114720++) {
        for (int64_t i_114721 = 0; i_114721 < (int64_t) 64; i_114721++) {
            for (int64_t i_114722 = 0; i_114722 < (int64_t) 3; i_114722++) {
                for (int64_t i_114723 = 0; i_114723 < (int64_t) 3; i_114723++) {
                    ((double *) mem_96119.mem)[i_114720 * (int64_t) 576 +
                                               i_114721 * (int64_t) 9 +
                                               i_114722 * (int64_t) 3 +
                                               i_114723] = 0.0;
                }
            }
        }
    }
    if (memblock_alloc(ctx, &mem_96121, (int64_t) 131072, "mem_96121")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_114724 = 0; i_114724 < (int64_t) 64; i_114724++) {
        for (int64_t i_114725 = 0; i_114725 < (int64_t) 256; i_114725++) {
            ((double *) mem_96121.mem)[i_114724 * (int64_t) 256 + i_114725] =
                0.0;
        }
    }
    if (memblock_alloc(ctx, &mem_96123, (int64_t) 8, "mem_96123")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_114726 = 0; i_114726 < (int64_t) 1; i_114726++) {
        ((double *) mem_96123.mem)[i_114726] = 0.0;
    }
    if (memblock_alloc(ctx, &mem_96125, (int64_t) 512, "mem_96125")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_114727 = 0; i_114727 < (int64_t) 1; i_114727++) {
        for (int64_t i_114728 = 0; i_114728 < (int64_t) 64; i_114728++) {
            for (int64_t i_114729 = 0; i_114729 < (int64_t) 1; i_114729++) {
                for (int64_t i_114730 = 0; i_114730 < (int64_t) 1; i_114730++) {
                    ((double *) mem_96125.mem)[i_114727 * (int64_t) 64 +
                                               i_114728 + i_114729 + i_114730] =
                        0.0;
                }
            }
        }
    }
    if (memblock_unref(ctx, &mem_95627, "mem_95627") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_95625, "mem_95625") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_95623, "mem_95623") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_95621, "mem_95621") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_95619, "mem_95619") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_95617, "mem_95617") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_95615, "mem_95615") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_95613, "mem_95613") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_95611, "mem_95611") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_95609, "mem_95609") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_95607, "mem_95607") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_95605, "mem_95605") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_95603, "mem_95603") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_95601, "mem_95601") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_95559, "mem_95559") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_95557, "mem_95557") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_95555, "mem_95555") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_95553, "mem_95553") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_95541, "mem_95541") != 0)
        return 1;
    #undef mem_95769
    #undef mem_95781
    #undef mem_95783
    #undef mem_95785
    #undef mem_95787
    #undef mem_95789
    #undef mem_95841
    #undef mem_95853
    #undef mem_95855
    #undef mem_95857
    #undef mem_95859
    #undef mem_95861
    #undef mem_95863
    #undef mem_95925
    #undef mem_95927
    #undef mem_95949
    #undef mem_95951
    #undef mem_95953
    #undef mem_95985
    #undef mem_95997
    #undef mem_95999
    #undef mem_96001
    #undef mem_96033
    #undef mem_96045
    #undef mem_96047
    #undef mem_96069
    #undef mem_96081
    #undef zp_res_61110
    #undef mem_96093
    #undef mem_96095
    #undef mem_96097
    #undef mem_96099
    #undef mem_96101
    #undef mem_96103
    #undef mem_96105
    #undef mem_96107
    #undef mem_96109
    #undef mem_96111
    #undef mem_96113
    #undef mem_96115
    #undef mem_96117
    #undef mem_96119
    #undef mem_96121
    #undef mem_96123
    #undef mem_96125
    
  cleanup:
    return err;
}
static int free_constants(struct futhark_context *ctx)
{
    (void) ctx;
    if (memblock_unref(ctx, &ctx->constants.mem_95769,
                       "ctx->constants.mem_95769") != 0)
        return 1;
    if (memblock_unref(ctx, &ctx->constants.mem_95781,
                       "ctx->constants.mem_95781") != 0)
        return 1;
    if (memblock_unref(ctx, &ctx->constants.mem_95783,
                       "ctx->constants.mem_95783") != 0)
        return 1;
    if (memblock_unref(ctx, &ctx->constants.mem_95785,
                       "ctx->constants.mem_95785") != 0)
        return 1;
    if (memblock_unref(ctx, &ctx->constants.mem_95787,
                       "ctx->constants.mem_95787") != 0)
        return 1;
    if (memblock_unref(ctx, &ctx->constants.mem_95789,
                       "ctx->constants.mem_95789") != 0)
        return 1;
    if (memblock_unref(ctx, &ctx->constants.mem_95841,
                       "ctx->constants.mem_95841") != 0)
        return 1;
    if (memblock_unref(ctx, &ctx->constants.mem_95853,
                       "ctx->constants.mem_95853") != 0)
        return 1;
    if (memblock_unref(ctx, &ctx->constants.mem_95855,
                       "ctx->constants.mem_95855") != 0)
        return 1;
    if (memblock_unref(ctx, &ctx->constants.mem_95857,
                       "ctx->constants.mem_95857") != 0)
        return 1;
    if (memblock_unref(ctx, &ctx->constants.mem_95859,
                       "ctx->constants.mem_95859") != 0)
        return 1;
    if (memblock_unref(ctx, &ctx->constants.mem_95861,
                       "ctx->constants.mem_95861") != 0)
        return 1;
    if (memblock_unref(ctx, &ctx->constants.mem_95863,
                       "ctx->constants.mem_95863") != 0)
        return 1;
    if (memblock_unref(ctx, &ctx->constants.mem_95925,
                       "ctx->constants.mem_95925") != 0)
        return 1;
    if (memblock_unref(ctx, &ctx->constants.mem_95927,
                       "ctx->constants.mem_95927") != 0)
        return 1;
    if (memblock_unref(ctx, &ctx->constants.mem_95949,
                       "ctx->constants.mem_95949") != 0)
        return 1;
    if (memblock_unref(ctx, &ctx->constants.mem_95951,
                       "ctx->constants.mem_95951") != 0)
        return 1;
    if (memblock_unref(ctx, &ctx->constants.mem_95953,
                       "ctx->constants.mem_95953") != 0)
        return 1;
    if (memblock_unref(ctx, &ctx->constants.mem_95985,
                       "ctx->constants.mem_95985") != 0)
        return 1;
    if (memblock_unref(ctx, &ctx->constants.mem_95997,
                       "ctx->constants.mem_95997") != 0)
        return 1;
    if (memblock_unref(ctx, &ctx->constants.mem_95999,
                       "ctx->constants.mem_95999") != 0)
        return 1;
    if (memblock_unref(ctx, &ctx->constants.mem_96001,
                       "ctx->constants.mem_96001") != 0)
        return 1;
    if (memblock_unref(ctx, &ctx->constants.mem_96033,
                       "ctx->constants.mem_96033") != 0)
        return 1;
    if (memblock_unref(ctx, &ctx->constants.mem_96045,
                       "ctx->constants.mem_96045") != 0)
        return 1;
    if (memblock_unref(ctx, &ctx->constants.mem_96047,
                       "ctx->constants.mem_96047") != 0)
        return 1;
    if (memblock_unref(ctx, &ctx->constants.mem_96069,
                       "ctx->constants.mem_96069") != 0)
        return 1;
    if (memblock_unref(ctx, &ctx->constants.mem_96081,
                       "ctx->constants.mem_96081") != 0)
        return 1;
    if (memblock_unref(ctx, &ctx->constants.mem_96093,
                       "ctx->constants.mem_96093") != 0)
        return 1;
    if (memblock_unref(ctx, &ctx->constants.mem_96095,
                       "ctx->constants.mem_96095") != 0)
        return 1;
    if (memblock_unref(ctx, &ctx->constants.mem_96097,
                       "ctx->constants.mem_96097") != 0)
        return 1;
    if (memblock_unref(ctx, &ctx->constants.mem_96099,
                       "ctx->constants.mem_96099") != 0)
        return 1;
    if (memblock_unref(ctx, &ctx->constants.mem_96101,
                       "ctx->constants.mem_96101") != 0)
        return 1;
    if (memblock_unref(ctx, &ctx->constants.mem_96103,
                       "ctx->constants.mem_96103") != 0)
        return 1;
    if (memblock_unref(ctx, &ctx->constants.mem_96105,
                       "ctx->constants.mem_96105") != 0)
        return 1;
    if (memblock_unref(ctx, &ctx->constants.mem_96107,
                       "ctx->constants.mem_96107") != 0)
        return 1;
    if (memblock_unref(ctx, &ctx->constants.mem_96109,
                       "ctx->constants.mem_96109") != 0)
        return 1;
    if (memblock_unref(ctx, &ctx->constants.mem_96111,
                       "ctx->constants.mem_96111") != 0)
        return 1;
    if (memblock_unref(ctx, &ctx->constants.mem_96113,
                       "ctx->constants.mem_96113") != 0)
        return 1;
    if (memblock_unref(ctx, &ctx->constants.mem_96115,
                       "ctx->constants.mem_96115") != 0)
        return 1;
    if (memblock_unref(ctx, &ctx->constants.mem_96117,
                       "ctx->constants.mem_96117") != 0)
        return 1;
    if (memblock_unref(ctx, &ctx->constants.mem_96119,
                       "ctx->constants.mem_96119") != 0)
        return 1;
    if (memblock_unref(ctx, &ctx->constants.mem_96121,
                       "ctx->constants.mem_96121") != 0)
        return 1;
    if (memblock_unref(ctx, &ctx->constants.mem_96123,
                       "ctx->constants.mem_96123") != 0)
        return 1;
    if (memblock_unref(ctx, &ctx->constants.mem_96125,
                       "ctx->constants.mem_96125") != 0)
        return 1;
    return 0;
}
struct futhark_i32_2d {
    struct memblock mem;
    int64_t shape[2];
};
struct futhark_i32_2d *futhark_new_i32_2d(struct futhark_context *ctx, const
                                          int32_t *data, int64_t dim0,
                                          int64_t dim1)
{
    struct futhark_i32_2d *bad = NULL;
    struct futhark_i32_2d *arr =
                          (struct futhark_i32_2d *) malloc(sizeof(struct futhark_i32_2d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    if (memblock_alloc(ctx, &arr->mem, dim0 * dim1 * 4, "arr->mem"))
        return NULL;
    arr->shape[0] = dim0;
    arr->shape[1] = dim1;
    if ((size_t) (dim0 * dim1) * 4 > 0)
        memmove(arr->mem.mem + 0, data + 0, (size_t) (dim0 * dim1) * 4);
    lock_unlock(&ctx->lock);
    return arr;
}
struct futhark_i32_2d *futhark_new_raw_i32_2d(struct futhark_context *ctx, const
                                              unsigned char *data,
                                              int64_t offset, int64_t dim0,
                                              int64_t dim1)
{
    struct futhark_i32_2d *bad = NULL;
    struct futhark_i32_2d *arr =
                          (struct futhark_i32_2d *) malloc(sizeof(struct futhark_i32_2d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    if (memblock_alloc(ctx, &arr->mem, dim0 * dim1 * 4, "arr->mem"))
        return NULL;
    arr->shape[0] = dim0;
    arr->shape[1] = dim1;
    if ((size_t) (dim0 * dim1) * 4 > 0)
        memmove(arr->mem.mem + 0, data + offset, (size_t) (dim0 * dim1) * 4);
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_i32_2d(struct futhark_context *ctx, struct futhark_i32_2d *arr)
{
    lock_lock(&ctx->lock);
    if (memblock_unref(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_i32_2d(struct futhark_context *ctx,
                          struct futhark_i32_2d *arr, int32_t *data)
{
    lock_lock(&ctx->lock);
    if ((size_t) (arr->shape[0] * arr->shape[1]) * 4 > 0)
        memmove(data + 0, arr->mem.mem + 0, (size_t) (arr->shape[0] *
                                                      arr->shape[1]) * 4);
    lock_unlock(&ctx->lock);
    return 0;
}
unsigned char *futhark_values_raw_i32_2d(struct futhark_context *ctx,
                                         struct futhark_i32_2d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_i32_2d(struct futhark_context *ctx,
                                    struct futhark_i32_2d *arr)
{
    (void) ctx;
    return arr->shape;
}
struct futhark_f64_1d {
    struct memblock mem;
    int64_t shape[1];
};
struct futhark_f64_1d *futhark_new_f64_1d(struct futhark_context *ctx, const
                                          double *data, int64_t dim0)
{
    struct futhark_f64_1d *bad = NULL;
    struct futhark_f64_1d *arr =
                          (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    if (memblock_alloc(ctx, &arr->mem, dim0 * 8, "arr->mem"))
        return NULL;
    arr->shape[0] = dim0;
    if ((size_t) dim0 * 8 > 0)
        memmove(arr->mem.mem + 0, data + 0, (size_t) dim0 * 8);
    lock_unlock(&ctx->lock);
    return arr;
}
struct futhark_f64_1d *futhark_new_raw_f64_1d(struct futhark_context *ctx, const
                                              unsigned char *data,
                                              int64_t offset, int64_t dim0)
{
    struct futhark_f64_1d *bad = NULL;
    struct futhark_f64_1d *arr =
                          (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    if (memblock_alloc(ctx, &arr->mem, dim0 * 8, "arr->mem"))
        return NULL;
    arr->shape[0] = dim0;
    if ((size_t) dim0 * 8 > 0)
        memmove(arr->mem.mem + 0, data + offset, (size_t) dim0 * 8);
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr)
{
    lock_lock(&ctx->lock);
    if (memblock_unref(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_f64_1d(struct futhark_context *ctx,
                          struct futhark_f64_1d *arr, double *data)
{
    lock_lock(&ctx->lock);
    if ((size_t) arr->shape[0] * 8 > 0)
        memmove(data + 0, arr->mem.mem + 0, (size_t) arr->shape[0] * 8);
    lock_unlock(&ctx->lock);
    return 0;
}
unsigned char *futhark_values_raw_f64_1d(struct futhark_context *ctx,
                                         struct futhark_f64_1d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_f64_1d(struct futhark_context *ctx,
                                    struct futhark_f64_1d *arr)
{
    (void) ctx;
    return arr->shape;
}
struct futhark_f64_3d {
    struct memblock mem;
    int64_t shape[3];
};
struct futhark_f64_3d *futhark_new_f64_3d(struct futhark_context *ctx, const
                                          double *data, int64_t dim0,
                                          int64_t dim1, int64_t dim2)
{
    struct futhark_f64_3d *bad = NULL;
    struct futhark_f64_3d *arr =
                          (struct futhark_f64_3d *) malloc(sizeof(struct futhark_f64_3d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    if (memblock_alloc(ctx, &arr->mem, dim0 * dim1 * dim2 * 8, "arr->mem"))
        return NULL;
    arr->shape[0] = dim0;
    arr->shape[1] = dim1;
    arr->shape[2] = dim2;
    if ((size_t) (dim0 * dim1 * dim2) * 8 > 0)
        memmove(arr->mem.mem + 0, data + 0, (size_t) (dim0 * dim1 * dim2) * 8);
    lock_unlock(&ctx->lock);
    return arr;
}
struct futhark_f64_3d *futhark_new_raw_f64_3d(struct futhark_context *ctx, const
                                              unsigned char *data,
                                              int64_t offset, int64_t dim0,
                                              int64_t dim1, int64_t dim2)
{
    struct futhark_f64_3d *bad = NULL;
    struct futhark_f64_3d *arr =
                          (struct futhark_f64_3d *) malloc(sizeof(struct futhark_f64_3d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    if (memblock_alloc(ctx, &arr->mem, dim0 * dim1 * dim2 * 8, "arr->mem"))
        return NULL;
    arr->shape[0] = dim0;
    arr->shape[1] = dim1;
    arr->shape[2] = dim2;
    if ((size_t) (dim0 * dim1 * dim2) * 8 > 0)
        memmove(arr->mem.mem + 0, data + offset, (size_t) (dim0 * dim1 * dim2) *
                8);
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_f64_3d(struct futhark_context *ctx, struct futhark_f64_3d *arr)
{
    lock_lock(&ctx->lock);
    if (memblock_unref(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_f64_3d(struct futhark_context *ctx,
                          struct futhark_f64_3d *arr, double *data)
{
    lock_lock(&ctx->lock);
    if ((size_t) (arr->shape[0] * arr->shape[1] * arr->shape[2]) * 8 > 0)
        memmove(data + 0, arr->mem.mem + 0, (size_t) (arr->shape[0] *
                                                      arr->shape[1] *
                                                      arr->shape[2]) * 8);
    lock_unlock(&ctx->lock);
    return 0;
}
unsigned char *futhark_values_raw_f64_3d(struct futhark_context *ctx,
                                         struct futhark_f64_3d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_f64_3d(struct futhark_context *ctx,
                                    struct futhark_f64_3d *arr)
{
    (void) ctx;
    return arr->shape;
}

static int futrts_entry_diffusion_sample(struct futhark_context *ctx,
                                         struct memblock *mem_out_p_114731,
                                         struct memblock beta_mem_96126,
                                         struct memblock alpha_mem_96127,
                                         struct memblock alpha_bar_mem_96128,
                                         int64_t dz2082U_51162,
                                         int64_t num_imgs_51163,
                                         int32_t x_seed_51167,
                                         int32_t eps_seed_51168,
                                         int64_t denoise_steps_51169)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_96146_cached_sizze_114732 = 0;
    unsigned char *mem_96146 = NULL;
    int64_t mem_96171_cached_sizze_114733 = 0;
    unsigned char *mem_96171 = NULL;
    int64_t mem_96225_cached_sizze_114734 = 0;
    unsigned char *mem_96225 = NULL;
    int64_t mem_96227_cached_sizze_114735 = 0;
    unsigned char *mem_96227 = NULL;
    int64_t mem_96249_cached_sizze_114736 = 0;
    unsigned char *mem_96249 = NULL;
    int64_t mem_96261_cached_sizze_114737 = 0;
    unsigned char *mem_96261 = NULL;
    int64_t mem_96273_cached_sizze_114738 = 0;
    unsigned char *mem_96273 = NULL;
    int64_t mem_96285_cached_sizze_114739 = 0;
    unsigned char *mem_96285 = NULL;
    int64_t mem_96313_cached_sizze_114740 = 0;
    unsigned char *mem_96313 = NULL;
    int64_t mem_96353_cached_sizze_114741 = 0;
    unsigned char *mem_96353 = NULL;
    int64_t mem_96355_cached_sizze_114742 = 0;
    unsigned char *mem_96355 = NULL;
    int64_t mem_96407_cached_sizze_114743 = 0;
    unsigned char *mem_96407 = NULL;
    int64_t mem_96447_cached_sizze_114744 = 0;
    unsigned char *mem_96447 = NULL;
    int64_t mem_96531_cached_sizze_114745 = 0;
    unsigned char *mem_96531 = NULL;
    int64_t mem_96583_cached_sizze_114746 = 0;
    unsigned char *mem_96583 = NULL;
    int64_t mem_96623_cached_sizze_114747 = 0;
    unsigned char *mem_96623 = NULL;
    int64_t mem_96707_cached_sizze_114748 = 0;
    unsigned char *mem_96707 = NULL;
    int64_t mem_96737_cached_sizze_114749 = 0;
    unsigned char *mem_96737 = NULL;
    int64_t mem_96739_cached_sizze_114750 = 0;
    unsigned char *mem_96739 = NULL;
    int64_t mem_96761_cached_sizze_114751 = 0;
    unsigned char *mem_96761 = NULL;
    int64_t mem_96774_cached_sizze_114752 = 0;
    unsigned char *mem_96774 = NULL;
    int64_t mem_96885_cached_sizze_114753 = 0;
    unsigned char *mem_96885 = NULL;
    int64_t mem_96937_cached_sizze_114754 = 0;
    unsigned char *mem_96937 = NULL;
    int64_t mem_96977_cached_sizze_114755 = 0;
    unsigned char *mem_96977 = NULL;
    int64_t mem_97061_cached_sizze_114756 = 0;
    unsigned char *mem_97061 = NULL;
    int64_t mem_97091_cached_sizze_114757 = 0;
    unsigned char *mem_97091 = NULL;
    int64_t mem_97093_cached_sizze_114758 = 0;
    unsigned char *mem_97093 = NULL;
    int64_t mem_97115_cached_sizze_114759 = 0;
    unsigned char *mem_97115 = NULL;
    int64_t mem_97117_cached_sizze_114760 = 0;
    unsigned char *mem_97117 = NULL;
    int64_t mem_97283_cached_sizze_114761 = 0;
    unsigned char *mem_97283 = NULL;
    int64_t mem_97335_cached_sizze_114762 = 0;
    unsigned char *mem_97335 = NULL;
    int64_t mem_97375_cached_sizze_114763 = 0;
    unsigned char *mem_97375 = NULL;
    int64_t mem_97459_cached_sizze_114764 = 0;
    unsigned char *mem_97459 = NULL;
    int64_t mem_97489_cached_sizze_114765 = 0;
    unsigned char *mem_97489 = NULL;
    int64_t mem_97491_cached_sizze_114766 = 0;
    unsigned char *mem_97491 = NULL;
    int64_t mem_97513_cached_sizze_114767 = 0;
    unsigned char *mem_97513 = NULL;
    int64_t mem_97526_cached_sizze_114768 = 0;
    unsigned char *mem_97526 = NULL;
    int64_t mem_97637_cached_sizze_114769 = 0;
    unsigned char *mem_97637 = NULL;
    int64_t mem_97689_cached_sizze_114770 = 0;
    unsigned char *mem_97689 = NULL;
    int64_t mem_97729_cached_sizze_114771 = 0;
    unsigned char *mem_97729 = NULL;
    int64_t mem_97813_cached_sizze_114772 = 0;
    unsigned char *mem_97813 = NULL;
    int64_t mem_97843_cached_sizze_114773 = 0;
    unsigned char *mem_97843 = NULL;
    int64_t mem_97845_cached_sizze_114774 = 0;
    unsigned char *mem_97845 = NULL;
    int64_t mem_97867_cached_sizze_114775 = 0;
    unsigned char *mem_97867 = NULL;
    int64_t mem_97951_cached_sizze_114776 = 0;
    unsigned char *mem_97951 = NULL;
    int64_t mem_98035_cached_sizze_114777 = 0;
    unsigned char *mem_98035 = NULL;
    int64_t mem_98087_cached_sizze_114778 = 0;
    unsigned char *mem_98087 = NULL;
    int64_t mem_98127_cached_sizze_114779 = 0;
    unsigned char *mem_98127 = NULL;
    int64_t mem_98211_cached_sizze_114780 = 0;
    unsigned char *mem_98211 = NULL;
    int64_t mem_98241_cached_sizze_114781 = 0;
    unsigned char *mem_98241 = NULL;
    int64_t mem_98243_cached_sizze_114782 = 0;
    unsigned char *mem_98243 = NULL;
    int64_t mem_98265_cached_sizze_114783 = 0;
    unsigned char *mem_98265 = NULL;
    int64_t mem_98278_cached_sizze_114784 = 0;
    unsigned char *mem_98278 = NULL;
    int64_t mem_98389_cached_sizze_114785 = 0;
    unsigned char *mem_98389 = NULL;
    int64_t mem_98441_cached_sizze_114786 = 0;
    unsigned char *mem_98441 = NULL;
    int64_t mem_98481_cached_sizze_114787 = 0;
    unsigned char *mem_98481 = NULL;
    int64_t mem_98565_cached_sizze_114788 = 0;
    unsigned char *mem_98565 = NULL;
    int64_t mem_98595_cached_sizze_114789 = 0;
    unsigned char *mem_98595 = NULL;
    int64_t mem_98597_cached_sizze_114790 = 0;
    unsigned char *mem_98597 = NULL;
    int64_t mem_98619_cached_sizze_114791 = 0;
    unsigned char *mem_98619 = NULL;
    int64_t mem_98703_cached_sizze_114792 = 0;
    unsigned char *mem_98703 = NULL;
    int64_t mem_98787_cached_sizze_114793 = 0;
    unsigned char *mem_98787 = NULL;
    int64_t mem_98839_cached_sizze_114794 = 0;
    unsigned char *mem_98839 = NULL;
    int64_t mem_98879_cached_sizze_114795 = 0;
    unsigned char *mem_98879 = NULL;
    int64_t mem_98963_cached_sizze_114796 = 0;
    unsigned char *mem_98963 = NULL;
    int64_t mem_98993_cached_sizze_114797 = 0;
    unsigned char *mem_98993 = NULL;
    int64_t mem_98995_cached_sizze_114798 = 0;
    unsigned char *mem_98995 = NULL;
    int64_t mem_99017_cached_sizze_114799 = 0;
    unsigned char *mem_99017 = NULL;
    int64_t mem_99030_cached_sizze_114800 = 0;
    unsigned char *mem_99030 = NULL;
    int64_t mem_99141_cached_sizze_114801 = 0;
    unsigned char *mem_99141 = NULL;
    int64_t mem_99193_cached_sizze_114802 = 0;
    unsigned char *mem_99193 = NULL;
    int64_t mem_99233_cached_sizze_114803 = 0;
    unsigned char *mem_99233 = NULL;
    int64_t mem_99317_cached_sizze_114804 = 0;
    unsigned char *mem_99317 = NULL;
    int64_t mem_99347_cached_sizze_114805 = 0;
    unsigned char *mem_99347 = NULL;
    int64_t mem_99349_cached_sizze_114806 = 0;
    unsigned char *mem_99349 = NULL;
    int64_t mem_99371_cached_sizze_114807 = 0;
    unsigned char *mem_99371 = NULL;
    int64_t mem_99455_cached_sizze_114808 = 0;
    unsigned char *mem_99455 = NULL;
    int64_t mem_99507_cached_sizze_114809 = 0;
    unsigned char *mem_99507 = NULL;
    int64_t mem_99521_cached_sizze_114810 = 0;
    unsigned char *mem_99521 = NULL;
    struct memblock mem_99622;
    
    mem_99622.references = NULL;
    
    struct memblock mem_param_tmp_113574;
    
    mem_param_tmp_113574.references = NULL;
    
    struct memblock mem_99519;
    
    mem_99519.references = NULL;
    
    struct memblock mem_99533;
    
    mem_99533.references = NULL;
    
    struct memblock ext_mem_99535;
    
    ext_mem_99535.references = NULL;
    
    struct memblock mem_96300;
    
    mem_96300.references = NULL;
    
    struct memblock mem_param_96223;
    
    mem_param_96223.references = NULL;
    
    struct memblock ext_mem_99617;
    
    ext_mem_99617.references = NULL;
    
    struct memblock mem_96133;
    
    mem_96133.references = NULL;
    
    struct memblock mem_out_113560;
    
    mem_out_113560.references = NULL;
    
    struct memblock mem_95769 = ctx->constants.mem_95769;
    struct memblock mem_95781 = ctx->constants.mem_95781;
    struct memblock mem_95783 = ctx->constants.mem_95783;
    struct memblock mem_95785 = ctx->constants.mem_95785;
    struct memblock mem_95787 = ctx->constants.mem_95787;
    struct memblock mem_95789 = ctx->constants.mem_95789;
    struct memblock mem_95841 = ctx->constants.mem_95841;
    struct memblock mem_95853 = ctx->constants.mem_95853;
    struct memblock mem_95855 = ctx->constants.mem_95855;
    struct memblock mem_95857 = ctx->constants.mem_95857;
    struct memblock mem_95859 = ctx->constants.mem_95859;
    struct memblock mem_95861 = ctx->constants.mem_95861;
    struct memblock mem_95863 = ctx->constants.mem_95863;
    struct memblock mem_95925 = ctx->constants.mem_95925;
    struct memblock mem_95927 = ctx->constants.mem_95927;
    struct memblock mem_95949 = ctx->constants.mem_95949;
    struct memblock mem_95951 = ctx->constants.mem_95951;
    struct memblock mem_95953 = ctx->constants.mem_95953;
    struct memblock mem_95985 = ctx->constants.mem_95985;
    struct memblock mem_95997 = ctx->constants.mem_95997;
    struct memblock mem_95999 = ctx->constants.mem_95999;
    struct memblock mem_96001 = ctx->constants.mem_96001;
    struct memblock mem_96033 = ctx->constants.mem_96033;
    struct memblock mem_96045 = ctx->constants.mem_96045;
    struct memblock mem_96047 = ctx->constants.mem_96047;
    struct memblock mem_96069 = ctx->constants.mem_96069;
    struct memblock mem_96081 = ctx->constants.mem_96081;
    double zp_res_61110 = ctx->constants.zp_res_61110;
    struct memblock mem_96093 = ctx->constants.mem_96093;
    struct memblock mem_96095 = ctx->constants.mem_96095;
    struct memblock mem_96097 = ctx->constants.mem_96097;
    struct memblock mem_96099 = ctx->constants.mem_96099;
    struct memblock mem_96101 = ctx->constants.mem_96101;
    struct memblock mem_96103 = ctx->constants.mem_96103;
    struct memblock mem_96105 = ctx->constants.mem_96105;
    struct memblock mem_96107 = ctx->constants.mem_96107;
    struct memblock mem_96109 = ctx->constants.mem_96109;
    struct memblock mem_96111 = ctx->constants.mem_96111;
    struct memblock mem_96113 = ctx->constants.mem_96113;
    struct memblock mem_96115 = ctx->constants.mem_96115;
    struct memblock mem_96117 = ctx->constants.mem_96117;
    struct memblock mem_96119 = ctx->constants.mem_96119;
    struct memblock mem_96121 = ctx->constants.mem_96121;
    struct memblock mem_96123 = ctx->constants.mem_96123;
    struct memblock mem_96125 = ctx->constants.mem_96125;
    int32_t unsign_arg_56819 = 5460 ^ x_seed_51167;
    int32_t unsign_arg_56820 = mul32(48271, unsign_arg_56819);
    int32_t unsign_arg_56821 = umod32(unsign_arg_56820, 2147483647);
    int32_t unsign_arg_56822 = mul32(48271, unsign_arg_56821);
    int32_t unsign_arg_56823 = umod32(unsign_arg_56822, 2147483647);
    bool bounds_invalid_upwards_56824 = slt64(num_imgs_51163, (int64_t) 0);
    bool valid_56825 = !bounds_invalid_upwards_56824;
    bool range_valid_c_56826;
    
    if (!valid_56825) {
        set_error(ctx,
                  msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                            "Range ", (long long) (int64_t) 0, "..",
                            (long long) (int64_t) 1, "..<",
                            (long long) num_imgs_51163, " is invalid.",
                            "-> #0  /prelude/array.fut:95:3-10\n   #1  /prelude/array.fut:200:11-16\n   #2  ../gen_random/lib/github.com/diku-dk/cpprandom/random.fut:174:8-56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t binop_y_96131 = (int64_t) 6272 * num_imgs_51163;
    int64_t bytes_96132 = smax64((int64_t) 0, binop_y_96131);
    
    if (memblock_alloc(ctx, &mem_96133, bytes_96132, "mem_96133")) {
        err = 1;
        goto cleanup;
    }
    if (mem_96146_cached_sizze_114732 < (int64_t) 6272) {
        err = lexical_realloc(ctx, &mem_96146, &mem_96146_cached_sizze_114732,
                              (int64_t) 6272);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_84707 = 0; i_84707 < num_imgs_51163; i_84707++) {
        int32_t i64_res_72031 = sext_i64_i32(i_84707);
        int32_t x_72032 = lshr32(i64_res_72031, 16);
        int32_t x_72033 = i64_res_72031 ^ x_72032;
        int32_t x_72034 = mul32(73244475, x_72033);
        int32_t x_72035 = lshr32(x_72034, 16);
        int32_t x_72036 = x_72034 ^ x_72035;
        int32_t x_72037 = mul32(73244475, x_72036);
        int32_t x_72038 = lshr32(x_72037, 16);
        int32_t x_72039 = x_72037 ^ x_72038;
        int32_t unsign_arg_72040 = unsign_arg_56823 ^ x_72039;
        int32_t unsign_arg_72042 = mul32(48271, unsign_arg_72040);
        int32_t unsign_arg_72043 = umod32(unsign_arg_72042, 2147483647);
        bool zgze_res_72044 = ule32(2147000000, unsign_arg_72043);
        bool defunc_0_f_res_f_res_72045;
        int32_t defunc_0_f_res_f_res_72046;
        int32_t defunc_0_f_res_f_res_72047;
        bool loop_while_72048;
        int32_t rng_72049;
        int32_t x_72050;
        
        loop_while_72048 = zgze_res_72044;
        rng_72049 = unsign_arg_72043;
        x_72050 = unsign_arg_72043;
        while (loop_while_72048) {
            int32_t unsign_arg_72051 = mul32(48271, rng_72049);
            int32_t unsign_arg_72052 = umod32(unsign_arg_72051, 2147483647);
            bool zgze_res_72053 = ule32(2147000000, unsign_arg_72052);
            bool loop_while_tmp_113562 = zgze_res_72053;
            int32_t rng_tmp_113563 = unsign_arg_72052;
            int32_t x_tmp_113564 = unsign_arg_72052;
            
            loop_while_72048 = loop_while_tmp_113562;
            rng_72049 = rng_tmp_113563;
            x_72050 = x_tmp_113564;
        }
        defunc_0_f_res_f_res_72045 = loop_while_72048;
        defunc_0_f_res_f_res_72046 = rng_72049;
        defunc_0_f_res_f_res_72047 = x_72050;
        
        int32_t unsign_arg_72054 = umod32(defunc_0_f_res_f_res_72047, 1000000);
        int64_t to_i64_res_72055 = zext_i32_i64(unsign_arg_72054);
        int32_t defunc_0_f_res_72057 = sext_i64_i32(to_i64_res_72055);
        int32_t unsign_arg_72059 = 5460 ^ defunc_0_f_res_72057;
        int32_t unsign_arg_72060 = mul32(48271, unsign_arg_72059);
        int32_t unsign_arg_72061 = umod32(unsign_arg_72060, 2147483647);
        int32_t unsign_arg_72062 = mul32(48271, unsign_arg_72061);
        int32_t unsign_arg_72063 = umod32(unsign_arg_72062, 2147483647);
        
        for (int32_t i_87111 = 0; i_87111 < 784; i_87111++) {
            int64_t i_84703 = sext_i32_i64(i_87111);
            int32_t x_72096 = lshr32(i_87111, 16);
            int32_t x_72097 = x_72096 ^ i_87111;
            int32_t x_72098 = mul32(73244475, x_72097);
            int32_t x_72099 = lshr32(x_72098, 16);
            int32_t x_72100 = x_72098 ^ x_72099;
            int32_t x_72101 = mul32(73244475, x_72100);
            int32_t x_72102 = lshr32(x_72101, 16);
            int32_t x_72103 = x_72101 ^ x_72102;
            int32_t unsign_arg_72104 = unsign_arg_72063 ^ x_72103;
            int32_t unsign_arg_72106 = mul32(48271, unsign_arg_72104);
            int32_t unsign_arg_72107 = umod32(unsign_arg_72106, 2147483647);
            int32_t unsign_arg_72108 = mul32(48271, unsign_arg_72107);
            int32_t unsign_arg_72109 = umod32(unsign_arg_72108, 2147483647);
            double u64_res_72110 = uitofp_i32_f64(unsign_arg_72107);
            double zs_res_72111 = u64_res_72110 / 2.147483647e9;
            double u64_res_72112 = uitofp_i32_f64(unsign_arg_72109);
            double zs_res_72113 = u64_res_72112 / 2.147483647e9;
            double log_res_72114 = futrts_log64(zs_res_72111);
            double zt_res_72115 = -2.0 * log_res_72114;
            double sqrt_res_72116 = futrts_sqrt64(zt_res_72115);
            double zt_res_72117 = 6.283185307179586 * zs_res_72113;
            double cos_res_72118 = futrts_cos64(zt_res_72117);
            double zt_res_72119 = sqrt_res_72116 * cos_res_72118;
            
            ((double *) mem_96146)[i_84703] = zt_res_72119;
        }
        if ((int64_t) 6272 > 0)
            memmove(mem_96133.mem + i_84707 * (int64_t) 784 * (int64_t) 8,
                    mem_96146 + (int64_t) 0, (int64_t) 6272);
    }
    
    int32_t unsign_arg_56905 = 5460 ^ eps_seed_51168;
    int32_t unsign_arg_56906 = mul32(48271, unsign_arg_56905);
    int32_t unsign_arg_56907 = umod32(unsign_arg_56906, 2147483647);
    int32_t unsign_arg_56908 = mul32(48271, unsign_arg_56907);
    int32_t unsign_arg_56909 = umod32(unsign_arg_56908, 2147483647);
    bool bounds_invalid_upwards_56910 = slt64(denoise_steps_51169, (int64_t) 0);
    bool valid_56911 = !bounds_invalid_upwards_56910;
    bool range_valid_c_56912;
    
    if (!valid_56911) {
        set_error(ctx,
                  msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                            "Range ", (long long) (int64_t) 0, "..",
                            (long long) (int64_t) 1, "..<",
                            (long long) denoise_steps_51169, " is invalid.",
                            "-> #0  /prelude/array.fut:95:3-10\n   #1  /prelude/array.fut:200:11-16\n   #2  ../gen_random/lib/github.com/diku-dk/cpprandom/random.fut:174:8-56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t binop_x_96168 = num_imgs_51163 * denoise_steps_51169;
    int64_t binop_y_96169 = (int64_t) 4 * binop_x_96168;
    int64_t bytes_96170 = smax64((int64_t) 0, binop_y_96169);
    
    if (mem_96171_cached_sizze_114733 < bytes_96170) {
        err = lexical_realloc(ctx, &mem_96171, &mem_96171_cached_sizze_114733,
                              bytes_96170);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_84715 = 0; i_84715 < denoise_steps_51169; i_84715++) {
        int32_t i64_res_71874 = sext_i64_i32(i_84715);
        int32_t x_71875 = lshr32(i64_res_71874, 16);
        int32_t x_71876 = i64_res_71874 ^ x_71875;
        int32_t x_71877 = mul32(73244475, x_71876);
        int32_t x_71878 = lshr32(x_71877, 16);
        int32_t x_71879 = x_71877 ^ x_71878;
        int32_t x_71880 = mul32(73244475, x_71879);
        int32_t x_71881 = lshr32(x_71880, 16);
        int32_t x_71882 = x_71880 ^ x_71881;
        int32_t unsign_arg_71883 = unsign_arg_56909 ^ x_71882;
        int32_t unsign_arg_71885 = mul32(48271, unsign_arg_71883);
        int32_t unsign_arg_71886 = umod32(unsign_arg_71885, 2147483647);
        bool zgze_res_71887 = ule32(2147000000, unsign_arg_71886);
        bool defunc_0_f_res_f_res_71888;
        int32_t defunc_0_f_res_f_res_71889;
        int32_t defunc_0_f_res_f_res_71890;
        bool loop_while_71891;
        int32_t rng_71892;
        int32_t x_71893;
        
        loop_while_71891 = zgze_res_71887;
        rng_71892 = unsign_arg_71886;
        x_71893 = unsign_arg_71886;
        while (loop_while_71891) {
            int32_t unsign_arg_71894 = mul32(48271, rng_71892);
            int32_t unsign_arg_71895 = umod32(unsign_arg_71894, 2147483647);
            bool zgze_res_71896 = ule32(2147000000, unsign_arg_71895);
            bool loop_while_tmp_113567 = zgze_res_71896;
            int32_t rng_tmp_113568 = unsign_arg_71895;
            int32_t x_tmp_113569 = unsign_arg_71895;
            
            loop_while_71891 = loop_while_tmp_113567;
            rng_71892 = rng_tmp_113568;
            x_71893 = x_tmp_113569;
        }
        defunc_0_f_res_f_res_71888 = loop_while_71891;
        defunc_0_f_res_f_res_71889 = rng_71892;
        defunc_0_f_res_f_res_71890 = x_71893;
        
        int32_t unsign_arg_71897 = umod32(defunc_0_f_res_f_res_71890, 1000000);
        int64_t to_i64_res_71898 = zext_i32_i64(unsign_arg_71897);
        int32_t defunc_0_f_res_71900 = sext_i64_i32(to_i64_res_71898);
        int32_t unsign_arg_71902 = 5460 ^ defunc_0_f_res_71900;
        int32_t unsign_arg_71903 = mul32(48271, unsign_arg_71902);
        int32_t unsign_arg_71904 = umod32(unsign_arg_71903, 2147483647);
        int32_t unsign_arg_71905 = mul32(48271, unsign_arg_71904);
        int32_t unsign_arg_71906 = umod32(unsign_arg_71905, 2147483647);
        
        for (int64_t i_84711 = 0; i_84711 < num_imgs_51163; i_84711++) {
            int32_t i64_res_72141 = sext_i64_i32(i_84711);
            int32_t x_72142 = lshr32(i64_res_72141, 16);
            int32_t x_72143 = i64_res_72141 ^ x_72142;
            int32_t x_72144 = mul32(73244475, x_72143);
            int32_t x_72145 = lshr32(x_72144, 16);
            int32_t x_72146 = x_72144 ^ x_72145;
            int32_t x_72147 = mul32(73244475, x_72146);
            int32_t x_72148 = lshr32(x_72147, 16);
            int32_t x_72149 = x_72147 ^ x_72148;
            int32_t unsign_arg_72150 = unsign_arg_71906 ^ x_72149;
            int32_t unsign_arg_72152 = mul32(48271, unsign_arg_72150);
            int32_t unsign_arg_72153 = umod32(unsign_arg_72152, 2147483647);
            bool zgze_res_72154 = ule32(2147000000, unsign_arg_72153);
            bool defunc_0_f_res_f_res_72155;
            int32_t defunc_0_f_res_f_res_72156;
            int32_t defunc_0_f_res_f_res_72157;
            bool loop_while_72158;
            int32_t rng_72159;
            int32_t x_72160;
            
            loop_while_72158 = zgze_res_72154;
            rng_72159 = unsign_arg_72153;
            x_72160 = unsign_arg_72153;
            while (loop_while_72158) {
                int32_t unsign_arg_72161 = mul32(48271, rng_72159);
                int32_t unsign_arg_72162 = umod32(unsign_arg_72161, 2147483647);
                bool zgze_res_72163 = ule32(2147000000, unsign_arg_72162);
                bool loop_while_tmp_113571 = zgze_res_72163;
                int32_t rng_tmp_113572 = unsign_arg_72162;
                int32_t x_tmp_113573 = unsign_arg_72162;
                
                loop_while_72158 = loop_while_tmp_113571;
                rng_72159 = rng_tmp_113572;
                x_72160 = x_tmp_113573;
            }
            defunc_0_f_res_f_res_72155 = loop_while_72158;
            defunc_0_f_res_f_res_72156 = rng_72159;
            defunc_0_f_res_f_res_72157 = x_72160;
            
            int32_t unsign_arg_72164 = umod32(defunc_0_f_res_f_res_72157,
                                              1000000);
            int64_t to_i64_res_72165 = zext_i32_i64(unsign_arg_72164);
            int32_t defunc_0_f_res_72167 = sext_i64_i32(to_i64_res_72165);
            
            ((int32_t *) mem_96171)[i_84715 * num_imgs_51163 + i_84711] =
                defunc_0_f_res_72167;
        }
    }
    if (mem_96225_cached_sizze_114734 < (int64_t) 1024) {
        err = lexical_realloc(ctx, &mem_96225, &mem_96225_cached_sizze_114734,
                              (int64_t) 1024);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_96227_cached_sizze_114735 < (int64_t) 1024) {
        err = lexical_realloc(ctx, &mem_96227, &mem_96227_cached_sizze_114735,
                              (int64_t) 1024);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_96249_cached_sizze_114736 < (int64_t) 1024) {
        err = lexical_realloc(ctx, &mem_96249, &mem_96249_cached_sizze_114736,
                              (int64_t) 1024);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_96261_cached_sizze_114737 < (int64_t) 2048) {
        err = lexical_realloc(ctx, &mem_96261, &mem_96261_cached_sizze_114737,
                              (int64_t) 2048);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_96273_cached_sizze_114738 < (int64_t) 1024) {
        err = lexical_realloc(ctx, &mem_96273, &mem_96273_cached_sizze_114738,
                              (int64_t) 1024);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_96285_cached_sizze_114739 < (int64_t) 512) {
        err = lexical_realloc(ctx, &mem_96285, &mem_96285_cached_sizze_114739,
                              (int64_t) 512);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_96313_cached_sizze_114740 < (int64_t) 7200) {
        err = lexical_realloc(ctx, &mem_96313, &mem_96313_cached_sizze_114740,
                              (int64_t) 7200);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_96353_cached_sizze_114741 < (int64_t) 7200) {
        err = lexical_realloc(ctx, &mem_96353, &mem_96353_cached_sizze_114741,
                              (int64_t) 7200);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_96355_cached_sizze_114742 < (int64_t) 56448) {
        err = lexical_realloc(ctx, &mem_96355, &mem_96355_cached_sizze_114742,
                              (int64_t) 56448);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_96407_cached_sizze_114743 < (int64_t) 401408) {
        err = lexical_realloc(ctx, &mem_96407, &mem_96407_cached_sizze_114743,
                              (int64_t) 401408);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_96447_cached_sizze_114744 < (int64_t) 460800) {
        err = lexical_realloc(ctx, &mem_96447, &mem_96447_cached_sizze_114744,
                              (int64_t) 460800);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_96531_cached_sizze_114745 < (int64_t) 3612672) {
        err = lexical_realloc(ctx, &mem_96531, &mem_96531_cached_sizze_114745,
                              (int64_t) 3612672);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_96583_cached_sizze_114746 < (int64_t) 802816) {
        err = lexical_realloc(ctx, &mem_96583, &mem_96583_cached_sizze_114746,
                              (int64_t) 802816);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_96623_cached_sizze_114747 < (int64_t) 802816) {
        err = lexical_realloc(ctx, &mem_96623, &mem_96623_cached_sizze_114747,
                              (int64_t) 802816);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_96707_cached_sizze_114748 < (int64_t) 802816) {
        err = lexical_realloc(ctx, &mem_96707, &mem_96707_cached_sizze_114748,
                              (int64_t) 802816);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_96737_cached_sizze_114749 < (int64_t) 256) {
        err = lexical_realloc(ctx, &mem_96737, &mem_96737_cached_sizze_114749,
                              (int64_t) 256);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_96739_cached_sizze_114750 < (int64_t) 256) {
        err = lexical_realloc(ctx, &mem_96739, &mem_96739_cached_sizze_114750,
                              (int64_t) 256);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_96761_cached_sizze_114751 < (int64_t) 921600) {
        err = lexical_realloc(ctx, &mem_96761, &mem_96761_cached_sizze_114751,
                              (int64_t) 921600);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_96774_cached_sizze_114752 < (int64_t) 6272) {
        err = lexical_realloc(ctx, &mem_96774, &mem_96774_cached_sizze_114752,
                              (int64_t) 6272);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_96885_cached_sizze_114753 < (int64_t) 7225344) {
        err = lexical_realloc(ctx, &mem_96885, &mem_96885_cached_sizze_114753,
                              (int64_t) 7225344);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_96937_cached_sizze_114754 < (int64_t) 802816) {
        err = lexical_realloc(ctx, &mem_96937, &mem_96937_cached_sizze_114754,
                              (int64_t) 802816);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_96977_cached_sizze_114755 < (int64_t) 802816) {
        err = lexical_realloc(ctx, &mem_96977, &mem_96977_cached_sizze_114755,
                              (int64_t) 802816);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_97061_cached_sizze_114756 < (int64_t) 802816) {
        err = lexical_realloc(ctx, &mem_97061, &mem_97061_cached_sizze_114756,
                              (int64_t) 802816);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_97091_cached_sizze_114757 < (int64_t) 256) {
        err = lexical_realloc(ctx, &mem_97091, &mem_97091_cached_sizze_114757,
                              (int64_t) 256);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_97093_cached_sizze_114758 < (int64_t) 256) {
        err = lexical_realloc(ctx, &mem_97093, &mem_97093_cached_sizze_114758,
                              (int64_t) 256);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_97115_cached_sizze_114759 < (int64_t) 921600) {
        err = lexical_realloc(ctx, &mem_97115, &mem_97115_cached_sizze_114759,
                              (int64_t) 921600);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_97117_cached_sizze_114760 < (int64_t) 802816) {
        err = lexical_realloc(ctx, &mem_97117, &mem_97117_cached_sizze_114760,
                              (int64_t) 802816);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_97283_cached_sizze_114761 < (int64_t) 7225344) {
        err = lexical_realloc(ctx, &mem_97283, &mem_97283_cached_sizze_114761,
                              (int64_t) 7225344);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_97335_cached_sizze_114762 < (int64_t) 1605632) {
        err = lexical_realloc(ctx, &mem_97335, &mem_97335_cached_sizze_114762,
                              (int64_t) 1605632);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_97375_cached_sizze_114763 < (int64_t) 1605632) {
        err = lexical_realloc(ctx, &mem_97375, &mem_97375_cached_sizze_114763,
                              (int64_t) 1605632);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_97459_cached_sizze_114764 < (int64_t) 1605632) {
        err = lexical_realloc(ctx, &mem_97459, &mem_97459_cached_sizze_114764,
                              (int64_t) 1605632);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_97489_cached_sizze_114765 < (int64_t) 256) {
        err = lexical_realloc(ctx, &mem_97489, &mem_97489_cached_sizze_114765,
                              (int64_t) 256);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_97491_cached_sizze_114766 < (int64_t) 256) {
        err = lexical_realloc(ctx, &mem_97491, &mem_97491_cached_sizze_114766,
                              (int64_t) 256);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_97513_cached_sizze_114767 < (int64_t) 1843200) {
        err = lexical_realloc(ctx, &mem_97513, &mem_97513_cached_sizze_114767,
                              (int64_t) 1843200);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_97526_cached_sizze_114768 < (int64_t) 6272) {
        err = lexical_realloc(ctx, &mem_97526, &mem_97526_cached_sizze_114768,
                              (int64_t) 6272);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_97637_cached_sizze_114769 < (int64_t) 14450688) {
        err = lexical_realloc(ctx, &mem_97637, &mem_97637_cached_sizze_114769,
                              (int64_t) 14450688);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_97689_cached_sizze_114770 < (int64_t) 1605632) {
        err = lexical_realloc(ctx, &mem_97689, &mem_97689_cached_sizze_114770,
                              (int64_t) 1605632);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_97729_cached_sizze_114771 < (int64_t) 1605632) {
        err = lexical_realloc(ctx, &mem_97729, &mem_97729_cached_sizze_114771,
                              (int64_t) 1605632);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_97813_cached_sizze_114772 < (int64_t) 1605632) {
        err = lexical_realloc(ctx, &mem_97813, &mem_97813_cached_sizze_114772,
                              (int64_t) 1605632);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_97843_cached_sizze_114773 < (int64_t) 256) {
        err = lexical_realloc(ctx, &mem_97843, &mem_97843_cached_sizze_114773,
                              (int64_t) 256);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_97845_cached_sizze_114774 < (int64_t) 256) {
        err = lexical_realloc(ctx, &mem_97845, &mem_97845_cached_sizze_114774,
                              (int64_t) 256);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_97867_cached_sizze_114775 < (int64_t) 1605632) {
        err = lexical_realloc(ctx, &mem_97867, &mem_97867_cached_sizze_114775,
                              (int64_t) 1605632);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_97951_cached_sizze_114776 < (int64_t) 3686400) {
        err = lexical_realloc(ctx, &mem_97951, &mem_97951_cached_sizze_114776,
                              (int64_t) 3686400);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_98035_cached_sizze_114777 < (int64_t) 28901376) {
        err = lexical_realloc(ctx, &mem_98035, &mem_98035_cached_sizze_114777,
                              (int64_t) 28901376);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_98087_cached_sizze_114778 < (int64_t) 802816) {
        err = lexical_realloc(ctx, &mem_98087, &mem_98087_cached_sizze_114778,
                              (int64_t) 802816);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_98127_cached_sizze_114779 < (int64_t) 802816) {
        err = lexical_realloc(ctx, &mem_98127, &mem_98127_cached_sizze_114779,
                              (int64_t) 802816);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_98211_cached_sizze_114780 < (int64_t) 802816) {
        err = lexical_realloc(ctx, &mem_98211, &mem_98211_cached_sizze_114780,
                              (int64_t) 802816);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_98241_cached_sizze_114781 < (int64_t) 256) {
        err = lexical_realloc(ctx, &mem_98241, &mem_98241_cached_sizze_114781,
                              (int64_t) 256);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_98243_cached_sizze_114782 < (int64_t) 256) {
        err = lexical_realloc(ctx, &mem_98243, &mem_98243_cached_sizze_114782,
                              (int64_t) 256);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_98265_cached_sizze_114783 < (int64_t) 921600) {
        err = lexical_realloc(ctx, &mem_98265, &mem_98265_cached_sizze_114783,
                              (int64_t) 921600);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_98278_cached_sizze_114784 < (int64_t) 6272) {
        err = lexical_realloc(ctx, &mem_98278, &mem_98278_cached_sizze_114784,
                              (int64_t) 6272);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_98389_cached_sizze_114785 < (int64_t) 7225344) {
        err = lexical_realloc(ctx, &mem_98389, &mem_98389_cached_sizze_114785,
                              (int64_t) 7225344);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_98441_cached_sizze_114786 < (int64_t) 802816) {
        err = lexical_realloc(ctx, &mem_98441, &mem_98441_cached_sizze_114786,
                              (int64_t) 802816);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_98481_cached_sizze_114787 < (int64_t) 802816) {
        err = lexical_realloc(ctx, &mem_98481, &mem_98481_cached_sizze_114787,
                              (int64_t) 802816);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_98565_cached_sizze_114788 < (int64_t) 802816) {
        err = lexical_realloc(ctx, &mem_98565, &mem_98565_cached_sizze_114788,
                              (int64_t) 802816);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_98595_cached_sizze_114789 < (int64_t) 256) {
        err = lexical_realloc(ctx, &mem_98595, &mem_98595_cached_sizze_114789,
                              (int64_t) 256);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_98597_cached_sizze_114790 < (int64_t) 256) {
        err = lexical_realloc(ctx, &mem_98597, &mem_98597_cached_sizze_114790,
                              (int64_t) 256);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_98619_cached_sizze_114791 < (int64_t) 802816) {
        err = lexical_realloc(ctx, &mem_98619, &mem_98619_cached_sizze_114791,
                              (int64_t) 802816);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_98703_cached_sizze_114792 < (int64_t) 1843200) {
        err = lexical_realloc(ctx, &mem_98703, &mem_98703_cached_sizze_114792,
                              (int64_t) 1843200);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_98787_cached_sizze_114793 < (int64_t) 14450688) {
        err = lexical_realloc(ctx, &mem_98787, &mem_98787_cached_sizze_114793,
                              (int64_t) 14450688);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_98839_cached_sizze_114794 < (int64_t) 401408) {
        err = lexical_realloc(ctx, &mem_98839, &mem_98839_cached_sizze_114794,
                              (int64_t) 401408);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_98879_cached_sizze_114795 < (int64_t) 401408) {
        err = lexical_realloc(ctx, &mem_98879, &mem_98879_cached_sizze_114795,
                              (int64_t) 401408);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_98963_cached_sizze_114796 < (int64_t) 401408) {
        err = lexical_realloc(ctx, &mem_98963, &mem_98963_cached_sizze_114796,
                              (int64_t) 401408);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_98993_cached_sizze_114797 < (int64_t) 256) {
        err = lexical_realloc(ctx, &mem_98993, &mem_98993_cached_sizze_114797,
                              (int64_t) 256);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_98995_cached_sizze_114798 < (int64_t) 256) {
        err = lexical_realloc(ctx, &mem_98995, &mem_98995_cached_sizze_114798,
                              (int64_t) 256);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_99017_cached_sizze_114799 < (int64_t) 460800) {
        err = lexical_realloc(ctx, &mem_99017, &mem_99017_cached_sizze_114799,
                              (int64_t) 460800);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_99030_cached_sizze_114800 < (int64_t) 6272) {
        err = lexical_realloc(ctx, &mem_99030, &mem_99030_cached_sizze_114800,
                              (int64_t) 6272);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_99141_cached_sizze_114801 < (int64_t) 3612672) {
        err = lexical_realloc(ctx, &mem_99141, &mem_99141_cached_sizze_114801,
                              (int64_t) 3612672);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_99193_cached_sizze_114802 < (int64_t) 401408) {
        err = lexical_realloc(ctx, &mem_99193, &mem_99193_cached_sizze_114802,
                              (int64_t) 401408);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_99233_cached_sizze_114803 < (int64_t) 401408) {
        err = lexical_realloc(ctx, &mem_99233, &mem_99233_cached_sizze_114803,
                              (int64_t) 401408);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_99317_cached_sizze_114804 < (int64_t) 401408) {
        err = lexical_realloc(ctx, &mem_99317, &mem_99317_cached_sizze_114804,
                              (int64_t) 401408);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_99347_cached_sizze_114805 < (int64_t) 256) {
        err = lexical_realloc(ctx, &mem_99347, &mem_99347_cached_sizze_114805,
                              (int64_t) 256);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_99349_cached_sizze_114806 < (int64_t) 256) {
        err = lexical_realloc(ctx, &mem_99349, &mem_99349_cached_sizze_114806,
                              (int64_t) 256);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_99371_cached_sizze_114807 < (int64_t) 401408) {
        err = lexical_realloc(ctx, &mem_99371, &mem_99371_cached_sizze_114807,
                              (int64_t) 401408);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_99455_cached_sizze_114808 < (int64_t) 401408) {
        err = lexical_realloc(ctx, &mem_99455, &mem_99455_cached_sizze_114808,
                              (int64_t) 401408);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_99507_cached_sizze_114809 < (int64_t) 6272) {
        err = lexical_realloc(ctx, &mem_99507, &mem_99507_cached_sizze_114809,
                              (int64_t) 6272);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (memblock_set(ctx, &mem_param_96223, &mem_96133, "mem_96133") != 0)
        return 1;
    for (int64_t t__54922 = 0; t__54922 < denoise_steps_51169; t__54922++) {
        int64_t x_54924 = sub64(denoise_steps_51169, t__54922);
        int64_t t_54925 = sub64(x_54924, (int64_t) 1);
        double i64_res_54927 = sitofp_i64_f64(t_54925);
        
        for (int32_t i_86763 = 0; i_86763 < 128; i_86763++) {
            int64_t i_84721 = sext_i32_i64(i_86763);
            double i64_res_72231 = sitofp_i32_f64(i_86763);
            double exp_arg_72232 = -7.252236513367073e-2 * i64_res_72231;
            double exp_res_72233 = futrts_exp64(exp_arg_72232);
            double defunc_0_f_res_72234 = i64_res_54927 * exp_res_72233;
            double sin_res_72236 = futrts_sin64(defunc_0_f_res_72234);
            double cos_res_72237 = futrts_cos64(defunc_0_f_res_72234);
            
            ((double *) mem_96225)[i_84721] = sin_res_72236;
            ((double *) mem_96227)[i_84721] = cos_res_72237;
        }
        
        bool x_54929 = sle64((int64_t) 0, t_54925);
        bool y_54930 = slt64(t_54925, dz2082U_51162);
        bool bounds_check_54931 = x_54929 && y_54930;
        bool index_certs_54932;
        
        if (!bounds_check_54931) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                     "Index [", (long long) t_54925,
                                     "] out of bounds for array of shape [",
                                     (long long) dz2082U_51162, "].",
                                     "-> #0  diffusion.fut:69:21-32\n   #1  diffusion.fut:89:60-152\n   #2  /prelude/soacs.fut:59:3-10\n   #3  /prelude/array.fut:200:3-17\n   #4  diffusion.fut:89:31-153\n   #5  test_diffusion.fut:62:22-116\n   #6  test_diffusion.fut:61:1-63:17\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        double alpha_bar_t_54933 =
               ((double *) alpha_bar_mem_96128.mem)[t_54925];
        double alpha_t_54934 = ((double *) alpha_mem_96127.mem)[t_54925];
        double x_54935 = 1.0 - alpha_t_54934;
        double x_54936 = 1.0 - alpha_bar_t_54933;
        double y_54937 = fpow64(x_54936, 0.5);
        double eps_coef_54938 = x_54935 / y_54937;
        double var_54939 = ((double *) beta_mem_96126.mem)[t_54925];
        bool cond_54940 = slt64((int64_t) 1, t_54925);
        double y_54941 = fpow64(alpha_t_54934, 0.5);
        double x_54942 = 1.0 / y_54941;
        double x_54943 = fpow64(var_54939, 0.5);
        
        for (int32_t i_86764 = 0; i_86764 < 128; i_86764++) {
            int64_t i_84728 = sext_i32_i64(i_86764);
            double x_72216 = ((double *) mem_95861.mem)[i_84728];
            int64_t binop_x_88658 = (int64_t) 256 * i_84728;
            double defunc_2_reduce_res_73840;
            double redout_84724 = 0.0;
            
            for (int32_t i_87098 = 0; i_87098 < 256; i_87098++) {
                int64_t i_84725 = sext_i32_i64(i_87098);
                bool index_concat_cmp_87100 = sle64((int64_t) 128, i_84725);
                double index_concat_branch_87104;
                
                if (index_concat_cmp_87100 == 1) {
                    int64_t index_concat_i_87101 = sub64(i_84725,
                                                         (int64_t) 128);
                    double index_concat_87102 =
                           ((double *) mem_96227)[index_concat_i_87101];
                    
                    index_concat_branch_87104 = index_concat_87102;
                } else {
                    double index_concat_87103 = ((double *) mem_96225)[i_84725];
                    
                    index_concat_branch_87104 = index_concat_87103;
                }
                
                int64_t new_index_88659 = i_84725 + binop_x_88658;
                double x_72240 = ((double *) mem_95927.mem)[new_index_88659];
                double defunc_1_f_res_72241 = x_72240 *
                       index_concat_branch_87104;
                double defunc_1_op_res_72224 = defunc_1_f_res_72241 +
                       redout_84724;
                double redout_tmp_113579 = defunc_1_op_res_72224;
                
                redout_84724 = redout_tmp_113579;
            }
            defunc_2_reduce_res_73840 = redout_84724;
            
            double defunc_1_f_res_72226 = x_72216 + defunc_2_reduce_res_73840;
            double max_res_72228 = fmax64(0.0, defunc_1_f_res_72226);
            
            ((double *) mem_96249)[i_84728] = max_res_72228;
        }
        for (int32_t i_86765 = 0; i_86765 < 256; i_86765++) {
            int64_t i_84734 = sext_i32_i64(i_86765);
            double x_72201 = ((double *) mem_95999.mem)[i_84734];
            int64_t binop_x_88656 = (int64_t) 256 * i_84734;
            double defunc_2_reduce_res_73841;
            double redout_84730 = 0.0;
            
            for (int32_t i_87091 = 0; i_87091 < 256; i_87091++) {
                int64_t i_84731 = sext_i32_i64(i_87091);
                bool index_concat_cmp_87093 = sle64((int64_t) 128, i_84731);
                double index_concat_branch_87097;
                
                if (index_concat_cmp_87093 == 1) {
                    int64_t index_concat_i_87094 = sub64(i_84731,
                                                         (int64_t) 128);
                    double index_concat_87095 =
                           ((double *) mem_96227)[index_concat_i_87094];
                    
                    index_concat_branch_87097 = index_concat_87095;
                } else {
                    double index_concat_87096 = ((double *) mem_96225)[i_84731];
                    
                    index_concat_branch_87097 = index_concat_87096;
                }
                
                int64_t new_index_88657 = i_84731 + binop_x_88656;
                double x_72246 = ((double *) mem_96033.mem)[new_index_88657];
                double defunc_1_f_res_72247 = x_72246 *
                       index_concat_branch_87097;
                double defunc_1_op_res_72209 = defunc_1_f_res_72247 +
                       redout_84730;
                double redout_tmp_113581 = defunc_1_op_res_72209;
                
                redout_84730 = redout_tmp_113581;
            }
            defunc_2_reduce_res_73841 = redout_84730;
            
            double defunc_1_f_res_72211 = x_72201 + defunc_2_reduce_res_73841;
            double max_res_72213 = fmax64(0.0, defunc_1_f_res_72211);
            
            ((double *) mem_96261)[i_84734] = max_res_72213;
        }
        for (int32_t i_86766 = 0; i_86766 < 128; i_86766++) {
            int64_t i_84740 = sext_i32_i64(i_86766);
            double x_72186 = ((double *) mem_95855.mem)[i_84740];
            int64_t binop_x_88654 = (int64_t) 256 * i_84740;
            double defunc_2_reduce_res_73842;
            double redout_84736 = 0.0;
            
            for (int32_t i_87084 = 0; i_87084 < 256; i_87084++) {
                int64_t i_84737 = sext_i32_i64(i_87084);
                bool index_concat_cmp_87086 = sle64((int64_t) 128, i_84737);
                double index_concat_branch_87090;
                
                if (index_concat_cmp_87086 == 1) {
                    int64_t index_concat_i_87087 = sub64(i_84737,
                                                         (int64_t) 128);
                    double index_concat_87088 =
                           ((double *) mem_96227)[index_concat_i_87087];
                    
                    index_concat_branch_87090 = index_concat_87088;
                } else {
                    double index_concat_87089 = ((double *) mem_96225)[i_84737];
                    
                    index_concat_branch_87090 = index_concat_87089;
                }
                
                int64_t new_index_88655 = i_84737 + binop_x_88654;
                double x_72252 = ((double *) mem_95925.mem)[new_index_88655];
                double defunc_1_f_res_72253 = x_72252 *
                       index_concat_branch_87090;
                double defunc_1_op_res_72194 = defunc_1_f_res_72253 +
                       redout_84736;
                double redout_tmp_113583 = defunc_1_op_res_72194;
                
                redout_84736 = redout_tmp_113583;
            }
            defunc_2_reduce_res_73842 = redout_84736;
            
            double defunc_1_f_res_72196 = x_72186 + defunc_2_reduce_res_73842;
            double max_res_72198 = fmax64(0.0, defunc_1_f_res_72196);
            
            ((double *) mem_96273)[i_84740] = max_res_72198;
        }
        for (int32_t i_86767 = 0; i_86767 < 64; i_86767++) {
            int64_t i_84746 = sext_i32_i64(i_86767);
            double x_72171 = ((double *) mem_95785.mem)[i_84746];
            int64_t binop_x_88652 = (int64_t) 256 * i_84746;
            double defunc_2_reduce_res_73843;
            double redout_84742 = 0.0;
            
            for (int32_t i_87077 = 0; i_87077 < 256; i_87077++) {
                int64_t i_84743 = sext_i32_i64(i_87077);
                bool index_concat_cmp_87079 = sle64((int64_t) 128, i_84743);
                double index_concat_branch_87083;
                
                if (index_concat_cmp_87079 == 1) {
                    int64_t index_concat_i_87080 = sub64(i_84743,
                                                         (int64_t) 128);
                    double index_concat_87081 =
                           ((double *) mem_96227)[index_concat_i_87080];
                    
                    index_concat_branch_87083 = index_concat_87081;
                } else {
                    double index_concat_87082 = ((double *) mem_96225)[i_84743];
                    
                    index_concat_branch_87083 = index_concat_87082;
                }
                
                int64_t new_index_88653 = i_84743 + binop_x_88652;
                double x_72258 = ((double *) mem_96069.mem)[new_index_88653];
                double defunc_1_f_res_72259 = x_72258 *
                       index_concat_branch_87083;
                double defunc_1_op_res_72179 = defunc_1_f_res_72259 +
                       redout_84742;
                double redout_tmp_113585 = defunc_1_op_res_72179;
                
                redout_84742 = redout_tmp_113585;
            }
            defunc_2_reduce_res_73843 = redout_84742;
            
            double defunc_1_f_res_72181 = x_72171 + defunc_2_reduce_res_73843;
            double max_res_72183 = fmax64(0.0, defunc_1_f_res_72181);
            
            ((double *) mem_96285)[i_84746] = max_res_72183;
        }
        if (memblock_alloc(ctx, &mem_96300, bytes_96132, "mem_96300")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_85337 = 0; i_85337 < num_imgs_51163; i_85337++) {
            int32_t p_sample_arg_54950 = ((int32_t *) mem_96171)[t__54922 *
                                                                 num_imgs_51163 +
                                                                 i_85337];
            
            for (int32_t i_86768 = 0; i_86768 < 30; i_86768++) {
                int64_t i_84754 = sext_i32_i64(i_86768);
                bool cond_55835 = slt64(i_84754, (int64_t) 1);
                bool cond_f_res_55836 = sle64((int64_t) 29, i_84754);
                bool x_55837 = !cond_55835;
                bool y_55838 = cond_f_res_55836 && x_55837;
                bool cond_55839 = cond_55835 || y_55838;
                bool x_55840 = !cond_55839;
                
                for (int32_t i_87070 = 0; i_87070 < 30; i_87070++) {
                    int64_t i_84750 = sext_i32_i64(i_87070);
                    bool cond_f_res_55843 = slt64(i_84750, (int64_t) 1);
                    bool y_55844 = x_55840 && cond_f_res_55843;
                    bool cond_55845 = cond_55839 || y_55844;
                    bool cond_f_res_55846 = sle64((int64_t) 29, i_84750);
                    bool x_55847 = !cond_55845;
                    bool y_55848 = cond_f_res_55846 && x_55847;
                    bool cond_55849 = cond_55845 || y_55848;
                    double defunc_0_f_res_55850;
                    
                    if (cond_55849 == 1) {
                        defunc_0_f_res_55850 = 0.0;
                    } else {
                        int64_t i_55851 = sub64(i_84754, (int64_t) 1);
                        bool x_55852 = sle64((int64_t) 0, i_55851);
                        bool y_55853 = slt64(i_55851, (int64_t) 28);
                        bool bounds_check_55854 = x_55852 && y_55853;
                        int64_t i_55855 = sub64(i_84750, (int64_t) 1);
                        bool x_55856 = sle64((int64_t) 0, i_55855);
                        bool y_55857 = slt64(i_55855, (int64_t) 28);
                        bool bounds_check_55858 = x_55856 && y_55857;
                        bool index_ok_55859 = bounds_check_55854 &&
                             bounds_check_55858;
                        bool index_certs_55860;
                        
                        if (!index_ok_55859) {
                            set_error(ctx,
                                      msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                "Index [", (long long) i_55851,
                                                ", ", (long long) i_55855,
                                                "] out of bounds for array of shape [",
                                                (long long) (int64_t) 28, "][",
                                                (long long) (int64_t) 28, "].",
                                                "-> #0  ../layers/conv2d.fut:7:91-116\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  ../layers/conv2d.fut:6:22-7:117\n   #7  ../layers/conv2d.fut:6:6-7:123\n   #8  ../layers/conv2d.fut:22:7-30\n   #9  test_diffusion.fut:62:22-116\n   #10 test_diffusion.fut:61:1-63:17\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        double defunc_0_f_res_f_res_55861 =
                               ((double *) mem_param_96223.mem)[i_85337 *
                                                                (int64_t) 784 +
                                                                i_55851 *
                                                                (int64_t) 28 +
                                                                i_55855];
                        
                        defunc_0_f_res_55850 = defunc_0_f_res_f_res_55861;
                    }
                    ((double *) mem_96313)[i_84754 * (int64_t) 30 + i_84750] =
                        defunc_0_f_res_55850;
                }
            }
            for (int64_t i_113589 = 0; i_113589 < (int64_t) 1; i_113589++) {
                if ((int64_t) 7200 > 0)
                    memmove(mem_96353 + i_113589 * (int64_t) 900 * (int64_t) 8,
                            mem_96313 + (int64_t) 0, (int64_t) 7200);
            }
            for (int32_t i_86769 = 0; i_86769 < 28; i_86769++) {
                int64_t i_84762 = sext_i32_i64(i_86769);
                int64_t j_55875 = add64((int64_t) 3, i_84762);
                int64_t i_p_m_t_s_55876 = add64((int64_t) 2, i_84762);
                bool zzero_leq_i_p_m_t_s_55877 = sle64((int64_t) 0,
                                                       i_p_m_t_s_55876);
                bool i_p_m_t_s_leq_w_55878 = slt64(i_p_m_t_s_55876,
                                                   (int64_t) 30);
                bool zzero_lte_i_55879 = sle64((int64_t) 0, i_84762);
                bool i_lte_j_55880 = sle64(i_84762, j_55875);
                bool y_55881 = i_p_m_t_s_leq_w_55878 && zzero_lte_i_55879;
                bool y_55882 = zzero_leq_i_p_m_t_s_55877 && y_55881;
                bool y_55883 = i_lte_j_55880 && y_55882;
                bool forwards_ok_55884 = zzero_lte_i_55879 && y_55883;
                
                for (int32_t i_87065 = 0; i_87065 < 28; i_87065++) {
                    int64_t i_84758 = sext_i32_i64(i_87065);
                    int64_t j_55888 = add64((int64_t) 3, i_84758);
                    int64_t i_p_m_t_s_55889 = add64((int64_t) 2, i_84758);
                    bool zzero_leq_i_p_m_t_s_55890 = sle64((int64_t) 0,
                                                           i_p_m_t_s_55889);
                    bool i_p_m_t_s_leq_w_55891 = slt64(i_p_m_t_s_55889,
                                                       (int64_t) 30);
                    bool zzero_lte_i_55892 = sle64((int64_t) 0, i_84758);
                    bool i_lte_j_55893 = sle64(i_84758, j_55888);
                    bool y_55894 = i_p_m_t_s_leq_w_55891 && zzero_lte_i_55892;
                    bool y_55895 = zzero_leq_i_p_m_t_s_55890 && y_55894;
                    bool y_55896 = i_lte_j_55893 && y_55895;
                    bool forwards_ok_55897 = zzero_lte_i_55892 && y_55896;
                    bool index_ok_55899 = forwards_ok_55884 &&
                         forwards_ok_55897;
                    bool index_certs_55900;
                    
                    if (!index_ok_55899) {
                        set_error(ctx,
                                  msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                            "Index [", (long long) i_84762, ":",
                                            (long long) j_55875, ", ",
                                            (long long) i_84758, ":",
                                            (long long) j_55888,
                                            "] out of bounds for array of shape [",
                                            (long long) (int64_t) 30, "][",
                                            (long long) (int64_t) 30, "].",
                                            "-> #0  ../layers/conv2d.fut:13:90-124\n   #1  ../layers/conv2d.fut:13:69-146\n   #2  /prelude/soacs.fut:59:3-10\n   #3  /prelude/array.fut:200:3-17\n   #4  /prelude/functional.fut:39:59-65\n   #5  /prelude/soacs.fut:59:3-10\n   #6  /prelude/array.fut:208:3-34\n   #7  ../layers/conv2d.fut:13:26-162\n   #8  ../layers/conv2d.fut:26:17-54\n   #9  test_diffusion.fut:62:22-116\n   #10 test_diffusion.fut:61:1-63:17\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    for (int64_t i_113592 = 0; i_113592 < (int64_t) 9;
                         i_113592++) {
                        double tmp_113593 =
                               ((double *) mem_96353)[(int64_t) 30 * i_84762 +
                                                      i_84758 +
                                                      (squot64(i_113592,
                                                               (int64_t) 9) *
                                                       (int64_t) 900 +
                                                       squot64(i_113592 -
                                                               squot64(i_113592,
                                                                       (int64_t) 9) *
                                                               (int64_t) 9,
                                                               (int64_t) 3) *
                                                       (int64_t) 30 +
                                                       (i_113592 -
                                                        squot64(i_113592,
                                                                (int64_t) 9) *
                                                        (int64_t) 9 -
                                                        squot64(i_113592 -
                                                                squot64(i_113592,
                                                                        (int64_t) 9) *
                                                                (int64_t) 9,
                                                                (int64_t) 3) *
                                                        (int64_t) 3))];
                        
                        ((double *) mem_96355)[i_84762 * (int64_t) 252 +
                                               i_84758 * (int64_t) 9 +
                                               i_113592] = tmp_113593;
                    }
                }
            }
            for (int32_t i_86770 = 0; i_86770 < 64; i_86770++) {
                int64_t i_84772 = sext_i32_i64(i_86770);
                double x_72901 = ((double *) mem_95789.mem)[i_84772];
                int64_t binop_x_88622 = (int64_t) 9 * i_84772;
                
                for (int32_t i_87063 = 0; i_87063 < 784; i_87063++) {
                    int64_t i_84768 = sext_i32_i64(i_87063);
                    int64_t binop_x_88624 = (int64_t) 9 * i_84768;
                    double defunc_2_reduce_res_73846;
                    double redout_84764 = 0.0;
                    
                    for (int32_t i_87064 = 0; i_87064 < 9; i_87064++) {
                        int64_t i_84765 = sext_i32_i64(i_87064);
                        int64_t new_index_88623 = i_84765 + binop_x_88622;
                        double x_72933 =
                               ((double *) mem_95769.mem)[new_index_88623];
                        int64_t binop_x_88625 = i_84765 + binop_x_88624;
                        int64_t new_index_88626 = squot64(binop_x_88625,
                                                          (int64_t) 252);
                        int64_t binop_y_88632 = (int64_t) 252 * new_index_88626;
                        int64_t binop_x_88633 = binop_x_88625 - binop_y_88632;
                        int64_t new_index_88634 = squot64(binop_x_88633,
                                                          (int64_t) 9);
                        int64_t binop_y_88650 = (int64_t) 9 * new_index_88634;
                        int64_t new_index_88651 = binop_x_88633 - binop_y_88650;
                        double x_72934 =
                               ((double *) mem_96355)[new_index_88626 *
                                                      (int64_t) 252 +
                                                      new_index_88634 *
                                                      (int64_t) 9 +
                                                      new_index_88651];
                        double defunc_1_f_res_72935 = x_72933 * x_72934;
                        double defunc_1_op_res_72928 = defunc_1_f_res_72935 +
                               redout_84764;
                        double redout_tmp_113596 = defunc_1_op_res_72928;
                        
                        redout_84764 = redout_tmp_113596;
                    }
                    defunc_2_reduce_res_73846 = redout_84764;
                    
                    double defunc_0_f_res_72931 = x_72901 +
                           defunc_2_reduce_res_73846;
                    
                    ((double *) mem_96407)[i_84772 * (int64_t) 784 + i_84768] =
                        defunc_0_f_res_72931;
                }
            }
            for (int32_t i_86771 = 0; i_86771 < 64; i_86771++) {
                int64_t i_84784 = sext_i32_i64(i_86771);
                
                for (int32_t i_87057 = 0; i_87057 < 30; i_87057++) {
                    int64_t i_84780 = sext_i32_i64(i_87057);
                    bool cond_57029 = slt64(i_84780, (int64_t) 1);
                    bool cond_f_res_57030 = sle64((int64_t) 29, i_84780);
                    bool x_57031 = !cond_57029;
                    bool y_57032 = cond_f_res_57030 && x_57031;
                    bool cond_57033 = cond_57029 || y_57032;
                    bool x_57034 = !cond_57033;
                    
                    for (int32_t i_87058 = 0; i_87058 < 30; i_87058++) {
                        int64_t i_84776 = sext_i32_i64(i_87058);
                        bool cond_f_res_57037 = slt64(i_84776, (int64_t) 1);
                        bool y_57038 = x_57034 && cond_f_res_57037;
                        bool cond_57039 = cond_57033 || y_57038;
                        bool cond_f_res_57040 = sle64((int64_t) 29, i_84776);
                        bool x_57041 = !cond_57039;
                        bool y_57042 = cond_f_res_57040 && x_57041;
                        bool cond_57043 = cond_57039 || y_57042;
                        double defunc_0_f_res_57044;
                        
                        if (cond_57043 == 1) {
                            defunc_0_f_res_57044 = 0.0;
                        } else {
                            int64_t i_57045 = sub64(i_84780, (int64_t) 1);
                            bool x_57046 = sle64((int64_t) 0, i_57045);
                            bool y_57047 = slt64(i_57045, (int64_t) 28);
                            bool bounds_check_57048 = x_57046 && y_57047;
                            int64_t i_57049 = sub64(i_84776, (int64_t) 1);
                            bool x_57050 = sle64((int64_t) 0, i_57049);
                            bool y_57051 = slt64(i_57049, (int64_t) 28);
                            bool bounds_check_57052 = x_57050 && y_57051;
                            bool index_ok_57053 = bounds_check_57048 &&
                                 bounds_check_57052;
                            bool index_certs_57054;
                            
                            if (!index_ok_57053) {
                                set_error(ctx,
                                          msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                    "Index [",
                                                    (long long) i_57045, ", ",
                                                    (long long) i_57049,
                                                    "] out of bounds for array of shape [",
                                                    (long long) (int64_t) 28,
                                                    "][",
                                                    (long long) (int64_t) 28,
                                                    "].",
                                                    "-> #0  ../layers/conv2d.fut:7:91-116\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  ../layers/conv2d.fut:6:22-7:117\n   #7  ../layers/conv2d.fut:6:6-7:123\n   #8  ../layers/conv2d.fut:22:7-30\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t binop_x_88606 = (int64_t) 784 * i_84784;
                            int64_t binop_y_88607 = (int64_t) 28 * i_57045;
                            int64_t binop_x_88608 = binop_x_88606 +
                                    binop_y_88607;
                            int64_t binop_x_88609 = i_57049 + binop_x_88608;
                            int64_t new_index_88610 = squot64(binop_x_88609,
                                                              (int64_t) 784);
                            int64_t binop_y_88620 = (int64_t) 784 *
                                    new_index_88610;
                            int64_t new_index_88621 = binop_x_88609 -
                                    binop_y_88620;
                            double defunc_0_f_res_f_res_57055 =
                                   ((double *) mem_96407)[new_index_88610 *
                                                          (int64_t) 784 +
                                                          new_index_88621];
                            
                            defunc_0_f_res_57044 = defunc_0_f_res_f_res_57055;
                        }
                        ((double *) mem_96447)[i_84784 * (int64_t) 900 +
                                               i_84780 * (int64_t) 30 +
                                               i_84776] = defunc_0_f_res_57044;
                    }
                }
            }
            for (int32_t i_86772 = 0; i_86772 < 28; i_86772++) {
                int64_t i_84792 = sext_i32_i64(i_86772);
                int64_t j_57074 = add64((int64_t) 3, i_84792);
                int64_t i_p_m_t_s_57075 = add64((int64_t) 2, i_84792);
                bool zzero_leq_i_p_m_t_s_57076 = sle64((int64_t) 0,
                                                       i_p_m_t_s_57075);
                bool i_p_m_t_s_leq_w_57077 = slt64(i_p_m_t_s_57075,
                                                   (int64_t) 30);
                bool zzero_lte_i_57078 = sle64((int64_t) 0, i_84792);
                bool i_lte_j_57079 = sle64(i_84792, j_57074);
                bool y_57080 = i_p_m_t_s_leq_w_57077 && zzero_lte_i_57078;
                bool y_57081 = zzero_leq_i_p_m_t_s_57076 && y_57080;
                bool y_57082 = i_lte_j_57079 && y_57081;
                bool forwards_ok_57083 = zzero_lte_i_57078 && y_57082;
                
                for (int32_t i_87052 = 0; i_87052 < 28; i_87052++) {
                    int64_t i_84788 = sext_i32_i64(i_87052);
                    int64_t j_57087 = add64((int64_t) 3, i_84788);
                    int64_t i_p_m_t_s_57088 = add64((int64_t) 2, i_84788);
                    bool zzero_leq_i_p_m_t_s_57089 = sle64((int64_t) 0,
                                                           i_p_m_t_s_57088);
                    bool i_p_m_t_s_leq_w_57090 = slt64(i_p_m_t_s_57088,
                                                       (int64_t) 30);
                    bool zzero_lte_i_57091 = sle64((int64_t) 0, i_84788);
                    bool i_lte_j_57092 = sle64(i_84788, j_57087);
                    bool y_57093 = i_p_m_t_s_leq_w_57090 && zzero_lte_i_57091;
                    bool y_57094 = zzero_leq_i_p_m_t_s_57089 && y_57093;
                    bool y_57095 = i_lte_j_57092 && y_57094;
                    bool forwards_ok_57096 = zzero_lte_i_57091 && y_57095;
                    bool index_ok_57098 = forwards_ok_57083 &&
                         forwards_ok_57096;
                    bool index_certs_57099;
                    
                    if (!index_ok_57098) {
                        set_error(ctx,
                                  msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                            "Index [", (long long) i_84792, ":",
                                            (long long) j_57074, ", ",
                                            (long long) i_84788, ":",
                                            (long long) j_57087,
                                            "] out of bounds for array of shape [",
                                            (long long) (int64_t) 30, "][",
                                            (long long) (int64_t) 30, "].",
                                            "-> #0  ../layers/conv2d.fut:13:90-124\n   #1  ../layers/conv2d.fut:13:69-146\n   #2  /prelude/soacs.fut:59:3-10\n   #3  /prelude/array.fut:200:3-17\n   #4  /prelude/functional.fut:39:59-65\n   #5  /prelude/soacs.fut:59:3-10\n   #6  /prelude/array.fut:208:3-34\n   #7  ../layers/conv2d.fut:13:26-162\n   #8  ../layers/conv2d.fut:26:17-54\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    for (int64_t i_113602 = 0; i_113602 < (int64_t) 576;
                         i_113602++) {
                        double tmp_113603 =
                               ((double *) mem_96447)[(int64_t) 30 * i_84792 +
                                                      i_84788 +
                                                      (squot64(i_113602,
                                                               (int64_t) 9) *
                                                       (int64_t) 900 +
                                                       squot64(i_113602 -
                                                               squot64(i_113602,
                                                                       (int64_t) 9) *
                                                               (int64_t) 9,
                                                               (int64_t) 3) *
                                                       (int64_t) 30 +
                                                       (i_113602 -
                                                        squot64(i_113602,
                                                                (int64_t) 9) *
                                                        (int64_t) 9 -
                                                        squot64(i_113602 -
                                                                squot64(i_113602,
                                                                        (int64_t) 9) *
                                                                (int64_t) 9,
                                                                (int64_t) 3) *
                                                        (int64_t) 3))];
                        
                        ((double *) mem_96531)[i_84792 * (int64_t) 16128 +
                                               i_84788 * (int64_t) 576 +
                                               i_113602] = tmp_113603;
                    }
                }
            }
            for (int32_t i_86773 = 0; i_86773 < 128; i_86773++) {
                int64_t i_84802 = sext_i32_i64(i_86773);
                double x_72883 = ((double *) mem_95863.mem)[i_84802];
                int64_t binop_x_88576 = (int64_t) 576 * i_84802;
                
                for (int32_t i_87050 = 0; i_87050 < 784; i_87050++) {
                    int64_t i_84798 = sext_i32_i64(i_87050);
                    int64_t binop_x_88578 = (int64_t) 576 * i_84798;
                    double defunc_2_reduce_res_73851;
                    double redout_84794 = 0.0;
                    
                    for (int32_t i_87051 = 0; i_87051 < 576; i_87051++) {
                        int64_t i_84795 = sext_i32_i64(i_87051);
                        int64_t new_index_88577 = i_84795 + binop_x_88576;
                        double x_72957 =
                               ((double *) mem_95841.mem)[new_index_88577];
                        int64_t binop_x_88579 = i_84795 + binop_x_88578;
                        int64_t new_index_88580 = squot64(binop_x_88579,
                                                          (int64_t) 16128);
                        int64_t binop_y_88586 = (int64_t) 16128 *
                                new_index_88580;
                        int64_t binop_x_88587 = binop_x_88579 - binop_y_88586;
                        int64_t new_index_88588 = squot64(binop_x_88587,
                                                          (int64_t) 576);
                        int64_t binop_y_88604 = (int64_t) 576 * new_index_88588;
                        int64_t new_index_88605 = binop_x_88587 - binop_y_88604;
                        double x_72958 =
                               ((double *) mem_96531)[new_index_88580 *
                                                      (int64_t) 16128 +
                                                      new_index_88588 *
                                                      (int64_t) 576 +
                                                      new_index_88605];
                        double defunc_1_f_res_72959 = x_72957 * x_72958;
                        double defunc_1_op_res_72952 = defunc_1_f_res_72959 +
                               redout_84794;
                        double redout_tmp_113606 = defunc_1_op_res_72952;
                        
                        redout_84794 = redout_tmp_113606;
                    }
                    defunc_2_reduce_res_73851 = redout_84794;
                    
                    double defunc_0_f_res_72955 = x_72883 +
                           defunc_2_reduce_res_73851;
                    
                    ((double *) mem_96583)[i_84802 * (int64_t) 784 + i_84798] =
                        defunc_0_f_res_72955;
                }
            }
            for (int32_t i_86774 = 0; i_86774 < 128; i_86774++) {
                int64_t i_84814 = sext_i32_i64(i_86774);
                int64_t binop_x_88560 = (int64_t) 784 * i_84814;
                
                for (int32_t i_87048 = 0; i_87048 < 28; i_87048++) {
                    int64_t i_84810 = sext_i32_i64(i_87048);
                    int64_t binop_y_88561 = (int64_t) 28 * i_84810;
                    int64_t binop_x_88562 = binop_x_88560 + binop_y_88561;
                    
                    for (int32_t i_87049 = 0; i_87049 < 28; i_87049++) {
                        int64_t i_84806 = sext_i32_i64(i_87049);
                        int64_t binop_x_88563 = i_84806 + binop_x_88562;
                        int64_t new_index_88564 = squot64(binop_x_88563,
                                                          (int64_t) 784);
                        int64_t binop_y_88574 = (int64_t) 784 * new_index_88564;
                        int64_t new_index_88575 = binop_x_88563 - binop_y_88574;
                        double x_57142 =
                               ((double *) mem_96583)[new_index_88564 *
                                                      (int64_t) 784 +
                                                      new_index_88575];
                        double max_res_57143 = fmax64(0.0, x_57142);
                        
                        ((double *) mem_96623)[i_84814 * (int64_t) 784 +
                                               i_84810 * (int64_t) 28 +
                                               i_84806] = max_res_57143;
                    }
                }
            }
            for (int32_t i_86775 = 0; i_86775 < 32; i_86775++) {
                int64_t i_84818 = sext_i32_i64(i_86775);
                int64_t i_57154 = mul64((int64_t) 4, i_84818);
                int64_t x_57155 = add64((int64_t) 1, i_84818);
                int64_t j_57156 = mul64((int64_t) 4, x_57155);
                int64_t j_m_i_57157 = sub64(j_57156, i_57154);
                bool empty_slice_57158 = j_m_i_57157 == (int64_t) 0;
                int64_t m_57159 = sub64(j_m_i_57157, (int64_t) 1);
                int64_t i_p_m_t_s_57160 = add64(i_57154, m_57159);
                bool zzero_leq_i_p_m_t_s_57161 = sle64((int64_t) 0,
                                                       i_p_m_t_s_57160);
                bool i_p_m_t_s_leq_w_57162 = slt64(i_p_m_t_s_57160,
                                                   (int64_t) 128);
                bool zzero_lte_i_57163 = sle64((int64_t) 0, i_57154);
                bool i_lte_j_57164 = sle64(i_57154, j_57156);
                bool y_57165 = i_p_m_t_s_leq_w_57162 && zzero_lte_i_57163;
                bool y_57166 = zzero_leq_i_p_m_t_s_57161 && y_57165;
                bool y_57167 = i_lte_j_57164 && y_57166;
                bool forwards_ok_57168 = zzero_lte_i_57163 && y_57167;
                bool ok_or_empty_57169 = empty_slice_57158 || forwards_ok_57168;
                bool index_certs_57170;
                
                if (!ok_or_empty_57169) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Index [", (long long) i_57154, ":",
                                        (long long) j_57156,
                                        "] out of bounds for array of shape [",
                                        (long long) (int64_t) 128, "].",
                                        "-> #0  ../layers/groupnorm.fut:2:31-70\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  ../layers/groupnorm.fut:2:3-97\n   #4  ../layers/groupnorm.fut:15:19-54\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool dim_match_57171 = (int64_t) 4 == j_m_i_57157;
                bool empty_or_match_cert_57172;
                
                if (!dim_match_57171) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Value of (core language) shape (",
                                        (long long) j_m_i_57157, ", ",
                                        (long long) (int64_t) 28, ", ",
                                        (long long) (int64_t) 28,
                                        ") cannot match shape of type `[",
                                        (long long) (int64_t) 4, "][",
                                        (long long) (int64_t) 28, "][",
                                        (long long) (int64_t) 28, "]f64`.",
                                        "-> #0  ../layers/groupnorm.fut:2:31-96\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  ../layers/groupnorm.fut:2:3-97\n   #4  ../layers/groupnorm.fut:15:19-54\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if ((int64_t) 25088 > 0)
                    memmove(mem_96707 + i_84818 * (int64_t) 3136 * (int64_t) 8,
                            mem_96623 + (int64_t) 784 * i_57154 * (int64_t) 8,
                            (int64_t) 25088);
            }
            for (int32_t i_86776 = 0; i_86776 < 32; i_86776++) {
                int64_t i_84828 = sext_i32_i64(i_86776);
                int64_t binop_x_88494 = (int64_t) 3136 * i_84828;
                double defunc_2_reduce_res_73855;
                double redout_84820 = 0.0;
                
                for (int32_t i_87044 = 0; i_87044 < 3136; i_87044++) {
                    int64_t i_84821 = sext_i32_i64(i_87044);
                    int64_t binop_x_88495 = i_84821 + binop_x_88494;
                    int64_t new_index_88496 = squot64(binop_x_88495,
                                                      (int64_t) 3136);
                    int64_t binop_y_88502 = (int64_t) 3136 * new_index_88496;
                    int64_t binop_x_88503 = binop_x_88495 - binop_y_88502;
                    int64_t new_index_88504 = squot64(binop_x_88503,
                                                      (int64_t) 784);
                    int64_t binop_y_88520 = (int64_t) 784 * new_index_88504;
                    int64_t binop_x_88521 = binop_x_88503 - binop_y_88520;
                    int64_t new_index_88522 = squot64(binop_x_88521,
                                                      (int64_t) 28);
                    int64_t binop_y_88558 = (int64_t) 28 * new_index_88522;
                    int64_t new_index_88559 = binop_x_88521 - binop_y_88558;
                    double x_57188 = ((double *) mem_96707)[new_index_88496 *
                                                            (int64_t) 3136 +
                                                            new_index_88504 *
                                                            (int64_t) 784 +
                                                            new_index_88522 *
                                                            (int64_t) 28 +
                                                            new_index_88559];
                    double defunc_1_op_res_57187 = x_57188 + redout_84820;
                    double redout_tmp_113613 = defunc_1_op_res_57187;
                    
                    redout_84820 = redout_tmp_113613;
                }
                defunc_2_reduce_res_73855 = redout_84820;
                
                double calc_mean_flat_res_57189 = defunc_2_reduce_res_73855 /
                       3136.0;
                double defunc_2_reduce_res_73856;
                double redout_84822 = 0.0;
                
                for (int32_t i_87045 = 0; i_87045 < 3136; i_87045++) {
                    int64_t i_84823 = sext_i32_i64(i_87045);
                    int64_t binop_x_88429 = i_84823 + binop_x_88494;
                    int64_t new_index_88430 = squot64(binop_x_88429,
                                                      (int64_t) 3136);
                    int64_t binop_y_88436 = (int64_t) 3136 * new_index_88430;
                    int64_t binop_x_88437 = binop_x_88429 - binop_y_88436;
                    int64_t new_index_88438 = squot64(binop_x_88437,
                                                      (int64_t) 784);
                    int64_t binop_y_88454 = (int64_t) 784 * new_index_88438;
                    int64_t binop_x_88455 = binop_x_88437 - binop_y_88454;
                    int64_t new_index_88456 = squot64(binop_x_88455,
                                                      (int64_t) 28);
                    int64_t binop_y_88492 = (int64_t) 28 * new_index_88456;
                    int64_t new_index_88493 = binop_x_88455 - binop_y_88492;
                    double x_57196 = ((double *) mem_96707)[new_index_88430 *
                                                            (int64_t) 3136 +
                                                            new_index_88438 *
                                                            (int64_t) 784 +
                                                            new_index_88456 *
                                                            (int64_t) 28 +
                                                            new_index_88493];
                    double x_57193 = x_57196 - calc_mean_flat_res_57189;
                    double x_57194 = fpow64(x_57193, 2.0);
                    double defunc_1_op_res_57195 = x_57194 + redout_84822;
                    double redout_tmp_113614 = defunc_1_op_res_57195;
                    
                    redout_84822 = redout_tmp_113614;
                }
                defunc_2_reduce_res_73856 = redout_84822;
                
                double defunc_0_f_res_57197 = defunc_2_reduce_res_73856 /
                       3136.0;
                
                ((double *) mem_96737)[i_84828] = calc_mean_flat_res_57189;
                ((double *) mem_96739)[i_84828] = defunc_0_f_res_57197;
            }
            for (int32_t i_86777 = 0; i_86777 < 128; i_86777++) {
                int64_t i_84849 = sext_i32_i64(i_86777);
                double x_72816 = ((double *) mem_96249)[i_84849];
                bool x_72817 = sle64((int64_t) 0, i_84849);
                bool y_72818 = slt64(i_84849, (int64_t) 128);
                bool bounds_check_72819 = x_72817 && y_72818;
                int64_t i_72820 = sdiv64(i_84849, (int64_t) 4);
                bool x_72821 = sle64((int64_t) 0, i_72820);
                bool y_72822 = slt64(i_72820, (int64_t) 32);
                bool bounds_check_72823 = x_72821 && y_72822;
                bool index_certs_72824;
                
                if (!bounds_check_72823) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Index [", (long long) i_72820,
                                        "] out of bounds for array of shape [",
                                        (long long) (int64_t) 32, "].",
                                        "-> #0  ../layers/groupnorm.fut:17:57-77\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  /prelude/functional.fut:39:59-65\n   #7  /prelude/soacs.fut:59:3-10\n   #8  /prelude/array.fut:216:3-39\n   #9  ../layers/groupnorm.fut:17:13-119\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                double y_72825 = ((double *) mem_96737)[i_72820];
                double x_72826 = ((double *) mem_96739)[i_72820];
                double sqrt_arg_72827 = 1.0e-5 + x_72826;
                double sqrt_res_72828 = futrts_sqrt64(sqrt_arg_72827);
                
                for (int32_t i_87030 = 0; i_87030 < 28; i_87030++) {
                    int64_t i_84837 = sext_i32_i64(i_87030);
                    bool x_72970 = sle64((int64_t) 0, i_84837);
                    bool y_72971 = slt64(i_84837, (int64_t) 28);
                    bool bounds_check_72972 = x_72970 && y_72971;
                    
                    for (int32_t i_87037 = 0; i_87037 < 28; i_87037++) {
                        int64_t i_84833 = sext_i32_i64(i_87037);
                        bool x_72990 = sle64((int64_t) 0, i_84833);
                        bool y_72991 = slt64(i_84833, (int64_t) 28);
                        bool bounds_check_72992 = x_72990 && y_72991;
                        bool y_72993 = bounds_check_72819 && bounds_check_72992;
                        bool index_ok_72994 = bounds_check_72972 && y_72993;
                        bool index_certs_72995;
                        
                        if (!index_ok_72994) {
                            set_error(ctx,
                                      msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                "Index [", (long long) i_84849,
                                                ", ", (long long) i_84837, ", ",
                                                (long long) i_84833,
                                                "] out of bounds for array of shape [",
                                                (long long) (int64_t) 128, "][",
                                                (long long) (int64_t) 28, "][",
                                                (long long) (int64_t) 28, "].",
                                                "-> #0  ../layers/groupnorm.fut:17:44-53\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  /prelude/functional.fut:39:59-65\n   #7  /prelude/soacs.fut:59:3-10\n   #8  /prelude/array.fut:216:3-39\n   #9  ../layers/groupnorm.fut:17:13-119\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        double x_72996 = ((double *) mem_96623)[i_84849 *
                                                                (int64_t) 784 +
                                                                i_84837 *
                                                                (int64_t) 28 +
                                                                i_84833];
                        double x_72997 = x_72996 - y_72825;
                        double defunc_0_f_res_72998 = x_72997 / sqrt_res_72828;
                        double defunc_0_f_res_73000 = x_72816 +
                               defunc_0_f_res_72998;
                        
                        ((double *) mem_96774)[i_84837 * (int64_t) 28 +
                                               i_84833] = defunc_0_f_res_73000;
                    }
                }
                for (int32_t i_87031 = 0; i_87031 < 30; i_87031++) {
                    int64_t i_84845 = sext_i32_i64(i_87031);
                    bool cond_72854 = slt64(i_84845, (int64_t) 1);
                    bool cond_f_res_72855 = sle64((int64_t) 29, i_84845);
                    bool x_72856 = !cond_72854;
                    bool y_72857 = cond_f_res_72855 && x_72856;
                    bool cond_72858 = cond_72854 || y_72857;
                    bool x_72859 = !cond_72858;
                    
                    for (int32_t i_87032 = 0; i_87032 < 30; i_87032++) {
                        int64_t i_84841 = sext_i32_i64(i_87032);
                        bool cond_f_res_72862 = slt64(i_84841, (int64_t) 1);
                        bool y_72863 = x_72859 && cond_f_res_72862;
                        bool cond_72864 = cond_72858 || y_72863;
                        bool cond_f_res_72865 = sle64((int64_t) 29, i_84841);
                        bool x_72866 = !cond_72864;
                        bool y_72867 = cond_f_res_72865 && x_72866;
                        bool cond_72868 = cond_72864 || y_72867;
                        double defunc_0_f_res_72869;
                        
                        if (cond_72868 == 1) {
                            defunc_0_f_res_72869 = 0.0;
                        } else {
                            int64_t i_72870 = sub64(i_84845, (int64_t) 1);
                            bool x_72871 = sle64((int64_t) 0, i_72870);
                            bool y_72872 = slt64(i_72870, (int64_t) 28);
                            bool bounds_check_72873 = x_72871 && y_72872;
                            int64_t i_72874 = sub64(i_84841, (int64_t) 1);
                            bool x_72875 = sle64((int64_t) 0, i_72874);
                            bool y_72876 = slt64(i_72874, (int64_t) 28);
                            bool bounds_check_72877 = x_72875 && y_72876;
                            bool index_ok_72878 = bounds_check_72873 &&
                                 bounds_check_72877;
                            bool index_certs_72879;
                            
                            if (!index_ok_72878) {
                                set_error(ctx,
                                          msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                    "Index [",
                                                    (long long) i_72870, ", ",
                                                    (long long) i_72874,
                                                    "] out of bounds for array of shape [",
                                                    (long long) (int64_t) 28,
                                                    "][",
                                                    (long long) (int64_t) 28,
                                                    "].",
                                                    "-> #0  ../layers/conv2d.fut:7:91-116\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  ../layers/conv2d.fut:6:22-7:117\n   #7  ../layers/conv2d.fut:6:6-7:123\n   #8  ../layers/conv2d.fut:22:7-30\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            double defunc_0_f_res_f_res_72880 =
                                   ((double *) mem_96774)[i_72870 *
                                                          (int64_t) 28 +
                                                          i_72874];
                            
                            defunc_0_f_res_72869 = defunc_0_f_res_f_res_72880;
                        }
                        ((double *) mem_96761)[i_84849 * (int64_t) 900 +
                                               i_84845 * (int64_t) 30 +
                                               i_84841] = defunc_0_f_res_72869;
                    }
                }
            }
            for (int32_t i_86778 = 0; i_86778 < 28; i_86778++) {
                int64_t i_84857 = sext_i32_i64(i_86778);
                int64_t j_57313 = add64((int64_t) 3, i_84857);
                int64_t i_p_m_t_s_57314 = add64((int64_t) 2, i_84857);
                bool zzero_leq_i_p_m_t_s_57315 = sle64((int64_t) 0,
                                                       i_p_m_t_s_57314);
                bool i_p_m_t_s_leq_w_57316 = slt64(i_p_m_t_s_57314,
                                                   (int64_t) 30);
                bool zzero_lte_i_57317 = sle64((int64_t) 0, i_84857);
                bool i_lte_j_57318 = sle64(i_84857, j_57313);
                bool y_57319 = i_p_m_t_s_leq_w_57316 && zzero_lte_i_57317;
                bool y_57320 = zzero_leq_i_p_m_t_s_57315 && y_57319;
                bool y_57321 = i_lte_j_57318 && y_57320;
                bool forwards_ok_57322 = zzero_lte_i_57317 && y_57321;
                
                for (int32_t i_87025 = 0; i_87025 < 28; i_87025++) {
                    int64_t i_84853 = sext_i32_i64(i_87025);
                    int64_t j_57326 = add64((int64_t) 3, i_84853);
                    int64_t i_p_m_t_s_57327 = add64((int64_t) 2, i_84853);
                    bool zzero_leq_i_p_m_t_s_57328 = sle64((int64_t) 0,
                                                           i_p_m_t_s_57327);
                    bool i_p_m_t_s_leq_w_57329 = slt64(i_p_m_t_s_57327,
                                                       (int64_t) 30);
                    bool zzero_lte_i_57330 = sle64((int64_t) 0, i_84853);
                    bool i_lte_j_57331 = sle64(i_84853, j_57326);
                    bool y_57332 = i_p_m_t_s_leq_w_57329 && zzero_lte_i_57330;
                    bool y_57333 = zzero_leq_i_p_m_t_s_57328 && y_57332;
                    bool y_57334 = i_lte_j_57331 && y_57333;
                    bool forwards_ok_57335 = zzero_lte_i_57330 && y_57334;
                    bool index_ok_57337 = forwards_ok_57322 &&
                         forwards_ok_57335;
                    bool index_certs_57338;
                    
                    if (!index_ok_57337) {
                        set_error(ctx,
                                  msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                            "Index [", (long long) i_84857, ":",
                                            (long long) j_57313, ", ",
                                            (long long) i_84853, ":",
                                            (long long) j_57326,
                                            "] out of bounds for array of shape [",
                                            (long long) (int64_t) 30, "][",
                                            (long long) (int64_t) 30, "].",
                                            "-> #0  ../layers/conv2d.fut:13:90-124\n   #1  ../layers/conv2d.fut:13:69-146\n   #2  /prelude/soacs.fut:59:3-10\n   #3  /prelude/array.fut:200:3-17\n   #4  /prelude/functional.fut:39:59-65\n   #5  /prelude/soacs.fut:59:3-10\n   #6  /prelude/array.fut:208:3-34\n   #7  ../layers/conv2d.fut:13:26-162\n   #8  ../layers/conv2d.fut:26:17-54\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    for (int64_t i_113622 = 0; i_113622 < (int64_t) 1152;
                         i_113622++) {
                        double tmp_113623 =
                               ((double *) mem_96761)[(int64_t) 30 * i_84857 +
                                                      i_84853 +
                                                      (squot64(i_113622,
                                                               (int64_t) 9) *
                                                       (int64_t) 900 +
                                                       squot64(i_113622 -
                                                               squot64(i_113622,
                                                                       (int64_t) 9) *
                                                               (int64_t) 9,
                                                               (int64_t) 3) *
                                                       (int64_t) 30 +
                                                       (i_113622 -
                                                        squot64(i_113622,
                                                                (int64_t) 9) *
                                                        (int64_t) 9 -
                                                        squot64(i_113622 -
                                                                squot64(i_113622,
                                                                        (int64_t) 9) *
                                                                (int64_t) 9,
                                                                (int64_t) 3) *
                                                        (int64_t) 3))];
                        
                        ((double *) mem_96885)[i_84857 * (int64_t) 32256 +
                                               i_84853 * (int64_t) 1152 +
                                               i_113622] = tmp_113623;
                    }
                }
            }
            for (int32_t i_86779 = 0; i_86779 < 128; i_86779++) {
                int64_t i_84867 = sext_i32_i64(i_86779);
                double x_72760 = ((double *) mem_95859.mem)[i_84867];
                int64_t binop_x_88398 = (int64_t) 1152 * i_84867;
                
                for (int32_t i_87023 = 0; i_87023 < 784; i_87023++) {
                    int64_t i_84863 = sext_i32_i64(i_87023);
                    int64_t binop_x_88400 = (int64_t) 1152 * i_84863;
                    double defunc_2_reduce_res_73862;
                    double redout_84859 = 0.0;
                    
                    for (int32_t i_87024 = 0; i_87024 < 1152; i_87024++) {
                        int64_t i_84860 = sext_i32_i64(i_87024);
                        int64_t new_index_88399 = i_84860 + binop_x_88398;
                        double x_73022 =
                               ((double *) mem_95953.mem)[new_index_88399];
                        int64_t binop_x_88401 = i_84860 + binop_x_88400;
                        int64_t new_index_88402 = squot64(binop_x_88401,
                                                          (int64_t) 32256);
                        int64_t binop_y_88408 = (int64_t) 32256 *
                                new_index_88402;
                        int64_t binop_x_88409 = binop_x_88401 - binop_y_88408;
                        int64_t new_index_88410 = squot64(binop_x_88409,
                                                          (int64_t) 1152);
                        int64_t binop_y_88426 = (int64_t) 1152 *
                                new_index_88410;
                        int64_t new_index_88427 = binop_x_88409 - binop_y_88426;
                        double x_73023 =
                               ((double *) mem_96885)[new_index_88402 *
                                                      (int64_t) 32256 +
                                                      new_index_88410 *
                                                      (int64_t) 1152 +
                                                      new_index_88427];
                        double defunc_1_f_res_73024 = x_73022 * x_73023;
                        double defunc_1_op_res_73017 = defunc_1_f_res_73024 +
                               redout_84859;
                        double redout_tmp_113626 = defunc_1_op_res_73017;
                        
                        redout_84859 = redout_tmp_113626;
                    }
                    defunc_2_reduce_res_73862 = redout_84859;
                    
                    double defunc_0_f_res_73020 = x_72760 +
                           defunc_2_reduce_res_73862;
                    
                    ((double *) mem_96937)[i_84867 * (int64_t) 784 + i_84863] =
                        defunc_0_f_res_73020;
                }
            }
            for (int32_t i_86780 = 0; i_86780 < 128; i_86780++) {
                int64_t i_84879 = sext_i32_i64(i_86780);
                int64_t binop_x_88382 = (int64_t) 784 * i_84879;
                
                for (int32_t i_87021 = 0; i_87021 < 28; i_87021++) {
                    int64_t i_84875 = sext_i32_i64(i_87021);
                    int64_t binop_y_88383 = (int64_t) 28 * i_84875;
                    int64_t binop_x_88384 = binop_x_88382 + binop_y_88383;
                    
                    for (int32_t i_87022 = 0; i_87022 < 28; i_87022++) {
                        int64_t i_84871 = sext_i32_i64(i_87022);
                        int64_t binop_x_88385 = i_84871 + binop_x_88384;
                        int64_t new_index_88386 = squot64(binop_x_88385,
                                                          (int64_t) 784);
                        int64_t binop_y_88396 = (int64_t) 784 * new_index_88386;
                        int64_t new_index_88397 = binop_x_88385 - binop_y_88396;
                        double x_57381 =
                               ((double *) mem_96937)[new_index_88386 *
                                                      (int64_t) 784 +
                                                      new_index_88397];
                        double max_res_57382 = fmax64(0.0, x_57381);
                        
                        ((double *) mem_96977)[i_84879 * (int64_t) 784 +
                                               i_84875 * (int64_t) 28 +
                                               i_84871] = max_res_57382;
                    }
                }
            }
            for (int32_t i_86781 = 0; i_86781 < 32; i_86781++) {
                int64_t i_84883 = sext_i32_i64(i_86781);
                int64_t i_57385 = mul64((int64_t) 4, i_84883);
                int64_t x_57386 = add64((int64_t) 1, i_84883);
                int64_t j_57387 = mul64((int64_t) 4, x_57386);
                int64_t j_m_i_57388 = sub64(j_57387, i_57385);
                bool empty_slice_57389 = j_m_i_57388 == (int64_t) 0;
                int64_t m_57390 = sub64(j_m_i_57388, (int64_t) 1);
                int64_t i_p_m_t_s_57391 = add64(i_57385, m_57390);
                bool zzero_leq_i_p_m_t_s_57392 = sle64((int64_t) 0,
                                                       i_p_m_t_s_57391);
                bool i_p_m_t_s_leq_w_57393 = slt64(i_p_m_t_s_57391,
                                                   (int64_t) 128);
                bool zzero_lte_i_57394 = sle64((int64_t) 0, i_57385);
                bool i_lte_j_57395 = sle64(i_57385, j_57387);
                bool y_57396 = i_p_m_t_s_leq_w_57393 && zzero_lte_i_57394;
                bool y_57397 = zzero_leq_i_p_m_t_s_57392 && y_57396;
                bool y_57398 = i_lte_j_57395 && y_57397;
                bool forwards_ok_57399 = zzero_lte_i_57394 && y_57398;
                bool ok_or_empty_57400 = empty_slice_57389 || forwards_ok_57399;
                bool index_certs_57401;
                
                if (!ok_or_empty_57400) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Index [", (long long) i_57385, ":",
                                        (long long) j_57387,
                                        "] out of bounds for array of shape [",
                                        (long long) (int64_t) 128, "].",
                                        "-> #0  ../layers/groupnorm.fut:2:31-70\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  ../layers/groupnorm.fut:2:3-97\n   #4  ../layers/groupnorm.fut:15:19-54\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool dim_match_57402 = (int64_t) 4 == j_m_i_57388;
                bool empty_or_match_cert_57403;
                
                if (!dim_match_57402) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Value of (core language) shape (",
                                        (long long) j_m_i_57388, ", ",
                                        (long long) (int64_t) 28, ", ",
                                        (long long) (int64_t) 28,
                                        ") cannot match shape of type `[",
                                        (long long) (int64_t) 4, "][",
                                        (long long) (int64_t) 28, "][",
                                        (long long) (int64_t) 28, "]f64`.",
                                        "-> #0  ../layers/groupnorm.fut:2:31-96\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  ../layers/groupnorm.fut:2:3-97\n   #4  ../layers/groupnorm.fut:15:19-54\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if ((int64_t) 25088 > 0)
                    memmove(mem_97061 + i_84883 * (int64_t) 3136 * (int64_t) 8,
                            mem_96977 + (int64_t) 784 * i_57385 * (int64_t) 8,
                            (int64_t) 25088);
            }
            for (int32_t i_86782 = 0; i_86782 < 32; i_86782++) {
                int64_t i_84893 = sext_i32_i64(i_86782);
                int64_t binop_x_88316 = (int64_t) 3136 * i_84893;
                double defunc_2_reduce_res_73866;
                double redout_84885 = 0.0;
                
                for (int32_t i_87017 = 0; i_87017 < 3136; i_87017++) {
                    int64_t i_84886 = sext_i32_i64(i_87017);
                    int64_t binop_x_88317 = i_84886 + binop_x_88316;
                    int64_t new_index_88318 = squot64(binop_x_88317,
                                                      (int64_t) 3136);
                    int64_t binop_y_88324 = (int64_t) 3136 * new_index_88318;
                    int64_t binop_x_88325 = binop_x_88317 - binop_y_88324;
                    int64_t new_index_88326 = squot64(binop_x_88325,
                                                      (int64_t) 784);
                    int64_t binop_y_88342 = (int64_t) 784 * new_index_88326;
                    int64_t binop_x_88343 = binop_x_88325 - binop_y_88342;
                    int64_t new_index_88344 = squot64(binop_x_88343,
                                                      (int64_t) 28);
                    int64_t binop_y_88380 = (int64_t) 28 * new_index_88344;
                    int64_t new_index_88381 = binop_x_88343 - binop_y_88380;
                    double x_57413 = ((double *) mem_97061)[new_index_88318 *
                                                            (int64_t) 3136 +
                                                            new_index_88326 *
                                                            (int64_t) 784 +
                                                            new_index_88344 *
                                                            (int64_t) 28 +
                                                            new_index_88381];
                    double defunc_1_op_res_57412 = x_57413 + redout_84885;
                    double redout_tmp_113633 = defunc_1_op_res_57412;
                    
                    redout_84885 = redout_tmp_113633;
                }
                defunc_2_reduce_res_73866 = redout_84885;
                
                double calc_mean_flat_res_57414 = defunc_2_reduce_res_73866 /
                       3136.0;
                double defunc_2_reduce_res_73867;
                double redout_84887 = 0.0;
                
                for (int32_t i_87018 = 0; i_87018 < 3136; i_87018++) {
                    int64_t i_84888 = sext_i32_i64(i_87018);
                    int64_t binop_x_88251 = i_84888 + binop_x_88316;
                    int64_t new_index_88252 = squot64(binop_x_88251,
                                                      (int64_t) 3136);
                    int64_t binop_y_88258 = (int64_t) 3136 * new_index_88252;
                    int64_t binop_x_88259 = binop_x_88251 - binop_y_88258;
                    int64_t new_index_88260 = squot64(binop_x_88259,
                                                      (int64_t) 784);
                    int64_t binop_y_88276 = (int64_t) 784 * new_index_88260;
                    int64_t binop_x_88277 = binop_x_88259 - binop_y_88276;
                    int64_t new_index_88278 = squot64(binop_x_88277,
                                                      (int64_t) 28);
                    int64_t binop_y_88314 = (int64_t) 28 * new_index_88278;
                    int64_t new_index_88315 = binop_x_88277 - binop_y_88314;
                    double x_57421 = ((double *) mem_97061)[new_index_88252 *
                                                            (int64_t) 3136 +
                                                            new_index_88260 *
                                                            (int64_t) 784 +
                                                            new_index_88278 *
                                                            (int64_t) 28 +
                                                            new_index_88315];
                    double x_57418 = x_57421 - calc_mean_flat_res_57414;
                    double x_57419 = fpow64(x_57418, 2.0);
                    double defunc_1_op_res_57420 = x_57419 + redout_84887;
                    double redout_tmp_113634 = defunc_1_op_res_57420;
                    
                    redout_84887 = redout_tmp_113634;
                }
                defunc_2_reduce_res_73867 = redout_84887;
                
                double defunc_0_f_res_57422 = defunc_2_reduce_res_73867 /
                       3136.0;
                
                ((double *) mem_97091)[i_84893] = calc_mean_flat_res_57414;
                ((double *) mem_97093)[i_84893] = defunc_0_f_res_57422;
            }
            for (int32_t i_86783 = 0; i_86783 < 128; i_86783++) {
                int64_t i_84916 = sext_i32_i64(i_86783);
                bool x_72700 = sle64((int64_t) 0, i_84916);
                bool y_72701 = slt64(i_84916, (int64_t) 128);
                bool bounds_check_72702 = x_72700 && y_72701;
                int64_t i_72703 = sdiv64(i_84916, (int64_t) 4);
                bool x_72704 = sle64((int64_t) 0, i_72703);
                bool y_72705 = slt64(i_72703, (int64_t) 32);
                bool bounds_check_72706 = x_72704 && y_72705;
                bool index_certs_72707;
                
                if (!bounds_check_72706) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Index [", (long long) i_72703,
                                        "] out of bounds for array of shape [",
                                        (long long) (int64_t) 32, "].",
                                        "-> #0  ../layers/groupnorm.fut:17:57-77\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  /prelude/functional.fut:39:59-65\n   #7  /prelude/soacs.fut:59:3-10\n   #8  /prelude/array.fut:216:3-39\n   #9  ../layers/groupnorm.fut:17:13-119\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                double y_72708 = ((double *) mem_97091)[i_72703];
                double x_72709 = ((double *) mem_97093)[i_72703];
                double sqrt_arg_72710 = 1.0e-5 + x_72709;
                double sqrt_res_72711 = futrts_sqrt64(sqrt_arg_72710);
                
                for (int32_t i_87003 = 0; i_87003 < 28; i_87003++) {
                    int64_t i_84902 = sext_i32_i64(i_87003);
                    bool x_72714 = sle64((int64_t) 0, i_84902);
                    bool y_72715 = slt64(i_84902, (int64_t) 28);
                    bool bounds_check_72716 = x_72714 && y_72715;
                    
                    for (int32_t i_87010 = 0; i_87010 < 28; i_87010++) {
                        int64_t i_84898 = sext_i32_i64(i_87010);
                        bool x_72719 = sle64((int64_t) 0, i_84898);
                        bool y_72720 = slt64(i_84898, (int64_t) 28);
                        bool bounds_check_72721 = x_72719 && y_72720;
                        bool y_72722 = bounds_check_72702 && bounds_check_72721;
                        bool index_ok_72723 = bounds_check_72716 && y_72722;
                        bool index_certs_72724;
                        
                        if (!index_ok_72723) {
                            set_error(ctx,
                                      msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                "Index [", (long long) i_84916,
                                                ", ", (long long) i_84902, ", ",
                                                (long long) i_84898,
                                                "] out of bounds for array of shape [",
                                                (long long) (int64_t) 128, "][",
                                                (long long) (int64_t) 28, "][",
                                                (long long) (int64_t) 28, "].",
                                                "-> #0  ../layers/groupnorm.fut:17:44-53\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  /prelude/functional.fut:39:59-65\n   #7  /prelude/soacs.fut:59:3-10\n   #8  /prelude/array.fut:216:3-39\n   #9  ../layers/groupnorm.fut:17:13-119\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        double x_72725 = ((double *) mem_96977)[i_84916 *
                                                                (int64_t) 784 +
                                                                i_84902 *
                                                                (int64_t) 28 +
                                                                i_84898];
                        double x_72726 = x_72725 - y_72708;
                        double defunc_0_f_res_72727 = x_72726 / sqrt_res_72711;
                        
                        ((double *) mem_97117)[i_84916 * (int64_t) 784 +
                                               i_84902 * (int64_t) 28 +
                                               i_84898] = defunc_0_f_res_72727;
                    }
                }
                for (int32_t i_87004 = 0; i_87004 < 30; i_87004++) {
                    int64_t i_84910 = sext_i32_i64(i_87004);
                    bool cond_72731 = slt64(i_84910, (int64_t) 1);
                    bool cond_f_res_72732 = sle64((int64_t) 29, i_84910);
                    bool x_72733 = !cond_72731;
                    bool y_72734 = cond_f_res_72732 && x_72733;
                    bool cond_72735 = cond_72731 || y_72734;
                    bool x_72736 = !cond_72735;
                    
                    for (int32_t i_87005 = 0; i_87005 < 30; i_87005++) {
                        int64_t i_84906 = sext_i32_i64(i_87005);
                        bool cond_f_res_72739 = slt64(i_84906, (int64_t) 1);
                        bool y_72740 = x_72736 && cond_f_res_72739;
                        bool cond_72741 = cond_72735 || y_72740;
                        bool cond_f_res_72742 = sle64((int64_t) 29, i_84906);
                        bool x_72743 = !cond_72741;
                        bool y_72744 = cond_f_res_72742 && x_72743;
                        bool cond_72745 = cond_72741 || y_72744;
                        double defunc_0_f_res_72746;
                        
                        if (cond_72745 == 1) {
                            defunc_0_f_res_72746 = 0.0;
                        } else {
                            int64_t i_72747 = sub64(i_84910, (int64_t) 1);
                            bool x_72748 = sle64((int64_t) 0, i_72747);
                            bool y_72749 = slt64(i_72747, (int64_t) 28);
                            bool bounds_check_72750 = x_72748 && y_72749;
                            int64_t i_72751 = sub64(i_84906, (int64_t) 1);
                            bool x_72752 = sle64((int64_t) 0, i_72751);
                            bool y_72753 = slt64(i_72751, (int64_t) 28);
                            bool bounds_check_72754 = x_72752 && y_72753;
                            bool index_ok_72755 = bounds_check_72750 &&
                                 bounds_check_72754;
                            bool index_certs_72756;
                            
                            if (!index_ok_72755) {
                                set_error(ctx,
                                          msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                    "Index [",
                                                    (long long) i_72747, ", ",
                                                    (long long) i_72751,
                                                    "] out of bounds for array of shape [",
                                                    (long long) (int64_t) 28,
                                                    "][",
                                                    (long long) (int64_t) 28,
                                                    "].",
                                                    "-> #0  ../layers/conv2d.fut:7:91-116\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  ../layers/conv2d.fut:6:22-7:117\n   #7  ../layers/conv2d.fut:6:6-7:123\n   #8  ../layers/conv2d.fut:22:7-30\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            double defunc_0_f_res_f_res_72757 =
                                   ((double *) mem_97117)[i_84916 *
                                                          (int64_t) 784 +
                                                          i_72747 *
                                                          (int64_t) 28 +
                                                          i_72751];
                            
                            defunc_0_f_res_72746 = defunc_0_f_res_f_res_72757;
                        }
                        ((double *) mem_97115)[i_84916 * (int64_t) 900 +
                                               i_84910 * (int64_t) 30 +
                                               i_84906] = defunc_0_f_res_72746;
                    }
                }
            }
            for (int32_t i_86784 = 0; i_86784 < 28; i_86784++) {
                int64_t i_84925 = sext_i32_i64(i_86784);
                int64_t j_57540 = add64((int64_t) 3, i_84925);
                int64_t i_p_m_t_s_57541 = add64((int64_t) 2, i_84925);
                bool zzero_leq_i_p_m_t_s_57542 = sle64((int64_t) 0,
                                                       i_p_m_t_s_57541);
                bool i_p_m_t_s_leq_w_57543 = slt64(i_p_m_t_s_57541,
                                                   (int64_t) 30);
                bool zzero_lte_i_57544 = sle64((int64_t) 0, i_84925);
                bool i_lte_j_57545 = sle64(i_84925, j_57540);
                bool y_57546 = i_p_m_t_s_leq_w_57543 && zzero_lte_i_57544;
                bool y_57547 = zzero_leq_i_p_m_t_s_57542 && y_57546;
                bool y_57548 = i_lte_j_57545 && y_57547;
                bool forwards_ok_57549 = zzero_lte_i_57544 && y_57548;
                
                for (int32_t i_86998 = 0; i_86998 < 28; i_86998++) {
                    int64_t i_84921 = sext_i32_i64(i_86998);
                    int64_t j_57553 = add64((int64_t) 3, i_84921);
                    int64_t i_p_m_t_s_57554 = add64((int64_t) 2, i_84921);
                    bool zzero_leq_i_p_m_t_s_57555 = sle64((int64_t) 0,
                                                           i_p_m_t_s_57554);
                    bool i_p_m_t_s_leq_w_57556 = slt64(i_p_m_t_s_57554,
                                                       (int64_t) 30);
                    bool zzero_lte_i_57557 = sle64((int64_t) 0, i_84921);
                    bool i_lte_j_57558 = sle64(i_84921, j_57553);
                    bool y_57559 = i_p_m_t_s_leq_w_57556 && zzero_lte_i_57557;
                    bool y_57560 = zzero_leq_i_p_m_t_s_57555 && y_57559;
                    bool y_57561 = i_lte_j_57558 && y_57560;
                    bool forwards_ok_57562 = zzero_lte_i_57557 && y_57561;
                    bool index_ok_57564 = forwards_ok_57549 &&
                         forwards_ok_57562;
                    bool index_certs_57565;
                    
                    if (!index_ok_57564) {
                        set_error(ctx,
                                  msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                            "Index [", (long long) i_84925, ":",
                                            (long long) j_57540, ", ",
                                            (long long) i_84921, ":",
                                            (long long) j_57553,
                                            "] out of bounds for array of shape [",
                                            (long long) (int64_t) 30, "][",
                                            (long long) (int64_t) 30, "].",
                                            "-> #0  ../layers/conv2d.fut:13:90-124\n   #1  ../layers/conv2d.fut:13:69-146\n   #2  /prelude/soacs.fut:59:3-10\n   #3  /prelude/array.fut:200:3-17\n   #4  /prelude/functional.fut:39:59-65\n   #5  /prelude/soacs.fut:59:3-10\n   #6  /prelude/array.fut:208:3-34\n   #7  ../layers/conv2d.fut:13:26-162\n   #8  ../layers/conv2d.fut:26:17-54\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    for (int64_t i_113643 = 0; i_113643 < (int64_t) 1152;
                         i_113643++) {
                        double tmp_113644 =
                               ((double *) mem_97115)[(int64_t) 30 * i_84925 +
                                                      i_84921 +
                                                      (squot64(i_113643,
                                                               (int64_t) 9) *
                                                       (int64_t) 900 +
                                                       squot64(i_113643 -
                                                               squot64(i_113643,
                                                                       (int64_t) 9) *
                                                               (int64_t) 9,
                                                               (int64_t) 3) *
                                                       (int64_t) 30 +
                                                       (i_113643 -
                                                        squot64(i_113643,
                                                                (int64_t) 9) *
                                                        (int64_t) 9 -
                                                        squot64(i_113643 -
                                                                squot64(i_113643,
                                                                        (int64_t) 9) *
                                                                (int64_t) 9,
                                                                (int64_t) 3) *
                                                        (int64_t) 3))];
                        
                        ((double *) mem_97283)[i_84925 * (int64_t) 32256 +
                                               i_84921 * (int64_t) 1152 +
                                               i_113643] = tmp_113644;
                    }
                }
            }
            for (int32_t i_86785 = 0; i_86785 < 256; i_86785++) {
                int64_t i_84935 = sext_i32_i64(i_86785);
                double x_72682 = ((double *) mem_96001.mem)[i_84935];
                int64_t binop_x_88220 = (int64_t) 1152 * i_84935;
                
                for (int32_t i_86996 = 0; i_86996 < 784; i_86996++) {
                    int64_t i_84931 = sext_i32_i64(i_86996);
                    int64_t binop_x_88222 = (int64_t) 1152 * i_84931;
                    double defunc_2_reduce_res_73873;
                    double redout_84927 = 0.0;
                    
                    for (int32_t i_86997 = 0; i_86997 < 1152; i_86997++) {
                        int64_t i_84928 = sext_i32_i64(i_86997);
                        int64_t new_index_88221 = i_84928 + binop_x_88220;
                        double x_73052 =
                               ((double *) mem_95985.mem)[new_index_88221];
                        int64_t binop_x_88223 = i_84928 + binop_x_88222;
                        int64_t new_index_88224 = squot64(binop_x_88223,
                                                          (int64_t) 32256);
                        int64_t binop_y_88230 = (int64_t) 32256 *
                                new_index_88224;
                        int64_t binop_x_88231 = binop_x_88223 - binop_y_88230;
                        int64_t new_index_88232 = squot64(binop_x_88231,
                                                          (int64_t) 1152);
                        int64_t binop_y_88248 = (int64_t) 1152 *
                                new_index_88232;
                        int64_t new_index_88249 = binop_x_88231 - binop_y_88248;
                        double x_73053 =
                               ((double *) mem_97283)[new_index_88224 *
                                                      (int64_t) 32256 +
                                                      new_index_88232 *
                                                      (int64_t) 1152 +
                                                      new_index_88249];
                        double defunc_1_f_res_73054 = x_73052 * x_73053;
                        double defunc_1_op_res_73047 = defunc_1_f_res_73054 +
                               redout_84927;
                        double redout_tmp_113647 = defunc_1_op_res_73047;
                        
                        redout_84927 = redout_tmp_113647;
                    }
                    defunc_2_reduce_res_73873 = redout_84927;
                    
                    double defunc_0_f_res_73050 = x_72682 +
                           defunc_2_reduce_res_73873;
                    
                    ((double *) mem_97335)[i_84935 * (int64_t) 784 + i_84931] =
                        defunc_0_f_res_73050;
                }
            }
            for (int32_t i_86786 = 0; i_86786 < 256; i_86786++) {
                int64_t i_84947 = sext_i32_i64(i_86786);
                int64_t binop_x_88204 = (int64_t) 784 * i_84947;
                
                for (int32_t i_86994 = 0; i_86994 < 28; i_86994++) {
                    int64_t i_84943 = sext_i32_i64(i_86994);
                    int64_t binop_y_88205 = (int64_t) 28 * i_84943;
                    int64_t binop_x_88206 = binop_x_88204 + binop_y_88205;
                    
                    for (int32_t i_86995 = 0; i_86995 < 28; i_86995++) {
                        int64_t i_84939 = sext_i32_i64(i_86995);
                        int64_t binop_x_88207 = i_84939 + binop_x_88206;
                        int64_t new_index_88208 = squot64(binop_x_88207,
                                                          (int64_t) 784);
                        int64_t binop_y_88218 = (int64_t) 784 * new_index_88208;
                        int64_t new_index_88219 = binop_x_88207 - binop_y_88218;
                        double x_57608 =
                               ((double *) mem_97335)[new_index_88208 *
                                                      (int64_t) 784 +
                                                      new_index_88219];
                        double max_res_57609 = fmax64(0.0, x_57608);
                        
                        ((double *) mem_97375)[i_84947 * (int64_t) 784 +
                                               i_84943 * (int64_t) 28 +
                                               i_84939] = max_res_57609;
                    }
                }
            }
            for (int32_t i_86787 = 0; i_86787 < 32; i_86787++) {
                int64_t i_84951 = sext_i32_i64(i_86787);
                int64_t i_57620 = mul64((int64_t) 8, i_84951);
                int64_t x_57621 = add64((int64_t) 1, i_84951);
                int64_t j_57622 = mul64((int64_t) 8, x_57621);
                int64_t j_m_i_57623 = sub64(j_57622, i_57620);
                bool empty_slice_57624 = j_m_i_57623 == (int64_t) 0;
                int64_t m_57625 = sub64(j_m_i_57623, (int64_t) 1);
                int64_t i_p_m_t_s_57626 = add64(i_57620, m_57625);
                bool zzero_leq_i_p_m_t_s_57627 = sle64((int64_t) 0,
                                                       i_p_m_t_s_57626);
                bool i_p_m_t_s_leq_w_57628 = slt64(i_p_m_t_s_57626,
                                                   (int64_t) 256);
                bool zzero_lte_i_57629 = sle64((int64_t) 0, i_57620);
                bool i_lte_j_57630 = sle64(i_57620, j_57622);
                bool y_57631 = i_p_m_t_s_leq_w_57628 && zzero_lte_i_57629;
                bool y_57632 = zzero_leq_i_p_m_t_s_57627 && y_57631;
                bool y_57633 = i_lte_j_57630 && y_57632;
                bool forwards_ok_57634 = zzero_lte_i_57629 && y_57633;
                bool ok_or_empty_57635 = empty_slice_57624 || forwards_ok_57634;
                bool index_certs_57636;
                
                if (!ok_or_empty_57635) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Index [", (long long) i_57620, ":",
                                        (long long) j_57622,
                                        "] out of bounds for array of shape [",
                                        (long long) (int64_t) 256, "].",
                                        "-> #0  ../layers/groupnorm.fut:2:31-70\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  ../layers/groupnorm.fut:2:3-97\n   #4  ../layers/groupnorm.fut:15:19-54\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool dim_match_57637 = (int64_t) 8 == j_m_i_57623;
                bool empty_or_match_cert_57638;
                
                if (!dim_match_57637) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Value of (core language) shape (",
                                        (long long) j_m_i_57623, ", ",
                                        (long long) (int64_t) 28, ", ",
                                        (long long) (int64_t) 28,
                                        ") cannot match shape of type `[",
                                        (long long) (int64_t) 8, "][",
                                        (long long) (int64_t) 28, "][",
                                        (long long) (int64_t) 28, "]f64`.",
                                        "-> #0  ../layers/groupnorm.fut:2:31-96\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  ../layers/groupnorm.fut:2:3-97\n   #4  ../layers/groupnorm.fut:15:19-54\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if ((int64_t) 50176 > 0)
                    memmove(mem_97459 + i_84951 * (int64_t) 6272 * (int64_t) 8,
                            mem_97375 + (int64_t) 784 * i_57620 * (int64_t) 8,
                            (int64_t) 50176);
            }
            for (int32_t i_86788 = 0; i_86788 < 32; i_86788++) {
                int64_t i_84961 = sext_i32_i64(i_86788);
                int64_t binop_x_88138 = (int64_t) 6272 * i_84961;
                double defunc_2_reduce_res_73877;
                double redout_84953 = 0.0;
                
                for (int32_t i_86990 = 0; i_86990 < 6272; i_86990++) {
                    int64_t i_84954 = sext_i32_i64(i_86990);
                    int64_t binop_x_88139 = i_84954 + binop_x_88138;
                    int64_t new_index_88140 = squot64(binop_x_88139,
                                                      (int64_t) 6272);
                    int64_t binop_y_88146 = (int64_t) 6272 * new_index_88140;
                    int64_t binop_x_88147 = binop_x_88139 - binop_y_88146;
                    int64_t new_index_88148 = squot64(binop_x_88147,
                                                      (int64_t) 784);
                    int64_t binop_y_88164 = (int64_t) 784 * new_index_88148;
                    int64_t binop_x_88165 = binop_x_88147 - binop_y_88164;
                    int64_t new_index_88166 = squot64(binop_x_88165,
                                                      (int64_t) 28);
                    int64_t binop_y_88202 = (int64_t) 28 * new_index_88166;
                    int64_t new_index_88203 = binop_x_88165 - binop_y_88202;
                    double x_57654 = ((double *) mem_97459)[new_index_88140 *
                                                            (int64_t) 6272 +
                                                            new_index_88148 *
                                                            (int64_t) 784 +
                                                            new_index_88166 *
                                                            (int64_t) 28 +
                                                            new_index_88203];
                    double defunc_1_op_res_57653 = x_57654 + redout_84953;
                    double redout_tmp_113654 = defunc_1_op_res_57653;
                    
                    redout_84953 = redout_tmp_113654;
                }
                defunc_2_reduce_res_73877 = redout_84953;
                
                double calc_mean_flat_res_57655 = defunc_2_reduce_res_73877 /
                       6272.0;
                double defunc_2_reduce_res_73878;
                double redout_84955 = 0.0;
                
                for (int32_t i_86991 = 0; i_86991 < 6272; i_86991++) {
                    int64_t i_84956 = sext_i32_i64(i_86991);
                    int64_t binop_x_88073 = i_84956 + binop_x_88138;
                    int64_t new_index_88074 = squot64(binop_x_88073,
                                                      (int64_t) 6272);
                    int64_t binop_y_88080 = (int64_t) 6272 * new_index_88074;
                    int64_t binop_x_88081 = binop_x_88073 - binop_y_88080;
                    int64_t new_index_88082 = squot64(binop_x_88081,
                                                      (int64_t) 784);
                    int64_t binop_y_88098 = (int64_t) 784 * new_index_88082;
                    int64_t binop_x_88099 = binop_x_88081 - binop_y_88098;
                    int64_t new_index_88100 = squot64(binop_x_88099,
                                                      (int64_t) 28);
                    int64_t binop_y_88136 = (int64_t) 28 * new_index_88100;
                    int64_t new_index_88137 = binop_x_88099 - binop_y_88136;
                    double x_57662 = ((double *) mem_97459)[new_index_88074 *
                                                            (int64_t) 6272 +
                                                            new_index_88082 *
                                                            (int64_t) 784 +
                                                            new_index_88100 *
                                                            (int64_t) 28 +
                                                            new_index_88137];
                    double x_57659 = x_57662 - calc_mean_flat_res_57655;
                    double x_57660 = fpow64(x_57659, 2.0);
                    double defunc_1_op_res_57661 = x_57660 + redout_84955;
                    double redout_tmp_113655 = defunc_1_op_res_57661;
                    
                    redout_84955 = redout_tmp_113655;
                }
                defunc_2_reduce_res_73878 = redout_84955;
                
                double defunc_0_f_res_57663 = defunc_2_reduce_res_73878 /
                       6272.0;
                
                ((double *) mem_97489)[i_84961] = calc_mean_flat_res_57655;
                ((double *) mem_97491)[i_84961] = defunc_0_f_res_57663;
            }
            for (int32_t i_86789 = 0; i_86789 < 256; i_86789++) {
                int64_t i_84982 = sext_i32_i64(i_86789);
                double x_72615 = ((double *) mem_96261)[i_84982];
                bool x_72616 = sle64((int64_t) 0, i_84982);
                bool y_72617 = slt64(i_84982, (int64_t) 256);
                bool bounds_check_72618 = x_72616 && y_72617;
                int64_t i_72619 = sdiv64(i_84982, (int64_t) 8);
                bool x_72620 = sle64((int64_t) 0, i_72619);
                bool y_72621 = slt64(i_72619, (int64_t) 32);
                bool bounds_check_72622 = x_72620 && y_72621;
                bool index_certs_72623;
                
                if (!bounds_check_72622) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Index [", (long long) i_72619,
                                        "] out of bounds for array of shape [",
                                        (long long) (int64_t) 32, "].",
                                        "-> #0  ../layers/groupnorm.fut:17:57-77\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  /prelude/functional.fut:39:59-65\n   #7  /prelude/soacs.fut:59:3-10\n   #8  /prelude/array.fut:216:3-39\n   #9  ../layers/groupnorm.fut:17:13-119\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                double y_72624 = ((double *) mem_97489)[i_72619];
                double x_72625 = ((double *) mem_97491)[i_72619];
                double sqrt_arg_72626 = 1.0e-5 + x_72625;
                double sqrt_res_72627 = futrts_sqrt64(sqrt_arg_72626);
                
                for (int32_t i_86976 = 0; i_86976 < 28; i_86976++) {
                    int64_t i_84970 = sext_i32_i64(i_86976);
                    bool x_73065 = sle64((int64_t) 0, i_84970);
                    bool y_73066 = slt64(i_84970, (int64_t) 28);
                    bool bounds_check_73067 = x_73065 && y_73066;
                    
                    for (int32_t i_86983 = 0; i_86983 < 28; i_86983++) {
                        int64_t i_84966 = sext_i32_i64(i_86983);
                        bool x_73085 = sle64((int64_t) 0, i_84966);
                        bool y_73086 = slt64(i_84966, (int64_t) 28);
                        bool bounds_check_73087 = x_73085 && y_73086;
                        bool y_73088 = bounds_check_72618 && bounds_check_73087;
                        bool index_ok_73089 = bounds_check_73067 && y_73088;
                        bool index_certs_73090;
                        
                        if (!index_ok_73089) {
                            set_error(ctx,
                                      msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                "Index [", (long long) i_84982,
                                                ", ", (long long) i_84970, ", ",
                                                (long long) i_84966,
                                                "] out of bounds for array of shape [",
                                                (long long) (int64_t) 256, "][",
                                                (long long) (int64_t) 28, "][",
                                                (long long) (int64_t) 28, "].",
                                                "-> #0  ../layers/groupnorm.fut:17:44-53\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  /prelude/functional.fut:39:59-65\n   #7  /prelude/soacs.fut:59:3-10\n   #8  /prelude/array.fut:216:3-39\n   #9  ../layers/groupnorm.fut:17:13-119\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        double x_73091 = ((double *) mem_97375)[i_84982 *
                                                                (int64_t) 784 +
                                                                i_84970 *
                                                                (int64_t) 28 +
                                                                i_84966];
                        double x_73092 = x_73091 - y_72624;
                        double defunc_0_f_res_73093 = x_73092 / sqrt_res_72627;
                        double defunc_0_f_res_73095 = x_72615 +
                               defunc_0_f_res_73093;
                        
                        ((double *) mem_97526)[i_84970 * (int64_t) 28 +
                                               i_84966] = defunc_0_f_res_73095;
                    }
                }
                for (int32_t i_86977 = 0; i_86977 < 30; i_86977++) {
                    int64_t i_84978 = sext_i32_i64(i_86977);
                    bool cond_72653 = slt64(i_84978, (int64_t) 1);
                    bool cond_f_res_72654 = sle64((int64_t) 29, i_84978);
                    bool x_72655 = !cond_72653;
                    bool y_72656 = cond_f_res_72654 && x_72655;
                    bool cond_72657 = cond_72653 || y_72656;
                    bool x_72658 = !cond_72657;
                    
                    for (int32_t i_86978 = 0; i_86978 < 30; i_86978++) {
                        int64_t i_84974 = sext_i32_i64(i_86978);
                        bool cond_f_res_72661 = slt64(i_84974, (int64_t) 1);
                        bool y_72662 = x_72658 && cond_f_res_72661;
                        bool cond_72663 = cond_72657 || y_72662;
                        bool cond_f_res_72664 = sle64((int64_t) 29, i_84974);
                        bool x_72665 = !cond_72663;
                        bool y_72666 = cond_f_res_72664 && x_72665;
                        bool cond_72667 = cond_72663 || y_72666;
                        double defunc_0_f_res_72668;
                        
                        if (cond_72667 == 1) {
                            defunc_0_f_res_72668 = 0.0;
                        } else {
                            int64_t i_72669 = sub64(i_84978, (int64_t) 1);
                            bool x_72670 = sle64((int64_t) 0, i_72669);
                            bool y_72671 = slt64(i_72669, (int64_t) 28);
                            bool bounds_check_72672 = x_72670 && y_72671;
                            int64_t i_72673 = sub64(i_84974, (int64_t) 1);
                            bool x_72674 = sle64((int64_t) 0, i_72673);
                            bool y_72675 = slt64(i_72673, (int64_t) 28);
                            bool bounds_check_72676 = x_72674 && y_72675;
                            bool index_ok_72677 = bounds_check_72672 &&
                                 bounds_check_72676;
                            bool index_certs_72678;
                            
                            if (!index_ok_72677) {
                                set_error(ctx,
                                          msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                    "Index [",
                                                    (long long) i_72669, ", ",
                                                    (long long) i_72673,
                                                    "] out of bounds for array of shape [",
                                                    (long long) (int64_t) 28,
                                                    "][",
                                                    (long long) (int64_t) 28,
                                                    "].",
                                                    "-> #0  ../layers/conv2d.fut:7:91-116\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  ../layers/conv2d.fut:6:22-7:117\n   #7  ../layers/conv2d.fut:6:6-7:123\n   #8  ../layers/conv2d.fut:22:7-30\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            double defunc_0_f_res_f_res_72679 =
                                   ((double *) mem_97526)[i_72669 *
                                                          (int64_t) 28 +
                                                          i_72673];
                            
                            defunc_0_f_res_72668 = defunc_0_f_res_f_res_72679;
                        }
                        ((double *) mem_97513)[i_84982 * (int64_t) 900 +
                                               i_84978 * (int64_t) 30 +
                                               i_84974] = defunc_0_f_res_72668;
                    }
                }
            }
            for (int32_t i_86790 = 0; i_86790 < 28; i_86790++) {
                int64_t i_84990 = sext_i32_i64(i_86790);
                int64_t j_57779 = add64((int64_t) 3, i_84990);
                int64_t i_p_m_t_s_57780 = add64((int64_t) 2, i_84990);
                bool zzero_leq_i_p_m_t_s_57781 = sle64((int64_t) 0,
                                                       i_p_m_t_s_57780);
                bool i_p_m_t_s_leq_w_57782 = slt64(i_p_m_t_s_57780,
                                                   (int64_t) 30);
                bool zzero_lte_i_57783 = sle64((int64_t) 0, i_84990);
                bool i_lte_j_57784 = sle64(i_84990, j_57779);
                bool y_57785 = i_p_m_t_s_leq_w_57782 && zzero_lte_i_57783;
                bool y_57786 = zzero_leq_i_p_m_t_s_57781 && y_57785;
                bool y_57787 = i_lte_j_57784 && y_57786;
                bool forwards_ok_57788 = zzero_lte_i_57783 && y_57787;
                
                for (int32_t i_86971 = 0; i_86971 < 28; i_86971++) {
                    int64_t i_84986 = sext_i32_i64(i_86971);
                    int64_t j_57792 = add64((int64_t) 3, i_84986);
                    int64_t i_p_m_t_s_57793 = add64((int64_t) 2, i_84986);
                    bool zzero_leq_i_p_m_t_s_57794 = sle64((int64_t) 0,
                                                           i_p_m_t_s_57793);
                    bool i_p_m_t_s_leq_w_57795 = slt64(i_p_m_t_s_57793,
                                                       (int64_t) 30);
                    bool zzero_lte_i_57796 = sle64((int64_t) 0, i_84986);
                    bool i_lte_j_57797 = sle64(i_84986, j_57792);
                    bool y_57798 = i_p_m_t_s_leq_w_57795 && zzero_lte_i_57796;
                    bool y_57799 = zzero_leq_i_p_m_t_s_57794 && y_57798;
                    bool y_57800 = i_lte_j_57797 && y_57799;
                    bool forwards_ok_57801 = zzero_lte_i_57796 && y_57800;
                    bool index_ok_57803 = forwards_ok_57788 &&
                         forwards_ok_57801;
                    bool index_certs_57804;
                    
                    if (!index_ok_57803) {
                        set_error(ctx,
                                  msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                            "Index [", (long long) i_84990, ":",
                                            (long long) j_57779, ", ",
                                            (long long) i_84986, ":",
                                            (long long) j_57792,
                                            "] out of bounds for array of shape [",
                                            (long long) (int64_t) 30, "][",
                                            (long long) (int64_t) 30, "].",
                                            "-> #0  ../layers/conv2d.fut:13:90-124\n   #1  ../layers/conv2d.fut:13:69-146\n   #2  /prelude/soacs.fut:59:3-10\n   #3  /prelude/array.fut:200:3-17\n   #4  /prelude/functional.fut:39:59-65\n   #5  /prelude/soacs.fut:59:3-10\n   #6  /prelude/array.fut:208:3-34\n   #7  ../layers/conv2d.fut:13:26-162\n   #8  ../layers/conv2d.fut:26:17-54\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    for (int64_t i_113663 = 0; i_113663 < (int64_t) 2304;
                         i_113663++) {
                        double tmp_113664 =
                               ((double *) mem_97513)[(int64_t) 30 * i_84990 +
                                                      i_84986 +
                                                      (squot64(i_113663,
                                                               (int64_t) 9) *
                                                       (int64_t) 900 +
                                                       squot64(i_113663 -
                                                               squot64(i_113663,
                                                                       (int64_t) 9) *
                                                               (int64_t) 9,
                                                               (int64_t) 3) *
                                                       (int64_t) 30 +
                                                       (i_113663 -
                                                        squot64(i_113663,
                                                                (int64_t) 9) *
                                                        (int64_t) 9 -
                                                        squot64(i_113663 -
                                                                squot64(i_113663,
                                                                        (int64_t) 9) *
                                                                (int64_t) 9,
                                                                (int64_t) 3) *
                                                        (int64_t) 3))];
                        
                        ((double *) mem_97637)[i_84990 * (int64_t) 64512 +
                                               i_84986 * (int64_t) 2304 +
                                               i_113663] = tmp_113664;
                    }
                }
            }
            for (int32_t i_86791 = 0; i_86791 < 256; i_86791++) {
                int64_t i_85000 = sext_i32_i64(i_86791);
                double x_72559 = ((double *) mem_95997.mem)[i_85000];
                int64_t binop_x_88042 = (int64_t) 2304 * i_85000;
                
                for (int32_t i_86969 = 0; i_86969 < 784; i_86969++) {
                    int64_t i_84996 = sext_i32_i64(i_86969);
                    int64_t binop_x_88044 = (int64_t) 2304 * i_84996;
                    double defunc_2_reduce_res_73884;
                    double redout_84992 = 0.0;
                    
                    for (int32_t i_86970 = 0; i_86970 < 2304; i_86970++) {
                        int64_t i_84993 = sext_i32_i64(i_86970);
                        int64_t new_index_88043 = i_84993 + binop_x_88042;
                        double x_73117 =
                               ((double *) mem_96047.mem)[new_index_88043];
                        int64_t binop_x_88045 = i_84993 + binop_x_88044;
                        int64_t new_index_88046 = squot64(binop_x_88045,
                                                          (int64_t) 64512);
                        int64_t binop_y_88052 = (int64_t) 64512 *
                                new_index_88046;
                        int64_t binop_x_88053 = binop_x_88045 - binop_y_88052;
                        int64_t new_index_88054 = squot64(binop_x_88053,
                                                          (int64_t) 2304);
                        int64_t binop_y_88070 = (int64_t) 2304 *
                                new_index_88054;
                        int64_t new_index_88071 = binop_x_88053 - binop_y_88070;
                        double x_73118 =
                               ((double *) mem_97637)[new_index_88046 *
                                                      (int64_t) 64512 +
                                                      new_index_88054 *
                                                      (int64_t) 2304 +
                                                      new_index_88071];
                        double defunc_1_f_res_73119 = x_73117 * x_73118;
                        double defunc_1_op_res_73112 = defunc_1_f_res_73119 +
                               redout_84992;
                        double redout_tmp_113667 = defunc_1_op_res_73112;
                        
                        redout_84992 = redout_tmp_113667;
                    }
                    defunc_2_reduce_res_73884 = redout_84992;
                    
                    double defunc_0_f_res_73115 = x_72559 +
                           defunc_2_reduce_res_73884;
                    
                    ((double *) mem_97689)[i_85000 * (int64_t) 784 + i_84996] =
                        defunc_0_f_res_73115;
                }
            }
            for (int32_t i_86792 = 0; i_86792 < 256; i_86792++) {
                int64_t i_85012 = sext_i32_i64(i_86792);
                int64_t binop_x_88026 = (int64_t) 784 * i_85012;
                
                for (int32_t i_86967 = 0; i_86967 < 28; i_86967++) {
                    int64_t i_85008 = sext_i32_i64(i_86967);
                    int64_t binop_y_88027 = (int64_t) 28 * i_85008;
                    int64_t binop_x_88028 = binop_x_88026 + binop_y_88027;
                    
                    for (int32_t i_86968 = 0; i_86968 < 28; i_86968++) {
                        int64_t i_85004 = sext_i32_i64(i_86968);
                        int64_t binop_x_88029 = i_85004 + binop_x_88028;
                        int64_t new_index_88030 = squot64(binop_x_88029,
                                                          (int64_t) 784);
                        int64_t binop_y_88040 = (int64_t) 784 * new_index_88030;
                        int64_t new_index_88041 = binop_x_88029 - binop_y_88040;
                        double x_57847 =
                               ((double *) mem_97689)[new_index_88030 *
                                                      (int64_t) 784 +
                                                      new_index_88041];
                        double max_res_57848 = fmax64(0.0, x_57847);
                        
                        ((double *) mem_97729)[i_85012 * (int64_t) 784 +
                                               i_85008 * (int64_t) 28 +
                                               i_85004] = max_res_57848;
                    }
                }
            }
            for (int32_t i_86793 = 0; i_86793 < 32; i_86793++) {
                int64_t i_85016 = sext_i32_i64(i_86793);
                int64_t i_57851 = mul64((int64_t) 8, i_85016);
                int64_t x_57852 = add64((int64_t) 1, i_85016);
                int64_t j_57853 = mul64((int64_t) 8, x_57852);
                int64_t j_m_i_57854 = sub64(j_57853, i_57851);
                bool empty_slice_57855 = j_m_i_57854 == (int64_t) 0;
                int64_t m_57856 = sub64(j_m_i_57854, (int64_t) 1);
                int64_t i_p_m_t_s_57857 = add64(i_57851, m_57856);
                bool zzero_leq_i_p_m_t_s_57858 = sle64((int64_t) 0,
                                                       i_p_m_t_s_57857);
                bool i_p_m_t_s_leq_w_57859 = slt64(i_p_m_t_s_57857,
                                                   (int64_t) 256);
                bool zzero_lte_i_57860 = sle64((int64_t) 0, i_57851);
                bool i_lte_j_57861 = sle64(i_57851, j_57853);
                bool y_57862 = i_p_m_t_s_leq_w_57859 && zzero_lte_i_57860;
                bool y_57863 = zzero_leq_i_p_m_t_s_57858 && y_57862;
                bool y_57864 = i_lte_j_57861 && y_57863;
                bool forwards_ok_57865 = zzero_lte_i_57860 && y_57864;
                bool ok_or_empty_57866 = empty_slice_57855 || forwards_ok_57865;
                bool index_certs_57867;
                
                if (!ok_or_empty_57866) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Index [", (long long) i_57851, ":",
                                        (long long) j_57853,
                                        "] out of bounds for array of shape [",
                                        (long long) (int64_t) 256, "].",
                                        "-> #0  ../layers/groupnorm.fut:2:31-70\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  ../layers/groupnorm.fut:2:3-97\n   #4  ../layers/groupnorm.fut:15:19-54\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool dim_match_57868 = (int64_t) 8 == j_m_i_57854;
                bool empty_or_match_cert_57869;
                
                if (!dim_match_57868) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Value of (core language) shape (",
                                        (long long) j_m_i_57854, ", ",
                                        (long long) (int64_t) 28, ", ",
                                        (long long) (int64_t) 28,
                                        ") cannot match shape of type `[",
                                        (long long) (int64_t) 8, "][",
                                        (long long) (int64_t) 28, "][",
                                        (long long) (int64_t) 28, "]f64`.",
                                        "-> #0  ../layers/groupnorm.fut:2:31-96\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  ../layers/groupnorm.fut:2:3-97\n   #4  ../layers/groupnorm.fut:15:19-54\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if ((int64_t) 50176 > 0)
                    memmove(mem_97813 + i_85016 * (int64_t) 6272 * (int64_t) 8,
                            mem_97729 + (int64_t) 784 * i_57851 * (int64_t) 8,
                            (int64_t) 50176);
            }
            for (int32_t i_86794 = 0; i_86794 < 32; i_86794++) {
                int64_t i_85026 = sext_i32_i64(i_86794);
                int64_t binop_x_87960 = (int64_t) 6272 * i_85026;
                double defunc_2_reduce_res_73888;
                double redout_85018 = 0.0;
                
                for (int32_t i_86963 = 0; i_86963 < 6272; i_86963++) {
                    int64_t i_85019 = sext_i32_i64(i_86963);
                    int64_t binop_x_87961 = i_85019 + binop_x_87960;
                    int64_t new_index_87962 = squot64(binop_x_87961,
                                                      (int64_t) 6272);
                    int64_t binop_y_87968 = (int64_t) 6272 * new_index_87962;
                    int64_t binop_x_87969 = binop_x_87961 - binop_y_87968;
                    int64_t new_index_87970 = squot64(binop_x_87969,
                                                      (int64_t) 784);
                    int64_t binop_y_87986 = (int64_t) 784 * new_index_87970;
                    int64_t binop_x_87987 = binop_x_87969 - binop_y_87986;
                    int64_t new_index_87988 = squot64(binop_x_87987,
                                                      (int64_t) 28);
                    int64_t binop_y_88024 = (int64_t) 28 * new_index_87988;
                    int64_t new_index_88025 = binop_x_87987 - binop_y_88024;
                    double x_57879 = ((double *) mem_97813)[new_index_87962 *
                                                            (int64_t) 6272 +
                                                            new_index_87970 *
                                                            (int64_t) 784 +
                                                            new_index_87988 *
                                                            (int64_t) 28 +
                                                            new_index_88025];
                    double defunc_1_op_res_57878 = x_57879 + redout_85018;
                    double redout_tmp_113674 = defunc_1_op_res_57878;
                    
                    redout_85018 = redout_tmp_113674;
                }
                defunc_2_reduce_res_73888 = redout_85018;
                
                double calc_mean_flat_res_57880 = defunc_2_reduce_res_73888 /
                       6272.0;
                double defunc_2_reduce_res_73889;
                double redout_85020 = 0.0;
                
                for (int32_t i_86964 = 0; i_86964 < 6272; i_86964++) {
                    int64_t i_85021 = sext_i32_i64(i_86964);
                    int64_t binop_x_87895 = i_85021 + binop_x_87960;
                    int64_t new_index_87896 = squot64(binop_x_87895,
                                                      (int64_t) 6272);
                    int64_t binop_y_87902 = (int64_t) 6272 * new_index_87896;
                    int64_t binop_x_87903 = binop_x_87895 - binop_y_87902;
                    int64_t new_index_87904 = squot64(binop_x_87903,
                                                      (int64_t) 784);
                    int64_t binop_y_87920 = (int64_t) 784 * new_index_87904;
                    int64_t binop_x_87921 = binop_x_87903 - binop_y_87920;
                    int64_t new_index_87922 = squot64(binop_x_87921,
                                                      (int64_t) 28);
                    int64_t binop_y_87958 = (int64_t) 28 * new_index_87922;
                    int64_t new_index_87959 = binop_x_87921 - binop_y_87958;
                    double x_57887 = ((double *) mem_97813)[new_index_87896 *
                                                            (int64_t) 6272 +
                                                            new_index_87904 *
                                                            (int64_t) 784 +
                                                            new_index_87922 *
                                                            (int64_t) 28 +
                                                            new_index_87959];
                    double x_57884 = x_57887 - calc_mean_flat_res_57880;
                    double x_57885 = fpow64(x_57884, 2.0);
                    double defunc_1_op_res_57886 = x_57885 + redout_85020;
                    double redout_tmp_113675 = defunc_1_op_res_57886;
                    
                    redout_85020 = redout_tmp_113675;
                }
                defunc_2_reduce_res_73889 = redout_85020;
                
                double defunc_0_f_res_57888 = defunc_2_reduce_res_73889 /
                       6272.0;
                
                ((double *) mem_97843)[i_85026] = calc_mean_flat_res_57880;
                ((double *) mem_97845)[i_85026] = defunc_0_f_res_57888;
            }
            for (int32_t i_86795 = 0; i_86795 < 256; i_86795++) {
                int64_t i_85039 = sext_i32_i64(i_86795);
                bool x_57891 = sle64((int64_t) 0, i_85039);
                bool y_57892 = slt64(i_85039, (int64_t) 256);
                bool bounds_check_57893 = x_57891 && y_57892;
                int64_t i_57894 = sdiv64(i_85039, (int64_t) 8);
                bool x_57895 = sle64((int64_t) 0, i_57894);
                bool y_57896 = slt64(i_57894, (int64_t) 32);
                bool bounds_check_57897 = x_57895 && y_57896;
                bool index_certs_57898;
                
                if (!bounds_check_57897) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Index [", (long long) i_57894,
                                        "] out of bounds for array of shape [",
                                        (long long) (int64_t) 32, "].",
                                        "-> #0  ../layers/groupnorm.fut:17:57-77\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  /prelude/functional.fut:39:59-65\n   #7  /prelude/soacs.fut:59:3-10\n   #8  /prelude/array.fut:216:3-39\n   #9  ../layers/groupnorm.fut:17:13-119\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                double y_57899 = ((double *) mem_97843)[i_57894];
                double x_57900 = ((double *) mem_97845)[i_57894];
                double sqrt_arg_57901 = 1.0e-5 + x_57900;
                double sqrt_res_57902 = futrts_sqrt64(sqrt_arg_57901);
                
                for (int32_t i_86955 = 0; i_86955 < 28; i_86955++) {
                    int64_t i_85035 = sext_i32_i64(i_86955);
                    bool x_57905 = sle64((int64_t) 0, i_85035);
                    bool y_57906 = slt64(i_85035, (int64_t) 28);
                    bool bounds_check_57907 = x_57905 && y_57906;
                    
                    for (int32_t i_86956 = 0; i_86956 < 28; i_86956++) {
                        int64_t i_85031 = sext_i32_i64(i_86956);
                        bool x_57910 = sle64((int64_t) 0, i_85031);
                        bool y_57911 = slt64(i_85031, (int64_t) 28);
                        bool bounds_check_57912 = x_57910 && y_57911;
                        bool y_57913 = bounds_check_57893 && bounds_check_57912;
                        bool index_ok_57914 = bounds_check_57907 && y_57913;
                        bool index_certs_57915;
                        
                        if (!index_ok_57914) {
                            set_error(ctx,
                                      msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                "Index [", (long long) i_85039,
                                                ", ", (long long) i_85035, ", ",
                                                (long long) i_85031,
                                                "] out of bounds for array of shape [",
                                                (long long) (int64_t) 256, "][",
                                                (long long) (int64_t) 28, "][",
                                                (long long) (int64_t) 28, "].",
                                                "-> #0  ../layers/groupnorm.fut:17:44-53\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  /prelude/functional.fut:39:59-65\n   #7  /prelude/soacs.fut:59:3-10\n   #8  /prelude/array.fut:216:3-39\n   #9  ../layers/groupnorm.fut:17:13-119\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        double x_57916 = ((double *) mem_97729)[i_85039 *
                                                                (int64_t) 784 +
                                                                i_85035 *
                                                                (int64_t) 28 +
                                                                i_85031];
                        double x_57917 = x_57916 - y_57899;
                        double defunc_0_f_res_57918 = x_57917 / sqrt_res_57902;
                        
                        ((double *) mem_97867)[i_85039 * (int64_t) 784 +
                                               i_85035 * (int64_t) 28 +
                                               i_85031] = defunc_0_f_res_57918;
                    }
                }
            }
            for (int32_t i_86796 = 0; i_86796 < 512; i_86796++) {
                int64_t i_85051 = sext_i32_i64(i_86796);
                
                for (int32_t i_86943 = 0; i_86943 < 30; i_86943++) {
                    int64_t i_85047 = sext_i32_i64(i_86943);
                    bool cond_57961 = slt64(i_85047, (int64_t) 1);
                    bool cond_f_res_57962 = sle64((int64_t) 29, i_85047);
                    bool x_57963 = !cond_57961;
                    bool y_57964 = cond_f_res_57962 && x_57963;
                    bool cond_57965 = cond_57961 || y_57964;
                    bool x_57966 = !cond_57965;
                    
                    for (int32_t i_86944 = 0; i_86944 < 30; i_86944++) {
                        int64_t i_85043 = sext_i32_i64(i_86944);
                        bool cond_f_res_57969 = slt64(i_85043, (int64_t) 1);
                        bool y_57970 = x_57966 && cond_f_res_57969;
                        bool cond_57971 = cond_57965 || y_57970;
                        bool cond_f_res_57972 = sle64((int64_t) 29, i_85043);
                        bool x_57973 = !cond_57971;
                        bool y_57974 = cond_f_res_57972 && x_57973;
                        bool cond_57975 = cond_57971 || y_57974;
                        double defunc_0_f_res_57976;
                        
                        if (cond_57975 == 1) {
                            defunc_0_f_res_57976 = 0.0;
                        } else {
                            int64_t i_57977 = sub64(i_85047, (int64_t) 1);
                            bool x_57978 = sle64((int64_t) 0, i_57977);
                            bool y_57979 = slt64(i_57977, (int64_t) 28);
                            bool bounds_check_57980 = x_57978 && y_57979;
                            int64_t i_57981 = sub64(i_85043, (int64_t) 1);
                            bool x_57982 = sle64((int64_t) 0, i_57981);
                            bool y_57983 = slt64(i_57981, (int64_t) 28);
                            bool bounds_check_57984 = x_57982 && y_57983;
                            bool index_ok_57985 = bounds_check_57980 &&
                                 bounds_check_57984;
                            bool index_certs_57986;
                            
                            if (!index_ok_57985) {
                                set_error(ctx,
                                          msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                    "Index [",
                                                    (long long) i_57977, ", ",
                                                    (long long) i_57981,
                                                    "] out of bounds for array of shape [",
                                                    (long long) (int64_t) 28,
                                                    "][",
                                                    (long long) (int64_t) 28,
                                                    "].",
                                                    "-> #0  ../layers/conv2d.fut:7:91-116\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  ../layers/conv2d.fut:6:22-7:117\n   #7  ../layers/conv2d.fut:6:6-7:123\n   #8  ../layers/conv2d.fut:22:7-30\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            bool index_concat_cmp_86946 = sle64((int64_t) 256,
                                                                i_85051);
                            double index_concat_branch_86950;
                            
                            if (index_concat_cmp_86946 == 1) {
                                int64_t index_concat_i_86947 = sub64(i_85051,
                                                                     (int64_t) 256);
                                double index_concat_86948 =
                                       ((double *) mem_97867)[index_concat_i_86947 *
                                                              (int64_t) 784 +
                                                              i_57977 *
                                                              (int64_t) 28 +
                                                              i_57981];
                                
                                index_concat_branch_86950 = index_concat_86948;
                            } else {
                                double index_concat_86949 =
                                       ((double *) mem_97867)[i_85051 *
                                                              (int64_t) 784 +
                                                              i_57977 *
                                                              (int64_t) 28 +
                                                              i_57981];
                                
                                index_concat_branch_86950 = index_concat_86949;
                            }
                            defunc_0_f_res_57976 = index_concat_branch_86950;
                        }
                        ((double *) mem_97951)[i_85051 * (int64_t) 900 +
                                               i_85047 * (int64_t) 30 +
                                               i_85043] = defunc_0_f_res_57976;
                    }
                }
            }
            for (int32_t i_86797 = 0; i_86797 < 28; i_86797++) {
                int64_t i_85059 = sext_i32_i64(i_86797);
                int64_t j_58006 = add64((int64_t) 3, i_85059);
                int64_t i_p_m_t_s_58007 = add64((int64_t) 2, i_85059);
                bool zzero_leq_i_p_m_t_s_58008 = sle64((int64_t) 0,
                                                       i_p_m_t_s_58007);
                bool i_p_m_t_s_leq_w_58009 = slt64(i_p_m_t_s_58007,
                                                   (int64_t) 30);
                bool zzero_lte_i_58010 = sle64((int64_t) 0, i_85059);
                bool i_lte_j_58011 = sle64(i_85059, j_58006);
                bool y_58012 = i_p_m_t_s_leq_w_58009 && zzero_lte_i_58010;
                bool y_58013 = zzero_leq_i_p_m_t_s_58008 && y_58012;
                bool y_58014 = i_lte_j_58011 && y_58013;
                bool forwards_ok_58015 = zzero_lte_i_58010 && y_58014;
                
                for (int32_t i_86938 = 0; i_86938 < 28; i_86938++) {
                    int64_t i_85055 = sext_i32_i64(i_86938);
                    int64_t j_58019 = add64((int64_t) 3, i_85055);
                    int64_t i_p_m_t_s_58020 = add64((int64_t) 2, i_85055);
                    bool zzero_leq_i_p_m_t_s_58021 = sle64((int64_t) 0,
                                                           i_p_m_t_s_58020);
                    bool i_p_m_t_s_leq_w_58022 = slt64(i_p_m_t_s_58020,
                                                       (int64_t) 30);
                    bool zzero_lte_i_58023 = sle64((int64_t) 0, i_85055);
                    bool i_lte_j_58024 = sle64(i_85055, j_58019);
                    bool y_58025 = i_p_m_t_s_leq_w_58022 && zzero_lte_i_58023;
                    bool y_58026 = zzero_leq_i_p_m_t_s_58021 && y_58025;
                    bool y_58027 = i_lte_j_58024 && y_58026;
                    bool forwards_ok_58028 = zzero_lte_i_58023 && y_58027;
                    bool index_ok_58030 = forwards_ok_58015 &&
                         forwards_ok_58028;
                    bool index_certs_58031;
                    
                    if (!index_ok_58030) {
                        set_error(ctx,
                                  msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                            "Index [", (long long) i_85059, ":",
                                            (long long) j_58006, ", ",
                                            (long long) i_85055, ":",
                                            (long long) j_58019,
                                            "] out of bounds for array of shape [",
                                            (long long) (int64_t) 30, "][",
                                            (long long) (int64_t) 30, "].",
                                            "-> #0  ../layers/conv2d.fut:13:90-124\n   #1  ../layers/conv2d.fut:13:69-146\n   #2  /prelude/soacs.fut:59:3-10\n   #3  /prelude/array.fut:200:3-17\n   #4  /prelude/functional.fut:39:59-65\n   #5  /prelude/soacs.fut:59:3-10\n   #6  /prelude/array.fut:208:3-34\n   #7  ../layers/conv2d.fut:13:26-162\n   #8  ../layers/conv2d.fut:26:17-54\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    for (int64_t i_113684 = 0; i_113684 < (int64_t) 4608;
                         i_113684++) {
                        double tmp_113685 =
                               ((double *) mem_97951)[(int64_t) 30 * i_85059 +
                                                      i_85055 +
                                                      (squot64(i_113684,
                                                               (int64_t) 9) *
                                                       (int64_t) 900 +
                                                       squot64(i_113684 -
                                                               squot64(i_113684,
                                                                       (int64_t) 9) *
                                                               (int64_t) 9,
                                                               (int64_t) 3) *
                                                       (int64_t) 30 +
                                                       (i_113684 -
                                                        squot64(i_113684,
                                                                (int64_t) 9) *
                                                        (int64_t) 9 -
                                                        squot64(i_113684 -
                                                                squot64(i_113684,
                                                                        (int64_t) 9) *
                                                                (int64_t) 9,
                                                                (int64_t) 3) *
                                                        (int64_t) 3))];
                        
                        ((double *) mem_98035)[i_85059 * (int64_t) 129024 +
                                               i_85055 * (int64_t) 4608 +
                                               i_113684] = tmp_113685;
                    }
                }
            }
            for (int32_t i_86798 = 0; i_86798 < 128; i_86798++) {
                int64_t i_85069 = sext_i32_i64(i_86798);
                double x_72541 = ((double *) mem_95857.mem)[i_85069];
                int64_t binop_x_87864 = (int64_t) 4608 * i_85069;
                
                for (int32_t i_86936 = 0; i_86936 < 784; i_86936++) {
                    int64_t i_85065 = sext_i32_i64(i_86936);
                    int64_t binop_x_87866 = (int64_t) 4608 * i_85065;
                    double defunc_2_reduce_res_73895;
                    double redout_85061 = 0.0;
                    
                    for (int32_t i_86937 = 0; i_86937 < 4608; i_86937++) {
                        int64_t i_85062 = sext_i32_i64(i_86937);
                        int64_t new_index_87865 = i_85062 + binop_x_87864;
                        double x_73147 =
                               ((double *) mem_96045.mem)[new_index_87865];
                        int64_t binop_x_87867 = i_85062 + binop_x_87866;
                        int64_t new_index_87868 = squot64(binop_x_87867,
                                                          (int64_t) 129024);
                        int64_t binop_y_87874 = (int64_t) 129024 *
                                new_index_87868;
                        int64_t binop_x_87875 = binop_x_87867 - binop_y_87874;
                        int64_t new_index_87876 = squot64(binop_x_87875,
                                                          (int64_t) 4608);
                        int64_t binop_y_87892 = (int64_t) 4608 *
                                new_index_87876;
                        int64_t new_index_87893 = binop_x_87875 - binop_y_87892;
                        double x_73148 =
                               ((double *) mem_98035)[new_index_87868 *
                                                      (int64_t) 129024 +
                                                      new_index_87876 *
                                                      (int64_t) 4608 +
                                                      new_index_87893];
                        double defunc_1_f_res_73149 = x_73147 * x_73148;
                        double defunc_1_op_res_73142 = defunc_1_f_res_73149 +
                               redout_85061;
                        double redout_tmp_113688 = defunc_1_op_res_73142;
                        
                        redout_85061 = redout_tmp_113688;
                    }
                    defunc_2_reduce_res_73895 = redout_85061;
                    
                    double defunc_0_f_res_73145 = x_72541 +
                           defunc_2_reduce_res_73895;
                    
                    ((double *) mem_98087)[i_85069 * (int64_t) 784 + i_85065] =
                        defunc_0_f_res_73145;
                }
            }
            for (int32_t i_86799 = 0; i_86799 < 128; i_86799++) {
                int64_t i_85081 = sext_i32_i64(i_86799);
                int64_t binop_x_87848 = (int64_t) 784 * i_85081;
                
                for (int32_t i_86934 = 0; i_86934 < 28; i_86934++) {
                    int64_t i_85077 = sext_i32_i64(i_86934);
                    int64_t binop_y_87849 = (int64_t) 28 * i_85077;
                    int64_t binop_x_87850 = binop_x_87848 + binop_y_87849;
                    
                    for (int32_t i_86935 = 0; i_86935 < 28; i_86935++) {
                        int64_t i_85073 = sext_i32_i64(i_86935);
                        int64_t binop_x_87851 = i_85073 + binop_x_87850;
                        int64_t new_index_87852 = squot64(binop_x_87851,
                                                          (int64_t) 784);
                        int64_t binop_y_87862 = (int64_t) 784 * new_index_87852;
                        int64_t new_index_87863 = binop_x_87851 - binop_y_87862;
                        double x_58074 =
                               ((double *) mem_98087)[new_index_87852 *
                                                      (int64_t) 784 +
                                                      new_index_87863];
                        double max_res_58075 = fmax64(0.0, x_58074);
                        
                        ((double *) mem_98127)[i_85081 * (int64_t) 784 +
                                               i_85077 * (int64_t) 28 +
                                               i_85073] = max_res_58075;
                    }
                }
            }
            for (int32_t i_86800 = 0; i_86800 < 32; i_86800++) {
                int64_t i_85085 = sext_i32_i64(i_86800);
                int64_t i_58086 = mul64((int64_t) 4, i_85085);
                int64_t x_58087 = add64((int64_t) 1, i_85085);
                int64_t j_58088 = mul64((int64_t) 4, x_58087);
                int64_t j_m_i_58089 = sub64(j_58088, i_58086);
                bool empty_slice_58090 = j_m_i_58089 == (int64_t) 0;
                int64_t m_58091 = sub64(j_m_i_58089, (int64_t) 1);
                int64_t i_p_m_t_s_58092 = add64(i_58086, m_58091);
                bool zzero_leq_i_p_m_t_s_58093 = sle64((int64_t) 0,
                                                       i_p_m_t_s_58092);
                bool i_p_m_t_s_leq_w_58094 = slt64(i_p_m_t_s_58092,
                                                   (int64_t) 128);
                bool zzero_lte_i_58095 = sle64((int64_t) 0, i_58086);
                bool i_lte_j_58096 = sle64(i_58086, j_58088);
                bool y_58097 = i_p_m_t_s_leq_w_58094 && zzero_lte_i_58095;
                bool y_58098 = zzero_leq_i_p_m_t_s_58093 && y_58097;
                bool y_58099 = i_lte_j_58096 && y_58098;
                bool forwards_ok_58100 = zzero_lte_i_58095 && y_58099;
                bool ok_or_empty_58101 = empty_slice_58090 || forwards_ok_58100;
                bool index_certs_58102;
                
                if (!ok_or_empty_58101) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Index [", (long long) i_58086, ":",
                                        (long long) j_58088,
                                        "] out of bounds for array of shape [",
                                        (long long) (int64_t) 128, "].",
                                        "-> #0  ../layers/groupnorm.fut:2:31-70\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  ../layers/groupnorm.fut:2:3-97\n   #4  ../layers/groupnorm.fut:15:19-54\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool dim_match_58103 = (int64_t) 4 == j_m_i_58089;
                bool empty_or_match_cert_58104;
                
                if (!dim_match_58103) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Value of (core language) shape (",
                                        (long long) j_m_i_58089, ", ",
                                        (long long) (int64_t) 28, ", ",
                                        (long long) (int64_t) 28,
                                        ") cannot match shape of type `[",
                                        (long long) (int64_t) 4, "][",
                                        (long long) (int64_t) 28, "][",
                                        (long long) (int64_t) 28, "]f64`.",
                                        "-> #0  ../layers/groupnorm.fut:2:31-96\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  ../layers/groupnorm.fut:2:3-97\n   #4  ../layers/groupnorm.fut:15:19-54\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if ((int64_t) 25088 > 0)
                    memmove(mem_98211 + i_85085 * (int64_t) 3136 * (int64_t) 8,
                            mem_98127 + (int64_t) 784 * i_58086 * (int64_t) 8,
                            (int64_t) 25088);
            }
            for (int32_t i_86801 = 0; i_86801 < 32; i_86801++) {
                int64_t i_85095 = sext_i32_i64(i_86801);
                int64_t binop_x_87782 = (int64_t) 3136 * i_85095;
                double defunc_2_reduce_res_73899;
                double redout_85087 = 0.0;
                
                for (int32_t i_86930 = 0; i_86930 < 3136; i_86930++) {
                    int64_t i_85088 = sext_i32_i64(i_86930);
                    int64_t binop_x_87783 = i_85088 + binop_x_87782;
                    int64_t new_index_87784 = squot64(binop_x_87783,
                                                      (int64_t) 3136);
                    int64_t binop_y_87790 = (int64_t) 3136 * new_index_87784;
                    int64_t binop_x_87791 = binop_x_87783 - binop_y_87790;
                    int64_t new_index_87792 = squot64(binop_x_87791,
                                                      (int64_t) 784);
                    int64_t binop_y_87808 = (int64_t) 784 * new_index_87792;
                    int64_t binop_x_87809 = binop_x_87791 - binop_y_87808;
                    int64_t new_index_87810 = squot64(binop_x_87809,
                                                      (int64_t) 28);
                    int64_t binop_y_87846 = (int64_t) 28 * new_index_87810;
                    int64_t new_index_87847 = binop_x_87809 - binop_y_87846;
                    double x_58120 = ((double *) mem_98211)[new_index_87784 *
                                                            (int64_t) 3136 +
                                                            new_index_87792 *
                                                            (int64_t) 784 +
                                                            new_index_87810 *
                                                            (int64_t) 28 +
                                                            new_index_87847];
                    double defunc_1_op_res_58119 = x_58120 + redout_85087;
                    double redout_tmp_113695 = defunc_1_op_res_58119;
                    
                    redout_85087 = redout_tmp_113695;
                }
                defunc_2_reduce_res_73899 = redout_85087;
                
                double calc_mean_flat_res_58121 = defunc_2_reduce_res_73899 /
                       3136.0;
                double defunc_2_reduce_res_73900;
                double redout_85089 = 0.0;
                
                for (int32_t i_86931 = 0; i_86931 < 3136; i_86931++) {
                    int64_t i_85090 = sext_i32_i64(i_86931);
                    int64_t binop_x_87717 = i_85090 + binop_x_87782;
                    int64_t new_index_87718 = squot64(binop_x_87717,
                                                      (int64_t) 3136);
                    int64_t binop_y_87724 = (int64_t) 3136 * new_index_87718;
                    int64_t binop_x_87725 = binop_x_87717 - binop_y_87724;
                    int64_t new_index_87726 = squot64(binop_x_87725,
                                                      (int64_t) 784);
                    int64_t binop_y_87742 = (int64_t) 784 * new_index_87726;
                    int64_t binop_x_87743 = binop_x_87725 - binop_y_87742;
                    int64_t new_index_87744 = squot64(binop_x_87743,
                                                      (int64_t) 28);
                    int64_t binop_y_87780 = (int64_t) 28 * new_index_87744;
                    int64_t new_index_87781 = binop_x_87743 - binop_y_87780;
                    double x_58128 = ((double *) mem_98211)[new_index_87718 *
                                                            (int64_t) 3136 +
                                                            new_index_87726 *
                                                            (int64_t) 784 +
                                                            new_index_87744 *
                                                            (int64_t) 28 +
                                                            new_index_87781];
                    double x_58125 = x_58128 - calc_mean_flat_res_58121;
                    double x_58126 = fpow64(x_58125, 2.0);
                    double defunc_1_op_res_58127 = x_58126 + redout_85089;
                    double redout_tmp_113696 = defunc_1_op_res_58127;
                    
                    redout_85089 = redout_tmp_113696;
                }
                defunc_2_reduce_res_73900 = redout_85089;
                
                double defunc_0_f_res_58129 = defunc_2_reduce_res_73900 /
                       3136.0;
                
                ((double *) mem_98241)[i_85095] = calc_mean_flat_res_58121;
                ((double *) mem_98243)[i_85095] = defunc_0_f_res_58129;
            }
            for (int32_t i_86802 = 0; i_86802 < 128; i_86802++) {
                int64_t i_85116 = sext_i32_i64(i_86802);
                double x_72474 = ((double *) mem_96273)[i_85116];
                bool x_72475 = sle64((int64_t) 0, i_85116);
                bool y_72476 = slt64(i_85116, (int64_t) 128);
                bool bounds_check_72477 = x_72475 && y_72476;
                int64_t i_72478 = sdiv64(i_85116, (int64_t) 4);
                bool x_72479 = sle64((int64_t) 0, i_72478);
                bool y_72480 = slt64(i_72478, (int64_t) 32);
                bool bounds_check_72481 = x_72479 && y_72480;
                bool index_certs_72482;
                
                if (!bounds_check_72481) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Index [", (long long) i_72478,
                                        "] out of bounds for array of shape [",
                                        (long long) (int64_t) 32, "].",
                                        "-> #0  ../layers/groupnorm.fut:17:57-77\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  /prelude/functional.fut:39:59-65\n   #7  /prelude/soacs.fut:59:3-10\n   #8  /prelude/array.fut:216:3-39\n   #9  ../layers/groupnorm.fut:17:13-119\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                double y_72483 = ((double *) mem_98241)[i_72478];
                double x_72484 = ((double *) mem_98243)[i_72478];
                double sqrt_arg_72485 = 1.0e-5 + x_72484;
                double sqrt_res_72486 = futrts_sqrt64(sqrt_arg_72485);
                
                for (int32_t i_86916 = 0; i_86916 < 28; i_86916++) {
                    int64_t i_85104 = sext_i32_i64(i_86916);
                    bool x_73160 = sle64((int64_t) 0, i_85104);
                    bool y_73161 = slt64(i_85104, (int64_t) 28);
                    bool bounds_check_73162 = x_73160 && y_73161;
                    
                    for (int32_t i_86923 = 0; i_86923 < 28; i_86923++) {
                        int64_t i_85100 = sext_i32_i64(i_86923);
                        bool x_73180 = sle64((int64_t) 0, i_85100);
                        bool y_73181 = slt64(i_85100, (int64_t) 28);
                        bool bounds_check_73182 = x_73180 && y_73181;
                        bool y_73183 = bounds_check_72477 && bounds_check_73182;
                        bool index_ok_73184 = bounds_check_73162 && y_73183;
                        bool index_certs_73185;
                        
                        if (!index_ok_73184) {
                            set_error(ctx,
                                      msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                "Index [", (long long) i_85116,
                                                ", ", (long long) i_85104, ", ",
                                                (long long) i_85100,
                                                "] out of bounds for array of shape [",
                                                (long long) (int64_t) 128, "][",
                                                (long long) (int64_t) 28, "][",
                                                (long long) (int64_t) 28, "].",
                                                "-> #0  ../layers/groupnorm.fut:17:44-53\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  /prelude/functional.fut:39:59-65\n   #7  /prelude/soacs.fut:59:3-10\n   #8  /prelude/array.fut:216:3-39\n   #9  ../layers/groupnorm.fut:17:13-119\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        double x_73186 = ((double *) mem_98127)[i_85116 *
                                                                (int64_t) 784 +
                                                                i_85104 *
                                                                (int64_t) 28 +
                                                                i_85100];
                        double x_73187 = x_73186 - y_72483;
                        double defunc_0_f_res_73188 = x_73187 / sqrt_res_72486;
                        double defunc_0_f_res_73190 = x_72474 +
                               defunc_0_f_res_73188;
                        
                        ((double *) mem_98278)[i_85104 * (int64_t) 28 +
                                               i_85100] = defunc_0_f_res_73190;
                    }
                }
                for (int32_t i_86917 = 0; i_86917 < 30; i_86917++) {
                    int64_t i_85112 = sext_i32_i64(i_86917);
                    bool cond_72512 = slt64(i_85112, (int64_t) 1);
                    bool cond_f_res_72513 = sle64((int64_t) 29, i_85112);
                    bool x_72514 = !cond_72512;
                    bool y_72515 = cond_f_res_72513 && x_72514;
                    bool cond_72516 = cond_72512 || y_72515;
                    bool x_72517 = !cond_72516;
                    
                    for (int32_t i_86918 = 0; i_86918 < 30; i_86918++) {
                        int64_t i_85108 = sext_i32_i64(i_86918);
                        bool cond_f_res_72520 = slt64(i_85108, (int64_t) 1);
                        bool y_72521 = x_72517 && cond_f_res_72520;
                        bool cond_72522 = cond_72516 || y_72521;
                        bool cond_f_res_72523 = sle64((int64_t) 29, i_85108);
                        bool x_72524 = !cond_72522;
                        bool y_72525 = cond_f_res_72523 && x_72524;
                        bool cond_72526 = cond_72522 || y_72525;
                        double defunc_0_f_res_72527;
                        
                        if (cond_72526 == 1) {
                            defunc_0_f_res_72527 = 0.0;
                        } else {
                            int64_t i_72528 = sub64(i_85112, (int64_t) 1);
                            bool x_72529 = sle64((int64_t) 0, i_72528);
                            bool y_72530 = slt64(i_72528, (int64_t) 28);
                            bool bounds_check_72531 = x_72529 && y_72530;
                            int64_t i_72532 = sub64(i_85108, (int64_t) 1);
                            bool x_72533 = sle64((int64_t) 0, i_72532);
                            bool y_72534 = slt64(i_72532, (int64_t) 28);
                            bool bounds_check_72535 = x_72533 && y_72534;
                            bool index_ok_72536 = bounds_check_72531 &&
                                 bounds_check_72535;
                            bool index_certs_72537;
                            
                            if (!index_ok_72536) {
                                set_error(ctx,
                                          msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                    "Index [",
                                                    (long long) i_72528, ", ",
                                                    (long long) i_72532,
                                                    "] out of bounds for array of shape [",
                                                    (long long) (int64_t) 28,
                                                    "][",
                                                    (long long) (int64_t) 28,
                                                    "].",
                                                    "-> #0  ../layers/conv2d.fut:7:91-116\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  ../layers/conv2d.fut:6:22-7:117\n   #7  ../layers/conv2d.fut:6:6-7:123\n   #8  ../layers/conv2d.fut:22:7-30\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            double defunc_0_f_res_f_res_72538 =
                                   ((double *) mem_98278)[i_72528 *
                                                          (int64_t) 28 +
                                                          i_72532];
                            
                            defunc_0_f_res_72527 = defunc_0_f_res_f_res_72538;
                        }
                        ((double *) mem_98265)[i_85116 * (int64_t) 900 +
                                               i_85112 * (int64_t) 30 +
                                               i_85108] = defunc_0_f_res_72527;
                    }
                }
            }
            for (int32_t i_86803 = 0; i_86803 < 28; i_86803++) {
                int64_t i_85124 = sext_i32_i64(i_86803);
                int64_t j_58245 = add64((int64_t) 3, i_85124);
                int64_t i_p_m_t_s_58246 = add64((int64_t) 2, i_85124);
                bool zzero_leq_i_p_m_t_s_58247 = sle64((int64_t) 0,
                                                       i_p_m_t_s_58246);
                bool i_p_m_t_s_leq_w_58248 = slt64(i_p_m_t_s_58246,
                                                   (int64_t) 30);
                bool zzero_lte_i_58249 = sle64((int64_t) 0, i_85124);
                bool i_lte_j_58250 = sle64(i_85124, j_58245);
                bool y_58251 = i_p_m_t_s_leq_w_58248 && zzero_lte_i_58249;
                bool y_58252 = zzero_leq_i_p_m_t_s_58247 && y_58251;
                bool y_58253 = i_lte_j_58250 && y_58252;
                bool forwards_ok_58254 = zzero_lte_i_58249 && y_58253;
                
                for (int32_t i_86911 = 0; i_86911 < 28; i_86911++) {
                    int64_t i_85120 = sext_i32_i64(i_86911);
                    int64_t j_58258 = add64((int64_t) 3, i_85120);
                    int64_t i_p_m_t_s_58259 = add64((int64_t) 2, i_85120);
                    bool zzero_leq_i_p_m_t_s_58260 = sle64((int64_t) 0,
                                                           i_p_m_t_s_58259);
                    bool i_p_m_t_s_leq_w_58261 = slt64(i_p_m_t_s_58259,
                                                       (int64_t) 30);
                    bool zzero_lte_i_58262 = sle64((int64_t) 0, i_85120);
                    bool i_lte_j_58263 = sle64(i_85120, j_58258);
                    bool y_58264 = i_p_m_t_s_leq_w_58261 && zzero_lte_i_58262;
                    bool y_58265 = zzero_leq_i_p_m_t_s_58260 && y_58264;
                    bool y_58266 = i_lte_j_58263 && y_58265;
                    bool forwards_ok_58267 = zzero_lte_i_58262 && y_58266;
                    bool index_ok_58269 = forwards_ok_58254 &&
                         forwards_ok_58267;
                    bool index_certs_58270;
                    
                    if (!index_ok_58269) {
                        set_error(ctx,
                                  msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                            "Index [", (long long) i_85124, ":",
                                            (long long) j_58245, ", ",
                                            (long long) i_85120, ":",
                                            (long long) j_58258,
                                            "] out of bounds for array of shape [",
                                            (long long) (int64_t) 30, "][",
                                            (long long) (int64_t) 30, "].",
                                            "-> #0  ../layers/conv2d.fut:13:90-124\n   #1  ../layers/conv2d.fut:13:69-146\n   #2  /prelude/soacs.fut:59:3-10\n   #3  /prelude/array.fut:200:3-17\n   #4  /prelude/functional.fut:39:59-65\n   #5  /prelude/soacs.fut:59:3-10\n   #6  /prelude/array.fut:208:3-34\n   #7  ../layers/conv2d.fut:13:26-162\n   #8  ../layers/conv2d.fut:26:17-54\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    for (int64_t i_113704 = 0; i_113704 < (int64_t) 1152;
                         i_113704++) {
                        double tmp_113705 =
                               ((double *) mem_98265)[(int64_t) 30 * i_85124 +
                                                      i_85120 +
                                                      (squot64(i_113704,
                                                               (int64_t) 9) *
                                                       (int64_t) 900 +
                                                       squot64(i_113704 -
                                                               squot64(i_113704,
                                                                       (int64_t) 9) *
                                                               (int64_t) 9,
                                                               (int64_t) 3) *
                                                       (int64_t) 30 +
                                                       (i_113704 -
                                                        squot64(i_113704,
                                                                (int64_t) 9) *
                                                        (int64_t) 9 -
                                                        squot64(i_113704 -
                                                                squot64(i_113704,
                                                                        (int64_t) 9) *
                                                                (int64_t) 9,
                                                                (int64_t) 3) *
                                                        (int64_t) 3))];
                        
                        ((double *) mem_98389)[i_85124 * (int64_t) 32256 +
                                               i_85120 * (int64_t) 1152 +
                                               i_113704] = tmp_113705;
                    }
                }
            }
            for (int32_t i_86804 = 0; i_86804 < 128; i_86804++) {
                int64_t i_85134 = sext_i32_i64(i_86804);
                double x_72418 = ((double *) mem_95853.mem)[i_85134];
                int64_t binop_x_87686 = (int64_t) 1152 * i_85134;
                
                for (int32_t i_86909 = 0; i_86909 < 784; i_86909++) {
                    int64_t i_85130 = sext_i32_i64(i_86909);
                    int64_t binop_x_87688 = (int64_t) 1152 * i_85130;
                    double defunc_2_reduce_res_73906;
                    double redout_85126 = 0.0;
                    
                    for (int32_t i_86910 = 0; i_86910 < 1152; i_86910++) {
                        int64_t i_85127 = sext_i32_i64(i_86910);
                        int64_t new_index_87687 = i_85127 + binop_x_87686;
                        double x_73212 =
                               ((double *) mem_95951.mem)[new_index_87687];
                        int64_t binop_x_87689 = i_85127 + binop_x_87688;
                        int64_t new_index_87690 = squot64(binop_x_87689,
                                                          (int64_t) 32256);
                        int64_t binop_y_87696 = (int64_t) 32256 *
                                new_index_87690;
                        int64_t binop_x_87697 = binop_x_87689 - binop_y_87696;
                        int64_t new_index_87698 = squot64(binop_x_87697,
                                                          (int64_t) 1152);
                        int64_t binop_y_87714 = (int64_t) 1152 *
                                new_index_87698;
                        int64_t new_index_87715 = binop_x_87697 - binop_y_87714;
                        double x_73213 =
                               ((double *) mem_98389)[new_index_87690 *
                                                      (int64_t) 32256 +
                                                      new_index_87698 *
                                                      (int64_t) 1152 +
                                                      new_index_87715];
                        double defunc_1_f_res_73214 = x_73212 * x_73213;
                        double defunc_1_op_res_73207 = defunc_1_f_res_73214 +
                               redout_85126;
                        double redout_tmp_113708 = defunc_1_op_res_73207;
                        
                        redout_85126 = redout_tmp_113708;
                    }
                    defunc_2_reduce_res_73906 = redout_85126;
                    
                    double defunc_0_f_res_73210 = x_72418 +
                           defunc_2_reduce_res_73906;
                    
                    ((double *) mem_98441)[i_85134 * (int64_t) 784 + i_85130] =
                        defunc_0_f_res_73210;
                }
            }
            for (int32_t i_86805 = 0; i_86805 < 128; i_86805++) {
                int64_t i_85146 = sext_i32_i64(i_86805);
                int64_t binop_x_87670 = (int64_t) 784 * i_85146;
                
                for (int32_t i_86907 = 0; i_86907 < 28; i_86907++) {
                    int64_t i_85142 = sext_i32_i64(i_86907);
                    int64_t binop_y_87671 = (int64_t) 28 * i_85142;
                    int64_t binop_x_87672 = binop_x_87670 + binop_y_87671;
                    
                    for (int32_t i_86908 = 0; i_86908 < 28; i_86908++) {
                        int64_t i_85138 = sext_i32_i64(i_86908);
                        int64_t binop_x_87673 = i_85138 + binop_x_87672;
                        int64_t new_index_87674 = squot64(binop_x_87673,
                                                          (int64_t) 784);
                        int64_t binop_y_87684 = (int64_t) 784 * new_index_87674;
                        int64_t new_index_87685 = binop_x_87673 - binop_y_87684;
                        double x_58313 =
                               ((double *) mem_98441)[new_index_87674 *
                                                      (int64_t) 784 +
                                                      new_index_87685];
                        double max_res_58314 = fmax64(0.0, x_58313);
                        
                        ((double *) mem_98481)[i_85146 * (int64_t) 784 +
                                               i_85142 * (int64_t) 28 +
                                               i_85138] = max_res_58314;
                    }
                }
            }
            for (int32_t i_86806 = 0; i_86806 < 32; i_86806++) {
                int64_t i_85150 = sext_i32_i64(i_86806);
                int64_t i_58317 = mul64((int64_t) 4, i_85150);
                int64_t x_58318 = add64((int64_t) 1, i_85150);
                int64_t j_58319 = mul64((int64_t) 4, x_58318);
                int64_t j_m_i_58320 = sub64(j_58319, i_58317);
                bool empty_slice_58321 = j_m_i_58320 == (int64_t) 0;
                int64_t m_58322 = sub64(j_m_i_58320, (int64_t) 1);
                int64_t i_p_m_t_s_58323 = add64(i_58317, m_58322);
                bool zzero_leq_i_p_m_t_s_58324 = sle64((int64_t) 0,
                                                       i_p_m_t_s_58323);
                bool i_p_m_t_s_leq_w_58325 = slt64(i_p_m_t_s_58323,
                                                   (int64_t) 128);
                bool zzero_lte_i_58326 = sle64((int64_t) 0, i_58317);
                bool i_lte_j_58327 = sle64(i_58317, j_58319);
                bool y_58328 = i_p_m_t_s_leq_w_58325 && zzero_lte_i_58326;
                bool y_58329 = zzero_leq_i_p_m_t_s_58324 && y_58328;
                bool y_58330 = i_lte_j_58327 && y_58329;
                bool forwards_ok_58331 = zzero_lte_i_58326 && y_58330;
                bool ok_or_empty_58332 = empty_slice_58321 || forwards_ok_58331;
                bool index_certs_58333;
                
                if (!ok_or_empty_58332) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Index [", (long long) i_58317, ":",
                                        (long long) j_58319,
                                        "] out of bounds for array of shape [",
                                        (long long) (int64_t) 128, "].",
                                        "-> #0  ../layers/groupnorm.fut:2:31-70\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  ../layers/groupnorm.fut:2:3-97\n   #4  ../layers/groupnorm.fut:15:19-54\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool dim_match_58334 = (int64_t) 4 == j_m_i_58320;
                bool empty_or_match_cert_58335;
                
                if (!dim_match_58334) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Value of (core language) shape (",
                                        (long long) j_m_i_58320, ", ",
                                        (long long) (int64_t) 28, ", ",
                                        (long long) (int64_t) 28,
                                        ") cannot match shape of type `[",
                                        (long long) (int64_t) 4, "][",
                                        (long long) (int64_t) 28, "][",
                                        (long long) (int64_t) 28, "]f64`.",
                                        "-> #0  ../layers/groupnorm.fut:2:31-96\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  ../layers/groupnorm.fut:2:3-97\n   #4  ../layers/groupnorm.fut:15:19-54\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if ((int64_t) 25088 > 0)
                    memmove(mem_98565 + i_85150 * (int64_t) 3136 * (int64_t) 8,
                            mem_98481 + (int64_t) 784 * i_58317 * (int64_t) 8,
                            (int64_t) 25088);
            }
            for (int32_t i_86807 = 0; i_86807 < 32; i_86807++) {
                int64_t i_85160 = sext_i32_i64(i_86807);
                int64_t binop_x_87604 = (int64_t) 3136 * i_85160;
                double defunc_2_reduce_res_73910;
                double redout_85152 = 0.0;
                
                for (int32_t i_86903 = 0; i_86903 < 3136; i_86903++) {
                    int64_t i_85153 = sext_i32_i64(i_86903);
                    int64_t binop_x_87605 = i_85153 + binop_x_87604;
                    int64_t new_index_87606 = squot64(binop_x_87605,
                                                      (int64_t) 3136);
                    int64_t binop_y_87612 = (int64_t) 3136 * new_index_87606;
                    int64_t binop_x_87613 = binop_x_87605 - binop_y_87612;
                    int64_t new_index_87614 = squot64(binop_x_87613,
                                                      (int64_t) 784);
                    int64_t binop_y_87630 = (int64_t) 784 * new_index_87614;
                    int64_t binop_x_87631 = binop_x_87613 - binop_y_87630;
                    int64_t new_index_87632 = squot64(binop_x_87631,
                                                      (int64_t) 28);
                    int64_t binop_y_87668 = (int64_t) 28 * new_index_87632;
                    int64_t new_index_87669 = binop_x_87631 - binop_y_87668;
                    double x_58345 = ((double *) mem_98565)[new_index_87606 *
                                                            (int64_t) 3136 +
                                                            new_index_87614 *
                                                            (int64_t) 784 +
                                                            new_index_87632 *
                                                            (int64_t) 28 +
                                                            new_index_87669];
                    double defunc_1_op_res_58344 = x_58345 + redout_85152;
                    double redout_tmp_113715 = defunc_1_op_res_58344;
                    
                    redout_85152 = redout_tmp_113715;
                }
                defunc_2_reduce_res_73910 = redout_85152;
                
                double calc_mean_flat_res_58346 = defunc_2_reduce_res_73910 /
                       3136.0;
                double defunc_2_reduce_res_73911;
                double redout_85154 = 0.0;
                
                for (int32_t i_86904 = 0; i_86904 < 3136; i_86904++) {
                    int64_t i_85155 = sext_i32_i64(i_86904);
                    int64_t binop_x_87539 = i_85155 + binop_x_87604;
                    int64_t new_index_87540 = squot64(binop_x_87539,
                                                      (int64_t) 3136);
                    int64_t binop_y_87546 = (int64_t) 3136 * new_index_87540;
                    int64_t binop_x_87547 = binop_x_87539 - binop_y_87546;
                    int64_t new_index_87548 = squot64(binop_x_87547,
                                                      (int64_t) 784);
                    int64_t binop_y_87564 = (int64_t) 784 * new_index_87548;
                    int64_t binop_x_87565 = binop_x_87547 - binop_y_87564;
                    int64_t new_index_87566 = squot64(binop_x_87565,
                                                      (int64_t) 28);
                    int64_t binop_y_87602 = (int64_t) 28 * new_index_87566;
                    int64_t new_index_87603 = binop_x_87565 - binop_y_87602;
                    double x_58353 = ((double *) mem_98565)[new_index_87540 *
                                                            (int64_t) 3136 +
                                                            new_index_87548 *
                                                            (int64_t) 784 +
                                                            new_index_87566 *
                                                            (int64_t) 28 +
                                                            new_index_87603];
                    double x_58350 = x_58353 - calc_mean_flat_res_58346;
                    double x_58351 = fpow64(x_58350, 2.0);
                    double defunc_1_op_res_58352 = x_58351 + redout_85154;
                    double redout_tmp_113716 = defunc_1_op_res_58352;
                    
                    redout_85154 = redout_tmp_113716;
                }
                defunc_2_reduce_res_73911 = redout_85154;
                
                double defunc_0_f_res_58354 = defunc_2_reduce_res_73911 /
                       3136.0;
                
                ((double *) mem_98595)[i_85160] = calc_mean_flat_res_58346;
                ((double *) mem_98597)[i_85160] = defunc_0_f_res_58354;
            }
            for (int32_t i_86808 = 0; i_86808 < 128; i_86808++) {
                int64_t i_85173 = sext_i32_i64(i_86808);
                bool x_58357 = sle64((int64_t) 0, i_85173);
                bool y_58358 = slt64(i_85173, (int64_t) 128);
                bool bounds_check_58359 = x_58357 && y_58358;
                int64_t i_58360 = sdiv64(i_85173, (int64_t) 4);
                bool x_58361 = sle64((int64_t) 0, i_58360);
                bool y_58362 = slt64(i_58360, (int64_t) 32);
                bool bounds_check_58363 = x_58361 && y_58362;
                bool index_certs_58364;
                
                if (!bounds_check_58363) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Index [", (long long) i_58360,
                                        "] out of bounds for array of shape [",
                                        (long long) (int64_t) 32, "].",
                                        "-> #0  ../layers/groupnorm.fut:17:57-77\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  /prelude/functional.fut:39:59-65\n   #7  /prelude/soacs.fut:59:3-10\n   #8  /prelude/array.fut:216:3-39\n   #9  ../layers/groupnorm.fut:17:13-119\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                double y_58365 = ((double *) mem_98595)[i_58360];
                double x_58366 = ((double *) mem_98597)[i_58360];
                double sqrt_arg_58367 = 1.0e-5 + x_58366;
                double sqrt_res_58368 = futrts_sqrt64(sqrt_arg_58367);
                
                for (int32_t i_86895 = 0; i_86895 < 28; i_86895++) {
                    int64_t i_85169 = sext_i32_i64(i_86895);
                    bool x_58371 = sle64((int64_t) 0, i_85169);
                    bool y_58372 = slt64(i_85169, (int64_t) 28);
                    bool bounds_check_58373 = x_58371 && y_58372;
                    
                    for (int32_t i_86896 = 0; i_86896 < 28; i_86896++) {
                        int64_t i_85165 = sext_i32_i64(i_86896);
                        bool x_58376 = sle64((int64_t) 0, i_85165);
                        bool y_58377 = slt64(i_85165, (int64_t) 28);
                        bool bounds_check_58378 = x_58376 && y_58377;
                        bool y_58379 = bounds_check_58359 && bounds_check_58378;
                        bool index_ok_58380 = bounds_check_58373 && y_58379;
                        bool index_certs_58381;
                        
                        if (!index_ok_58380) {
                            set_error(ctx,
                                      msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                "Index [", (long long) i_85173,
                                                ", ", (long long) i_85169, ", ",
                                                (long long) i_85165,
                                                "] out of bounds for array of shape [",
                                                (long long) (int64_t) 128, "][",
                                                (long long) (int64_t) 28, "][",
                                                (long long) (int64_t) 28, "].",
                                                "-> #0  ../layers/groupnorm.fut:17:44-53\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  /prelude/functional.fut:39:59-65\n   #7  /prelude/soacs.fut:59:3-10\n   #8  /prelude/array.fut:216:3-39\n   #9  ../layers/groupnorm.fut:17:13-119\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        double x_58382 = ((double *) mem_98481)[i_85173 *
                                                                (int64_t) 784 +
                                                                i_85169 *
                                                                (int64_t) 28 +
                                                                i_85165];
                        double x_58383 = x_58382 - y_58365;
                        double defunc_0_f_res_58384 = x_58383 / sqrt_res_58368;
                        
                        ((double *) mem_98619)[i_85173 * (int64_t) 784 +
                                               i_85169 * (int64_t) 28 +
                                               i_85165] = defunc_0_f_res_58384;
                    }
                }
            }
            for (int32_t i_86809 = 0; i_86809 < 256; i_86809++) {
                int64_t i_85185 = sext_i32_i64(i_86809);
                
                for (int32_t i_86883 = 0; i_86883 < 30; i_86883++) {
                    int64_t i_85181 = sext_i32_i64(i_86883);
                    bool cond_58427 = slt64(i_85181, (int64_t) 1);
                    bool cond_f_res_58428 = sle64((int64_t) 29, i_85181);
                    bool x_58429 = !cond_58427;
                    bool y_58430 = cond_f_res_58428 && x_58429;
                    bool cond_58431 = cond_58427 || y_58430;
                    bool x_58432 = !cond_58431;
                    
                    for (int32_t i_86884 = 0; i_86884 < 30; i_86884++) {
                        int64_t i_85177 = sext_i32_i64(i_86884);
                        bool cond_f_res_58435 = slt64(i_85177, (int64_t) 1);
                        bool y_58436 = x_58432 && cond_f_res_58435;
                        bool cond_58437 = cond_58431 || y_58436;
                        bool cond_f_res_58438 = sle64((int64_t) 29, i_85177);
                        bool x_58439 = !cond_58437;
                        bool y_58440 = cond_f_res_58438 && x_58439;
                        bool cond_58441 = cond_58437 || y_58440;
                        double defunc_0_f_res_58442;
                        
                        if (cond_58441 == 1) {
                            defunc_0_f_res_58442 = 0.0;
                        } else {
                            int64_t i_58443 = sub64(i_85181, (int64_t) 1);
                            bool x_58444 = sle64((int64_t) 0, i_58443);
                            bool y_58445 = slt64(i_58443, (int64_t) 28);
                            bool bounds_check_58446 = x_58444 && y_58445;
                            int64_t i_58447 = sub64(i_85177, (int64_t) 1);
                            bool x_58448 = sle64((int64_t) 0, i_58447);
                            bool y_58449 = slt64(i_58447, (int64_t) 28);
                            bool bounds_check_58450 = x_58448 && y_58449;
                            bool index_ok_58451 = bounds_check_58446 &&
                                 bounds_check_58450;
                            bool index_certs_58452;
                            
                            if (!index_ok_58451) {
                                set_error(ctx,
                                          msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                    "Index [",
                                                    (long long) i_58443, ", ",
                                                    (long long) i_58447,
                                                    "] out of bounds for array of shape [",
                                                    (long long) (int64_t) 28,
                                                    "][",
                                                    (long long) (int64_t) 28,
                                                    "].",
                                                    "-> #0  ../layers/conv2d.fut:7:91-116\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  ../layers/conv2d.fut:6:22-7:117\n   #7  ../layers/conv2d.fut:6:6-7:123\n   #8  ../layers/conv2d.fut:22:7-30\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            bool index_concat_cmp_86886 = sle64((int64_t) 128,
                                                                i_85185);
                            double index_concat_branch_86890;
                            
                            if (index_concat_cmp_86886 == 1) {
                                int64_t index_concat_i_86887 = sub64(i_85185,
                                                                     (int64_t) 128);
                                double index_concat_86888 =
                                       ((double *) mem_97117)[index_concat_i_86887 *
                                                              (int64_t) 784 +
                                                              i_58443 *
                                                              (int64_t) 28 +
                                                              i_58447];
                                
                                index_concat_branch_86890 = index_concat_86888;
                            } else {
                                double index_concat_86889 =
                                       ((double *) mem_98619)[i_85185 *
                                                              (int64_t) 784 +
                                                              i_58443 *
                                                              (int64_t) 28 +
                                                              i_58447];
                                
                                index_concat_branch_86890 = index_concat_86889;
                            }
                            defunc_0_f_res_58442 = index_concat_branch_86890;
                        }
                        ((double *) mem_98703)[i_85185 * (int64_t) 900 +
                                               i_85181 * (int64_t) 30 +
                                               i_85177] = defunc_0_f_res_58442;
                    }
                }
            }
            for (int32_t i_86810 = 0; i_86810 < 28; i_86810++) {
                int64_t i_85193 = sext_i32_i64(i_86810);
                int64_t j_58472 = add64((int64_t) 3, i_85193);
                int64_t i_p_m_t_s_58473 = add64((int64_t) 2, i_85193);
                bool zzero_leq_i_p_m_t_s_58474 = sle64((int64_t) 0,
                                                       i_p_m_t_s_58473);
                bool i_p_m_t_s_leq_w_58475 = slt64(i_p_m_t_s_58473,
                                                   (int64_t) 30);
                bool zzero_lte_i_58476 = sle64((int64_t) 0, i_85193);
                bool i_lte_j_58477 = sle64(i_85193, j_58472);
                bool y_58478 = i_p_m_t_s_leq_w_58475 && zzero_lte_i_58476;
                bool y_58479 = zzero_leq_i_p_m_t_s_58474 && y_58478;
                bool y_58480 = i_lte_j_58477 && y_58479;
                bool forwards_ok_58481 = zzero_lte_i_58476 && y_58480;
                
                for (int32_t i_86878 = 0; i_86878 < 28; i_86878++) {
                    int64_t i_85189 = sext_i32_i64(i_86878);
                    int64_t j_58485 = add64((int64_t) 3, i_85189);
                    int64_t i_p_m_t_s_58486 = add64((int64_t) 2, i_85189);
                    bool zzero_leq_i_p_m_t_s_58487 = sle64((int64_t) 0,
                                                           i_p_m_t_s_58486);
                    bool i_p_m_t_s_leq_w_58488 = slt64(i_p_m_t_s_58486,
                                                       (int64_t) 30);
                    bool zzero_lte_i_58489 = sle64((int64_t) 0, i_85189);
                    bool i_lte_j_58490 = sle64(i_85189, j_58485);
                    bool y_58491 = i_p_m_t_s_leq_w_58488 && zzero_lte_i_58489;
                    bool y_58492 = zzero_leq_i_p_m_t_s_58487 && y_58491;
                    bool y_58493 = i_lte_j_58490 && y_58492;
                    bool forwards_ok_58494 = zzero_lte_i_58489 && y_58493;
                    bool index_ok_58496 = forwards_ok_58481 &&
                         forwards_ok_58494;
                    bool index_certs_58497;
                    
                    if (!index_ok_58496) {
                        set_error(ctx,
                                  msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                            "Index [", (long long) i_85193, ":",
                                            (long long) j_58472, ", ",
                                            (long long) i_85189, ":",
                                            (long long) j_58485,
                                            "] out of bounds for array of shape [",
                                            (long long) (int64_t) 30, "][",
                                            (long long) (int64_t) 30, "].",
                                            "-> #0  ../layers/conv2d.fut:13:90-124\n   #1  ../layers/conv2d.fut:13:69-146\n   #2  /prelude/soacs.fut:59:3-10\n   #3  /prelude/array.fut:200:3-17\n   #4  /prelude/functional.fut:39:59-65\n   #5  /prelude/soacs.fut:59:3-10\n   #6  /prelude/array.fut:208:3-34\n   #7  ../layers/conv2d.fut:13:26-162\n   #8  ../layers/conv2d.fut:26:17-54\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    for (int64_t i_113725 = 0; i_113725 < (int64_t) 2304;
                         i_113725++) {
                        double tmp_113726 =
                               ((double *) mem_98703)[(int64_t) 30 * i_85193 +
                                                      i_85189 +
                                                      (squot64(i_113725,
                                                               (int64_t) 9) *
                                                       (int64_t) 900 +
                                                       squot64(i_113725 -
                                                               squot64(i_113725,
                                                                       (int64_t) 9) *
                                                               (int64_t) 9,
                                                               (int64_t) 3) *
                                                       (int64_t) 30 +
                                                       (i_113725 -
                                                        squot64(i_113725,
                                                                (int64_t) 9) *
                                                        (int64_t) 9 -
                                                        squot64(i_113725 -
                                                                squot64(i_113725,
                                                                        (int64_t) 9) *
                                                                (int64_t) 9,
                                                                (int64_t) 3) *
                                                        (int64_t) 3))];
                        
                        ((double *) mem_98787)[i_85193 * (int64_t) 64512 +
                                               i_85189 * (int64_t) 2304 +
                                               i_113725] = tmp_113726;
                    }
                }
            }
            for (int32_t i_86811 = 0; i_86811 < 64; i_86811++) {
                int64_t i_85203 = sext_i32_i64(i_86811);
                double x_72400 = ((double *) mem_95787.mem)[i_85203];
                int64_t binop_x_87508 = (int64_t) 2304 * i_85203;
                
                for (int32_t i_86876 = 0; i_86876 < 784; i_86876++) {
                    int64_t i_85199 = sext_i32_i64(i_86876);
                    int64_t binop_x_87510 = (int64_t) 2304 * i_85199;
                    double defunc_2_reduce_res_73917;
                    double redout_85195 = 0.0;
                    
                    for (int32_t i_86877 = 0; i_86877 < 2304; i_86877++) {
                        int64_t i_85196 = sext_i32_i64(i_86877);
                        int64_t new_index_87509 = i_85196 + binop_x_87508;
                        double x_73242 =
                               ((double *) mem_95949.mem)[new_index_87509];
                        int64_t binop_x_87511 = i_85196 + binop_x_87510;
                        int64_t new_index_87512 = squot64(binop_x_87511,
                                                          (int64_t) 64512);
                        int64_t binop_y_87518 = (int64_t) 64512 *
                                new_index_87512;
                        int64_t binop_x_87519 = binop_x_87511 - binop_y_87518;
                        int64_t new_index_87520 = squot64(binop_x_87519,
                                                          (int64_t) 2304);
                        int64_t binop_y_87536 = (int64_t) 2304 *
                                new_index_87520;
                        int64_t new_index_87537 = binop_x_87519 - binop_y_87536;
                        double x_73243 =
                               ((double *) mem_98787)[new_index_87512 *
                                                      (int64_t) 64512 +
                                                      new_index_87520 *
                                                      (int64_t) 2304 +
                                                      new_index_87537];
                        double defunc_1_f_res_73244 = x_73242 * x_73243;
                        double defunc_1_op_res_73237 = defunc_1_f_res_73244 +
                               redout_85195;
                        double redout_tmp_113729 = defunc_1_op_res_73237;
                        
                        redout_85195 = redout_tmp_113729;
                    }
                    defunc_2_reduce_res_73917 = redout_85195;
                    
                    double defunc_0_f_res_73240 = x_72400 +
                           defunc_2_reduce_res_73917;
                    
                    ((double *) mem_98839)[i_85203 * (int64_t) 784 + i_85199] =
                        defunc_0_f_res_73240;
                }
            }
            for (int32_t i_86812 = 0; i_86812 < 64; i_86812++) {
                int64_t i_85215 = sext_i32_i64(i_86812);
                int64_t binop_x_87492 = (int64_t) 784 * i_85215;
                
                for (int32_t i_86874 = 0; i_86874 < 28; i_86874++) {
                    int64_t i_85211 = sext_i32_i64(i_86874);
                    int64_t binop_y_87493 = (int64_t) 28 * i_85211;
                    int64_t binop_x_87494 = binop_x_87492 + binop_y_87493;
                    
                    for (int32_t i_86875 = 0; i_86875 < 28; i_86875++) {
                        int64_t i_85207 = sext_i32_i64(i_86875);
                        int64_t binop_x_87495 = i_85207 + binop_x_87494;
                        int64_t new_index_87496 = squot64(binop_x_87495,
                                                          (int64_t) 784);
                        int64_t binop_y_87506 = (int64_t) 784 * new_index_87496;
                        int64_t new_index_87507 = binop_x_87495 - binop_y_87506;
                        double x_58540 =
                               ((double *) mem_98839)[new_index_87496 *
                                                      (int64_t) 784 +
                                                      new_index_87507];
                        double max_res_58541 = fmax64(0.0, x_58540);
                        
                        ((double *) mem_98879)[i_85215 * (int64_t) 784 +
                                               i_85211 * (int64_t) 28 +
                                               i_85207] = max_res_58541;
                    }
                }
            }
            for (int32_t i_86813 = 0; i_86813 < 32; i_86813++) {
                int64_t i_85219 = sext_i32_i64(i_86813);
                int64_t i_58552 = mul64((int64_t) 2, i_85219);
                int64_t x_58553 = add64((int64_t) 1, i_85219);
                int64_t j_58554 = mul64((int64_t) 2, x_58553);
                int64_t j_m_i_58555 = sub64(j_58554, i_58552);
                bool empty_slice_58556 = j_m_i_58555 == (int64_t) 0;
                int64_t m_58557 = sub64(j_m_i_58555, (int64_t) 1);
                int64_t i_p_m_t_s_58558 = add64(i_58552, m_58557);
                bool zzero_leq_i_p_m_t_s_58559 = sle64((int64_t) 0,
                                                       i_p_m_t_s_58558);
                bool i_p_m_t_s_leq_w_58560 = slt64(i_p_m_t_s_58558,
                                                   (int64_t) 64);
                bool zzero_lte_i_58561 = sle64((int64_t) 0, i_58552);
                bool i_lte_j_58562 = sle64(i_58552, j_58554);
                bool y_58563 = i_p_m_t_s_leq_w_58560 && zzero_lte_i_58561;
                bool y_58564 = zzero_leq_i_p_m_t_s_58559 && y_58563;
                bool y_58565 = i_lte_j_58562 && y_58564;
                bool forwards_ok_58566 = zzero_lte_i_58561 && y_58565;
                bool ok_or_empty_58567 = empty_slice_58556 || forwards_ok_58566;
                bool index_certs_58568;
                
                if (!ok_or_empty_58567) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Index [", (long long) i_58552, ":",
                                        (long long) j_58554,
                                        "] out of bounds for array of shape [",
                                        (long long) (int64_t) 64, "].",
                                        "-> #0  ../layers/groupnorm.fut:2:31-70\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  ../layers/groupnorm.fut:2:3-97\n   #4  ../layers/groupnorm.fut:15:19-54\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool dim_match_58569 = (int64_t) 2 == j_m_i_58555;
                bool empty_or_match_cert_58570;
                
                if (!dim_match_58569) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Value of (core language) shape (",
                                        (long long) j_m_i_58555, ", ",
                                        (long long) (int64_t) 28, ", ",
                                        (long long) (int64_t) 28,
                                        ") cannot match shape of type `[",
                                        (long long) (int64_t) 2, "][",
                                        (long long) (int64_t) 28, "][",
                                        (long long) (int64_t) 28, "]f64`.",
                                        "-> #0  ../layers/groupnorm.fut:2:31-96\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  ../layers/groupnorm.fut:2:3-97\n   #4  ../layers/groupnorm.fut:15:19-54\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if ((int64_t) 12544 > 0)
                    memmove(mem_98963 + i_85219 * (int64_t) 1568 * (int64_t) 8,
                            mem_98879 + (int64_t) 784 * i_58552 * (int64_t) 8,
                            (int64_t) 12544);
            }
            for (int32_t i_86814 = 0; i_86814 < 32; i_86814++) {
                int64_t i_85229 = sext_i32_i64(i_86814);
                int64_t binop_x_87426 = (int64_t) 1568 * i_85229;
                double defunc_2_reduce_res_73921;
                double redout_85221 = 0.0;
                
                for (int32_t i_86870 = 0; i_86870 < 1568; i_86870++) {
                    int64_t i_85222 = sext_i32_i64(i_86870);
                    int64_t binop_x_87427 = i_85222 + binop_x_87426;
                    int64_t new_index_87428 = squot64(binop_x_87427,
                                                      (int64_t) 1568);
                    int64_t binop_y_87434 = (int64_t) 1568 * new_index_87428;
                    int64_t binop_x_87435 = binop_x_87427 - binop_y_87434;
                    int64_t new_index_87436 = squot64(binop_x_87435,
                                                      (int64_t) 784);
                    int64_t binop_y_87452 = (int64_t) 784 * new_index_87436;
                    int64_t binop_x_87453 = binop_x_87435 - binop_y_87452;
                    int64_t new_index_87454 = squot64(binop_x_87453,
                                                      (int64_t) 28);
                    int64_t binop_y_87490 = (int64_t) 28 * new_index_87454;
                    int64_t new_index_87491 = binop_x_87453 - binop_y_87490;
                    double x_58586 = ((double *) mem_98963)[new_index_87428 *
                                                            (int64_t) 1568 +
                                                            new_index_87436 *
                                                            (int64_t) 784 +
                                                            new_index_87454 *
                                                            (int64_t) 28 +
                                                            new_index_87491];
                    double defunc_1_op_res_58585 = x_58586 + redout_85221;
                    double redout_tmp_113736 = defunc_1_op_res_58585;
                    
                    redout_85221 = redout_tmp_113736;
                }
                defunc_2_reduce_res_73921 = redout_85221;
                
                double calc_mean_flat_res_58587 = defunc_2_reduce_res_73921 /
                       1568.0;
                double defunc_2_reduce_res_73922;
                double redout_85223 = 0.0;
                
                for (int32_t i_86871 = 0; i_86871 < 1568; i_86871++) {
                    int64_t i_85224 = sext_i32_i64(i_86871);
                    int64_t binop_x_87361 = i_85224 + binop_x_87426;
                    int64_t new_index_87362 = squot64(binop_x_87361,
                                                      (int64_t) 1568);
                    int64_t binop_y_87368 = (int64_t) 1568 * new_index_87362;
                    int64_t binop_x_87369 = binop_x_87361 - binop_y_87368;
                    int64_t new_index_87370 = squot64(binop_x_87369,
                                                      (int64_t) 784);
                    int64_t binop_y_87386 = (int64_t) 784 * new_index_87370;
                    int64_t binop_x_87387 = binop_x_87369 - binop_y_87386;
                    int64_t new_index_87388 = squot64(binop_x_87387,
                                                      (int64_t) 28);
                    int64_t binop_y_87424 = (int64_t) 28 * new_index_87388;
                    int64_t new_index_87425 = binop_x_87387 - binop_y_87424;
                    double x_58594 = ((double *) mem_98963)[new_index_87362 *
                                                            (int64_t) 1568 +
                                                            new_index_87370 *
                                                            (int64_t) 784 +
                                                            new_index_87388 *
                                                            (int64_t) 28 +
                                                            new_index_87425];
                    double x_58591 = x_58594 - calc_mean_flat_res_58587;
                    double x_58592 = fpow64(x_58591, 2.0);
                    double defunc_1_op_res_58593 = x_58592 + redout_85223;
                    double redout_tmp_113737 = defunc_1_op_res_58593;
                    
                    redout_85223 = redout_tmp_113737;
                }
                defunc_2_reduce_res_73922 = redout_85223;
                
                double defunc_0_f_res_58595 = defunc_2_reduce_res_73922 /
                       1568.0;
                
                ((double *) mem_98993)[i_85229] = calc_mean_flat_res_58587;
                ((double *) mem_98995)[i_85229] = defunc_0_f_res_58595;
            }
            for (int32_t i_86815 = 0; i_86815 < 64; i_86815++) {
                int64_t i_85250 = sext_i32_i64(i_86815);
                double x_72333 = ((double *) mem_96285)[i_85250];
                bool x_72334 = sle64((int64_t) 0, i_85250);
                bool y_72335 = slt64(i_85250, (int64_t) 64);
                bool bounds_check_72336 = x_72334 && y_72335;
                int64_t i_72337 = sdiv64(i_85250, (int64_t) 2);
                bool x_72338 = sle64((int64_t) 0, i_72337);
                bool y_72339 = slt64(i_72337, (int64_t) 32);
                bool bounds_check_72340 = x_72338 && y_72339;
                bool index_certs_72341;
                
                if (!bounds_check_72340) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Index [", (long long) i_72337,
                                        "] out of bounds for array of shape [",
                                        (long long) (int64_t) 32, "].",
                                        "-> #0  ../layers/groupnorm.fut:17:57-77\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  /prelude/functional.fut:39:59-65\n   #7  /prelude/soacs.fut:59:3-10\n   #8  /prelude/array.fut:216:3-39\n   #9  ../layers/groupnorm.fut:17:13-119\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                double y_72342 = ((double *) mem_98993)[i_72337];
                double x_72343 = ((double *) mem_98995)[i_72337];
                double sqrt_arg_72344 = 1.0e-5 + x_72343;
                double sqrt_res_72345 = futrts_sqrt64(sqrt_arg_72344);
                
                for (int32_t i_86856 = 0; i_86856 < 28; i_86856++) {
                    int64_t i_85238 = sext_i32_i64(i_86856);
                    bool x_73255 = sle64((int64_t) 0, i_85238);
                    bool y_73256 = slt64(i_85238, (int64_t) 28);
                    bool bounds_check_73257 = x_73255 && y_73256;
                    
                    for (int32_t i_86863 = 0; i_86863 < 28; i_86863++) {
                        int64_t i_85234 = sext_i32_i64(i_86863);
                        bool x_73275 = sle64((int64_t) 0, i_85234);
                        bool y_73276 = slt64(i_85234, (int64_t) 28);
                        bool bounds_check_73277 = x_73275 && y_73276;
                        bool y_73278 = bounds_check_72336 && bounds_check_73277;
                        bool index_ok_73279 = bounds_check_73257 && y_73278;
                        bool index_certs_73280;
                        
                        if (!index_ok_73279) {
                            set_error(ctx,
                                      msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                "Index [", (long long) i_85250,
                                                ", ", (long long) i_85238, ", ",
                                                (long long) i_85234,
                                                "] out of bounds for array of shape [",
                                                (long long) (int64_t) 64, "][",
                                                (long long) (int64_t) 28, "][",
                                                (long long) (int64_t) 28, "].",
                                                "-> #0  ../layers/groupnorm.fut:17:44-53\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  /prelude/functional.fut:39:59-65\n   #7  /prelude/soacs.fut:59:3-10\n   #8  /prelude/array.fut:216:3-39\n   #9  ../layers/groupnorm.fut:17:13-119\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        double x_73281 = ((double *) mem_98879)[i_85250 *
                                                                (int64_t) 784 +
                                                                i_85238 *
                                                                (int64_t) 28 +
                                                                i_85234];
                        double x_73282 = x_73281 - y_72342;
                        double defunc_0_f_res_73283 = x_73282 / sqrt_res_72345;
                        double defunc_0_f_res_73285 = x_72333 +
                               defunc_0_f_res_73283;
                        
                        ((double *) mem_99030)[i_85238 * (int64_t) 28 +
                                               i_85234] = defunc_0_f_res_73285;
                    }
                }
                for (int32_t i_86857 = 0; i_86857 < 30; i_86857++) {
                    int64_t i_85246 = sext_i32_i64(i_86857);
                    bool cond_72371 = slt64(i_85246, (int64_t) 1);
                    bool cond_f_res_72372 = sle64((int64_t) 29, i_85246);
                    bool x_72373 = !cond_72371;
                    bool y_72374 = cond_f_res_72372 && x_72373;
                    bool cond_72375 = cond_72371 || y_72374;
                    bool x_72376 = !cond_72375;
                    
                    for (int32_t i_86858 = 0; i_86858 < 30; i_86858++) {
                        int64_t i_85242 = sext_i32_i64(i_86858);
                        bool cond_f_res_72379 = slt64(i_85242, (int64_t) 1);
                        bool y_72380 = x_72376 && cond_f_res_72379;
                        bool cond_72381 = cond_72375 || y_72380;
                        bool cond_f_res_72382 = sle64((int64_t) 29, i_85242);
                        bool x_72383 = !cond_72381;
                        bool y_72384 = cond_f_res_72382 && x_72383;
                        bool cond_72385 = cond_72381 || y_72384;
                        double defunc_0_f_res_72386;
                        
                        if (cond_72385 == 1) {
                            defunc_0_f_res_72386 = 0.0;
                        } else {
                            int64_t i_72387 = sub64(i_85246, (int64_t) 1);
                            bool x_72388 = sle64((int64_t) 0, i_72387);
                            bool y_72389 = slt64(i_72387, (int64_t) 28);
                            bool bounds_check_72390 = x_72388 && y_72389;
                            int64_t i_72391 = sub64(i_85242, (int64_t) 1);
                            bool x_72392 = sle64((int64_t) 0, i_72391);
                            bool y_72393 = slt64(i_72391, (int64_t) 28);
                            bool bounds_check_72394 = x_72392 && y_72393;
                            bool index_ok_72395 = bounds_check_72390 &&
                                 bounds_check_72394;
                            bool index_certs_72396;
                            
                            if (!index_ok_72395) {
                                set_error(ctx,
                                          msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                    "Index [",
                                                    (long long) i_72387, ", ",
                                                    (long long) i_72391,
                                                    "] out of bounds for array of shape [",
                                                    (long long) (int64_t) 28,
                                                    "][",
                                                    (long long) (int64_t) 28,
                                                    "].",
                                                    "-> #0  ../layers/conv2d.fut:7:91-116\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  ../layers/conv2d.fut:6:22-7:117\n   #7  ../layers/conv2d.fut:6:6-7:123\n   #8  ../layers/conv2d.fut:22:7-30\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            double defunc_0_f_res_f_res_72397 =
                                   ((double *) mem_99030)[i_72387 *
                                                          (int64_t) 28 +
                                                          i_72391];
                            
                            defunc_0_f_res_72386 = defunc_0_f_res_f_res_72397;
                        }
                        ((double *) mem_99017)[i_85250 * (int64_t) 900 +
                                               i_85246 * (int64_t) 30 +
                                               i_85242] = defunc_0_f_res_72386;
                    }
                }
            }
            for (int32_t i_86816 = 0; i_86816 < 28; i_86816++) {
                int64_t i_85258 = sext_i32_i64(i_86816);
                int64_t j_58711 = add64((int64_t) 3, i_85258);
                int64_t i_p_m_t_s_58712 = add64((int64_t) 2, i_85258);
                bool zzero_leq_i_p_m_t_s_58713 = sle64((int64_t) 0,
                                                       i_p_m_t_s_58712);
                bool i_p_m_t_s_leq_w_58714 = slt64(i_p_m_t_s_58712,
                                                   (int64_t) 30);
                bool zzero_lte_i_58715 = sle64((int64_t) 0, i_85258);
                bool i_lte_j_58716 = sle64(i_85258, j_58711);
                bool y_58717 = i_p_m_t_s_leq_w_58714 && zzero_lte_i_58715;
                bool y_58718 = zzero_leq_i_p_m_t_s_58713 && y_58717;
                bool y_58719 = i_lte_j_58716 && y_58718;
                bool forwards_ok_58720 = zzero_lte_i_58715 && y_58719;
                
                for (int32_t i_86851 = 0; i_86851 < 28; i_86851++) {
                    int64_t i_85254 = sext_i32_i64(i_86851);
                    int64_t j_58724 = add64((int64_t) 3, i_85254);
                    int64_t i_p_m_t_s_58725 = add64((int64_t) 2, i_85254);
                    bool zzero_leq_i_p_m_t_s_58726 = sle64((int64_t) 0,
                                                           i_p_m_t_s_58725);
                    bool i_p_m_t_s_leq_w_58727 = slt64(i_p_m_t_s_58725,
                                                       (int64_t) 30);
                    bool zzero_lte_i_58728 = sle64((int64_t) 0, i_85254);
                    bool i_lte_j_58729 = sle64(i_85254, j_58724);
                    bool y_58730 = i_p_m_t_s_leq_w_58727 && zzero_lte_i_58728;
                    bool y_58731 = zzero_leq_i_p_m_t_s_58726 && y_58730;
                    bool y_58732 = i_lte_j_58729 && y_58731;
                    bool forwards_ok_58733 = zzero_lte_i_58728 && y_58732;
                    bool index_ok_58735 = forwards_ok_58720 &&
                         forwards_ok_58733;
                    bool index_certs_58736;
                    
                    if (!index_ok_58735) {
                        set_error(ctx,
                                  msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                            "Index [", (long long) i_85258, ":",
                                            (long long) j_58711, ", ",
                                            (long long) i_85254, ":",
                                            (long long) j_58724,
                                            "] out of bounds for array of shape [",
                                            (long long) (int64_t) 30, "][",
                                            (long long) (int64_t) 30, "].",
                                            "-> #0  ../layers/conv2d.fut:13:90-124\n   #1  ../layers/conv2d.fut:13:69-146\n   #2  /prelude/soacs.fut:59:3-10\n   #3  /prelude/array.fut:200:3-17\n   #4  /prelude/functional.fut:39:59-65\n   #5  /prelude/soacs.fut:59:3-10\n   #6  /prelude/array.fut:208:3-34\n   #7  ../layers/conv2d.fut:13:26-162\n   #8  ../layers/conv2d.fut:26:17-54\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    for (int64_t i_113745 = 0; i_113745 < (int64_t) 576;
                         i_113745++) {
                        double tmp_113746 =
                               ((double *) mem_99017)[(int64_t) 30 * i_85258 +
                                                      i_85254 +
                                                      (squot64(i_113745,
                                                               (int64_t) 9) *
                                                       (int64_t) 900 +
                                                       squot64(i_113745 -
                                                               squot64(i_113745,
                                                                       (int64_t) 9) *
                                                               (int64_t) 9,
                                                               (int64_t) 3) *
                                                       (int64_t) 30 +
                                                       (i_113745 -
                                                        squot64(i_113745,
                                                                (int64_t) 9) *
                                                        (int64_t) 9 -
                                                        squot64(i_113745 -
                                                                squot64(i_113745,
                                                                        (int64_t) 9) *
                                                                (int64_t) 9,
                                                                (int64_t) 3) *
                                                        (int64_t) 3))];
                        
                        ((double *) mem_99141)[i_85258 * (int64_t) 16128 +
                                               i_85254 * (int64_t) 576 +
                                               i_113745] = tmp_113746;
                    }
                }
            }
            for (int32_t i_86817 = 0; i_86817 < 64; i_86817++) {
                int64_t i_85268 = sext_i32_i64(i_86817);
                double x_72277 = ((double *) mem_95783.mem)[i_85268];
                int64_t binop_x_87330 = (int64_t) 576 * i_85268;
                
                for (int32_t i_86849 = 0; i_86849 < 784; i_86849++) {
                    int64_t i_85264 = sext_i32_i64(i_86849);
                    int64_t binop_x_87332 = (int64_t) 576 * i_85264;
                    double defunc_2_reduce_res_73928;
                    double redout_85260 = 0.0;
                    
                    for (int32_t i_86850 = 0; i_86850 < 576; i_86850++) {
                        int64_t i_85261 = sext_i32_i64(i_86850);
                        int64_t new_index_87331 = i_85261 + binop_x_87330;
                        double x_73307 =
                               ((double *) mem_96081.mem)[new_index_87331];
                        int64_t binop_x_87333 = i_85261 + binop_x_87332;
                        int64_t new_index_87334 = squot64(binop_x_87333,
                                                          (int64_t) 16128);
                        int64_t binop_y_87340 = (int64_t) 16128 *
                                new_index_87334;
                        int64_t binop_x_87341 = binop_x_87333 - binop_y_87340;
                        int64_t new_index_87342 = squot64(binop_x_87341,
                                                          (int64_t) 576);
                        int64_t binop_y_87358 = (int64_t) 576 * new_index_87342;
                        int64_t new_index_87359 = binop_x_87341 - binop_y_87358;
                        double x_73308 =
                               ((double *) mem_99141)[new_index_87334 *
                                                      (int64_t) 16128 +
                                                      new_index_87342 *
                                                      (int64_t) 576 +
                                                      new_index_87359];
                        double defunc_1_f_res_73309 = x_73307 * x_73308;
                        double defunc_1_op_res_73302 = defunc_1_f_res_73309 +
                               redout_85260;
                        double redout_tmp_113749 = defunc_1_op_res_73302;
                        
                        redout_85260 = redout_tmp_113749;
                    }
                    defunc_2_reduce_res_73928 = redout_85260;
                    
                    double defunc_0_f_res_73305 = x_72277 +
                           defunc_2_reduce_res_73928;
                    
                    ((double *) mem_99193)[i_85268 * (int64_t) 784 + i_85264] =
                        defunc_0_f_res_73305;
                }
            }
            for (int32_t i_86818 = 0; i_86818 < 64; i_86818++) {
                int64_t i_85280 = sext_i32_i64(i_86818);
                int64_t binop_x_87314 = (int64_t) 784 * i_85280;
                
                for (int32_t i_86847 = 0; i_86847 < 28; i_86847++) {
                    int64_t i_85276 = sext_i32_i64(i_86847);
                    int64_t binop_y_87315 = (int64_t) 28 * i_85276;
                    int64_t binop_x_87316 = binop_x_87314 + binop_y_87315;
                    
                    for (int32_t i_86848 = 0; i_86848 < 28; i_86848++) {
                        int64_t i_85272 = sext_i32_i64(i_86848);
                        int64_t binop_x_87317 = i_85272 + binop_x_87316;
                        int64_t new_index_87318 = squot64(binop_x_87317,
                                                          (int64_t) 784);
                        int64_t binop_y_87328 = (int64_t) 784 * new_index_87318;
                        int64_t new_index_87329 = binop_x_87317 - binop_y_87328;
                        double x_58779 =
                               ((double *) mem_99193)[new_index_87318 *
                                                      (int64_t) 784 +
                                                      new_index_87329];
                        double max_res_58780 = fmax64(0.0, x_58779);
                        
                        ((double *) mem_99233)[i_85280 * (int64_t) 784 +
                                               i_85276 * (int64_t) 28 +
                                               i_85272] = max_res_58780;
                    }
                }
            }
            for (int32_t i_86819 = 0; i_86819 < 32; i_86819++) {
                int64_t i_85284 = sext_i32_i64(i_86819);
                int64_t i_58783 = mul64((int64_t) 2, i_85284);
                int64_t x_58784 = add64((int64_t) 1, i_85284);
                int64_t j_58785 = mul64((int64_t) 2, x_58784);
                int64_t j_m_i_58786 = sub64(j_58785, i_58783);
                bool empty_slice_58787 = j_m_i_58786 == (int64_t) 0;
                int64_t m_58788 = sub64(j_m_i_58786, (int64_t) 1);
                int64_t i_p_m_t_s_58789 = add64(i_58783, m_58788);
                bool zzero_leq_i_p_m_t_s_58790 = sle64((int64_t) 0,
                                                       i_p_m_t_s_58789);
                bool i_p_m_t_s_leq_w_58791 = slt64(i_p_m_t_s_58789,
                                                   (int64_t) 64);
                bool zzero_lte_i_58792 = sle64((int64_t) 0, i_58783);
                bool i_lte_j_58793 = sle64(i_58783, j_58785);
                bool y_58794 = i_p_m_t_s_leq_w_58791 && zzero_lte_i_58792;
                bool y_58795 = zzero_leq_i_p_m_t_s_58790 && y_58794;
                bool y_58796 = i_lte_j_58793 && y_58795;
                bool forwards_ok_58797 = zzero_lte_i_58792 && y_58796;
                bool ok_or_empty_58798 = empty_slice_58787 || forwards_ok_58797;
                bool index_certs_58799;
                
                if (!ok_or_empty_58798) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Index [", (long long) i_58783, ":",
                                        (long long) j_58785,
                                        "] out of bounds for array of shape [",
                                        (long long) (int64_t) 64, "].",
                                        "-> #0  ../layers/groupnorm.fut:2:31-70\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  ../layers/groupnorm.fut:2:3-97\n   #4  ../layers/groupnorm.fut:15:19-54\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool dim_match_58800 = (int64_t) 2 == j_m_i_58786;
                bool empty_or_match_cert_58801;
                
                if (!dim_match_58800) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Value of (core language) shape (",
                                        (long long) j_m_i_58786, ", ",
                                        (long long) (int64_t) 28, ", ",
                                        (long long) (int64_t) 28,
                                        ") cannot match shape of type `[",
                                        (long long) (int64_t) 2, "][",
                                        (long long) (int64_t) 28, "][",
                                        (long long) (int64_t) 28, "]f64`.",
                                        "-> #0  ../layers/groupnorm.fut:2:31-96\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  ../layers/groupnorm.fut:2:3-97\n   #4  ../layers/groupnorm.fut:15:19-54\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if ((int64_t) 12544 > 0)
                    memmove(mem_99317 + i_85284 * (int64_t) 1568 * (int64_t) 8,
                            mem_99233 + (int64_t) 784 * i_58783 * (int64_t) 8,
                            (int64_t) 12544);
            }
            for (int32_t i_86820 = 0; i_86820 < 32; i_86820++) {
                int64_t i_85294 = sext_i32_i64(i_86820);
                int64_t binop_x_87248 = (int64_t) 1568 * i_85294;
                double defunc_2_reduce_res_73932;
                double redout_85286 = 0.0;
                
                for (int32_t i_86843 = 0; i_86843 < 1568; i_86843++) {
                    int64_t i_85287 = sext_i32_i64(i_86843);
                    int64_t binop_x_87249 = i_85287 + binop_x_87248;
                    int64_t new_index_87250 = squot64(binop_x_87249,
                                                      (int64_t) 1568);
                    int64_t binop_y_87256 = (int64_t) 1568 * new_index_87250;
                    int64_t binop_x_87257 = binop_x_87249 - binop_y_87256;
                    int64_t new_index_87258 = squot64(binop_x_87257,
                                                      (int64_t) 784);
                    int64_t binop_y_87274 = (int64_t) 784 * new_index_87258;
                    int64_t binop_x_87275 = binop_x_87257 - binop_y_87274;
                    int64_t new_index_87276 = squot64(binop_x_87275,
                                                      (int64_t) 28);
                    int64_t binop_y_87312 = (int64_t) 28 * new_index_87276;
                    int64_t new_index_87313 = binop_x_87275 - binop_y_87312;
                    double x_58811 = ((double *) mem_99317)[new_index_87250 *
                                                            (int64_t) 1568 +
                                                            new_index_87258 *
                                                            (int64_t) 784 +
                                                            new_index_87276 *
                                                            (int64_t) 28 +
                                                            new_index_87313];
                    double defunc_1_op_res_58810 = x_58811 + redout_85286;
                    double redout_tmp_113756 = defunc_1_op_res_58810;
                    
                    redout_85286 = redout_tmp_113756;
                }
                defunc_2_reduce_res_73932 = redout_85286;
                
                double calc_mean_flat_res_58812 = defunc_2_reduce_res_73932 /
                       1568.0;
                double defunc_2_reduce_res_73933;
                double redout_85288 = 0.0;
                
                for (int32_t i_86844 = 0; i_86844 < 1568; i_86844++) {
                    int64_t i_85289 = sext_i32_i64(i_86844);
                    int64_t binop_x_87183 = i_85289 + binop_x_87248;
                    int64_t new_index_87184 = squot64(binop_x_87183,
                                                      (int64_t) 1568);
                    int64_t binop_y_87190 = (int64_t) 1568 * new_index_87184;
                    int64_t binop_x_87191 = binop_x_87183 - binop_y_87190;
                    int64_t new_index_87192 = squot64(binop_x_87191,
                                                      (int64_t) 784);
                    int64_t binop_y_87208 = (int64_t) 784 * new_index_87192;
                    int64_t binop_x_87209 = binop_x_87191 - binop_y_87208;
                    int64_t new_index_87210 = squot64(binop_x_87209,
                                                      (int64_t) 28);
                    int64_t binop_y_87246 = (int64_t) 28 * new_index_87210;
                    int64_t new_index_87247 = binop_x_87209 - binop_y_87246;
                    double x_58819 = ((double *) mem_99317)[new_index_87184 *
                                                            (int64_t) 1568 +
                                                            new_index_87192 *
                                                            (int64_t) 784 +
                                                            new_index_87210 *
                                                            (int64_t) 28 +
                                                            new_index_87247];
                    double x_58816 = x_58819 - calc_mean_flat_res_58812;
                    double x_58817 = fpow64(x_58816, 2.0);
                    double defunc_1_op_res_58818 = x_58817 + redout_85288;
                    double redout_tmp_113757 = defunc_1_op_res_58818;
                    
                    redout_85288 = redout_tmp_113757;
                }
                defunc_2_reduce_res_73933 = redout_85288;
                
                double defunc_0_f_res_58820 = defunc_2_reduce_res_73933 /
                       1568.0;
                
                ((double *) mem_99347)[i_85294] = calc_mean_flat_res_58812;
                ((double *) mem_99349)[i_85294] = defunc_0_f_res_58820;
            }
            for (int32_t i_86821 = 0; i_86821 < 64; i_86821++) {
                int64_t i_85307 = sext_i32_i64(i_86821);
                bool x_58823 = sle64((int64_t) 0, i_85307);
                bool y_58824 = slt64(i_85307, (int64_t) 64);
                bool bounds_check_58825 = x_58823 && y_58824;
                int64_t i_58826 = sdiv64(i_85307, (int64_t) 2);
                bool x_58827 = sle64((int64_t) 0, i_58826);
                bool y_58828 = slt64(i_58826, (int64_t) 32);
                bool bounds_check_58829 = x_58827 && y_58828;
                bool index_certs_58830;
                
                if (!bounds_check_58829) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Index [", (long long) i_58826,
                                        "] out of bounds for array of shape [",
                                        (long long) (int64_t) 32, "].",
                                        "-> #0  ../layers/groupnorm.fut:17:57-77\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  /prelude/functional.fut:39:59-65\n   #7  /prelude/soacs.fut:59:3-10\n   #8  /prelude/array.fut:216:3-39\n   #9  ../layers/groupnorm.fut:17:13-119\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                double y_58831 = ((double *) mem_99347)[i_58826];
                double x_58832 = ((double *) mem_99349)[i_58826];
                double sqrt_arg_58833 = 1.0e-5 + x_58832;
                double sqrt_res_58834 = futrts_sqrt64(sqrt_arg_58833);
                
                for (int32_t i_86835 = 0; i_86835 < 28; i_86835++) {
                    int64_t i_85303 = sext_i32_i64(i_86835);
                    bool x_58837 = sle64((int64_t) 0, i_85303);
                    bool y_58838 = slt64(i_85303, (int64_t) 28);
                    bool bounds_check_58839 = x_58837 && y_58838;
                    
                    for (int32_t i_86836 = 0; i_86836 < 28; i_86836++) {
                        int64_t i_85299 = sext_i32_i64(i_86836);
                        bool x_58842 = sle64((int64_t) 0, i_85299);
                        bool y_58843 = slt64(i_85299, (int64_t) 28);
                        bool bounds_check_58844 = x_58842 && y_58843;
                        bool y_58845 = bounds_check_58825 && bounds_check_58844;
                        bool index_ok_58846 = bounds_check_58839 && y_58845;
                        bool index_certs_58847;
                        
                        if (!index_ok_58846) {
                            set_error(ctx,
                                      msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                "Index [", (long long) i_85307,
                                                ", ", (long long) i_85303, ", ",
                                                (long long) i_85299,
                                                "] out of bounds for array of shape [",
                                                (long long) (int64_t) 64, "][",
                                                (long long) (int64_t) 28, "][",
                                                (long long) (int64_t) 28, "].",
                                                "-> #0  ../layers/groupnorm.fut:17:44-53\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  /prelude/functional.fut:39:59-65\n   #7  /prelude/soacs.fut:59:3-10\n   #8  /prelude/array.fut:216:3-39\n   #9  ../layers/groupnorm.fut:17:13-119\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        double x_58848 = ((double *) mem_99233)[i_85307 *
                                                                (int64_t) 784 +
                                                                i_85303 *
                                                                (int64_t) 28 +
                                                                i_85299];
                        double x_58849 = x_58848 - y_58831;
                        double defunc_0_f_res_58850 = x_58849 / sqrt_res_58834;
                        
                        ((double *) mem_99371)[i_85307 * (int64_t) 784 +
                                               i_85303 * (int64_t) 28 +
                                               i_85299] = defunc_0_f_res_58850;
                    }
                }
            }
            for (int32_t i_86822 = 0; i_86822 < 28; i_86822++) {
                int64_t i_85315 = sext_i32_i64(i_86822);
                int64_t j_56034 = add64((int64_t) 1, i_85315);
                bool zzero_leq_i_p_m_t_s_56036 = sle64((int64_t) 0, i_85315);
                bool i_p_m_t_s_leq_w_56037 = slt64(i_85315, (int64_t) 28);
                bool i_lte_j_56039 = sle64(i_85315, j_56034);
                bool y_56040 = zzero_leq_i_p_m_t_s_56036 &&
                     i_p_m_t_s_leq_w_56037;
                bool y_56041 = zzero_leq_i_p_m_t_s_56036 && y_56040;
                bool y_56042 = i_lte_j_56039 && y_56041;
                bool forwards_ok_56043 = zzero_leq_i_p_m_t_s_56036 && y_56042;
                
                for (int32_t i_86830 = 0; i_86830 < 28; i_86830++) {
                    int64_t i_85311 = sext_i32_i64(i_86830);
                    int64_t j_56047 = add64((int64_t) 1, i_85311);
                    bool zzero_leq_i_p_m_t_s_56049 = sle64((int64_t) 0,
                                                           i_85311);
                    bool i_p_m_t_s_leq_w_56050 = slt64(i_85311, (int64_t) 28);
                    bool i_lte_j_56052 = sle64(i_85311, j_56047);
                    bool y_56053 = zzero_leq_i_p_m_t_s_56049 &&
                         i_p_m_t_s_leq_w_56050;
                    bool y_56054 = zzero_leq_i_p_m_t_s_56049 && y_56053;
                    bool y_56055 = i_lte_j_56052 && y_56054;
                    bool forwards_ok_56056 = zzero_leq_i_p_m_t_s_56049 &&
                         y_56055;
                    bool index_ok_56058 = forwards_ok_56043 &&
                         forwards_ok_56056;
                    bool index_certs_56059;
                    
                    if (!index_ok_56058) {
                        set_error(ctx,
                                  msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                            "Index [", (long long) i_85315, ":",
                                            (long long) j_56034, ", ",
                                            (long long) i_85311, ":",
                                            (long long) j_56047,
                                            "] out of bounds for array of shape [",
                                            (long long) (int64_t) 28, "][",
                                            (long long) (int64_t) 28, "].",
                                            "-> #0  ../layers/conv2d.fut:13:90-124\n   #1  ../layers/conv2d.fut:13:69-146\n   #2  /prelude/soacs.fut:59:3-10\n   #3  /prelude/array.fut:200:3-17\n   #4  /prelude/functional.fut:39:59-65\n   #5  /prelude/soacs.fut:59:3-10\n   #6  /prelude/array.fut:208:3-34\n   #7  ../layers/conv2d.fut:13:26-162\n   #8  ../layers/conv2d.fut:26:17-54\n   #9  test_diffusion.fut:62:22-116\n   #10 test_diffusion.fut:61:1-63:17\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    for (int64_t i_113763 = 0; i_113763 < (int64_t) 64;
                         i_113763++) {
                        double tmp_113764 =
                               ((double *) mem_99371)[(int64_t) 28 * i_85315 +
                                                      i_85311 + (i_113763 *
                                                                 (int64_t) 784 +
                                                                 (i_113763 -
                                                                  i_113763) *
                                                                 (int64_t) 28 +
                                                                 (i_113763 -
                                                                  i_113763 -
                                                                  (i_113763 -
                                                                   i_113763)))];
                        
                        ((double *) mem_99455)[i_85315 * (int64_t) 1792 +
                                               i_85311 * (int64_t) 64 +
                                               i_113763] = tmp_113764;
                    }
                }
            }
            for (int32_t i_86823 = 0; i_86823 < 784; i_86823++) {
                int64_t i_85321 = sext_i32_i64(i_86823);
                int64_t binop_x_87154 = (int64_t) 64 * i_85321;
                double defunc_2_reduce_res_73937;
                double redout_85317 = 0.0;
                
                for (int32_t i_86829 = 0; i_86829 < 64; i_86829++) {
                    int64_t i_85318 = sext_i32_i64(i_86829);
                    double x_73322 = ((double *) mem_95781.mem)[i_85318];
                    int64_t binop_x_87155 = i_85318 + binop_x_87154;
                    int64_t new_index_87156 = squot64(binop_x_87155,
                                                      (int64_t) 1792);
                    int64_t binop_y_87162 = (int64_t) 1792 * new_index_87156;
                    int64_t binop_x_87163 = binop_x_87155 - binop_y_87162;
                    int64_t new_index_87164 = squot64(binop_x_87163,
                                                      (int64_t) 64);
                    int64_t binop_y_87180 = (int64_t) 64 * new_index_87164;
                    int64_t new_index_87181 = binop_x_87163 - binop_y_87180;
                    double x_73323 = ((double *) mem_99455)[new_index_87156 *
                                                            (int64_t) 1792 +
                                                            new_index_87164 *
                                                            (int64_t) 64 +
                                                            new_index_87181];
                    double defunc_1_f_res_73324 = x_73322 * x_73323;
                    double defunc_1_op_res_72271 = defunc_1_f_res_73324 +
                           redout_85317;
                    double redout_tmp_113766 = defunc_1_op_res_72271;
                    
                    redout_85317 = redout_tmp_113766;
                }
                defunc_2_reduce_res_73937 = redout_85317;
                
                double defunc_0_f_res_72274 = zp_res_61110 +
                       defunc_2_reduce_res_73937;
                
                ((double *) mem_99507)[i_85321] = defunc_0_f_res_72274;
            }
            if (cond_54940 == 1) {
                int32_t unsign_arg_73939 = 5460 ^ p_sample_arg_54950;
                int32_t unsign_arg_73940 = mul32(48271, unsign_arg_73939);
                int32_t unsign_arg_73941 = umod32(unsign_arg_73940, 2147483647);
                int32_t unsign_arg_73942 = mul32(48271, unsign_arg_73941);
                int32_t unsign_arg_73943 = umod32(unsign_arg_73942, 2147483647);
                
                if (mem_99521_cached_sizze_114810 < (int64_t) 6272) {
                    err = lexical_realloc(ctx, &mem_99521,
                                          &mem_99521_cached_sizze_114810,
                                          (int64_t) 6272);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                for (int32_t i_86826 = 0; i_86826 < 784; i_86826++) {
                    int64_t i_85325 = sext_i32_i64(i_86826);
                    int32_t x_73948 = lshr32(i_86826, 16);
                    int32_t x_73949 = x_73948 ^ i_86826;
                    int32_t x_73950 = mul32(73244475, x_73949);
                    int32_t x_73951 = lshr32(x_73950, 16);
                    int32_t x_73952 = x_73950 ^ x_73951;
                    int32_t x_73953 = mul32(73244475, x_73952);
                    int32_t x_73954 = lshr32(x_73953, 16);
                    int32_t x_73955 = x_73953 ^ x_73954;
                    int32_t unsign_arg_73956 = unsign_arg_73943 ^ x_73955;
                    int32_t unsign_arg_73957 = mul32(48271, unsign_arg_73956);
                    int32_t unsign_arg_73958 = umod32(unsign_arg_73957,
                                                      2147483647);
                    int32_t unsign_arg_73959 = mul32(48271, unsign_arg_73958);
                    int32_t unsign_arg_73960 = umod32(unsign_arg_73959,
                                                      2147483647);
                    double u64_res_73961 = uitofp_i32_f64(unsign_arg_73958);
                    double zs_res_73962 = u64_res_73961 / 2.147483647e9;
                    double u64_res_73963 = uitofp_i32_f64(unsign_arg_73960);
                    double zs_res_73964 = u64_res_73963 / 2.147483647e9;
                    double log_res_73965 = futrts_log64(zs_res_73962);
                    double zt_res_73966 = -2.0 * log_res_73965;
                    double sqrt_res_73967 = futrts_sqrt64(zt_res_73966);
                    double zt_res_73968 = 6.283185307179586 * zs_res_73964;
                    double cos_res_73969 = futrts_cos64(zt_res_73968);
                    double zt_res_73970 = sqrt_res_73967 * cos_res_73969;
                    
                    ((double *) mem_99521)[i_85325] = zt_res_73970;
                }
                if (memblock_alloc(ctx, &mem_99533, (int64_t) 6272,
                                   "mem_99533")) {
                    err = 1;
                    goto cleanup;
                }
                if ((int64_t) 6272 > 0)
                    memmove(mem_99533.mem + (int64_t) 0, mem_99521 +
                            (int64_t) 0, (int64_t) 6272);
                if (memblock_set(ctx, &ext_mem_99535, &mem_99533,
                                 "mem_99533") != 0)
                    return 1;
            } else {
                if (memblock_alloc(ctx, &mem_99519, (int64_t) 6272,
                                   "mem_99519")) {
                    err = 1;
                    goto cleanup;
                }
                for (int64_t i_113768 = 0; i_113768 < (int64_t) 28;
                     i_113768++) {
                    for (int64_t i_113769 = 0; i_113769 < (int64_t) 28;
                         i_113769++) {
                        ((double *) mem_99519.mem)[i_113768 * (int64_t) 28 +
                                                   i_113769] = 0.0;
                    }
                }
                if (memblock_set(ctx, &ext_mem_99535, &mem_99519,
                                 "mem_99519") != 0)
                    return 1;
            }
            for (int32_t i_86824 = 0; i_86824 < 28; i_86824++) {
                int64_t i_85333 = sext_i32_i64(i_86824);
                int64_t binop_x_87147 = (int64_t) 28 * i_85333;
                
                for (int32_t i_86825 = 0; i_86825 < 28; i_86825++) {
                    int64_t i_85329 = sext_i32_i64(i_86825);
                    double x_55041 = ((double *) mem_param_96223.mem)[i_85337 *
                                                                      (int64_t) 784 +
                                                                      i_85333 *
                                                                      (int64_t) 28 +
                                                                      i_85329];
                    int64_t binop_x_87148 = i_85329 + binop_x_87147;
                    int64_t binop_x_87151 = squot64(binop_x_87148,
                                                    (int64_t) 784);
                    int64_t binop_y_87152 = (int64_t) 784 * binop_x_87151;
                    int64_t new_index_87153 = binop_x_87148 - binop_y_87152;
                    double x_55042 = ((double *) mem_99507)[new_index_87153];
                    double x_55043 = ((double *) ext_mem_99535.mem)[i_85333 *
                                                                    (int64_t) 28 +
                                                                    i_85329];
                    double y_55044 = eps_coef_54938 * x_55042;
                    double y_55045 = x_55041 - y_55044;
                    double mean_55046 = x_54942 * y_55045;
                    double y_55047 = x_54943 * x_55043;
                    double defunc_2_f_res_55048 = mean_55046 + y_55047;
                    
                    ((double *) mem_96300.mem)[i_85337 * (int64_t) 784 +
                                               i_85333 * (int64_t) 28 +
                                               i_85329] = defunc_2_f_res_55048;
                }
            }
            if (memblock_unref(ctx, &ext_mem_99535, "ext_mem_99535") != 0)
                return 1;
        }
        if (memblock_set(ctx, &mem_param_tmp_113574, &mem_96300, "mem_96300") !=
            0)
            return 1;
        if (memblock_set(ctx, &mem_param_96223, &mem_param_tmp_113574,
                         "mem_param_tmp_113574") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_99617, &mem_param_96223,
                     "mem_param_96223") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_96133, "mem_96133") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_99622, bytes_96132, "mem_99622")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_85352 = 0; i_85352 < num_imgs_51163; i_85352++) {
        int64_t binop_x_87116 = (int64_t) 784 * i_85352;
        double defunc_2_reduce_res_74066;
        double defunc_2_reduce_res_74067;
        double redout_85339;
        double redout_85340;
        
        redout_85339 = -INFINITY;
        redout_85340 = INFINITY;
        for (int32_t i_86760 = 0; i_86760 < 784; i_86760++) {
            int64_t i_85341 = sext_i32_i64(i_86760);
            int64_t binop_x_87117 = i_85341 + binop_x_87116;
            int64_t new_index_87118 = squot64(binop_x_87117, (int64_t) 784);
            int64_t binop_y_87124 = (int64_t) 784 * new_index_87118;
            int64_t binop_x_87125 = binop_x_87117 - binop_y_87124;
            int64_t new_index_87126 = squot64(binop_x_87125, (int64_t) 28);
            int64_t binop_y_87142 = (int64_t) 28 * new_index_87126;
            int64_t new_index_87143 = binop_x_87125 - binop_y_87142;
            double x_73831 = ((double *) ext_mem_99617.mem)[new_index_87118 *
                                                            (int64_t) 784 +
                                                            new_index_87126 *
                                                            (int64_t) 28 +
                                                            new_index_87143];
            double defunc_1_op_res_55056 = fmax64(x_73831, redout_85339);
            double defunc_1_op_res_55061 = fmin64(x_73831, redout_85340);
            double redout_tmp_113773 = defunc_1_op_res_55056;
            double redout_tmp_113774 = defunc_1_op_res_55061;
            
            redout_85339 = redout_tmp_113773;
            redout_85340 = redout_tmp_113774;
        }
        defunc_2_reduce_res_74066 = redout_85339;
        defunc_2_reduce_res_74067 = redout_85340;
        
        double y_55063 = defunc_2_reduce_res_74066 - defunc_2_reduce_res_74067;
        
        for (int32_t i_86761 = 0; i_86761 < 28; i_86761++) {
            int64_t i_85348 = sext_i32_i64(i_86761);
            
            for (int32_t i_86762 = 0; i_86762 < 28; i_86762++) {
                int64_t i_85344 = sext_i32_i64(i_86762);
                double x_55067 = ((double *) ext_mem_99617.mem)[i_85352 *
                                                                (int64_t) 784 +
                                                                i_85348 *
                                                                (int64_t) 28 +
                                                                i_85344];
                double x_55068 = x_55067 - defunc_2_reduce_res_74067;
                double x_55069 = x_55068 / y_55063;
                double x_55070 = 2.0 * x_55069;
                double defunc_0_f_res_55071 = -1.0 + x_55070;
                
                ((double *) mem_99622.mem)[i_85352 * (int64_t) 784 + i_85348 *
                                           (int64_t) 28 + i_85344] =
                    defunc_0_f_res_55071;
            }
        }
    }
    if (memblock_unref(ctx, &ext_mem_99617, "ext_mem_99617") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_113560, &mem_99622, "mem_99622") != 0)
        return 1;
    (*mem_out_p_114731).references = NULL;
    if (memblock_set(ctx, &*mem_out_p_114731, &mem_out_113560,
                     "mem_out_113560") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_96146);
        free(mem_96171);
        free(mem_96225);
        free(mem_96227);
        free(mem_96249);
        free(mem_96261);
        free(mem_96273);
        free(mem_96285);
        free(mem_96313);
        free(mem_96353);
        free(mem_96355);
        free(mem_96407);
        free(mem_96447);
        free(mem_96531);
        free(mem_96583);
        free(mem_96623);
        free(mem_96707);
        free(mem_96737);
        free(mem_96739);
        free(mem_96761);
        free(mem_96774);
        free(mem_96885);
        free(mem_96937);
        free(mem_96977);
        free(mem_97061);
        free(mem_97091);
        free(mem_97093);
        free(mem_97115);
        free(mem_97117);
        free(mem_97283);
        free(mem_97335);
        free(mem_97375);
        free(mem_97459);
        free(mem_97489);
        free(mem_97491);
        free(mem_97513);
        free(mem_97526);
        free(mem_97637);
        free(mem_97689);
        free(mem_97729);
        free(mem_97813);
        free(mem_97843);
        free(mem_97845);
        free(mem_97867);
        free(mem_97951);
        free(mem_98035);
        free(mem_98087);
        free(mem_98127);
        free(mem_98211);
        free(mem_98241);
        free(mem_98243);
        free(mem_98265);
        free(mem_98278);
        free(mem_98389);
        free(mem_98441);
        free(mem_98481);
        free(mem_98565);
        free(mem_98595);
        free(mem_98597);
        free(mem_98619);
        free(mem_98703);
        free(mem_98787);
        free(mem_98839);
        free(mem_98879);
        free(mem_98963);
        free(mem_98993);
        free(mem_98995);
        free(mem_99017);
        free(mem_99030);
        free(mem_99141);
        free(mem_99193);
        free(mem_99233);
        free(mem_99317);
        free(mem_99347);
        free(mem_99349);
        free(mem_99371);
        free(mem_99455);
        free(mem_99507);
        free(mem_99521);
        if (memblock_unref(ctx, &mem_99622, "mem_99622") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113574,
                           "mem_param_tmp_113574") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_99519, "mem_99519") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_99533, "mem_99533") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_99535, "ext_mem_99535") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_96300, "mem_96300") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96223, "mem_param_96223") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_99617, "ext_mem_99617") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_96133, "mem_96133") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_113560, "mem_out_113560") != 0)
            return 1;
    }
    return err;
}
static int futrts_entry_diffusion_train(struct futhark_context *ctx,
                                        struct memblock *mem_out_p_114811,
                                        int64_t *out_prim_out_114812,
                                        struct memblock images_mem_96126,
                                        struct memblock alpha_bar_mem_96127,
                                        struct memblock time_seeds_mem_96128,
                                        struct memblock noise_seeds_mem_96129,
                                        int64_t l_49204, int64_t m_49205,
                                        int64_t n_49206, int64_t dz2080U_49207,
                                        int64_t epochs_49210)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_97633_cached_sizze_114813 = 0;
    unsigned char *mem_97633 = NULL;
    int64_t mem_97647_cached_sizze_114814 = 0;
    unsigned char *mem_97647 = NULL;
    int64_t mem_97690_cached_sizze_114815 = 0;
    unsigned char *mem_97690 = NULL;
    int64_t mem_97692_cached_sizze_114816 = 0;
    unsigned char *mem_97692 = NULL;
    int64_t mem_97716_cached_sizze_114817 = 0;
    unsigned char *mem_97716 = NULL;
    int64_t mem_97720_cached_sizze_114818 = 0;
    unsigned char *mem_97720 = NULL;
    int64_t mem_97806_cached_sizze_114819 = 0;
    unsigned char *mem_97806 = NULL;
    int64_t mem_97811_cached_sizze_114820 = 0;
    unsigned char *mem_97811 = NULL;
    int64_t mem_97872_cached_sizze_114821 = 0;
    unsigned char *mem_97872 = NULL;
    int64_t mem_97915_cached_sizze_114822 = 0;
    unsigned char *mem_97915 = NULL;
    int64_t mem_97999_cached_sizze_114823 = 0;
    unsigned char *mem_97999 = NULL;
    int64_t mem_98051_cached_sizze_114824 = 0;
    unsigned char *mem_98051 = NULL;
    int64_t mem_98091_cached_sizze_114825 = 0;
    unsigned char *mem_98091 = NULL;
    int64_t mem_98175_cached_sizze_114826 = 0;
    unsigned char *mem_98175 = NULL;
    int64_t mem_98205_cached_sizze_114827 = 0;
    unsigned char *mem_98205 = NULL;
    int64_t mem_98207_cached_sizze_114828 = 0;
    unsigned char *mem_98207 = NULL;
    int64_t mem_98229_cached_sizze_114829 = 0;
    unsigned char *mem_98229 = NULL;
    int64_t mem_98231_cached_sizze_114830 = 0;
    unsigned char *mem_98231 = NULL;
    int64_t mem_98233_cached_sizze_114831 = 0;
    unsigned char *mem_98233 = NULL;
    int64_t mem_98235_cached_sizze_114832 = 0;
    unsigned char *mem_98235 = NULL;
    int64_t mem_98493_cached_sizze_114833 = 0;
    unsigned char *mem_98493 = NULL;
    int64_t mem_98545_cached_sizze_114834 = 0;
    unsigned char *mem_98545 = NULL;
    int64_t mem_98585_cached_sizze_114835 = 0;
    unsigned char *mem_98585 = NULL;
    int64_t mem_98669_cached_sizze_114836 = 0;
    unsigned char *mem_98669 = NULL;
    int64_t mem_98699_cached_sizze_114837 = 0;
    unsigned char *mem_98699 = NULL;
    int64_t mem_98701_cached_sizze_114838 = 0;
    unsigned char *mem_98701 = NULL;
    int64_t mem_98723_cached_sizze_114839 = 0;
    unsigned char *mem_98723 = NULL;
    int64_t mem_98725_cached_sizze_114840 = 0;
    unsigned char *mem_98725 = NULL;
    int64_t mem_98891_cached_sizze_114841 = 0;
    unsigned char *mem_98891 = NULL;
    int64_t mem_98943_cached_sizze_114842 = 0;
    unsigned char *mem_98943 = NULL;
    int64_t mem_98983_cached_sizze_114843 = 0;
    unsigned char *mem_98983 = NULL;
    int64_t mem_99067_cached_sizze_114844 = 0;
    unsigned char *mem_99067 = NULL;
    int64_t mem_99097_cached_sizze_114845 = 0;
    unsigned char *mem_99097 = NULL;
    int64_t mem_99099_cached_sizze_114846 = 0;
    unsigned char *mem_99099 = NULL;
    int64_t mem_99121_cached_sizze_114847 = 0;
    unsigned char *mem_99121 = NULL;
    int64_t mem_99123_cached_sizze_114848 = 0;
    unsigned char *mem_99123 = NULL;
    int64_t mem_99125_cached_sizze_114849 = 0;
    unsigned char *mem_99125 = NULL;
    int64_t mem_99127_cached_sizze_114850 = 0;
    unsigned char *mem_99127 = NULL;
    int64_t mem_99385_cached_sizze_114851 = 0;
    unsigned char *mem_99385 = NULL;
    int64_t mem_99437_cached_sizze_114852 = 0;
    unsigned char *mem_99437 = NULL;
    int64_t mem_99477_cached_sizze_114853 = 0;
    unsigned char *mem_99477 = NULL;
    int64_t mem_99561_cached_sizze_114854 = 0;
    unsigned char *mem_99561 = NULL;
    int64_t mem_99591_cached_sizze_114855 = 0;
    unsigned char *mem_99591 = NULL;
    int64_t mem_99593_cached_sizze_114856 = 0;
    unsigned char *mem_99593 = NULL;
    int64_t mem_99615_cached_sizze_114857 = 0;
    unsigned char *mem_99615 = NULL;
    int64_t mem_99699_cached_sizze_114858 = 0;
    unsigned char *mem_99699 = NULL;
    int64_t mem_99783_cached_sizze_114859 = 0;
    unsigned char *mem_99783 = NULL;
    int64_t mem_99835_cached_sizze_114860 = 0;
    unsigned char *mem_99835 = NULL;
    int64_t mem_99875_cached_sizze_114861 = 0;
    unsigned char *mem_99875 = NULL;
    int64_t mem_99959_cached_sizze_114862 = 0;
    unsigned char *mem_99959 = NULL;
    int64_t mem_99989_cached_sizze_114863 = 0;
    unsigned char *mem_99989 = NULL;
    int64_t mem_99991_cached_sizze_114864 = 0;
    unsigned char *mem_99991 = NULL;
    int64_t mem_100013_cached_sizze_114865 = 0;
    unsigned char *mem_100013 = NULL;
    int64_t mem_100015_cached_sizze_114866 = 0;
    unsigned char *mem_100015 = NULL;
    int64_t mem_100017_cached_sizze_114867 = 0;
    unsigned char *mem_100017 = NULL;
    int64_t mem_100019_cached_sizze_114868 = 0;
    unsigned char *mem_100019 = NULL;
    int64_t mem_100277_cached_sizze_114869 = 0;
    unsigned char *mem_100277 = NULL;
    int64_t mem_100329_cached_sizze_114870 = 0;
    unsigned char *mem_100329 = NULL;
    int64_t mem_100369_cached_sizze_114871 = 0;
    unsigned char *mem_100369 = NULL;
    int64_t mem_100453_cached_sizze_114872 = 0;
    unsigned char *mem_100453 = NULL;
    int64_t mem_100483_cached_sizze_114873 = 0;
    unsigned char *mem_100483 = NULL;
    int64_t mem_100485_cached_sizze_114874 = 0;
    unsigned char *mem_100485 = NULL;
    int64_t mem_100507_cached_sizze_114875 = 0;
    unsigned char *mem_100507 = NULL;
    int64_t mem_100591_cached_sizze_114876 = 0;
    unsigned char *mem_100591 = NULL;
    int64_t mem_100675_cached_sizze_114877 = 0;
    unsigned char *mem_100675 = NULL;
    int64_t mem_100727_cached_sizze_114878 = 0;
    unsigned char *mem_100727 = NULL;
    int64_t mem_100767_cached_sizze_114879 = 0;
    unsigned char *mem_100767 = NULL;
    int64_t mem_100851_cached_sizze_114880 = 0;
    unsigned char *mem_100851 = NULL;
    int64_t mem_100881_cached_sizze_114881 = 0;
    unsigned char *mem_100881 = NULL;
    int64_t mem_100883_cached_sizze_114882 = 0;
    unsigned char *mem_100883 = NULL;
    int64_t mem_100905_cached_sizze_114883 = 0;
    unsigned char *mem_100905 = NULL;
    int64_t mem_100907_cached_sizze_114884 = 0;
    unsigned char *mem_100907 = NULL;
    int64_t mem_100909_cached_sizze_114885 = 0;
    unsigned char *mem_100909 = NULL;
    int64_t mem_100911_cached_sizze_114886 = 0;
    unsigned char *mem_100911 = NULL;
    int64_t mem_101169_cached_sizze_114887 = 0;
    unsigned char *mem_101169 = NULL;
    int64_t mem_101221_cached_sizze_114888 = 0;
    unsigned char *mem_101221 = NULL;
    int64_t mem_101261_cached_sizze_114889 = 0;
    unsigned char *mem_101261 = NULL;
    int64_t mem_101345_cached_sizze_114890 = 0;
    unsigned char *mem_101345 = NULL;
    int64_t mem_101375_cached_sizze_114891 = 0;
    unsigned char *mem_101375 = NULL;
    int64_t mem_101377_cached_sizze_114892 = 0;
    unsigned char *mem_101377 = NULL;
    int64_t mem_101399_cached_sizze_114893 = 0;
    unsigned char *mem_101399 = NULL;
    int64_t mem_101483_cached_sizze_114894 = 0;
    unsigned char *mem_101483 = NULL;
    int64_t mem_101535_cached_sizze_114895 = 0;
    unsigned char *mem_101535 = NULL;
    int64_t mem_101549_cached_sizze_114896 = 0;
    unsigned char *mem_101549 = NULL;
    int64_t mem_101560_cached_sizze_114897 = 0;
    unsigned char *mem_101560 = NULL;
    int64_t mem_101582_cached_sizze_114898 = 0;
    unsigned char *mem_101582 = NULL;
    int64_t mem_101587_cached_sizze_114899 = 0;
    unsigned char *mem_101587 = NULL;
    int64_t mem_101616_cached_sizze_114900 = 0;
    unsigned char *mem_101616 = NULL;
    int64_t mem_101650_cached_sizze_114901 = 0;
    unsigned char *mem_101650 = NULL;
    int64_t mem_101707_cached_sizze_114902 = 0;
    unsigned char *mem_101707 = NULL;
    int64_t mem_101750_cached_sizze_114903 = 0;
    unsigned char *mem_101750 = NULL;
    int64_t mem_101752_cached_sizze_114904 = 0;
    unsigned char *mem_101752 = NULL;
    int64_t mem_101810_cached_sizze_114905 = 0;
    unsigned char *mem_101810 = NULL;
    int64_t mem_101812_cached_sizze_114906 = 0;
    unsigned char *mem_101812 = NULL;
    int64_t mem_101834_cached_sizze_114907 = 0;
    unsigned char *mem_101834 = NULL;
    int64_t mem_101978_cached_sizze_114908 = 0;
    unsigned char *mem_101978 = NULL;
    int64_t mem_101980_cached_sizze_114909 = 0;
    unsigned char *mem_101980 = NULL;
    int64_t mem_102146_cached_sizze_114910 = 0;
    unsigned char *mem_102146 = NULL;
    int64_t mem_102198_cached_sizze_114911 = 0;
    unsigned char *mem_102198 = NULL;
    int64_t mem_102238_cached_sizze_114912 = 0;
    unsigned char *mem_102238 = NULL;
    int64_t mem_102240_cached_sizze_114913 = 0;
    unsigned char *mem_102240 = NULL;
    int64_t mem_102298_cached_sizze_114914 = 0;
    unsigned char *mem_102298 = NULL;
    int64_t mem_102300_cached_sizze_114915 = 0;
    unsigned char *mem_102300 = NULL;
    int64_t mem_102322_cached_sizze_114916 = 0;
    unsigned char *mem_102322 = NULL;
    int64_t mem_102466_cached_sizze_114917 = 0;
    unsigned char *mem_102466 = NULL;
    int64_t mem_102468_cached_sizze_114918 = 0;
    unsigned char *mem_102468 = NULL;
    int64_t mem_102634_cached_sizze_114919 = 0;
    unsigned char *mem_102634 = NULL;
    int64_t mem_102686_cached_sizze_114920 = 0;
    unsigned char *mem_102686 = NULL;
    int64_t mem_102726_cached_sizze_114921 = 0;
    unsigned char *mem_102726 = NULL;
    int64_t mem_102728_cached_sizze_114922 = 0;
    unsigned char *mem_102728 = NULL;
    int64_t mem_102786_cached_sizze_114923 = 0;
    unsigned char *mem_102786 = NULL;
    int64_t mem_102788_cached_sizze_114924 = 0;
    unsigned char *mem_102788 = NULL;
    int64_t mem_102810_cached_sizze_114925 = 0;
    unsigned char *mem_102810 = NULL;
    int64_t mem_102954_cached_sizze_114926 = 0;
    unsigned char *mem_102954 = NULL;
    int64_t mem_102956_cached_sizze_114927 = 0;
    unsigned char *mem_102956 = NULL;
    int64_t mem_103122_cached_sizze_114928 = 0;
    unsigned char *mem_103122 = NULL;
    int64_t mem_103174_cached_sizze_114929 = 0;
    unsigned char *mem_103174 = NULL;
    int64_t mem_103214_cached_sizze_114930 = 0;
    unsigned char *mem_103214 = NULL;
    int64_t mem_103216_cached_sizze_114931 = 0;
    unsigned char *mem_103216 = NULL;
    int64_t mem_103274_cached_sizze_114932 = 0;
    unsigned char *mem_103274 = NULL;
    int64_t mem_103276_cached_sizze_114933 = 0;
    unsigned char *mem_103276 = NULL;
    int64_t mem_103298_cached_sizze_114934 = 0;
    unsigned char *mem_103298 = NULL;
    int64_t mem_103442_cached_sizze_114935 = 0;
    unsigned char *mem_103442 = NULL;
    int64_t mem_103444_cached_sizze_114936 = 0;
    unsigned char *mem_103444 = NULL;
    int64_t mem_103610_cached_sizze_114937 = 0;
    unsigned char *mem_103610 = NULL;
    int64_t mem_103662_cached_sizze_114938 = 0;
    unsigned char *mem_103662 = NULL;
    int64_t mem_103702_cached_sizze_114939 = 0;
    unsigned char *mem_103702 = NULL;
    int64_t mem_103786_cached_sizze_114940 = 0;
    unsigned char *mem_103786 = NULL;
    int64_t mem_103788_cached_sizze_114941 = 0;
    unsigned char *mem_103788 = NULL;
    int64_t mem_103846_cached_sizze_114942 = 0;
    unsigned char *mem_103846 = NULL;
    int64_t mem_103848_cached_sizze_114943 = 0;
    unsigned char *mem_103848 = NULL;
    int64_t mem_103870_cached_sizze_114944 = 0;
    unsigned char *mem_103870 = NULL;
    int64_t mem_104014_cached_sizze_114945 = 0;
    unsigned char *mem_104014 = NULL;
    int64_t mem_104016_cached_sizze_114946 = 0;
    unsigned char *mem_104016 = NULL;
    int64_t mem_104182_cached_sizze_114947 = 0;
    unsigned char *mem_104182 = NULL;
    int64_t mem_104234_cached_sizze_114948 = 0;
    unsigned char *mem_104234 = NULL;
    int64_t mem_104274_cached_sizze_114949 = 0;
    unsigned char *mem_104274 = NULL;
    int64_t mem_104276_cached_sizze_114950 = 0;
    unsigned char *mem_104276 = NULL;
    int64_t mem_104334_cached_sizze_114951 = 0;
    unsigned char *mem_104334 = NULL;
    int64_t mem_104336_cached_sizze_114952 = 0;
    unsigned char *mem_104336 = NULL;
    int64_t mem_104358_cached_sizze_114953 = 0;
    unsigned char *mem_104358 = NULL;
    int64_t mem_104502_cached_sizze_114954 = 0;
    unsigned char *mem_104502 = NULL;
    int64_t mem_104504_cached_sizze_114955 = 0;
    unsigned char *mem_104504 = NULL;
    int64_t mem_104670_cached_sizze_114956 = 0;
    unsigned char *mem_104670 = NULL;
    int64_t mem_104722_cached_sizze_114957 = 0;
    unsigned char *mem_104722 = NULL;
    int64_t mem_104762_cached_sizze_114958 = 0;
    unsigned char *mem_104762 = NULL;
    int64_t mem_104846_cached_sizze_114959 = 0;
    unsigned char *mem_104846 = NULL;
    int64_t mem_104848_cached_sizze_114960 = 0;
    unsigned char *mem_104848 = NULL;
    int64_t mem_104906_cached_sizze_114961 = 0;
    unsigned char *mem_104906 = NULL;
    int64_t mem_104908_cached_sizze_114962 = 0;
    unsigned char *mem_104908 = NULL;
    int64_t mem_104930_cached_sizze_114963 = 0;
    unsigned char *mem_104930 = NULL;
    int64_t mem_105074_cached_sizze_114964 = 0;
    unsigned char *mem_105074 = NULL;
    int64_t mem_105076_cached_sizze_114965 = 0;
    unsigned char *mem_105076 = NULL;
    int64_t mem_105242_cached_sizze_114966 = 0;
    unsigned char *mem_105242 = NULL;
    int64_t mem_105294_cached_sizze_114967 = 0;
    unsigned char *mem_105294 = NULL;
    int64_t mem_105334_cached_sizze_114968 = 0;
    unsigned char *mem_105334 = NULL;
    int64_t mem_105336_cached_sizze_114969 = 0;
    unsigned char *mem_105336 = NULL;
    int64_t mem_105394_cached_sizze_114970 = 0;
    unsigned char *mem_105394 = NULL;
    int64_t mem_105396_cached_sizze_114971 = 0;
    unsigned char *mem_105396 = NULL;
    int64_t mem_105418_cached_sizze_114972 = 0;
    unsigned char *mem_105418 = NULL;
    int64_t mem_105562_cached_sizze_114973 = 0;
    unsigned char *mem_105562 = NULL;
    int64_t mem_105564_cached_sizze_114974 = 0;
    unsigned char *mem_105564 = NULL;
    int64_t mem_105730_cached_sizze_114975 = 0;
    unsigned char *mem_105730 = NULL;
    int64_t mem_105788_cached_sizze_114976 = 0;
    unsigned char *mem_105788 = NULL;
    int64_t mem_105813_cached_sizze_114977 = 0;
    unsigned char *mem_105813 = NULL;
    int64_t mem_105848_cached_sizze_114978 = 0;
    unsigned char *mem_105848 = NULL;
    int64_t mem_105862_cached_sizze_114979 = 0;
    unsigned char *mem_105862 = NULL;
    int64_t mem_105976_cached_sizze_114980 = 0;
    unsigned char *mem_105976 = NULL;
    int64_t mem_106006_cached_sizze_114981 = 0;
    unsigned char *mem_106006 = NULL;
    int64_t mem_106039_cached_sizze_114982 = 0;
    unsigned char *mem_106039 = NULL;
    int64_t mem_106053_cached_sizze_114983 = 0;
    unsigned char *mem_106053 = NULL;
    int64_t mem_106103_cached_sizze_114984 = 0;
    unsigned char *mem_106103 = NULL;
    int64_t mem_106485_cached_sizze_114985 = 0;
    unsigned char *mem_106485 = NULL;
    int64_t mem_106820_cached_sizze_114986 = 0;
    unsigned char *mem_106820 = NULL;
    int64_t mem_106832_cached_sizze_114987 = 0;
    unsigned char *mem_106832 = NULL;
    int64_t mem_107459_cached_sizze_114988 = 0;
    unsigned char *mem_107459 = NULL;
    int64_t mem_107461_cached_sizze_114989 = 0;
    unsigned char *mem_107461 = NULL;
    int64_t mem_108175_cached_sizze_114990 = 0;
    unsigned char *mem_108175 = NULL;
    int64_t mem_108557_cached_sizze_114991 = 0;
    unsigned char *mem_108557 = NULL;
    int64_t mem_109431_cached_sizze_114992 = 0;
    unsigned char *mem_109431 = NULL;
    int64_t mem_109813_cached_sizze_114993 = 0;
    unsigned char *mem_109813 = NULL;
    int64_t mem_110735_cached_sizze_114994 = 0;
    unsigned char *mem_110735 = NULL;
    int64_t mem_110737_cached_sizze_114995 = 0;
    unsigned char *mem_110737 = NULL;
    int64_t mem_110739_cached_sizze_114996 = 0;
    unsigned char *mem_110739 = NULL;
    int64_t mem_110855_cached_sizze_114997 = 0;
    unsigned char *mem_110855 = NULL;
    int64_t mem_110857_cached_sizze_114998 = 0;
    unsigned char *mem_110857 = NULL;
    int64_t mem_110859_cached_sizze_114999 = 0;
    unsigned char *mem_110859 = NULL;
    int64_t mem_110903_cached_sizze_115000 = 0;
    unsigned char *mem_110903 = NULL;
    int64_t mem_110905_cached_sizze_115001 = 0;
    unsigned char *mem_110905 = NULL;
    int64_t mem_110907_cached_sizze_115002 = 0;
    unsigned char *mem_110907 = NULL;
    int64_t mem_110942_cached_sizze_115003 = 0;
    unsigned char *mem_110942 = NULL;
    int64_t mem_110944_cached_sizze_115004 = 0;
    unsigned char *mem_110944 = NULL;
    int64_t mem_110946_cached_sizze_115005 = 0;
    unsigned char *mem_110946 = NULL;
    int64_t mem_111719_cached_sizze_115006 = 0;
    unsigned char *mem_111719 = NULL;
    struct memblock mem_112456;
    
    mem_112456.references = NULL;
    
    struct memblock mem_param_tmp_113646;
    
    mem_param_tmp_113646.references = NULL;
    
    struct memblock mem_param_tmp_113645;
    
    mem_param_tmp_113645.references = NULL;
    
    struct memblock mem_param_tmp_113644;
    
    mem_param_tmp_113644.references = NULL;
    
    struct memblock mem_param_tmp_113643;
    
    mem_param_tmp_113643.references = NULL;
    
    struct memblock mem_param_tmp_113642;
    
    mem_param_tmp_113642.references = NULL;
    
    struct memblock mem_param_tmp_113641;
    
    mem_param_tmp_113641.references = NULL;
    
    struct memblock mem_param_tmp_113640;
    
    mem_param_tmp_113640.references = NULL;
    
    struct memblock mem_param_tmp_113639;
    
    mem_param_tmp_113639.references = NULL;
    
    struct memblock mem_param_tmp_113638;
    
    mem_param_tmp_113638.references = NULL;
    
    struct memblock mem_param_tmp_113637;
    
    mem_param_tmp_113637.references = NULL;
    
    struct memblock mem_param_tmp_113636;
    
    mem_param_tmp_113636.references = NULL;
    
    struct memblock mem_param_tmp_113635;
    
    mem_param_tmp_113635.references = NULL;
    
    struct memblock mem_param_tmp_113634;
    
    mem_param_tmp_113634.references = NULL;
    
    struct memblock mem_param_tmp_113633;
    
    mem_param_tmp_113633.references = NULL;
    
    struct memblock mem_param_tmp_113632;
    
    mem_param_tmp_113632.references = NULL;
    
    struct memblock mem_param_tmp_113631;
    
    mem_param_tmp_113631.references = NULL;
    
    struct memblock mem_param_tmp_113630;
    
    mem_param_tmp_113630.references = NULL;
    
    struct memblock mem_param_tmp_113629;
    
    mem_param_tmp_113629.references = NULL;
    
    struct memblock mem_param_tmp_113628;
    
    mem_param_tmp_113628.references = NULL;
    
    struct memblock mem_param_tmp_113627;
    
    mem_param_tmp_113627.references = NULL;
    
    struct memblock mem_param_tmp_113626;
    
    mem_param_tmp_113626.references = NULL;
    
    struct memblock mem_param_tmp_113625;
    
    mem_param_tmp_113625.references = NULL;
    
    struct memblock mem_param_tmp_113624;
    
    mem_param_tmp_113624.references = NULL;
    
    struct memblock mem_param_tmp_113623;
    
    mem_param_tmp_113623.references = NULL;
    
    struct memblock mem_param_tmp_113622;
    
    mem_param_tmp_113622.references = NULL;
    
    struct memblock mem_param_tmp_113621;
    
    mem_param_tmp_113621.references = NULL;
    
    struct memblock mem_param_tmp_113620;
    
    mem_param_tmp_113620.references = NULL;
    
    struct memblock mem_param_tmp_113619;
    
    mem_param_tmp_113619.references = NULL;
    
    struct memblock mem_param_tmp_113618;
    
    mem_param_tmp_113618.references = NULL;
    
    struct memblock mem_param_tmp_113617;
    
    mem_param_tmp_113617.references = NULL;
    
    struct memblock mem_param_tmp_113616;
    
    mem_param_tmp_113616.references = NULL;
    
    struct memblock mem_param_tmp_113615;
    
    mem_param_tmp_113615.references = NULL;
    
    struct memblock mem_param_tmp_113614;
    
    mem_param_tmp_113614.references = NULL;
    
    struct memblock mem_param_tmp_113613;
    
    mem_param_tmp_113613.references = NULL;
    
    struct memblock mem_param_tmp_113612;
    
    mem_param_tmp_113612.references = NULL;
    
    struct memblock mem_param_tmp_113611;
    
    mem_param_tmp_113611.references = NULL;
    
    struct memblock mem_param_tmp_113610;
    
    mem_param_tmp_113610.references = NULL;
    
    struct memblock mem_param_tmp_113609;
    
    mem_param_tmp_113609.references = NULL;
    
    struct memblock mem_param_tmp_113608;
    
    mem_param_tmp_113608.references = NULL;
    
    struct memblock mem_param_tmp_113607;
    
    mem_param_tmp_113607.references = NULL;
    
    struct memblock mem_param_tmp_113606;
    
    mem_param_tmp_113606.references = NULL;
    
    struct memblock mem_param_tmp_113605;
    
    mem_param_tmp_113605.references = NULL;
    
    struct memblock mem_param_tmp_113604;
    
    mem_param_tmp_113604.references = NULL;
    
    struct memblock mem_param_tmp_113603;
    
    mem_param_tmp_113603.references = NULL;
    
    struct memblock mem_param_tmp_113602;
    
    mem_param_tmp_113602.references = NULL;
    
    struct memblock mem_param_tmp_113601;
    
    mem_param_tmp_113601.references = NULL;
    
    struct memblock mem_param_tmp_113600;
    
    mem_param_tmp_113600.references = NULL;
    
    struct memblock mem_param_tmp_113599;
    
    mem_param_tmp_113599.references = NULL;
    
    struct memblock mem_param_tmp_113598;
    
    mem_param_tmp_113598.references = NULL;
    
    struct memblock mem_param_tmp_113597;
    
    mem_param_tmp_113597.references = NULL;
    
    struct memblock mem_param_tmp_113596;
    
    mem_param_tmp_113596.references = NULL;
    
    struct memblock mem_param_tmp_113595;
    
    mem_param_tmp_113595.references = NULL;
    
    struct memblock mem_param_tmp_113594;
    
    mem_param_tmp_113594.references = NULL;
    
    struct memblock mem_param_tmp_113593;
    
    mem_param_tmp_113593.references = NULL;
    
    struct memblock mem_param_tmp_113592;
    
    mem_param_tmp_113592.references = NULL;
    
    struct memblock mem_param_tmp_113591;
    
    mem_param_tmp_113591.references = NULL;
    
    struct memblock mem_param_tmp_113590;
    
    mem_param_tmp_113590.references = NULL;
    
    struct memblock mem_param_tmp_113589;
    
    mem_param_tmp_113589.references = NULL;
    
    struct memblock mem_param_tmp_113588;
    
    mem_param_tmp_113588.references = NULL;
    
    struct memblock mem_param_tmp_113587;
    
    mem_param_tmp_113587.references = NULL;
    
    struct memblock mem_param_tmp_113586;
    
    mem_param_tmp_113586.references = NULL;
    
    struct memblock mem_param_tmp_113585;
    
    mem_param_tmp_113585.references = NULL;
    
    struct memblock mem_param_tmp_113584;
    
    mem_param_tmp_113584.references = NULL;
    
    struct memblock mem_param_tmp_113583;
    
    mem_param_tmp_113583.references = NULL;
    
    struct memblock mem_param_tmp_113582;
    
    mem_param_tmp_113582.references = NULL;
    
    struct memblock mem_param_tmp_113581;
    
    mem_param_tmp_113581.references = NULL;
    
    struct memblock mem_param_tmp_113580;
    
    mem_param_tmp_113580.references = NULL;
    
    struct memblock mem_param_tmp_113579;
    
    mem_param_tmp_113579.references = NULL;
    
    struct memblock mem_param_tmp_113578;
    
    mem_param_tmp_113578.references = NULL;
    
    struct memblock mem_param_tmp_113577;
    
    mem_param_tmp_113577.references = NULL;
    
    struct memblock mem_param_tmp_113576;
    
    mem_param_tmp_113576.references = NULL;
    
    struct memblock mem_param_tmp_113575;
    
    mem_param_tmp_113575.references = NULL;
    
    struct memblock mem_param_tmp_113574;
    
    mem_param_tmp_113574.references = NULL;
    
    struct memblock mem_param_tmp_113573;
    
    mem_param_tmp_113573.references = NULL;
    
    struct memblock mem_param_tmp_113572;
    
    mem_param_tmp_113572.references = NULL;
    
    struct memblock mem_param_tmp_113571;
    
    mem_param_tmp_113571.references = NULL;
    
    struct memblock mem_param_tmp_113570;
    
    mem_param_tmp_113570.references = NULL;
    
    struct memblock mem_param_tmp_113569;
    
    mem_param_tmp_113569.references = NULL;
    
    struct memblock mem_param_tmp_113568;
    
    mem_param_tmp_113568.references = NULL;
    
    struct memblock mem_param_tmp_113567;
    
    mem_param_tmp_113567.references = NULL;
    
    struct memblock mem_param_tmp_113566;
    
    mem_param_tmp_113566.references = NULL;
    
    struct memblock mem_param_tmp_113565;
    
    mem_param_tmp_113565.references = NULL;
    
    struct memblock mem_param_tmp_113564;
    
    mem_param_tmp_113564.references = NULL;
    
    struct memblock mem_param_tmp_113563;
    
    mem_param_tmp_113563.references = NULL;
    
    struct memblock mem_param_tmp_113562;
    
    mem_param_tmp_113562.references = NULL;
    
    struct memblock mem_111722;
    
    mem_111722.references = NULL;
    
    struct memblock mem_param_tmp_113818;
    
    mem_param_tmp_113818.references = NULL;
    
    struct memblock mem_param_tmp_113817;
    
    mem_param_tmp_113817.references = NULL;
    
    struct memblock mem_param_tmp_113816;
    
    mem_param_tmp_113816.references = NULL;
    
    struct memblock mem_param_tmp_113815;
    
    mem_param_tmp_113815.references = NULL;
    
    struct memblock mem_param_tmp_113814;
    
    mem_param_tmp_113814.references = NULL;
    
    struct memblock mem_param_tmp_113813;
    
    mem_param_tmp_113813.references = NULL;
    
    struct memblock mem_param_tmp_113812;
    
    mem_param_tmp_113812.references = NULL;
    
    struct memblock mem_param_tmp_113811;
    
    mem_param_tmp_113811.references = NULL;
    
    struct memblock mem_param_tmp_113810;
    
    mem_param_tmp_113810.references = NULL;
    
    struct memblock mem_param_tmp_113809;
    
    mem_param_tmp_113809.references = NULL;
    
    struct memblock mem_param_tmp_113808;
    
    mem_param_tmp_113808.references = NULL;
    
    struct memblock mem_param_tmp_113807;
    
    mem_param_tmp_113807.references = NULL;
    
    struct memblock mem_param_tmp_113806;
    
    mem_param_tmp_113806.references = NULL;
    
    struct memblock mem_param_tmp_113805;
    
    mem_param_tmp_113805.references = NULL;
    
    struct memblock mem_param_tmp_113804;
    
    mem_param_tmp_113804.references = NULL;
    
    struct memblock mem_param_tmp_113803;
    
    mem_param_tmp_113803.references = NULL;
    
    struct memblock mem_param_tmp_113802;
    
    mem_param_tmp_113802.references = NULL;
    
    struct memblock mem_param_tmp_113801;
    
    mem_param_tmp_113801.references = NULL;
    
    struct memblock mem_param_tmp_113800;
    
    mem_param_tmp_113800.references = NULL;
    
    struct memblock mem_param_tmp_113799;
    
    mem_param_tmp_113799.references = NULL;
    
    struct memblock mem_param_tmp_113798;
    
    mem_param_tmp_113798.references = NULL;
    
    struct memblock mem_param_tmp_113797;
    
    mem_param_tmp_113797.references = NULL;
    
    struct memblock mem_param_tmp_113796;
    
    mem_param_tmp_113796.references = NULL;
    
    struct memblock mem_param_tmp_113795;
    
    mem_param_tmp_113795.references = NULL;
    
    struct memblock mem_param_tmp_113794;
    
    mem_param_tmp_113794.references = NULL;
    
    struct memblock mem_param_tmp_113793;
    
    mem_param_tmp_113793.references = NULL;
    
    struct memblock mem_param_tmp_113792;
    
    mem_param_tmp_113792.references = NULL;
    
    struct memblock mem_param_tmp_113791;
    
    mem_param_tmp_113791.references = NULL;
    
    struct memblock mem_param_tmp_113790;
    
    mem_param_tmp_113790.references = NULL;
    
    struct memblock mem_param_tmp_113789;
    
    mem_param_tmp_113789.references = NULL;
    
    struct memblock mem_param_tmp_113788;
    
    mem_param_tmp_113788.references = NULL;
    
    struct memblock mem_param_tmp_113787;
    
    mem_param_tmp_113787.references = NULL;
    
    struct memblock mem_param_tmp_113786;
    
    mem_param_tmp_113786.references = NULL;
    
    struct memblock mem_param_tmp_113785;
    
    mem_param_tmp_113785.references = NULL;
    
    struct memblock mem_param_tmp_113784;
    
    mem_param_tmp_113784.references = NULL;
    
    struct memblock mem_param_tmp_113783;
    
    mem_param_tmp_113783.references = NULL;
    
    struct memblock mem_param_tmp_113782;
    
    mem_param_tmp_113782.references = NULL;
    
    struct memblock mem_param_tmp_113781;
    
    mem_param_tmp_113781.references = NULL;
    
    struct memblock mem_param_tmp_113780;
    
    mem_param_tmp_113780.references = NULL;
    
    struct memblock mem_param_tmp_113779;
    
    mem_param_tmp_113779.references = NULL;
    
    struct memblock mem_param_tmp_113778;
    
    mem_param_tmp_113778.references = NULL;
    
    struct memblock mem_param_tmp_113777;
    
    mem_param_tmp_113777.references = NULL;
    
    struct memblock mem_param_tmp_113776;
    
    mem_param_tmp_113776.references = NULL;
    
    struct memblock mem_param_tmp_113775;
    
    mem_param_tmp_113775.references = NULL;
    
    struct memblock mem_param_tmp_113774;
    
    mem_param_tmp_113774.references = NULL;
    
    struct memblock mem_param_tmp_113773;
    
    mem_param_tmp_113773.references = NULL;
    
    struct memblock mem_param_tmp_113772;
    
    mem_param_tmp_113772.references = NULL;
    
    struct memblock mem_param_tmp_113771;
    
    mem_param_tmp_113771.references = NULL;
    
    struct memblock mem_param_tmp_113770;
    
    mem_param_tmp_113770.references = NULL;
    
    struct memblock mem_param_tmp_113769;
    
    mem_param_tmp_113769.references = NULL;
    
    struct memblock mem_param_tmp_113768;
    
    mem_param_tmp_113768.references = NULL;
    
    struct memblock mem_param_tmp_113767;
    
    mem_param_tmp_113767.references = NULL;
    
    struct memblock mem_param_tmp_113766;
    
    mem_param_tmp_113766.references = NULL;
    
    struct memblock mem_param_tmp_113765;
    
    mem_param_tmp_113765.references = NULL;
    
    struct memblock mem_param_tmp_113764;
    
    mem_param_tmp_113764.references = NULL;
    
    struct memblock mem_param_tmp_113763;
    
    mem_param_tmp_113763.references = NULL;
    
    struct memblock mem_param_tmp_113762;
    
    mem_param_tmp_113762.references = NULL;
    
    struct memblock mem_param_tmp_113761;
    
    mem_param_tmp_113761.references = NULL;
    
    struct memblock mem_param_tmp_113760;
    
    mem_param_tmp_113760.references = NULL;
    
    struct memblock mem_param_tmp_113759;
    
    mem_param_tmp_113759.references = NULL;
    
    struct memblock mem_param_tmp_113758;
    
    mem_param_tmp_113758.references = NULL;
    
    struct memblock mem_param_tmp_113757;
    
    mem_param_tmp_113757.references = NULL;
    
    struct memblock mem_param_tmp_113756;
    
    mem_param_tmp_113756.references = NULL;
    
    struct memblock mem_param_tmp_113755;
    
    mem_param_tmp_113755.references = NULL;
    
    struct memblock mem_param_tmp_113754;
    
    mem_param_tmp_113754.references = NULL;
    
    struct memblock mem_param_tmp_113753;
    
    mem_param_tmp_113753.references = NULL;
    
    struct memblock mem_param_tmp_113752;
    
    mem_param_tmp_113752.references = NULL;
    
    struct memblock mem_param_tmp_113751;
    
    mem_param_tmp_113751.references = NULL;
    
    struct memblock mem_param_tmp_113750;
    
    mem_param_tmp_113750.references = NULL;
    
    struct memblock mem_param_tmp_113749;
    
    mem_param_tmp_113749.references = NULL;
    
    struct memblock mem_param_tmp_113748;
    
    mem_param_tmp_113748.references = NULL;
    
    struct memblock mem_param_tmp_113747;
    
    mem_param_tmp_113747.references = NULL;
    
    struct memblock mem_param_tmp_113746;
    
    mem_param_tmp_113746.references = NULL;
    
    struct memblock mem_param_tmp_113745;
    
    mem_param_tmp_113745.references = NULL;
    
    struct memblock mem_param_tmp_113744;
    
    mem_param_tmp_113744.references = NULL;
    
    struct memblock mem_param_tmp_113743;
    
    mem_param_tmp_113743.references = NULL;
    
    struct memblock mem_param_tmp_113742;
    
    mem_param_tmp_113742.references = NULL;
    
    struct memblock mem_param_tmp_113741;
    
    mem_param_tmp_113741.references = NULL;
    
    struct memblock mem_param_tmp_113740;
    
    mem_param_tmp_113740.references = NULL;
    
    struct memblock mem_param_tmp_113739;
    
    mem_param_tmp_113739.references = NULL;
    
    struct memblock mem_param_tmp_113738;
    
    mem_param_tmp_113738.references = NULL;
    
    struct memblock mem_param_tmp_113737;
    
    mem_param_tmp_113737.references = NULL;
    
    struct memblock mem_param_tmp_113736;
    
    mem_param_tmp_113736.references = NULL;
    
    struct memblock mem_param_tmp_113735;
    
    mem_param_tmp_113735.references = NULL;
    
    struct memblock mem_110991;
    
    mem_110991.references = NULL;
    
    struct memblock mem_110989;
    
    mem_110989.references = NULL;
    
    struct memblock mem_110987;
    
    mem_110987.references = NULL;
    
    struct memblock mem_110985;
    
    mem_110985.references = NULL;
    
    struct memblock mem_110983;
    
    mem_110983.references = NULL;
    
    struct memblock mem_110981;
    
    mem_110981.references = NULL;
    
    struct memblock mem_110691;
    
    mem_110691.references = NULL;
    
    struct memblock mem_110689;
    
    mem_110689.references = NULL;
    
    struct memblock mem_110687;
    
    mem_110687.references = NULL;
    
    struct memblock mem_110655;
    
    mem_110655.references = NULL;
    
    struct memblock mem_110653;
    
    mem_110653.references = NULL;
    
    struct memblock mem_110651;
    
    mem_110651.references = NULL;
    
    struct memblock mem_110505;
    
    mem_110505.references = NULL;
    
    struct memblock mem_110503;
    
    mem_110503.references = NULL;
    
    struct memblock mem_110501;
    
    mem_110501.references = NULL;
    
    struct memblock mem_110499;
    
    mem_110499.references = NULL;
    
    struct memblock mem_110497;
    
    mem_110497.references = NULL;
    
    struct memblock mem_110495;
    
    mem_110495.references = NULL;
    
    struct memblock mem_110463;
    
    mem_110463.references = NULL;
    
    struct memblock mem_110461;
    
    mem_110461.references = NULL;
    
    struct memblock mem_110459;
    
    mem_110459.references = NULL;
    
    struct memblock mem_110427;
    
    mem_110427.references = NULL;
    
    struct memblock mem_110425;
    
    mem_110425.references = NULL;
    
    struct memblock mem_110423;
    
    mem_110423.references = NULL;
    
    struct memblock mem_110277;
    
    mem_110277.references = NULL;
    
    struct memblock mem_110275;
    
    mem_110275.references = NULL;
    
    struct memblock mem_110273;
    
    mem_110273.references = NULL;
    
    struct memblock mem_110271;
    
    mem_110271.references = NULL;
    
    struct memblock mem_110269;
    
    mem_110269.references = NULL;
    
    struct memblock mem_110267;
    
    mem_110267.references = NULL;
    
    struct memblock mem_110235;
    
    mem_110235.references = NULL;
    
    struct memblock mem_110233;
    
    mem_110233.references = NULL;
    
    struct memblock mem_110231;
    
    mem_110231.references = NULL;
    
    struct memblock mem_109297;
    
    mem_109297.references = NULL;
    
    struct memblock mem_109295;
    
    mem_109295.references = NULL;
    
    struct memblock mem_109293;
    
    mem_109293.references = NULL;
    
    struct memblock mem_109291;
    
    mem_109291.references = NULL;
    
    struct memblock mem_109289;
    
    mem_109289.references = NULL;
    
    struct memblock mem_109287;
    
    mem_109287.references = NULL;
    
    struct memblock mem_109255;
    
    mem_109255.references = NULL;
    
    struct memblock mem_109253;
    
    mem_109253.references = NULL;
    
    struct memblock mem_109251;
    
    mem_109251.references = NULL;
    
    struct memblock mem_109105;
    
    mem_109105.references = NULL;
    
    struct memblock mem_109103;
    
    mem_109103.references = NULL;
    
    struct memblock mem_109101;
    
    mem_109101.references = NULL;
    
    struct memblock mem_109099;
    
    mem_109099.references = NULL;
    
    struct memblock mem_109097;
    
    mem_109097.references = NULL;
    
    struct memblock mem_109095;
    
    mem_109095.references = NULL;
    
    struct memblock mem_109063;
    
    mem_109063.references = NULL;
    
    struct memblock mem_109061;
    
    mem_109061.references = NULL;
    
    struct memblock mem_109059;
    
    mem_109059.references = NULL;
    
    struct memblock mem_107193;
    
    mem_107193.references = NULL;
    
    struct memblock mem_107191;
    
    mem_107191.references = NULL;
    
    struct memblock mem_107189;
    
    mem_107189.references = NULL;
    
    struct memblock mem_107187;
    
    mem_107187.references = NULL;
    
    struct memblock mem_107185;
    
    mem_107185.references = NULL;
    
    struct memblock mem_107183;
    
    mem_107183.references = NULL;
    
    struct memblock mem_107181;
    
    mem_107181.references = NULL;
    
    struct memblock mem_107179;
    
    mem_107179.references = NULL;
    
    struct memblock mem_107177;
    
    mem_107177.references = NULL;
    
    struct memblock mem_107175;
    
    mem_107175.references = NULL;
    
    struct memblock mem_107173;
    
    mem_107173.references = NULL;
    
    struct memblock mem_107171;
    
    mem_107171.references = NULL;
    
    struct memblock mem_107139;
    
    mem_107139.references = NULL;
    
    struct memblock mem_107137;
    
    mem_107137.references = NULL;
    
    struct memblock mem_107135;
    
    mem_107135.references = NULL;
    
    struct memblock mem_106989;
    
    mem_106989.references = NULL;
    
    struct memblock mem_106987;
    
    mem_106987.references = NULL;
    
    struct memblock mem_106985;
    
    mem_106985.references = NULL;
    
    struct memblock mem_106983;
    
    mem_106983.references = NULL;
    
    struct memblock mem_106981;
    
    mem_106981.references = NULL;
    
    struct memblock mem_106979;
    
    mem_106979.references = NULL;
    
    struct memblock mem_106947;
    
    mem_106947.references = NULL;
    
    struct memblock mem_106945;
    
    mem_106945.references = NULL;
    
    struct memblock mem_106943;
    
    mem_106943.references = NULL;
    
    struct memblock mem_105860;
    
    mem_105860.references = NULL;
    
    struct memblock mem_105858;
    
    mem_105858.references = NULL;
    
    struct memblock mem_105856;
    
    mem_105856.references = NULL;
    
    struct memblock mem_105854;
    
    mem_105854.references = NULL;
    
    struct memblock mem_105852;
    
    mem_105852.references = NULL;
    
    struct memblock mem_105850;
    
    mem_105850.references = NULL;
    
    struct memblock mem_105786;
    
    mem_105786.references = NULL;
    
    struct memblock mem_105784;
    
    mem_105784.references = NULL;
    
    struct memblock mem_105782;
    
    mem_105782.references = NULL;
    
    struct memblock mem_param_97630;
    
    mem_param_97630.references = NULL;
    
    struct memblock mem_param_97625;
    
    mem_param_97625.references = NULL;
    
    struct memblock mem_param_97611;
    
    mem_param_97611.references = NULL;
    
    struct memblock mem_param_97606;
    
    mem_param_97606.references = NULL;
    
    struct memblock mem_param_97592;
    
    mem_param_97592.references = NULL;
    
    struct memblock mem_param_97587;
    
    mem_param_97587.references = NULL;
    
    struct memblock mem_param_97573;
    
    mem_param_97573.references = NULL;
    
    struct memblock mem_param_97568;
    
    mem_param_97568.references = NULL;
    
    struct memblock mem_param_97554;
    
    mem_param_97554.references = NULL;
    
    struct memblock mem_param_97549;
    
    mem_param_97549.references = NULL;
    
    struct memblock mem_param_97541;
    
    mem_param_97541.references = NULL;
    
    struct memblock mem_param_97536;
    
    mem_param_97536.references = NULL;
    
    struct memblock mem_param_97528;
    
    mem_param_97528.references = NULL;
    
    struct memblock mem_param_97523;
    
    mem_param_97523.references = NULL;
    
    struct memblock mem_param_97509;
    
    mem_param_97509.references = NULL;
    
    struct memblock mem_param_97504;
    
    mem_param_97504.references = NULL;
    
    struct memblock mem_param_97490;
    
    mem_param_97490.references = NULL;
    
    struct memblock mem_param_97485;
    
    mem_param_97485.references = NULL;
    
    struct memblock mem_param_97471;
    
    mem_param_97471.references = NULL;
    
    struct memblock mem_param_97466;
    
    mem_param_97466.references = NULL;
    
    struct memblock mem_param_97452;
    
    mem_param_97452.references = NULL;
    
    struct memblock mem_param_97447;
    
    mem_param_97447.references = NULL;
    
    struct memblock mem_param_97439;
    
    mem_param_97439.references = NULL;
    
    struct memblock mem_param_97434;
    
    mem_param_97434.references = NULL;
    
    struct memblock mem_param_97426;
    
    mem_param_97426.references = NULL;
    
    struct memblock mem_param_97421;
    
    mem_param_97421.references = NULL;
    
    struct memblock mem_param_97407;
    
    mem_param_97407.references = NULL;
    
    struct memblock mem_param_97402;
    
    mem_param_97402.references = NULL;
    
    struct memblock mem_param_97388;
    
    mem_param_97388.references = NULL;
    
    struct memblock mem_param_97383;
    
    mem_param_97383.references = NULL;
    
    struct memblock mem_param_97369;
    
    mem_param_97369.references = NULL;
    
    struct memblock mem_param_97364;
    
    mem_param_97364.references = NULL;
    
    struct memblock mem_param_97350;
    
    mem_param_97350.references = NULL;
    
    struct memblock mem_param_97345;
    
    mem_param_97345.references = NULL;
    
    struct memblock mem_param_97337;
    
    mem_param_97337.references = NULL;
    
    struct memblock mem_param_97332;
    
    mem_param_97332.references = NULL;
    
    struct memblock mem_param_97324;
    
    mem_param_97324.references = NULL;
    
    struct memblock mem_param_97319;
    
    mem_param_97319.references = NULL;
    
    struct memblock mem_param_97305;
    
    mem_param_97305.references = NULL;
    
    struct memblock mem_param_97300;
    
    mem_param_97300.references = NULL;
    
    struct memblock mem_param_97286;
    
    mem_param_97286.references = NULL;
    
    struct memblock mem_param_97281;
    
    mem_param_97281.references = NULL;
    
    struct memblock mem_param_97267;
    
    mem_param_97267.references = NULL;
    
    struct memblock mem_param_97262;
    
    mem_param_97262.references = NULL;
    
    struct memblock mem_param_97248;
    
    mem_param_97248.references = NULL;
    
    struct memblock mem_param_97243;
    
    mem_param_97243.references = NULL;
    
    struct memblock mem_param_97235;
    
    mem_param_97235.references = NULL;
    
    struct memblock mem_param_97230;
    
    mem_param_97230.references = NULL;
    
    struct memblock mem_param_97222;
    
    mem_param_97222.references = NULL;
    
    struct memblock mem_param_97217;
    
    mem_param_97217.references = NULL;
    
    struct memblock mem_param_97203;
    
    mem_param_97203.references = NULL;
    
    struct memblock mem_param_97198;
    
    mem_param_97198.references = NULL;
    
    struct memblock mem_param_97184;
    
    mem_param_97184.references = NULL;
    
    struct memblock mem_param_97179;
    
    mem_param_97179.references = NULL;
    
    struct memblock mem_param_97165;
    
    mem_param_97165.references = NULL;
    
    struct memblock mem_param_97160;
    
    mem_param_97160.references = NULL;
    
    struct memblock mem_param_97146;
    
    mem_param_97146.references = NULL;
    
    struct memblock mem_param_97141;
    
    mem_param_97141.references = NULL;
    
    struct memblock mem_param_97127;
    
    mem_param_97127.references = NULL;
    
    struct memblock mem_param_97122;
    
    mem_param_97122.references = NULL;
    
    struct memblock mem_param_97108;
    
    mem_param_97108.references = NULL;
    
    struct memblock mem_param_97103;
    
    mem_param_97103.references = NULL;
    
    struct memblock mem_param_97095;
    
    mem_param_97095.references = NULL;
    
    struct memblock mem_param_97090;
    
    mem_param_97090.references = NULL;
    
    struct memblock mem_param_97076;
    
    mem_param_97076.references = NULL;
    
    struct memblock mem_param_97071;
    
    mem_param_97071.references = NULL;
    
    struct memblock mem_param_97057;
    
    mem_param_97057.references = NULL;
    
    struct memblock mem_param_97052;
    
    mem_param_97052.references = NULL;
    
    struct memblock mem_param_97044;
    
    mem_param_97044.references = NULL;
    
    struct memblock mem_param_97039;
    
    mem_param_97039.references = NULL;
    
    struct memblock mem_param_97025;
    
    mem_param_97025.references = NULL;
    
    struct memblock mem_param_97020;
    
    mem_param_97020.references = NULL;
    
    struct memblock mem_param_97006;
    
    mem_param_97006.references = NULL;
    
    struct memblock mem_param_97001;
    
    mem_param_97001.references = NULL;
    
    struct memblock mem_param_96993;
    
    mem_param_96993.references = NULL;
    
    struct memblock mem_param_96988;
    
    mem_param_96988.references = NULL;
    
    struct memblock mem_param_96974;
    
    mem_param_96974.references = NULL;
    
    struct memblock mem_param_96969;
    
    mem_param_96969.references = NULL;
    
    struct memblock mem_param_96955;
    
    mem_param_96955.references = NULL;
    
    struct memblock mem_param_96950;
    
    mem_param_96950.references = NULL;
    
    struct memblock mem_param_96942;
    
    mem_param_96942.references = NULL;
    
    struct memblock mem_param_96937;
    
    mem_param_96937.references = NULL;
    
    struct memblock mem_param_96923;
    
    mem_param_96923.references = NULL;
    
    struct memblock mem_param_96918;
    
    mem_param_96918.references = NULL;
    
    struct memblock ext_mem_111634;
    
    ext_mem_111634.references = NULL;
    
    struct memblock ext_mem_111635;
    
    ext_mem_111635.references = NULL;
    
    struct memblock ext_mem_111636;
    
    ext_mem_111636.references = NULL;
    
    struct memblock ext_mem_111637;
    
    ext_mem_111637.references = NULL;
    
    struct memblock ext_mem_111638;
    
    ext_mem_111638.references = NULL;
    
    struct memblock ext_mem_111639;
    
    ext_mem_111639.references = NULL;
    
    struct memblock ext_mem_111640;
    
    ext_mem_111640.references = NULL;
    
    struct memblock ext_mem_111641;
    
    ext_mem_111641.references = NULL;
    
    struct memblock ext_mem_111642;
    
    ext_mem_111642.references = NULL;
    
    struct memblock ext_mem_111643;
    
    ext_mem_111643.references = NULL;
    
    struct memblock ext_mem_111644;
    
    ext_mem_111644.references = NULL;
    
    struct memblock ext_mem_111645;
    
    ext_mem_111645.references = NULL;
    
    struct memblock ext_mem_111646;
    
    ext_mem_111646.references = NULL;
    
    struct memblock ext_mem_111647;
    
    ext_mem_111647.references = NULL;
    
    struct memblock ext_mem_111648;
    
    ext_mem_111648.references = NULL;
    
    struct memblock ext_mem_111649;
    
    ext_mem_111649.references = NULL;
    
    struct memblock ext_mem_111650;
    
    ext_mem_111650.references = NULL;
    
    struct memblock ext_mem_111651;
    
    ext_mem_111651.references = NULL;
    
    struct memblock ext_mem_111652;
    
    ext_mem_111652.references = NULL;
    
    struct memblock ext_mem_111653;
    
    ext_mem_111653.references = NULL;
    
    struct memblock ext_mem_111654;
    
    ext_mem_111654.references = NULL;
    
    struct memblock ext_mem_111655;
    
    ext_mem_111655.references = NULL;
    
    struct memblock ext_mem_111656;
    
    ext_mem_111656.references = NULL;
    
    struct memblock ext_mem_111657;
    
    ext_mem_111657.references = NULL;
    
    struct memblock ext_mem_111658;
    
    ext_mem_111658.references = NULL;
    
    struct memblock ext_mem_111659;
    
    ext_mem_111659.references = NULL;
    
    struct memblock ext_mem_111660;
    
    ext_mem_111660.references = NULL;
    
    struct memblock ext_mem_111661;
    
    ext_mem_111661.references = NULL;
    
    struct memblock ext_mem_111662;
    
    ext_mem_111662.references = NULL;
    
    struct memblock ext_mem_111663;
    
    ext_mem_111663.references = NULL;
    
    struct memblock ext_mem_111664;
    
    ext_mem_111664.references = NULL;
    
    struct memblock ext_mem_111665;
    
    ext_mem_111665.references = NULL;
    
    struct memblock ext_mem_111666;
    
    ext_mem_111666.references = NULL;
    
    struct memblock ext_mem_111667;
    
    ext_mem_111667.references = NULL;
    
    struct memblock ext_mem_111668;
    
    ext_mem_111668.references = NULL;
    
    struct memblock ext_mem_111669;
    
    ext_mem_111669.references = NULL;
    
    struct memblock ext_mem_111670;
    
    ext_mem_111670.references = NULL;
    
    struct memblock ext_mem_111671;
    
    ext_mem_111671.references = NULL;
    
    struct memblock ext_mem_111672;
    
    ext_mem_111672.references = NULL;
    
    struct memblock ext_mem_111673;
    
    ext_mem_111673.references = NULL;
    
    struct memblock ext_mem_111674;
    
    ext_mem_111674.references = NULL;
    
    struct memblock ext_mem_111675;
    
    ext_mem_111675.references = NULL;
    
    struct memblock ext_mem_111676;
    
    ext_mem_111676.references = NULL;
    
    struct memblock ext_mem_111677;
    
    ext_mem_111677.references = NULL;
    
    struct memblock ext_mem_111678;
    
    ext_mem_111678.references = NULL;
    
    struct memblock ext_mem_111679;
    
    ext_mem_111679.references = NULL;
    
    struct memblock ext_mem_111680;
    
    ext_mem_111680.references = NULL;
    
    struct memblock ext_mem_111681;
    
    ext_mem_111681.references = NULL;
    
    struct memblock ext_mem_111682;
    
    ext_mem_111682.references = NULL;
    
    struct memblock ext_mem_111683;
    
    ext_mem_111683.references = NULL;
    
    struct memblock ext_mem_111684;
    
    ext_mem_111684.references = NULL;
    
    struct memblock ext_mem_111685;
    
    ext_mem_111685.references = NULL;
    
    struct memblock ext_mem_111686;
    
    ext_mem_111686.references = NULL;
    
    struct memblock ext_mem_111687;
    
    ext_mem_111687.references = NULL;
    
    struct memblock ext_mem_111688;
    
    ext_mem_111688.references = NULL;
    
    struct memblock ext_mem_111689;
    
    ext_mem_111689.references = NULL;
    
    struct memblock ext_mem_111690;
    
    ext_mem_111690.references = NULL;
    
    struct memblock ext_mem_111691;
    
    ext_mem_111691.references = NULL;
    
    struct memblock ext_mem_111692;
    
    ext_mem_111692.references = NULL;
    
    struct memblock ext_mem_111693;
    
    ext_mem_111693.references = NULL;
    
    struct memblock ext_mem_111694;
    
    ext_mem_111694.references = NULL;
    
    struct memblock ext_mem_111695;
    
    ext_mem_111695.references = NULL;
    
    struct memblock ext_mem_111696;
    
    ext_mem_111696.references = NULL;
    
    struct memblock ext_mem_111697;
    
    ext_mem_111697.references = NULL;
    
    struct memblock ext_mem_111698;
    
    ext_mem_111698.references = NULL;
    
    struct memblock ext_mem_111699;
    
    ext_mem_111699.references = NULL;
    
    struct memblock ext_mem_111700;
    
    ext_mem_111700.references = NULL;
    
    struct memblock ext_mem_111701;
    
    ext_mem_111701.references = NULL;
    
    struct memblock ext_mem_111702;
    
    ext_mem_111702.references = NULL;
    
    struct memblock ext_mem_111703;
    
    ext_mem_111703.references = NULL;
    
    struct memblock ext_mem_111704;
    
    ext_mem_111704.references = NULL;
    
    struct memblock ext_mem_111705;
    
    ext_mem_111705.references = NULL;
    
    struct memblock ext_mem_111706;
    
    ext_mem_111706.references = NULL;
    
    struct memblock ext_mem_111707;
    
    ext_mem_111707.references = NULL;
    
    struct memblock ext_mem_111708;
    
    ext_mem_111708.references = NULL;
    
    struct memblock ext_mem_111709;
    
    ext_mem_111709.references = NULL;
    
    struct memblock ext_mem_111710;
    
    ext_mem_111710.references = NULL;
    
    struct memblock ext_mem_111711;
    
    ext_mem_111711.references = NULL;
    
    struct memblock ext_mem_111712;
    
    ext_mem_111712.references = NULL;
    
    struct memblock ext_mem_111713;
    
    ext_mem_111713.references = NULL;
    
    struct memblock ext_mem_111714;
    
    ext_mem_111714.references = NULL;
    
    struct memblock ext_mem_111715;
    
    ext_mem_111715.references = NULL;
    
    struct memblock ext_mem_111716;
    
    ext_mem_111716.references = NULL;
    
    struct memblock ext_mem_111717;
    
    ext_mem_111717.references = NULL;
    
    struct memblock mem_param_96904;
    
    mem_param_96904.references = NULL;
    
    struct memblock mem_param_96899;
    
    mem_param_96899.references = NULL;
    
    struct memblock mem_param_96894;
    
    mem_param_96894.references = NULL;
    
    struct memblock mem_param_96880;
    
    mem_param_96880.references = NULL;
    
    struct memblock mem_param_96875;
    
    mem_param_96875.references = NULL;
    
    struct memblock mem_param_96861;
    
    mem_param_96861.references = NULL;
    
    struct memblock mem_param_96856;
    
    mem_param_96856.references = NULL;
    
    struct memblock mem_param_96842;
    
    mem_param_96842.references = NULL;
    
    struct memblock mem_param_96837;
    
    mem_param_96837.references = NULL;
    
    struct memblock mem_param_96823;
    
    mem_param_96823.references = NULL;
    
    struct memblock mem_param_96818;
    
    mem_param_96818.references = NULL;
    
    struct memblock mem_param_96810;
    
    mem_param_96810.references = NULL;
    
    struct memblock mem_param_96805;
    
    mem_param_96805.references = NULL;
    
    struct memblock mem_param_96797;
    
    mem_param_96797.references = NULL;
    
    struct memblock mem_param_96792;
    
    mem_param_96792.references = NULL;
    
    struct memblock mem_param_96778;
    
    mem_param_96778.references = NULL;
    
    struct memblock mem_param_96773;
    
    mem_param_96773.references = NULL;
    
    struct memblock mem_param_96759;
    
    mem_param_96759.references = NULL;
    
    struct memblock mem_param_96754;
    
    mem_param_96754.references = NULL;
    
    struct memblock mem_param_96740;
    
    mem_param_96740.references = NULL;
    
    struct memblock mem_param_96735;
    
    mem_param_96735.references = NULL;
    
    struct memblock mem_param_96721;
    
    mem_param_96721.references = NULL;
    
    struct memblock mem_param_96716;
    
    mem_param_96716.references = NULL;
    
    struct memblock mem_param_96708;
    
    mem_param_96708.references = NULL;
    
    struct memblock mem_param_96703;
    
    mem_param_96703.references = NULL;
    
    struct memblock mem_param_96695;
    
    mem_param_96695.references = NULL;
    
    struct memblock mem_param_96690;
    
    mem_param_96690.references = NULL;
    
    struct memblock mem_param_96676;
    
    mem_param_96676.references = NULL;
    
    struct memblock mem_param_96671;
    
    mem_param_96671.references = NULL;
    
    struct memblock mem_param_96657;
    
    mem_param_96657.references = NULL;
    
    struct memblock mem_param_96652;
    
    mem_param_96652.references = NULL;
    
    struct memblock mem_param_96638;
    
    mem_param_96638.references = NULL;
    
    struct memblock mem_param_96633;
    
    mem_param_96633.references = NULL;
    
    struct memblock mem_param_96619;
    
    mem_param_96619.references = NULL;
    
    struct memblock mem_param_96614;
    
    mem_param_96614.references = NULL;
    
    struct memblock mem_param_96606;
    
    mem_param_96606.references = NULL;
    
    struct memblock mem_param_96601;
    
    mem_param_96601.references = NULL;
    
    struct memblock mem_param_96593;
    
    mem_param_96593.references = NULL;
    
    struct memblock mem_param_96588;
    
    mem_param_96588.references = NULL;
    
    struct memblock mem_param_96574;
    
    mem_param_96574.references = NULL;
    
    struct memblock mem_param_96569;
    
    mem_param_96569.references = NULL;
    
    struct memblock mem_param_96555;
    
    mem_param_96555.references = NULL;
    
    struct memblock mem_param_96550;
    
    mem_param_96550.references = NULL;
    
    struct memblock mem_param_96536;
    
    mem_param_96536.references = NULL;
    
    struct memblock mem_param_96531;
    
    mem_param_96531.references = NULL;
    
    struct memblock mem_param_96517;
    
    mem_param_96517.references = NULL;
    
    struct memblock mem_param_96512;
    
    mem_param_96512.references = NULL;
    
    struct memblock mem_param_96504;
    
    mem_param_96504.references = NULL;
    
    struct memblock mem_param_96499;
    
    mem_param_96499.references = NULL;
    
    struct memblock mem_param_96491;
    
    mem_param_96491.references = NULL;
    
    struct memblock mem_param_96486;
    
    mem_param_96486.references = NULL;
    
    struct memblock mem_param_96472;
    
    mem_param_96472.references = NULL;
    
    struct memblock mem_param_96467;
    
    mem_param_96467.references = NULL;
    
    struct memblock mem_param_96453;
    
    mem_param_96453.references = NULL;
    
    struct memblock mem_param_96448;
    
    mem_param_96448.references = NULL;
    
    struct memblock mem_param_96434;
    
    mem_param_96434.references = NULL;
    
    struct memblock mem_param_96429;
    
    mem_param_96429.references = NULL;
    
    struct memblock mem_param_96415;
    
    mem_param_96415.references = NULL;
    
    struct memblock mem_param_96410;
    
    mem_param_96410.references = NULL;
    
    struct memblock mem_param_96393;
    
    mem_param_96393.references = NULL;
    
    struct memblock mem_param_96388;
    
    mem_param_96388.references = NULL;
    
    struct memblock mem_param_96371;
    
    mem_param_96371.references = NULL;
    
    struct memblock mem_param_96366;
    
    mem_param_96366.references = NULL;
    
    struct memblock mem_param_96355;
    
    mem_param_96355.references = NULL;
    
    struct memblock mem_param_96350;
    
    mem_param_96350.references = NULL;
    
    struct memblock mem_param_96333;
    
    mem_param_96333.references = NULL;
    
    struct memblock mem_param_96328;
    
    mem_param_96328.references = NULL;
    
    struct memblock mem_param_96311;
    
    mem_param_96311.references = NULL;
    
    struct memblock mem_param_96306;
    
    mem_param_96306.references = NULL;
    
    struct memblock mem_param_96295;
    
    mem_param_96295.references = NULL;
    
    struct memblock mem_param_96290;
    
    mem_param_96290.references = NULL;
    
    struct memblock mem_param_96273;
    
    mem_param_96273.references = NULL;
    
    struct memblock mem_param_96268;
    
    mem_param_96268.references = NULL;
    
    struct memblock mem_param_96251;
    
    mem_param_96251.references = NULL;
    
    struct memblock mem_param_96246;
    
    mem_param_96246.references = NULL;
    
    struct memblock mem_param_96235;
    
    mem_param_96235.references = NULL;
    
    struct memblock mem_param_96230;
    
    mem_param_96230.references = NULL;
    
    struct memblock mem_param_96213;
    
    mem_param_96213.references = NULL;
    
    struct memblock mem_param_96208;
    
    mem_param_96208.references = NULL;
    
    struct memblock mem_param_96191;
    
    mem_param_96191.references = NULL;
    
    struct memblock mem_param_96186;
    
    mem_param_96186.references = NULL;
    
    struct memblock mem_param_96175;
    
    mem_param_96175.references = NULL;
    
    struct memblock mem_param_96170;
    
    mem_param_96170.references = NULL;
    
    struct memblock mem_param_96153;
    
    mem_param_96153.references = NULL;
    
    struct memblock mem_param_96148;
    
    mem_param_96148.references = NULL;
    
    struct memblock ext_mem_112369;
    
    ext_mem_112369.references = NULL;
    
    struct memblock ext_mem_112370;
    
    ext_mem_112370.references = NULL;
    
    struct memblock ext_mem_112371;
    
    ext_mem_112371.references = NULL;
    
    struct memblock ext_mem_112372;
    
    ext_mem_112372.references = NULL;
    
    struct memblock ext_mem_112373;
    
    ext_mem_112373.references = NULL;
    
    struct memblock ext_mem_112374;
    
    ext_mem_112374.references = NULL;
    
    struct memblock ext_mem_112375;
    
    ext_mem_112375.references = NULL;
    
    struct memblock ext_mem_112376;
    
    ext_mem_112376.references = NULL;
    
    struct memblock ext_mem_112377;
    
    ext_mem_112377.references = NULL;
    
    struct memblock ext_mem_112378;
    
    ext_mem_112378.references = NULL;
    
    struct memblock ext_mem_112379;
    
    ext_mem_112379.references = NULL;
    
    struct memblock ext_mem_112380;
    
    ext_mem_112380.references = NULL;
    
    struct memblock ext_mem_112381;
    
    ext_mem_112381.references = NULL;
    
    struct memblock ext_mem_112382;
    
    ext_mem_112382.references = NULL;
    
    struct memblock ext_mem_112383;
    
    ext_mem_112383.references = NULL;
    
    struct memblock ext_mem_112384;
    
    ext_mem_112384.references = NULL;
    
    struct memblock ext_mem_112385;
    
    ext_mem_112385.references = NULL;
    
    struct memblock ext_mem_112386;
    
    ext_mem_112386.references = NULL;
    
    struct memblock ext_mem_112387;
    
    ext_mem_112387.references = NULL;
    
    struct memblock ext_mem_112388;
    
    ext_mem_112388.references = NULL;
    
    struct memblock ext_mem_112389;
    
    ext_mem_112389.references = NULL;
    
    struct memblock ext_mem_112390;
    
    ext_mem_112390.references = NULL;
    
    struct memblock ext_mem_112391;
    
    ext_mem_112391.references = NULL;
    
    struct memblock ext_mem_112392;
    
    ext_mem_112392.references = NULL;
    
    struct memblock ext_mem_112393;
    
    ext_mem_112393.references = NULL;
    
    struct memblock ext_mem_112394;
    
    ext_mem_112394.references = NULL;
    
    struct memblock ext_mem_112395;
    
    ext_mem_112395.references = NULL;
    
    struct memblock ext_mem_112396;
    
    ext_mem_112396.references = NULL;
    
    struct memblock ext_mem_112397;
    
    ext_mem_112397.references = NULL;
    
    struct memblock ext_mem_112398;
    
    ext_mem_112398.references = NULL;
    
    struct memblock ext_mem_112399;
    
    ext_mem_112399.references = NULL;
    
    struct memblock ext_mem_112400;
    
    ext_mem_112400.references = NULL;
    
    struct memblock ext_mem_112401;
    
    ext_mem_112401.references = NULL;
    
    struct memblock ext_mem_112402;
    
    ext_mem_112402.references = NULL;
    
    struct memblock ext_mem_112403;
    
    ext_mem_112403.references = NULL;
    
    struct memblock ext_mem_112404;
    
    ext_mem_112404.references = NULL;
    
    struct memblock ext_mem_112405;
    
    ext_mem_112405.references = NULL;
    
    struct memblock ext_mem_112406;
    
    ext_mem_112406.references = NULL;
    
    struct memblock ext_mem_112407;
    
    ext_mem_112407.references = NULL;
    
    struct memblock ext_mem_112408;
    
    ext_mem_112408.references = NULL;
    
    struct memblock ext_mem_112409;
    
    ext_mem_112409.references = NULL;
    
    struct memblock ext_mem_112410;
    
    ext_mem_112410.references = NULL;
    
    struct memblock ext_mem_112411;
    
    ext_mem_112411.references = NULL;
    
    struct memblock ext_mem_112412;
    
    ext_mem_112412.references = NULL;
    
    struct memblock ext_mem_112413;
    
    ext_mem_112413.references = NULL;
    
    struct memblock ext_mem_112414;
    
    ext_mem_112414.references = NULL;
    
    struct memblock ext_mem_112415;
    
    ext_mem_112415.references = NULL;
    
    struct memblock ext_mem_112416;
    
    ext_mem_112416.references = NULL;
    
    struct memblock ext_mem_112417;
    
    ext_mem_112417.references = NULL;
    
    struct memblock ext_mem_112418;
    
    ext_mem_112418.references = NULL;
    
    struct memblock ext_mem_112419;
    
    ext_mem_112419.references = NULL;
    
    struct memblock ext_mem_112420;
    
    ext_mem_112420.references = NULL;
    
    struct memblock ext_mem_112421;
    
    ext_mem_112421.references = NULL;
    
    struct memblock ext_mem_112422;
    
    ext_mem_112422.references = NULL;
    
    struct memblock ext_mem_112423;
    
    ext_mem_112423.references = NULL;
    
    struct memblock ext_mem_112424;
    
    ext_mem_112424.references = NULL;
    
    struct memblock ext_mem_112425;
    
    ext_mem_112425.references = NULL;
    
    struct memblock ext_mem_112426;
    
    ext_mem_112426.references = NULL;
    
    struct memblock ext_mem_112427;
    
    ext_mem_112427.references = NULL;
    
    struct memblock ext_mem_112428;
    
    ext_mem_112428.references = NULL;
    
    struct memblock ext_mem_112429;
    
    ext_mem_112429.references = NULL;
    
    struct memblock ext_mem_112430;
    
    ext_mem_112430.references = NULL;
    
    struct memblock ext_mem_112431;
    
    ext_mem_112431.references = NULL;
    
    struct memblock ext_mem_112432;
    
    ext_mem_112432.references = NULL;
    
    struct memblock ext_mem_112433;
    
    ext_mem_112433.references = NULL;
    
    struct memblock ext_mem_112434;
    
    ext_mem_112434.references = NULL;
    
    struct memblock ext_mem_112435;
    
    ext_mem_112435.references = NULL;
    
    struct memblock ext_mem_112436;
    
    ext_mem_112436.references = NULL;
    
    struct memblock ext_mem_112437;
    
    ext_mem_112437.references = NULL;
    
    struct memblock ext_mem_112438;
    
    ext_mem_112438.references = NULL;
    
    struct memblock ext_mem_112439;
    
    ext_mem_112439.references = NULL;
    
    struct memblock ext_mem_112440;
    
    ext_mem_112440.references = NULL;
    
    struct memblock ext_mem_112441;
    
    ext_mem_112441.references = NULL;
    
    struct memblock ext_mem_112442;
    
    ext_mem_112442.references = NULL;
    
    struct memblock ext_mem_112443;
    
    ext_mem_112443.references = NULL;
    
    struct memblock ext_mem_112444;
    
    ext_mem_112444.references = NULL;
    
    struct memblock ext_mem_112445;
    
    ext_mem_112445.references = NULL;
    
    struct memblock ext_mem_112446;
    
    ext_mem_112446.references = NULL;
    
    struct memblock ext_mem_112447;
    
    ext_mem_112447.references = NULL;
    
    struct memblock ext_mem_112448;
    
    ext_mem_112448.references = NULL;
    
    struct memblock ext_mem_112449;
    
    ext_mem_112449.references = NULL;
    
    struct memblock ext_mem_112450;
    
    ext_mem_112450.references = NULL;
    
    struct memblock ext_mem_112451;
    
    ext_mem_112451.references = NULL;
    
    struct memblock ext_mem_112452;
    
    ext_mem_112452.references = NULL;
    
    struct memblock ext_mem_112453;
    
    ext_mem_112453.references = NULL;
    
    struct memblock mem_96395;
    
    mem_96395.references = NULL;
    
    struct memblock mem_96373;
    
    mem_96373.references = NULL;
    
    struct memblock mem_96357;
    
    mem_96357.references = NULL;
    
    struct memblock mem_96335;
    
    mem_96335.references = NULL;
    
    struct memblock mem_96313;
    
    mem_96313.references = NULL;
    
    struct memblock mem_96297;
    
    mem_96297.references = NULL;
    
    struct memblock mem_96275;
    
    mem_96275.references = NULL;
    
    struct memblock mem_96253;
    
    mem_96253.references = NULL;
    
    struct memblock mem_96237;
    
    mem_96237.references = NULL;
    
    struct memblock mem_96215;
    
    mem_96215.references = NULL;
    
    struct memblock mem_96193;
    
    mem_96193.references = NULL;
    
    struct memblock mem_96177;
    
    mem_96177.references = NULL;
    
    struct memblock mem_96155;
    
    mem_96155.references = NULL;
    
    struct memblock mem_96133;
    
    mem_96133.references = NULL;
    
    struct memblock mem_96131;
    
    mem_96131.references = NULL;
    
    struct memblock mem_out_113560;
    
    mem_out_113560.references = NULL;
    
    struct memblock mem_95769 = ctx->constants.mem_95769;
    struct memblock mem_95781 = ctx->constants.mem_95781;
    struct memblock mem_95783 = ctx->constants.mem_95783;
    struct memblock mem_95785 = ctx->constants.mem_95785;
    struct memblock mem_95787 = ctx->constants.mem_95787;
    struct memblock mem_95789 = ctx->constants.mem_95789;
    struct memblock mem_95841 = ctx->constants.mem_95841;
    struct memblock mem_95853 = ctx->constants.mem_95853;
    struct memblock mem_95855 = ctx->constants.mem_95855;
    struct memblock mem_95857 = ctx->constants.mem_95857;
    struct memblock mem_95859 = ctx->constants.mem_95859;
    struct memblock mem_95861 = ctx->constants.mem_95861;
    struct memblock mem_95863 = ctx->constants.mem_95863;
    struct memblock mem_95925 = ctx->constants.mem_95925;
    struct memblock mem_95927 = ctx->constants.mem_95927;
    struct memblock mem_95949 = ctx->constants.mem_95949;
    struct memblock mem_95951 = ctx->constants.mem_95951;
    struct memblock mem_95953 = ctx->constants.mem_95953;
    struct memblock mem_95985 = ctx->constants.mem_95985;
    struct memblock mem_95997 = ctx->constants.mem_95997;
    struct memblock mem_95999 = ctx->constants.mem_95999;
    struct memblock mem_96001 = ctx->constants.mem_96001;
    struct memblock mem_96033 = ctx->constants.mem_96033;
    struct memblock mem_96045 = ctx->constants.mem_96045;
    struct memblock mem_96047 = ctx->constants.mem_96047;
    struct memblock mem_96069 = ctx->constants.mem_96069;
    struct memblock mem_96081 = ctx->constants.mem_96081;
    double zp_res_61110 = ctx->constants.zp_res_61110;
    struct memblock mem_96093 = ctx->constants.mem_96093;
    struct memblock mem_96095 = ctx->constants.mem_96095;
    struct memblock mem_96097 = ctx->constants.mem_96097;
    struct memblock mem_96099 = ctx->constants.mem_96099;
    struct memblock mem_96101 = ctx->constants.mem_96101;
    struct memblock mem_96103 = ctx->constants.mem_96103;
    struct memblock mem_96105 = ctx->constants.mem_96105;
    struct memblock mem_96107 = ctx->constants.mem_96107;
    struct memblock mem_96109 = ctx->constants.mem_96109;
    struct memblock mem_96111 = ctx->constants.mem_96111;
    struct memblock mem_96113 = ctx->constants.mem_96113;
    struct memblock mem_96115 = ctx->constants.mem_96115;
    struct memblock mem_96117 = ctx->constants.mem_96117;
    struct memblock mem_96119 = ctx->constants.mem_96119;
    struct memblock mem_96121 = ctx->constants.mem_96121;
    struct memblock mem_96123 = ctx->constants.mem_96123;
    struct memblock mem_96125 = ctx->constants.mem_96125;
    int64_t prim_out_113561;
    
    if (memblock_alloc(ctx, &mem_96131, (int64_t) 0, "mem_96131")) {
        err = 1;
        goto cleanup;
    }
    
    double i64_res_54176 = sitofp_i64_f64(l_49204);
    double i64_res_54201 = sitofp_i64_f64(n_49206);
    double i64_res_54202 = sitofp_i64_f64(m_49205);
    int64_t i64_arg_54203 = mul64(m_49205, n_49206);
    double i64_res_54204 = sitofp_i64_f64(i64_arg_54203);
    bool loop_nonempty_56736 = slt64((int64_t) 0, epochs_49210);
    bool loop_nonempty_56721 = slt64((int64_t) 0, l_49204);
    int64_t x_55816 = add64((int64_t) 2, m_49205);
    int64_t x_55817 = sub64(x_55816, (int64_t) 3);
    int64_t new_n_55818 = add64((int64_t) 1, x_55817);
    int64_t x_55820 = add64((int64_t) 2, n_49206);
    int64_t x_55821 = sub64(x_55820, (int64_t) 3);
    int64_t new_m_55822 = add64((int64_t) 1, x_55821);
    bool bounds_invalid_upwards_55834 = slt64(x_55816, (int64_t) 0);
    bool valid_55835 = !bounds_invalid_upwards_55834;
    bool loop_not_taken_56722 = !loop_nonempty_56721;
    bool protect_assert_disj_56723 = valid_55835 || loop_not_taken_56722;
    bool loop_not_taken_56737 = !loop_nonempty_56736;
    bool protect_assert_disj_56738 = protect_assert_disj_56723 ||
         loop_not_taken_56737;
    bool range_valid_c_55836;
    
    if (!protect_assert_disj_56738) {
        set_error(ctx,
                  msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                            "Range ", (long long) (int64_t) 0, "..",
                            (long long) (int64_t) 1, "..<", (long long) x_55816,
                            " is invalid.",
                            "-> #0  /prelude/array.fut:95:3-10\n   #1  ../layers/conv2d.fut:6:6-7:123\n   #2  ../layers/conv2d.fut:22:7-30\n   #3  test_diffusion.fut:57:1-59:11\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_55838 = slt64(x_55820, (int64_t) 0);
    bool valid_55839 = !bounds_invalid_upwards_55838;
    bool protect_assert_disj_56725 = valid_55839 || loop_not_taken_56722;
    bool protect_assert_disj_56740 = protect_assert_disj_56725 ||
         loop_not_taken_56737;
    bool range_valid_c_55840;
    
    if (!protect_assert_disj_56740) {
        set_error(ctx,
                  msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                            "Range ", (long long) (int64_t) 0, "..",
                            (long long) (int64_t) 1, "..<", (long long) x_55820,
                            " is invalid.",
                            "-> #0  /prelude/array.fut:95:3-10\n   #1  ../layers/conv2d.fut:6:6-7:123\n   #2  ../layers/conv2d.fut:22:7-30\n   #3  test_diffusion.fut:57:1-59:11\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t y_55842 = add64((int64_t) 1, m_49205);
    int64_t y_55843 = add64((int64_t) 1, n_49206);
    bool bounds_invalid_upwards_55876 = slt64(new_n_55818, (int64_t) 0);
    bool valid_55877 = !bounds_invalid_upwards_55876;
    bool protect_assert_disj_56727 = valid_55877 || loop_not_taken_56722;
    bool protect_assert_disj_56742 = protect_assert_disj_56727 ||
         loop_not_taken_56737;
    bool range_valid_c_55878;
    
    if (!protect_assert_disj_56742) {
        set_error(ctx,
                  msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                            "Range ", (long long) (int64_t) 0, "..",
                            (long long) (int64_t) 1, "..<",
                            (long long) new_n_55818, " is invalid.",
                            "-> #0  /prelude/array.fut:95:3-10\n   #1  /prelude/array.fut:208:28-33\n   #2  ../layers/conv2d.fut:13:26-162\n   #3  ../layers/conv2d.fut:26:17-54\n   #4  test_diffusion.fut:57:1-59:11\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_55880 = slt64(new_m_55822, (int64_t) 0);
    bool valid_55881 = !bounds_invalid_upwards_55880;
    bool protect_assert_disj_56729 = valid_55881 || loop_not_taken_56722;
    bool protect_assert_disj_56744 = protect_assert_disj_56729 ||
         loop_not_taken_56737;
    bool range_valid_c_55882;
    
    if (!protect_assert_disj_56744) {
        set_error(ctx,
                  msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                            "Range ", (long long) (int64_t) 0, "..",
                            (long long) (int64_t) 1, "..<",
                            (long long) new_m_55822, " is invalid.",
                            "-> #0  /prelude/array.fut:95:3-10\n   #1  /prelude/array.fut:208:3-34\n   #2  ../layers/conv2d.fut:13:26-162\n   #3  ../layers/conv2d.fut:26:17-54\n   #4  test_diffusion.fut:57:1-59:11\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t flat_dim_55927 = new_n_55818 * new_m_55822;
    bool dim_match_54595 = (int64_t) 28 == new_n_55818;
    bool dim_match_54596 = (int64_t) 28 == new_m_55822;
    bool match_54597 = dim_match_54595 && dim_match_54596;
    bool protect_assert_disj_56733 = match_54597 || loop_not_taken_56722;
    bool protect_assert_disj_56748 = protect_assert_disj_56733 ||
         loop_not_taken_56737;
    bool empty_or_match_cert_54598;
    
    if (!protect_assert_disj_56748) {
        set_error(ctx,
                  msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                            "Value of (core language) shape (",
                            (long long) (int64_t) 64, ", ",
                            (long long) new_n_55818, ", ",
                            (long long) new_m_55822,
                            ") cannot match shape of type `[64][28][28]f64`.",
                            "-> #0  ../unet/unet.fut:42:37-84\n   #1  diffusion.fut:39:38-87\n   #2  test_diffusion.fut:58:34-136\n   #3  test_diffusion.fut:57:1-59:11\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool dim_match_54657 = m_49205 == (int64_t) 28;
    bool dim_match_54658 = n_49206 == (int64_t) 28;
    bool match_54659 = dim_match_54657 && dim_match_54658;
    bool protect_assert_disj_56735 = match_54659 || loop_not_taken_56722;
    bool protect_assert_disj_56750 = protect_assert_disj_56735 ||
         loop_not_taken_56737;
    bool empty_or_match_cert_54660;
    
    if (!protect_assert_disj_56750) {
        set_error(ctx,
                  msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                            "Value of (core language) shape (",
                            (long long) (int64_t) 28, ", ",
                            (long long) (int64_t) 28,
                            ") cannot match shape of type `[",
                            (long long) m_49205, "][", (long long) n_49206,
                            "]f64`.",
                            "-> #0  ../unet/unet.fut:51:18-41\n   #1  diffusion.fut:39:38-87\n   #2  test_diffusion.fut:58:34-136\n   #3  test_diffusion.fut:57:1-59:11\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_56826 = slt64(i64_arg_54203, (int64_t) 0);
    bool valid_56827 = !bounds_invalid_upwards_56826;
    bool protect_assert_disj_65552 = loop_not_taken_56722 || valid_56827;
    bool protect_assert_disj_65579 = loop_not_taken_56737 ||
         protect_assert_disj_65552;
    bool range_valid_c_56828;
    
    if (!protect_assert_disj_65579) {
        set_error(ctx,
                  msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                            "Range ", (long long) (int64_t) 0, "..",
                            (long long) (int64_t) 1, "..<",
                            (long long) i64_arg_54203, " is invalid.",
                            "-> #0  /prelude/array.fut:95:3-10\n   #1  /prelude/array.fut:200:11-16\n   #2  ../gen_random/lib/github.com/diku-dk/cpprandom/random.fut:174:8-56\n   #3  ../gen_random/mk_random.fut:20:20-55\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t x_58742 = sub64((int64_t) 28, m_49205);
    int64_t new_n_58743 = add64((int64_t) 1, x_58742);
    int64_t x_58750 = new_n_58743 * new_n_58743;
    bool dim_match_58751 = (int64_t) 1 == new_n_58743;
    int64_t k_total_58756 = mul64(m_49205, m_49205);
    bool bounds_invalid_upwards_58757 = slt64(new_n_58743, (int64_t) 0);
    bool valid_58758 = !bounds_invalid_upwards_58757;
    bool protect_assert_disj_65554 = loop_not_taken_56722 || valid_58758;
    bool protect_assert_disj_65581 = loop_not_taken_56737 ||
         protect_assert_disj_65554;
    bool range_valid_c_58759;
    
    if (!protect_assert_disj_65581) {
        set_error(ctx,
                  msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                            "Range ", (long long) (int64_t) 0, "..",
                            (long long) (int64_t) 1, "..<",
                            (long long) new_n_58743, " is invalid.",
                            "-> #0  /prelude/array.fut:95:3-10\n   #1  /prelude/array.fut:208:28-33\n   #2  ../layers/conv2d.fut:13:26-162\n   #3  /prelude/soacs.fut:59:3-10\n   #4  /prelude/array.fut:208:3-34\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool empty_slice_58765 = m_49205 == (int64_t) 0;
    int64_t m_58766 = sub64(m_49205, (int64_t) 1);
    bool dim_match_58769 = i64_arg_54203 == k_total_58756;
    bool protect_assert_disj_65558 = loop_not_taken_56722 || dim_match_58769;
    bool protect_assert_disj_65585 = loop_not_taken_56737 ||
         protect_assert_disj_65558;
    bool empty_or_match_cert_58770;
    
    if (!protect_assert_disj_65585) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                 "Value of (core language) shape (",
                                 (long long) k_total_58756,
                                 ") cannot match shape of type `[",
                                 (long long) i64_arg_54203, "]f64`.",
                                 "-> #0  ../layers/conv2d.fut:13:60-161\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  ../layers/conv2d.fut:13:26-162\n   #7  /prelude/soacs.fut:59:3-10\n   #8  /prelude/array.fut:208:3-34\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool match_58774 = dim_match_58751 && dim_match_58751;
    bool protect_assert_disj_65560 = loop_not_taken_56722 || match_58774;
    bool protect_assert_disj_65587 = loop_not_taken_56737 ||
         protect_assert_disj_65560;
    bool empty_or_match_cert_58775;
    
    if (!protect_assert_disj_65587) {
        set_error(ctx,
                  msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                            "Value of (core language) shape (",
                            (long long) new_n_58743, ", ",
                            (long long) new_n_58743,
                            ") cannot match shape of type `[",
                            (long long) (int64_t) 1, "][",
                            (long long) (int64_t) 1, "]f64`.",
                            "-> #0  ../layers/conv2d.fut:34:48-129\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool dim_match_59030 = (int64_t) 28 == m_49205;
    bool dim_match_59031 = (int64_t) 28 == n_49206;
    bool match_59032 = dim_match_59030 && dim_match_59031;
    bool protect_assert_disj_65564 = loop_not_taken_56722 || match_59032;
    bool protect_assert_disj_65591 = loop_not_taken_56737 ||
         protect_assert_disj_65564;
    bool empty_or_match_cert_59033;
    
    if (!protect_assert_disj_65591) {
        set_error(ctx,
                  msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                            "Value of (core language) shape (",
                            (long long) (int64_t) 64, ", ", (long long) m_49205,
                            ", ", (long long) n_49206,
                            ") cannot match shape of type `[",
                            (long long) (int64_t) 64, "][",
                            (long long) (int64_t) 28, "][",
                            (long long) (int64_t) 28, "]f64`.",
                            "-> #0  ../layers/conv2d.fut:35:20-117\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t x_59696 = sub64(x_55816, (int64_t) 28);
    int64_t new_n_59697 = add64((int64_t) 1, x_59696);
    int64_t x_59699 = sub64(x_55820, (int64_t) 28);
    int64_t new_m_59700 = add64((int64_t) 1, x_59699);
    int64_t x_59704 = new_n_59697 * new_m_59700;
    bool dim_match_59705 = (int64_t) 3 == new_m_59700;
    bool bounds_invalid_upwards_59711 = slt64(new_n_59697, (int64_t) 0);
    bool valid_59712 = !bounds_invalid_upwards_59711;
    bool protect_assert_disj_65566 = loop_not_taken_56722 || valid_59712;
    bool protect_assert_disj_65593 = loop_not_taken_56737 ||
         protect_assert_disj_65566;
    bool range_valid_c_59713;
    
    if (!protect_assert_disj_65593) {
        set_error(ctx,
                  msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                            "Range ", (long long) (int64_t) 0, "..",
                            (long long) (int64_t) 1, "..<",
                            (long long) new_n_59697, " is invalid.",
                            "-> #0  /prelude/array.fut:95:3-10\n   #1  /prelude/array.fut:208:28-33\n   #2  ../layers/conv2d.fut:13:26-162\n   #3  /prelude/soacs.fut:59:3-10\n   #4  /prelude/array.fut:208:3-34\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_59715 = slt64(new_m_59700, (int64_t) 0);
    bool valid_59716 = !bounds_invalid_upwards_59715;
    bool protect_assert_disj_65568 = loop_not_taken_56722 || valid_59716;
    bool protect_assert_disj_65595 = loop_not_taken_56737 ||
         protect_assert_disj_65568;
    bool range_valid_c_59717;
    
    if (!protect_assert_disj_65595) {
        set_error(ctx,
                  msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                            "Range ", (long long) (int64_t) 0, "..",
                            (long long) (int64_t) 1, "..<",
                            (long long) new_m_59700, " is invalid.",
                            "-> #0  /prelude/array.fut:95:3-10\n   #1  /prelude/array.fut:208:3-34\n   #2  ../layers/conv2d.fut:13:26-162\n   #3  /prelude/soacs.fut:59:3-10\n   #4  /prelude/array.fut:208:3-34\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool dim_match_59727 = (int64_t) 3 == new_n_59697;
    bool match_59728 = dim_match_59705 && dim_match_59727;
    bool protect_assert_disj_65570 = loop_not_taken_56722 || match_59728;
    bool protect_assert_disj_65597 = loop_not_taken_56737 ||
         protect_assert_disj_65570;
    bool empty_or_match_cert_59729;
    
    if (!protect_assert_disj_65597) {
        set_error(ctx,
                  msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                            "Value of (core language) shape (",
                            (long long) new_n_59697, ", ",
                            (long long) new_m_59700,
                            ") cannot match shape of type `[",
                            (long long) (int64_t) 3, "][",
                            (long long) (int64_t) 3, "]f64`.",
                            "-> #0  ../layers/conv2d.fut:34:48-129\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t binop_y_92967 = (int64_t) 9 * new_m_55822;
    int64_t binop_y_88024 = i64_arg_54203 * new_n_58743;
    int64_t binop_y_87989 = (int64_t) 784 * new_m_59700;
    
    if (memblock_alloc(ctx, &mem_96133, (int64_t) 4608, "mem_96133")) {
        err = 1;
        goto cleanup;
    }
    if ((int64_t) 4608 > 0)
        memmove(mem_96133.mem + (int64_t) 0, mem_95769.mem + (int64_t) 0,
                (int64_t) 4608);
    if (memblock_alloc(ctx, &mem_96155, (int64_t) 589824, "mem_96155")) {
        err = 1;
        goto cleanup;
    }
    if ((int64_t) 589824 > 0)
        memmove(mem_96155.mem + (int64_t) 0, mem_95841.mem + (int64_t) 0,
                (int64_t) 589824);
    if (memblock_alloc(ctx, &mem_96177, (int64_t) 262144, "mem_96177")) {
        err = 1;
        goto cleanup;
    }
    if ((int64_t) 262144 > 0)
        memmove(mem_96177.mem + (int64_t) 0, mem_95927.mem + (int64_t) 0,
                (int64_t) 262144);
    if (memblock_alloc(ctx, &mem_96193, (int64_t) 1179648, "mem_96193")) {
        err = 1;
        goto cleanup;
    }
    if ((int64_t) 1179648 > 0)
        memmove(mem_96193.mem + (int64_t) 0, mem_95953.mem + (int64_t) 0,
                (int64_t) 1179648);
    if (memblock_alloc(ctx, &mem_96215, (int64_t) 2359296, "mem_96215")) {
        err = 1;
        goto cleanup;
    }
    if ((int64_t) 2359296 > 0)
        memmove(mem_96215.mem + (int64_t) 0, mem_95985.mem + (int64_t) 0,
                (int64_t) 2359296);
    if (memblock_alloc(ctx, &mem_96237, (int64_t) 524288, "mem_96237")) {
        err = 1;
        goto cleanup;
    }
    if ((int64_t) 524288 > 0)
        memmove(mem_96237.mem + (int64_t) 0, mem_96033.mem + (int64_t) 0,
                (int64_t) 524288);
    if (memblock_alloc(ctx, &mem_96253, (int64_t) 4718592, "mem_96253")) {
        err = 1;
        goto cleanup;
    }
    if ((int64_t) 4718592 > 0)
        memmove(mem_96253.mem + (int64_t) 0, mem_96047.mem + (int64_t) 0,
                (int64_t) 4718592);
    if (memblock_alloc(ctx, &mem_96275, (int64_t) 4718592, "mem_96275")) {
        err = 1;
        goto cleanup;
    }
    if ((int64_t) 4718592 > 0)
        memmove(mem_96275.mem + (int64_t) 0, mem_96045.mem + (int64_t) 0,
                (int64_t) 4718592);
    if (memblock_alloc(ctx, &mem_96297, (int64_t) 262144, "mem_96297")) {
        err = 1;
        goto cleanup;
    }
    if ((int64_t) 262144 > 0)
        memmove(mem_96297.mem + (int64_t) 0, mem_95925.mem + (int64_t) 0,
                (int64_t) 262144);
    if (memblock_alloc(ctx, &mem_96313, (int64_t) 1179648, "mem_96313")) {
        err = 1;
        goto cleanup;
    }
    if ((int64_t) 1179648 > 0)
        memmove(mem_96313.mem + (int64_t) 0, mem_95951.mem + (int64_t) 0,
                (int64_t) 1179648);
    if (memblock_alloc(ctx, &mem_96335, (int64_t) 1179648, "mem_96335")) {
        err = 1;
        goto cleanup;
    }
    if ((int64_t) 1179648 > 0)
        memmove(mem_96335.mem + (int64_t) 0, mem_95949.mem + (int64_t) 0,
                (int64_t) 1179648);
    if (memblock_alloc(ctx, &mem_96357, (int64_t) 131072, "mem_96357")) {
        err = 1;
        goto cleanup;
    }
    if ((int64_t) 131072 > 0)
        memmove(mem_96357.mem + (int64_t) 0, mem_96069.mem + (int64_t) 0,
                (int64_t) 131072);
    if (memblock_alloc(ctx, &mem_96373, (int64_t) 294912, "mem_96373")) {
        err = 1;
        goto cleanup;
    }
    if ((int64_t) 294912 > 0)
        memmove(mem_96373.mem + (int64_t) 0, mem_96081.mem + (int64_t) 0,
                (int64_t) 294912);
    if (memblock_alloc(ctx, &mem_96395, (int64_t) 512, "mem_96395")) {
        err = 1;
        goto cleanup;
    }
    if ((int64_t) 512 > 0)
        memmove(mem_96395.mem + (int64_t) 0, mem_95781.mem + (int64_t) 0,
                (int64_t) 512);
    
    int64_t binop_y_97631 = (int64_t) 8 * i64_arg_54203;
    int64_t bytes_97632 = smax64((int64_t) 0, binop_y_97631);
    
    if (mem_97633_cached_sizze_114813 < bytes_97632) {
        err = lexical_realloc(ctx, &mem_97633, &mem_97633_cached_sizze_114813,
                              bytes_97632);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_97647_cached_sizze_114814 < bytes_97632) {
        err = lexical_realloc(ctx, &mem_97647, &mem_97647_cached_sizze_114814,
                              bytes_97632);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_97690_cached_sizze_114815 < (int64_t) 1024) {
        err = lexical_realloc(ctx, &mem_97690, &mem_97690_cached_sizze_114815,
                              (int64_t) 1024);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_97692_cached_sizze_114816 < (int64_t) 1024) {
        err = lexical_realloc(ctx, &mem_97692, &mem_97692_cached_sizze_114816,
                              (int64_t) 1024);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t binop_x_97713 = x_55816 * x_55820;
    int64_t binop_y_97714 = (int64_t) 8 * binop_x_97713;
    int64_t bytes_97715 = smax64((int64_t) 0, binop_y_97714);
    
    if (mem_97716_cached_sizze_114817 < bytes_97715) {
        err = lexical_realloc(ctx, &mem_97716, &mem_97716_cached_sizze_114817,
                              bytes_97715);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_97720_cached_sizze_114818 < bytes_97715) {
        err = lexical_realloc(ctx, &mem_97720, &mem_97720_cached_sizze_114818,
                              bytes_97715);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_97806_cached_sizze_114819 < bytes_97715) {
        err = lexical_realloc(ctx, &mem_97806, &mem_97806_cached_sizze_114819,
                              bytes_97715);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t binop_y_97809 = (int64_t) 72 * flat_dim_55927;
    int64_t bytes_97810 = smax64((int64_t) 0, binop_y_97809);
    
    if (mem_97811_cached_sizze_114820 < bytes_97810) {
        err = lexical_realloc(ctx, &mem_97811, &mem_97811_cached_sizze_114820,
                              bytes_97810);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t binop_y_97870 = (int64_t) 512 * flat_dim_55927;
    int64_t bytes_97871 = smax64((int64_t) 0, binop_y_97870);
    
    if (mem_97872_cached_sizze_114821 < bytes_97871) {
        err = lexical_realloc(ctx, &mem_97872, &mem_97872_cached_sizze_114821,
                              bytes_97871);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_97915_cached_sizze_114822 < (int64_t) 460800) {
        err = lexical_realloc(ctx, &mem_97915, &mem_97915_cached_sizze_114822,
                              (int64_t) 460800);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_97999_cached_sizze_114823 < (int64_t) 3612672) {
        err = lexical_realloc(ctx, &mem_97999, &mem_97999_cached_sizze_114823,
                              (int64_t) 3612672);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_98051_cached_sizze_114824 < (int64_t) 802816) {
        err = lexical_realloc(ctx, &mem_98051, &mem_98051_cached_sizze_114824,
                              (int64_t) 802816);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_98091_cached_sizze_114825 < (int64_t) 802816) {
        err = lexical_realloc(ctx, &mem_98091, &mem_98091_cached_sizze_114825,
                              (int64_t) 802816);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_98175_cached_sizze_114826 < (int64_t) 802816) {
        err = lexical_realloc(ctx, &mem_98175, &mem_98175_cached_sizze_114826,
                              (int64_t) 802816);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_98205_cached_sizze_114827 < (int64_t) 256) {
        err = lexical_realloc(ctx, &mem_98205, &mem_98205_cached_sizze_114827,
                              (int64_t) 256);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_98207_cached_sizze_114828 < (int64_t) 256) {
        err = lexical_realloc(ctx, &mem_98207, &mem_98207_cached_sizze_114828,
                              (int64_t) 256);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_98229_cached_sizze_114829 < (int64_t) 921600) {
        err = lexical_realloc(ctx, &mem_98229, &mem_98229_cached_sizze_114829,
                              (int64_t) 921600);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_98231_cached_sizze_114830 < (int64_t) 802816) {
        err = lexical_realloc(ctx, &mem_98231, &mem_98231_cached_sizze_114830,
                              (int64_t) 802816);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_98233_cached_sizze_114831 < (int64_t) 1024) {
        err = lexical_realloc(ctx, &mem_98233, &mem_98233_cached_sizze_114831,
                              (int64_t) 1024);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_98235_cached_sizze_114832 < (int64_t) 802816) {
        err = lexical_realloc(ctx, &mem_98235, &mem_98235_cached_sizze_114832,
                              (int64_t) 802816);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_98493_cached_sizze_114833 < (int64_t) 7225344) {
        err = lexical_realloc(ctx, &mem_98493, &mem_98493_cached_sizze_114833,
                              (int64_t) 7225344);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_98545_cached_sizze_114834 < (int64_t) 802816) {
        err = lexical_realloc(ctx, &mem_98545, &mem_98545_cached_sizze_114834,
                              (int64_t) 802816);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_98585_cached_sizze_114835 < (int64_t) 802816) {
        err = lexical_realloc(ctx, &mem_98585, &mem_98585_cached_sizze_114835,
                              (int64_t) 802816);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_98669_cached_sizze_114836 < (int64_t) 802816) {
        err = lexical_realloc(ctx, &mem_98669, &mem_98669_cached_sizze_114836,
                              (int64_t) 802816);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_98699_cached_sizze_114837 < (int64_t) 256) {
        err = lexical_realloc(ctx, &mem_98699, &mem_98699_cached_sizze_114837,
                              (int64_t) 256);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_98701_cached_sizze_114838 < (int64_t) 256) {
        err = lexical_realloc(ctx, &mem_98701, &mem_98701_cached_sizze_114838,
                              (int64_t) 256);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_98723_cached_sizze_114839 < (int64_t) 921600) {
        err = lexical_realloc(ctx, &mem_98723, &mem_98723_cached_sizze_114839,
                              (int64_t) 921600);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_98725_cached_sizze_114840 < (int64_t) 802816) {
        err = lexical_realloc(ctx, &mem_98725, &mem_98725_cached_sizze_114840,
                              (int64_t) 802816);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_98891_cached_sizze_114841 < (int64_t) 7225344) {
        err = lexical_realloc(ctx, &mem_98891, &mem_98891_cached_sizze_114841,
                              (int64_t) 7225344);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_98943_cached_sizze_114842 < (int64_t) 1605632) {
        err = lexical_realloc(ctx, &mem_98943, &mem_98943_cached_sizze_114842,
                              (int64_t) 1605632);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_98983_cached_sizze_114843 < (int64_t) 1605632) {
        err = lexical_realloc(ctx, &mem_98983, &mem_98983_cached_sizze_114843,
                              (int64_t) 1605632);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_99067_cached_sizze_114844 < (int64_t) 1605632) {
        err = lexical_realloc(ctx, &mem_99067, &mem_99067_cached_sizze_114844,
                              (int64_t) 1605632);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_99097_cached_sizze_114845 < (int64_t) 256) {
        err = lexical_realloc(ctx, &mem_99097, &mem_99097_cached_sizze_114845,
                              (int64_t) 256);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_99099_cached_sizze_114846 < (int64_t) 256) {
        err = lexical_realloc(ctx, &mem_99099, &mem_99099_cached_sizze_114846,
                              (int64_t) 256);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_99121_cached_sizze_114847 < (int64_t) 1843200) {
        err = lexical_realloc(ctx, &mem_99121, &mem_99121_cached_sizze_114847,
                              (int64_t) 1843200);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_99123_cached_sizze_114848 < (int64_t) 1605632) {
        err = lexical_realloc(ctx, &mem_99123, &mem_99123_cached_sizze_114848,
                              (int64_t) 1605632);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_99125_cached_sizze_114849 < (int64_t) 2048) {
        err = lexical_realloc(ctx, &mem_99125, &mem_99125_cached_sizze_114849,
                              (int64_t) 2048);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_99127_cached_sizze_114850 < (int64_t) 1605632) {
        err = lexical_realloc(ctx, &mem_99127, &mem_99127_cached_sizze_114850,
                              (int64_t) 1605632);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_99385_cached_sizze_114851 < (int64_t) 14450688) {
        err = lexical_realloc(ctx, &mem_99385, &mem_99385_cached_sizze_114851,
                              (int64_t) 14450688);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_99437_cached_sizze_114852 < (int64_t) 1605632) {
        err = lexical_realloc(ctx, &mem_99437, &mem_99437_cached_sizze_114852,
                              (int64_t) 1605632);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_99477_cached_sizze_114853 < (int64_t) 1605632) {
        err = lexical_realloc(ctx, &mem_99477, &mem_99477_cached_sizze_114853,
                              (int64_t) 1605632);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_99561_cached_sizze_114854 < (int64_t) 1605632) {
        err = lexical_realloc(ctx, &mem_99561, &mem_99561_cached_sizze_114854,
                              (int64_t) 1605632);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_99591_cached_sizze_114855 < (int64_t) 256) {
        err = lexical_realloc(ctx, &mem_99591, &mem_99591_cached_sizze_114855,
                              (int64_t) 256);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_99593_cached_sizze_114856 < (int64_t) 256) {
        err = lexical_realloc(ctx, &mem_99593, &mem_99593_cached_sizze_114856,
                              (int64_t) 256);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_99615_cached_sizze_114857 < (int64_t) 1605632) {
        err = lexical_realloc(ctx, &mem_99615, &mem_99615_cached_sizze_114857,
                              (int64_t) 1605632);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_99699_cached_sizze_114858 < (int64_t) 3686400) {
        err = lexical_realloc(ctx, &mem_99699, &mem_99699_cached_sizze_114858,
                              (int64_t) 3686400);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_99783_cached_sizze_114859 < (int64_t) 28901376) {
        err = lexical_realloc(ctx, &mem_99783, &mem_99783_cached_sizze_114859,
                              (int64_t) 28901376);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_99835_cached_sizze_114860 < (int64_t) 802816) {
        err = lexical_realloc(ctx, &mem_99835, &mem_99835_cached_sizze_114860,
                              (int64_t) 802816);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_99875_cached_sizze_114861 < (int64_t) 802816) {
        err = lexical_realloc(ctx, &mem_99875, &mem_99875_cached_sizze_114861,
                              (int64_t) 802816);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_99959_cached_sizze_114862 < (int64_t) 802816) {
        err = lexical_realloc(ctx, &mem_99959, &mem_99959_cached_sizze_114862,
                              (int64_t) 802816);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_99989_cached_sizze_114863 < (int64_t) 256) {
        err = lexical_realloc(ctx, &mem_99989, &mem_99989_cached_sizze_114863,
                              (int64_t) 256);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_99991_cached_sizze_114864 < (int64_t) 256) {
        err = lexical_realloc(ctx, &mem_99991, &mem_99991_cached_sizze_114864,
                              (int64_t) 256);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_100013_cached_sizze_114865 < (int64_t) 921600) {
        err = lexical_realloc(ctx, &mem_100013, &mem_100013_cached_sizze_114865,
                              (int64_t) 921600);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_100015_cached_sizze_114866 < (int64_t) 802816) {
        err = lexical_realloc(ctx, &mem_100015, &mem_100015_cached_sizze_114866,
                              (int64_t) 802816);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_100017_cached_sizze_114867 < (int64_t) 1024) {
        err = lexical_realloc(ctx, &mem_100017, &mem_100017_cached_sizze_114867,
                              (int64_t) 1024);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_100019_cached_sizze_114868 < (int64_t) 802816) {
        err = lexical_realloc(ctx, &mem_100019, &mem_100019_cached_sizze_114868,
                              (int64_t) 802816);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_100277_cached_sizze_114869 < (int64_t) 7225344) {
        err = lexical_realloc(ctx, &mem_100277, &mem_100277_cached_sizze_114869,
                              (int64_t) 7225344);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_100329_cached_sizze_114870 < (int64_t) 802816) {
        err = lexical_realloc(ctx, &mem_100329, &mem_100329_cached_sizze_114870,
                              (int64_t) 802816);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_100369_cached_sizze_114871 < (int64_t) 802816) {
        err = lexical_realloc(ctx, &mem_100369, &mem_100369_cached_sizze_114871,
                              (int64_t) 802816);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_100453_cached_sizze_114872 < (int64_t) 802816) {
        err = lexical_realloc(ctx, &mem_100453, &mem_100453_cached_sizze_114872,
                              (int64_t) 802816);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_100483_cached_sizze_114873 < (int64_t) 256) {
        err = lexical_realloc(ctx, &mem_100483, &mem_100483_cached_sizze_114873,
                              (int64_t) 256);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_100485_cached_sizze_114874 < (int64_t) 256) {
        err = lexical_realloc(ctx, &mem_100485, &mem_100485_cached_sizze_114874,
                              (int64_t) 256);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_100507_cached_sizze_114875 < (int64_t) 802816) {
        err = lexical_realloc(ctx, &mem_100507, &mem_100507_cached_sizze_114875,
                              (int64_t) 802816);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_100591_cached_sizze_114876 < (int64_t) 1843200) {
        err = lexical_realloc(ctx, &mem_100591, &mem_100591_cached_sizze_114876,
                              (int64_t) 1843200);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_100675_cached_sizze_114877 < (int64_t) 14450688) {
        err = lexical_realloc(ctx, &mem_100675, &mem_100675_cached_sizze_114877,
                              (int64_t) 14450688);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_100727_cached_sizze_114878 < (int64_t) 401408) {
        err = lexical_realloc(ctx, &mem_100727, &mem_100727_cached_sizze_114878,
                              (int64_t) 401408);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_100767_cached_sizze_114879 < (int64_t) 401408) {
        err = lexical_realloc(ctx, &mem_100767, &mem_100767_cached_sizze_114879,
                              (int64_t) 401408);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_100851_cached_sizze_114880 < (int64_t) 401408) {
        err = lexical_realloc(ctx, &mem_100851, &mem_100851_cached_sizze_114880,
                              (int64_t) 401408);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_100881_cached_sizze_114881 < (int64_t) 256) {
        err = lexical_realloc(ctx, &mem_100881, &mem_100881_cached_sizze_114881,
                              (int64_t) 256);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_100883_cached_sizze_114882 < (int64_t) 256) {
        err = lexical_realloc(ctx, &mem_100883, &mem_100883_cached_sizze_114882,
                              (int64_t) 256);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_100905_cached_sizze_114883 < (int64_t) 460800) {
        err = lexical_realloc(ctx, &mem_100905, &mem_100905_cached_sizze_114883,
                              (int64_t) 460800);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_100907_cached_sizze_114884 < (int64_t) 401408) {
        err = lexical_realloc(ctx, &mem_100907, &mem_100907_cached_sizze_114884,
                              (int64_t) 401408);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_100909_cached_sizze_114885 < (int64_t) 512) {
        err = lexical_realloc(ctx, &mem_100909, &mem_100909_cached_sizze_114885,
                              (int64_t) 512);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_100911_cached_sizze_114886 < (int64_t) 401408) {
        err = lexical_realloc(ctx, &mem_100911, &mem_100911_cached_sizze_114886,
                              (int64_t) 401408);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_101169_cached_sizze_114887 < (int64_t) 3612672) {
        err = lexical_realloc(ctx, &mem_101169, &mem_101169_cached_sizze_114887,
                              (int64_t) 3612672);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_101221_cached_sizze_114888 < (int64_t) 401408) {
        err = lexical_realloc(ctx, &mem_101221, &mem_101221_cached_sizze_114888,
                              (int64_t) 401408);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_101261_cached_sizze_114889 < (int64_t) 401408) {
        err = lexical_realloc(ctx, &mem_101261, &mem_101261_cached_sizze_114889,
                              (int64_t) 401408);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_101345_cached_sizze_114890 < (int64_t) 401408) {
        err = lexical_realloc(ctx, &mem_101345, &mem_101345_cached_sizze_114890,
                              (int64_t) 401408);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_101375_cached_sizze_114891 < (int64_t) 256) {
        err = lexical_realloc(ctx, &mem_101375, &mem_101375_cached_sizze_114891,
                              (int64_t) 256);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_101377_cached_sizze_114892 < (int64_t) 256) {
        err = lexical_realloc(ctx, &mem_101377, &mem_101377_cached_sizze_114892,
                              (int64_t) 256);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_101399_cached_sizze_114893 < (int64_t) 401408) {
        err = lexical_realloc(ctx, &mem_101399, &mem_101399_cached_sizze_114893,
                              (int64_t) 401408);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_101483_cached_sizze_114894 < (int64_t) 401408) {
        err = lexical_realloc(ctx, &mem_101483, &mem_101483_cached_sizze_114894,
                              (int64_t) 401408);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_101535_cached_sizze_114895 < (int64_t) 6272) {
        err = lexical_realloc(ctx, &mem_101535, &mem_101535_cached_sizze_114895,
                              (int64_t) 6272);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_101549_cached_sizze_114896 < bytes_97632) {
        err = lexical_realloc(ctx, &mem_101549, &mem_101549_cached_sizze_114896,
                              bytes_97632);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t binop_y_101558 = (int64_t) 8 * n_49206;
    int64_t bytes_101559 = smax64((int64_t) 0, binop_y_101558);
    
    if (mem_101560_cached_sizze_114897 < bytes_101559) {
        err = lexical_realloc(ctx, &mem_101560, &mem_101560_cached_sizze_114897,
                              bytes_101559);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_101582_cached_sizze_114898 < bytes_97632) {
        err = lexical_realloc(ctx, &mem_101582, &mem_101582_cached_sizze_114898,
                              bytes_97632);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t binop_y_101585 = (int64_t) 6272 * x_59704;
    int64_t bytes_101586 = smax64((int64_t) 0, binop_y_101585);
    
    if (mem_101587_cached_sizze_114899 < bytes_101586) {
        err = lexical_realloc(ctx, &mem_101587, &mem_101587_cached_sizze_114899,
                              bytes_101586);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_101616_cached_sizze_114900 < (int64_t) 6272) {
        err = lexical_realloc(ctx, &mem_101616, &mem_101616_cached_sizze_114900,
                              (int64_t) 6272);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_101650_cached_sizze_114901 < bytes_97632) {
        err = lexical_realloc(ctx, &mem_101650, &mem_101650_cached_sizze_114901,
                              bytes_97632);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t binop_y_101705 = (int64_t) 512 * i64_arg_54203;
    int64_t bytes_101706 = smax64((int64_t) 0, binop_y_101705);
    
    if (mem_101707_cached_sizze_114902 < bytes_101706) {
        err = lexical_realloc(ctx, &mem_101707, &mem_101707_cached_sizze_114902,
                              bytes_101706);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_101750_cached_sizze_114903 < (int64_t) 401408) {
        err = lexical_realloc(ctx, &mem_101750, &mem_101750_cached_sizze_114903,
                              (int64_t) 401408);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_101752_cached_sizze_114904 < (int64_t) 401408) {
        err = lexical_realloc(ctx, &mem_101752, &mem_101752_cached_sizze_114904,
                              (int64_t) 401408);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_101810_cached_sizze_114905 < (int64_t) 256) {
        err = lexical_realloc(ctx, &mem_101810, &mem_101810_cached_sizze_114905,
                              (int64_t) 256);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_101812_cached_sizze_114906 < (int64_t) 256) {
        err = lexical_realloc(ctx, &mem_101812, &mem_101812_cached_sizze_114906,
                              (int64_t) 256);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_101834_cached_sizze_114907 < (int64_t) 401408) {
        err = lexical_realloc(ctx, &mem_101834, &mem_101834_cached_sizze_114907,
                              (int64_t) 401408);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_101978_cached_sizze_114908 < (int64_t) 460800) {
        err = lexical_realloc(ctx, &mem_101978, &mem_101978_cached_sizze_114908,
                              (int64_t) 460800);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_101980_cached_sizze_114909 < (int64_t) 401408) {
        err = lexical_realloc(ctx, &mem_101980, &mem_101980_cached_sizze_114909,
                              (int64_t) 401408);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_102146_cached_sizze_114910 < (int64_t) 3612672) {
        err = lexical_realloc(ctx, &mem_102146, &mem_102146_cached_sizze_114910,
                              (int64_t) 3612672);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_102198_cached_sizze_114911 < (int64_t) 401408) {
        err = lexical_realloc(ctx, &mem_102198, &mem_102198_cached_sizze_114911,
                              (int64_t) 401408);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_102238_cached_sizze_114912 < (int64_t) 401408) {
        err = lexical_realloc(ctx, &mem_102238, &mem_102238_cached_sizze_114912,
                              (int64_t) 401408);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_102240_cached_sizze_114913 < (int64_t) 401408) {
        err = lexical_realloc(ctx, &mem_102240, &mem_102240_cached_sizze_114913,
                              (int64_t) 401408);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_102298_cached_sizze_114914 < (int64_t) 256) {
        err = lexical_realloc(ctx, &mem_102298, &mem_102298_cached_sizze_114914,
                              (int64_t) 256);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_102300_cached_sizze_114915 < (int64_t) 256) {
        err = lexical_realloc(ctx, &mem_102300, &mem_102300_cached_sizze_114915,
                              (int64_t) 256);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_102322_cached_sizze_114916 < (int64_t) 401408) {
        err = lexical_realloc(ctx, &mem_102322, &mem_102322_cached_sizze_114916,
                              (int64_t) 401408);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_102466_cached_sizze_114917 < (int64_t) 460800) {
        err = lexical_realloc(ctx, &mem_102466, &mem_102466_cached_sizze_114917,
                              (int64_t) 460800);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_102468_cached_sizze_114918 < (int64_t) 401408) {
        err = lexical_realloc(ctx, &mem_102468, &mem_102468_cached_sizze_114918,
                              (int64_t) 401408);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_102634_cached_sizze_114919 < (int64_t) 3612672) {
        err = lexical_realloc(ctx, &mem_102634, &mem_102634_cached_sizze_114919,
                              (int64_t) 3612672);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_102686_cached_sizze_114920 < (int64_t) 1605632) {
        err = lexical_realloc(ctx, &mem_102686, &mem_102686_cached_sizze_114920,
                              (int64_t) 1605632);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_102726_cached_sizze_114921 < (int64_t) 802816) {
        err = lexical_realloc(ctx, &mem_102726, &mem_102726_cached_sizze_114921,
                              (int64_t) 802816);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_102728_cached_sizze_114922 < (int64_t) 802816) {
        err = lexical_realloc(ctx, &mem_102728, &mem_102728_cached_sizze_114922,
                              (int64_t) 802816);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_102786_cached_sizze_114923 < (int64_t) 256) {
        err = lexical_realloc(ctx, &mem_102786, &mem_102786_cached_sizze_114923,
                              (int64_t) 256);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_102788_cached_sizze_114924 < (int64_t) 256) {
        err = lexical_realloc(ctx, &mem_102788, &mem_102788_cached_sizze_114924,
                              (int64_t) 256);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_102810_cached_sizze_114925 < (int64_t) 802816) {
        err = lexical_realloc(ctx, &mem_102810, &mem_102810_cached_sizze_114925,
                              (int64_t) 802816);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_102954_cached_sizze_114926 < (int64_t) 921600) {
        err = lexical_realloc(ctx, &mem_102954, &mem_102954_cached_sizze_114926,
                              (int64_t) 921600);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_102956_cached_sizze_114927 < (int64_t) 802816) {
        err = lexical_realloc(ctx, &mem_102956, &mem_102956_cached_sizze_114927,
                              (int64_t) 802816);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_103122_cached_sizze_114928 < (int64_t) 7225344) {
        err = lexical_realloc(ctx, &mem_103122, &mem_103122_cached_sizze_114928,
                              (int64_t) 7225344);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_103174_cached_sizze_114929 < (int64_t) 802816) {
        err = lexical_realloc(ctx, &mem_103174, &mem_103174_cached_sizze_114929,
                              (int64_t) 802816);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_103214_cached_sizze_114930 < (int64_t) 802816) {
        err = lexical_realloc(ctx, &mem_103214, &mem_103214_cached_sizze_114930,
                              (int64_t) 802816);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_103216_cached_sizze_114931 < (int64_t) 802816) {
        err = lexical_realloc(ctx, &mem_103216, &mem_103216_cached_sizze_114931,
                              (int64_t) 802816);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_103274_cached_sizze_114932 < (int64_t) 256) {
        err = lexical_realloc(ctx, &mem_103274, &mem_103274_cached_sizze_114932,
                              (int64_t) 256);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_103276_cached_sizze_114933 < (int64_t) 256) {
        err = lexical_realloc(ctx, &mem_103276, &mem_103276_cached_sizze_114933,
                              (int64_t) 256);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_103298_cached_sizze_114934 < (int64_t) 802816) {
        err = lexical_realloc(ctx, &mem_103298, &mem_103298_cached_sizze_114934,
                              (int64_t) 802816);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_103442_cached_sizze_114935 < (int64_t) 921600) {
        err = lexical_realloc(ctx, &mem_103442, &mem_103442_cached_sizze_114935,
                              (int64_t) 921600);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_103444_cached_sizze_114936 < (int64_t) 802816) {
        err = lexical_realloc(ctx, &mem_103444, &mem_103444_cached_sizze_114936,
                              (int64_t) 802816);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_103610_cached_sizze_114937 < (int64_t) 7225344) {
        err = lexical_realloc(ctx, &mem_103610, &mem_103610_cached_sizze_114937,
                              (int64_t) 7225344);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_103662_cached_sizze_114938 < (int64_t) 3211264) {
        err = lexical_realloc(ctx, &mem_103662, &mem_103662_cached_sizze_114938,
                              (int64_t) 3211264);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_103702_cached_sizze_114939 < (int64_t) 1605632) {
        err = lexical_realloc(ctx, &mem_103702, &mem_103702_cached_sizze_114939,
                              (int64_t) 1605632);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_103786_cached_sizze_114940 < (int64_t) 1605632) {
        err = lexical_realloc(ctx, &mem_103786, &mem_103786_cached_sizze_114940,
                              (int64_t) 1605632);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_103788_cached_sizze_114941 < (int64_t) 1605632) {
        err = lexical_realloc(ctx, &mem_103788, &mem_103788_cached_sizze_114941,
                              (int64_t) 1605632);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_103846_cached_sizze_114942 < (int64_t) 256) {
        err = lexical_realloc(ctx, &mem_103846, &mem_103846_cached_sizze_114942,
                              (int64_t) 256);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_103848_cached_sizze_114943 < (int64_t) 256) {
        err = lexical_realloc(ctx, &mem_103848, &mem_103848_cached_sizze_114943,
                              (int64_t) 256);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_103870_cached_sizze_114944 < (int64_t) 1605632) {
        err = lexical_realloc(ctx, &mem_103870, &mem_103870_cached_sizze_114944,
                              (int64_t) 1605632);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_104014_cached_sizze_114945 < (int64_t) 1843200) {
        err = lexical_realloc(ctx, &mem_104014, &mem_104014_cached_sizze_114945,
                              (int64_t) 1843200);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_104016_cached_sizze_114946 < (int64_t) 1605632) {
        err = lexical_realloc(ctx, &mem_104016, &mem_104016_cached_sizze_114946,
                              (int64_t) 1605632);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_104182_cached_sizze_114947 < (int64_t) 14450688) {
        err = lexical_realloc(ctx, &mem_104182, &mem_104182_cached_sizze_114947,
                              (int64_t) 14450688);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_104234_cached_sizze_114948 < (int64_t) 1605632) {
        err = lexical_realloc(ctx, &mem_104234, &mem_104234_cached_sizze_114948,
                              (int64_t) 1605632);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_104274_cached_sizze_114949 < (int64_t) 1605632) {
        err = lexical_realloc(ctx, &mem_104274, &mem_104274_cached_sizze_114949,
                              (int64_t) 1605632);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_104276_cached_sizze_114950 < (int64_t) 1605632) {
        err = lexical_realloc(ctx, &mem_104276, &mem_104276_cached_sizze_114950,
                              (int64_t) 1605632);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_104334_cached_sizze_114951 < (int64_t) 256) {
        err = lexical_realloc(ctx, &mem_104334, &mem_104334_cached_sizze_114951,
                              (int64_t) 256);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_104336_cached_sizze_114952 < (int64_t) 256) {
        err = lexical_realloc(ctx, &mem_104336, &mem_104336_cached_sizze_114952,
                              (int64_t) 256);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_104358_cached_sizze_114953 < (int64_t) 1605632) {
        err = lexical_realloc(ctx, &mem_104358, &mem_104358_cached_sizze_114953,
                              (int64_t) 1605632);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_104502_cached_sizze_114954 < (int64_t) 1843200) {
        err = lexical_realloc(ctx, &mem_104502, &mem_104502_cached_sizze_114954,
                              (int64_t) 1843200);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_104504_cached_sizze_114955 < (int64_t) 1605632) {
        err = lexical_realloc(ctx, &mem_104504, &mem_104504_cached_sizze_114955,
                              (int64_t) 1605632);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_104670_cached_sizze_114956 < (int64_t) 14450688) {
        err = lexical_realloc(ctx, &mem_104670, &mem_104670_cached_sizze_114956,
                              (int64_t) 14450688);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_104722_cached_sizze_114957 < (int64_t) 802816) {
        err = lexical_realloc(ctx, &mem_104722, &mem_104722_cached_sizze_114957,
                              (int64_t) 802816);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_104762_cached_sizze_114958 < (int64_t) 802816) {
        err = lexical_realloc(ctx, &mem_104762, &mem_104762_cached_sizze_114958,
                              (int64_t) 802816);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_104846_cached_sizze_114959 < (int64_t) 802816) {
        err = lexical_realloc(ctx, &mem_104846, &mem_104846_cached_sizze_114959,
                              (int64_t) 802816);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_104848_cached_sizze_114960 < (int64_t) 802816) {
        err = lexical_realloc(ctx, &mem_104848, &mem_104848_cached_sizze_114960,
                              (int64_t) 802816);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_104906_cached_sizze_114961 < (int64_t) 256) {
        err = lexical_realloc(ctx, &mem_104906, &mem_104906_cached_sizze_114961,
                              (int64_t) 256);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_104908_cached_sizze_114962 < (int64_t) 256) {
        err = lexical_realloc(ctx, &mem_104908, &mem_104908_cached_sizze_114962,
                              (int64_t) 256);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_104930_cached_sizze_114963 < (int64_t) 802816) {
        err = lexical_realloc(ctx, &mem_104930, &mem_104930_cached_sizze_114963,
                              (int64_t) 802816);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_105074_cached_sizze_114964 < (int64_t) 921600) {
        err = lexical_realloc(ctx, &mem_105074, &mem_105074_cached_sizze_114964,
                              (int64_t) 921600);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_105076_cached_sizze_114965 < (int64_t) 802816) {
        err = lexical_realloc(ctx, &mem_105076, &mem_105076_cached_sizze_114965,
                              (int64_t) 802816);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_105242_cached_sizze_114966 < (int64_t) 7225344) {
        err = lexical_realloc(ctx, &mem_105242, &mem_105242_cached_sizze_114966,
                              (int64_t) 7225344);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_105294_cached_sizze_114967 < (int64_t) 802816) {
        err = lexical_realloc(ctx, &mem_105294, &mem_105294_cached_sizze_114967,
                              (int64_t) 802816);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_105334_cached_sizze_114968 < (int64_t) 802816) {
        err = lexical_realloc(ctx, &mem_105334, &mem_105334_cached_sizze_114968,
                              (int64_t) 802816);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_105336_cached_sizze_114969 < (int64_t) 802816) {
        err = lexical_realloc(ctx, &mem_105336, &mem_105336_cached_sizze_114969,
                              (int64_t) 802816);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_105394_cached_sizze_114970 < (int64_t) 256) {
        err = lexical_realloc(ctx, &mem_105394, &mem_105394_cached_sizze_114970,
                              (int64_t) 256);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_105396_cached_sizze_114971 < (int64_t) 256) {
        err = lexical_realloc(ctx, &mem_105396, &mem_105396_cached_sizze_114971,
                              (int64_t) 256);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_105418_cached_sizze_114972 < (int64_t) 802816) {
        err = lexical_realloc(ctx, &mem_105418, &mem_105418_cached_sizze_114972,
                              (int64_t) 802816);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_105562_cached_sizze_114973 < (int64_t) 921600) {
        err = lexical_realloc(ctx, &mem_105562, &mem_105562_cached_sizze_114973,
                              (int64_t) 921600);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_105564_cached_sizze_114974 < (int64_t) 802816) {
        err = lexical_realloc(ctx, &mem_105564, &mem_105564_cached_sizze_114974,
                              (int64_t) 802816);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_105730_cached_sizze_114975 < (int64_t) 7225344) {
        err = lexical_realloc(ctx, &mem_105730, &mem_105730_cached_sizze_114975,
                              (int64_t) 7225344);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_105788_cached_sizze_114976 < (int64_t) 401408) {
        err = lexical_realloc(ctx, &mem_105788, &mem_105788_cached_sizze_114976,
                              (int64_t) 401408);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_105813_cached_sizze_114977 < (int64_t) 6272) {
        err = lexical_realloc(ctx, &mem_105813, &mem_105813_cached_sizze_114977,
                              (int64_t) 6272);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_105848_cached_sizze_114978 < (int64_t) 4608) {
        err = lexical_realloc(ctx, &mem_105848, &mem_105848_cached_sizze_114978,
                              (int64_t) 4608);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_105862_cached_sizze_114979 < (int64_t) 512) {
        err = lexical_realloc(ctx, &mem_105862, &mem_105862_cached_sizze_114979,
                              (int64_t) 512);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t binop_x_105973 = i64_arg_54203 * x_58750;
    int64_t binop_y_105974 = (int64_t) 8 * binop_x_105973;
    int64_t bytes_105975 = smax64((int64_t) 0, binop_y_105974);
    
    if (mem_105976_cached_sizze_114980 < bytes_105975) {
        err = lexical_realloc(ctx, &mem_105976, &mem_105976_cached_sizze_114980,
                              bytes_105975);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t binop_y_106004 = (int64_t) 8 * k_total_58756;
    int64_t bytes_106005 = smax64((int64_t) 0, binop_y_106004);
    
    if (mem_106006_cached_sizze_114981 < bytes_106005) {
        err = lexical_realloc(ctx, &mem_106006, &mem_106006_cached_sizze_114981,
                              bytes_106005);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t binop_y_106037 = (int64_t) 8 * x_58750;
    int64_t bytes_106038 = smax64((int64_t) 0, binop_y_106037);
    
    if (mem_106039_cached_sizze_114982 < bytes_106038) {
        err = lexical_realloc(ctx, &mem_106039, &mem_106039_cached_sizze_114982,
                              bytes_106038);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_106053_cached_sizze_114983 < bytes_106038) {
        err = lexical_realloc(ctx, &mem_106053, &mem_106053_cached_sizze_114983,
                              bytes_106038);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_106103_cached_sizze_114984 < (int64_t) 7200) {
        err = lexical_realloc(ctx, &mem_106103, &mem_106103_cached_sizze_114984,
                              (int64_t) 7200);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_106485_cached_sizze_114985 < (int64_t) 7200) {
        err = lexical_realloc(ctx, &mem_106485, &mem_106485_cached_sizze_114985,
                              (int64_t) 7200);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t binop_y_106818 = (int64_t) 8 * x_59704;
    int64_t bytes_106819 = smax64((int64_t) 0, binop_y_106818);
    
    if (mem_106820_cached_sizze_114986 < bytes_106819) {
        err = lexical_realloc(ctx, &mem_106820, &mem_106820_cached_sizze_114986,
                              bytes_106819);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_106832_cached_sizze_114987 < (int64_t) 72) {
        err = lexical_realloc(ctx, &mem_106832, &mem_106832_cached_sizze_114987,
                              (int64_t) 72);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_107459_cached_sizze_114988 < (int64_t) 7200) {
        err = lexical_realloc(ctx, &mem_107459, &mem_107459_cached_sizze_114988,
                              (int64_t) 7200);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_107461_cached_sizze_114989 < (int64_t) 7200) {
        err = lexical_realloc(ctx, &mem_107461, &mem_107461_cached_sizze_114989,
                              (int64_t) 7200);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_108175_cached_sizze_114990 < (int64_t) 7200) {
        err = lexical_realloc(ctx, &mem_108175, &mem_108175_cached_sizze_114990,
                              (int64_t) 7200);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_108557_cached_sizze_114991 < (int64_t) 7200) {
        err = lexical_realloc(ctx, &mem_108557, &mem_108557_cached_sizze_114991,
                              (int64_t) 7200);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_109431_cached_sizze_114992 < (int64_t) 7200) {
        err = lexical_realloc(ctx, &mem_109431, &mem_109431_cached_sizze_114992,
                              (int64_t) 7200);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_109813_cached_sizze_114993 < (int64_t) 7200) {
        err = lexical_realloc(ctx, &mem_109813, &mem_109813_cached_sizze_114993,
                              (int64_t) 7200);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_110735_cached_sizze_114994 < (int64_t) 72) {
        err = lexical_realloc(ctx, &mem_110735, &mem_110735_cached_sizze_114994,
                              (int64_t) 72);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_110737_cached_sizze_114995 < (int64_t) 72) {
        err = lexical_realloc(ctx, &mem_110737, &mem_110737_cached_sizze_114995,
                              (int64_t) 72);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_110739_cached_sizze_114996 < (int64_t) 72) {
        err = lexical_realloc(ctx, &mem_110739, &mem_110739_cached_sizze_114996,
                              (int64_t) 72);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_110855_cached_sizze_114997 < (int64_t) 72) {
        err = lexical_realloc(ctx, &mem_110855, &mem_110855_cached_sizze_114997,
                              (int64_t) 72);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_110857_cached_sizze_114998 < (int64_t) 72) {
        err = lexical_realloc(ctx, &mem_110857, &mem_110857_cached_sizze_114998,
                              (int64_t) 72);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_110859_cached_sizze_114999 < (int64_t) 72) {
        err = lexical_realloc(ctx, &mem_110859, &mem_110859_cached_sizze_114999,
                              (int64_t) 72);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_110903_cached_sizze_115000 < (int64_t) 512) {
        err = lexical_realloc(ctx, &mem_110903, &mem_110903_cached_sizze_115000,
                              (int64_t) 512);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_110905_cached_sizze_115001 < (int64_t) 512) {
        err = lexical_realloc(ctx, &mem_110905, &mem_110905_cached_sizze_115001,
                              (int64_t) 512);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_110907_cached_sizze_115002 < (int64_t) 512) {
        err = lexical_realloc(ctx, &mem_110907, &mem_110907_cached_sizze_115002,
                              (int64_t) 512);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_110942_cached_sizze_115003 < (int64_t) 8) {
        err = lexical_realloc(ctx, &mem_110942, &mem_110942_cached_sizze_115003,
                              (int64_t) 8);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_110944_cached_sizze_115004 < (int64_t) 8) {
        err = lexical_realloc(ctx, &mem_110944, &mem_110944_cached_sizze_115004,
                              (int64_t) 8);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_110946_cached_sizze_115005 < (int64_t) 8) {
        err = lexical_realloc(ctx, &mem_110946, &mem_110946_cached_sizze_115005,
                              (int64_t) 8);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_111719_cached_sizze_115006 < (int64_t) 8) {
        err = lexical_realloc(ctx, &mem_111719, &mem_111719_cached_sizze_115006,
                              (int64_t) 8);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t ext_111724;
    int64_t ext_111723;
    int64_t train_unet_res_54205;
    int64_t loopz2088U_54292;
    int64_t ctx_param_ext_96902;
    int64_t ctx_param_ext_96903;
    
    if (memblock_set(ctx, &mem_param_96148, &mem_96133, "mem_96133") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96153, &mem_95789, "mem_95789") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96170, &mem_96155, "mem_96155") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96175, &mem_95863, "mem_95863") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96186, &mem_96177, "mem_96177") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96191, &mem_95861, "mem_95861") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96208, &mem_96193, "mem_96193") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96213, &mem_95859, "mem_95859") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96230, &mem_96215, "mem_96215") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96235, &mem_96001, "mem_96001") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96246, &mem_96237, "mem_96237") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96251, &mem_95999, "mem_95999") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96268, &mem_96253, "mem_96253") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96273, &mem_95997, "mem_95997") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96290, &mem_96275, "mem_96275") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96295, &mem_95857, "mem_95857") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96306, &mem_96297, "mem_96297") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96311, &mem_95855, "mem_95855") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96328, &mem_96313, "mem_96313") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96333, &mem_95853, "mem_95853") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96350, &mem_96335, "mem_96335") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96355, &mem_95787, "mem_95787") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96366, &mem_96357, "mem_96357") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96371, &mem_95785, "mem_95785") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96388, &mem_96373, "mem_96373") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96393, &mem_95783, "mem_95783") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96410, &mem_96395, "mem_96395") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96415, &mem_96093, "mem_96093") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96429, &mem_96095, "mem_96095") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96434, &mem_96097, "mem_96097") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96448, &mem_96095, "mem_96095") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96453, &mem_96097, "mem_96097") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96467, &mem_96099, "mem_96099") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96472, &mem_96101, "mem_96101") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96486, &mem_96099, "mem_96099") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96491, &mem_96101, "mem_96101") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96499, &mem_96107, "mem_96107") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96504, &mem_96101, "mem_96101") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96512, &mem_96107, "mem_96107") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96517, &mem_96101, "mem_96101") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96531, &mem_96103, "mem_96103") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96536, &mem_96101, "mem_96101") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96550, &mem_96103, "mem_96103") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96555, &mem_96101, "mem_96101") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96569, &mem_96109, "mem_96109") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96574, &mem_96105, "mem_96105") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96588, &mem_96109, "mem_96109") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96593, &mem_96105, "mem_96105") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96601, &mem_96113, "mem_96113") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96606, &mem_96105, "mem_96105") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96614, &mem_96113, "mem_96113") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96619, &mem_96105, "mem_96105") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96633, &mem_96111, "mem_96111") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96638, &mem_96105, "mem_96105") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96652, &mem_96111, "mem_96111") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96657, &mem_96105, "mem_96105") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96671, &mem_96115, "mem_96115") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96676, &mem_96101, "mem_96101") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96690, &mem_96115, "mem_96115") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96695, &mem_96101, "mem_96101") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96703, &mem_96107, "mem_96107") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96708, &mem_96101, "mem_96101") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96716, &mem_96107, "mem_96107") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96721, &mem_96101, "mem_96101") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96735, &mem_96103, "mem_96103") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96740, &mem_96101, "mem_96101") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96754, &mem_96103, "mem_96103") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96759, &mem_96101, "mem_96101") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96773, &mem_96117, "mem_96117") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96778, &mem_96097, "mem_96097") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96792, &mem_96117, "mem_96117") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96797, &mem_96097, "mem_96097") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96805, &mem_96121, "mem_96121") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96810, &mem_96097, "mem_96097") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96818, &mem_96121, "mem_96121") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96823, &mem_96097, "mem_96097") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96837, &mem_96119, "mem_96119") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96842, &mem_96097, "mem_96097") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96856, &mem_96119, "mem_96119") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96861, &mem_96097, "mem_96097") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96875, &mem_96125, "mem_96125") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96880, &mem_96123, "mem_96123") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96894, &mem_96125, "mem_96125") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96899, &mem_96123, "mem_96123") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_96904, &mem_96131, "mem_96131") != 0)
        return 1;
    ctx_param_ext_96902 = (int64_t) 0;
    ctx_param_ext_96903 = (int64_t) 0;
    loopz2088U_54292 = (int64_t) 0;
    for (int64_t e_54291 = 0; e_54291 < epochs_49210; e_54291++) {
        int64_t x_54378 = mul64(l_49204, e_54291);
        double loopres_54463;
        double cum_loss__54549;
        
        if (memblock_set(ctx, &mem_param_96918, &mem_param_96148,
                         "mem_param_96148") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96923, &mem_param_96153,
                         "mem_param_96153") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96937, &mem_param_96170,
                         "mem_param_96170") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96942, &mem_param_96175,
                         "mem_param_96175") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96950, &mem_param_96186,
                         "mem_param_96186") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96955, &mem_param_96191,
                         "mem_param_96191") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96969, &mem_param_96208,
                         "mem_param_96208") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96974, &mem_param_96213,
                         "mem_param_96213") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96988, &mem_param_96230,
                         "mem_param_96230") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96993, &mem_param_96235,
                         "mem_param_96235") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97001, &mem_param_96246,
                         "mem_param_96246") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97006, &mem_param_96251,
                         "mem_param_96251") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97020, &mem_param_96268,
                         "mem_param_96268") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97025, &mem_param_96273,
                         "mem_param_96273") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97039, &mem_param_96290,
                         "mem_param_96290") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97044, &mem_param_96295,
                         "mem_param_96295") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97052, &mem_param_96306,
                         "mem_param_96306") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97057, &mem_param_96311,
                         "mem_param_96311") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97071, &mem_param_96328,
                         "mem_param_96328") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97076, &mem_param_96333,
                         "mem_param_96333") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97090, &mem_param_96350,
                         "mem_param_96350") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97095, &mem_param_96355,
                         "mem_param_96355") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97103, &mem_param_96366,
                         "mem_param_96366") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97108, &mem_param_96371,
                         "mem_param_96371") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97122, &mem_param_96388,
                         "mem_param_96388") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97127, &mem_param_96393,
                         "mem_param_96393") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97141, &mem_param_96410,
                         "mem_param_96410") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97146, &mem_param_96415,
                         "mem_param_96415") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97160, &mem_param_96429,
                         "mem_param_96429") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97165, &mem_param_96434,
                         "mem_param_96434") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97179, &mem_param_96448,
                         "mem_param_96448") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97184, &mem_param_96453,
                         "mem_param_96453") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97198, &mem_param_96467,
                         "mem_param_96467") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97203, &mem_param_96472,
                         "mem_param_96472") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97217, &mem_param_96486,
                         "mem_param_96486") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97222, &mem_param_96491,
                         "mem_param_96491") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97230, &mem_param_96499,
                         "mem_param_96499") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97235, &mem_param_96504,
                         "mem_param_96504") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97243, &mem_param_96512,
                         "mem_param_96512") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97248, &mem_param_96517,
                         "mem_param_96517") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97262, &mem_param_96531,
                         "mem_param_96531") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97267, &mem_param_96536,
                         "mem_param_96536") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97281, &mem_param_96550,
                         "mem_param_96550") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97286, &mem_param_96555,
                         "mem_param_96555") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97300, &mem_param_96569,
                         "mem_param_96569") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97305, &mem_param_96574,
                         "mem_param_96574") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97319, &mem_param_96588,
                         "mem_param_96588") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97324, &mem_param_96593,
                         "mem_param_96593") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97332, &mem_param_96601,
                         "mem_param_96601") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97337, &mem_param_96606,
                         "mem_param_96606") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97345, &mem_param_96614,
                         "mem_param_96614") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97350, &mem_param_96619,
                         "mem_param_96619") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97364, &mem_param_96633,
                         "mem_param_96633") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97369, &mem_param_96638,
                         "mem_param_96638") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97383, &mem_param_96652,
                         "mem_param_96652") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97388, &mem_param_96657,
                         "mem_param_96657") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97402, &mem_param_96671,
                         "mem_param_96671") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97407, &mem_param_96676,
                         "mem_param_96676") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97421, &mem_param_96690,
                         "mem_param_96690") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97426, &mem_param_96695,
                         "mem_param_96695") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97434, &mem_param_96703,
                         "mem_param_96703") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97439, &mem_param_96708,
                         "mem_param_96708") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97447, &mem_param_96716,
                         "mem_param_96716") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97452, &mem_param_96721,
                         "mem_param_96721") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97466, &mem_param_96735,
                         "mem_param_96735") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97471, &mem_param_96740,
                         "mem_param_96740") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97485, &mem_param_96754,
                         "mem_param_96754") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97490, &mem_param_96759,
                         "mem_param_96759") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97504, &mem_param_96773,
                         "mem_param_96773") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97509, &mem_param_96778,
                         "mem_param_96778") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97523, &mem_param_96792,
                         "mem_param_96792") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97528, &mem_param_96797,
                         "mem_param_96797") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97536, &mem_param_96805,
                         "mem_param_96805") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97541, &mem_param_96810,
                         "mem_param_96810") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97549, &mem_param_96818,
                         "mem_param_96818") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97554, &mem_param_96823,
                         "mem_param_96823") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97568, &mem_param_96837,
                         "mem_param_96837") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97573, &mem_param_96842,
                         "mem_param_96842") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97587, &mem_param_96856,
                         "mem_param_96856") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97592, &mem_param_96861,
                         "mem_param_96861") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97606, &mem_param_96875,
                         "mem_param_96875") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97611, &mem_param_96880,
                         "mem_param_96880") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97625, &mem_param_96894,
                         "mem_param_96894") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_97630, &mem_param_96899,
                         "mem_param_96899") != 0)
            return 1;
        cum_loss__54549 = 0.0;
        for (int64_t i_54464 = 0; i_54464 < l_49204; i_54464++) {
            int32_t mk_rand_int_arg_54550 =
                    ((int32_t *) time_seeds_mem_96128.mem)[e_54291 * l_49204 +
                                                           i_54464];
            int32_t unsign_arg_56688 = 5460 ^ mk_rand_int_arg_54550;
            int32_t unsign_arg_55802 = mul32(48271, unsign_arg_56688);
            int32_t unsign_arg_55804 = umod32(unsign_arg_55802, 2147483647);
            int32_t unsign_arg_55674 = mul32(48271, unsign_arg_55804);
            int32_t unsign_arg_55676 = umod32(unsign_arg_55674, 2147483647);
            bool zgze_res_55632 = ule32(2147483367, unsign_arg_55676);
            bool rand_res_f_res_54557;
            int32_t rand_res_f_res_54558;
            int32_t rand_res_f_res_54559;
            bool loop_while_54560;
            int32_t rng_54561;
            int32_t x_54562;
            
            loop_while_54560 = zgze_res_55632;
            rng_54561 = unsign_arg_55676;
            x_54562 = unsign_arg_55676;
            while (loop_while_54560) {
                int32_t unsign_arg_55678 = mul32(48271, rng_54561);
                int32_t unsign_arg_55680 = umod32(unsign_arg_55678, 2147483647);
                bool zgze_res_55635 = ule32(2147483367, unsign_arg_55680);
                bool loop_while_tmp_113904 = zgze_res_55635;
                int32_t rng_tmp_113905 = unsign_arg_55680;
                int32_t x_tmp_113906 = unsign_arg_55680;
                
                loop_while_54560 = loop_while_tmp_113904;
                rng_54561 = rng_tmp_113905;
                x_54562 = x_tmp_113906;
            }
            rand_res_f_res_54557 = loop_while_54560;
            rand_res_f_res_54558 = rng_54561;
            rand_res_f_res_54559 = x_54562;
            
            int32_t unsign_arg_55638 = umod32(rand_res_f_res_54559, 999);
            int64_t to_i64_res_55682 = zext_i32_i64(unsign_arg_55638);
            int64_t zp_res_54568 = add64((int64_t) 1, to_i64_res_55682);
            int32_t noise_images_arg_54569 =
                    ((int32_t *) noise_seeds_mem_96129.mem)[e_54291 * l_49204 +
                                                            i_54464];
            bool x_54571 = sle64((int64_t) 0, zp_res_54568);
            bool y_54572 = slt64(zp_res_54568, dz2080U_49207);
            bool bounds_check_54573 = x_54571 && y_54572;
            bool index_certs_54574;
            
            if (!bounds_check_54573) {
                set_error(ctx,
                          msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                    "Index [", (long long) zp_res_54568,
                                    "] out of bounds for array of shape [",
                                    (long long) dz2080U_49207, "].",
                                    "-> #0  diffusion.fut:24:33-44\n   #1  test_diffusion.fut:58:34-136\n   #2  test_diffusion.fut:57:1-59:11\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            double sqrt_arg_54575 =
                   ((double *) alpha_bar_mem_96127.mem)[zp_res_54568];
            double sqrt_res_54576 = futrts_sqrt64(sqrt_arg_54575);
            double sqrt_arg_54577 = 1.0 - sqrt_arg_54575;
            double sqrt_res_54578 = futrts_sqrt64(sqrt_arg_54577);
            int32_t unsign_arg_56820 = 5460 ^ noise_images_arg_54569;
            int32_t unsign_arg_56821 = mul32(48271, unsign_arg_56820);
            int32_t unsign_arg_56822 = umod32(unsign_arg_56821, 2147483647);
            int32_t unsign_arg_56824 = mul32(48271, unsign_arg_56822);
            int32_t unsign_arg_56825 = umod32(unsign_arg_56824, 2147483647);
            
            for (int64_t i_84703 = 0; i_84703 < i64_arg_54203; i_84703++) {
                int32_t i64_res_75498 = sext_i64_i32(i_84703);
                int32_t x_75499 = lshr32(i64_res_75498, 16);
                int32_t x_75500 = i64_res_75498 ^ x_75499;
                int32_t x_75501 = mul32(73244475, x_75500);
                int32_t x_75502 = lshr32(x_75501, 16);
                int32_t x_75503 = x_75501 ^ x_75502;
                int32_t x_75504 = mul32(73244475, x_75503);
                int32_t x_75505 = lshr32(x_75504, 16);
                int32_t x_75506 = x_75504 ^ x_75505;
                int32_t unsign_arg_75507 = unsign_arg_56825 ^ x_75506;
                int32_t unsign_arg_75509 = mul32(48271, unsign_arg_75507);
                int32_t unsign_arg_75510 = umod32(unsign_arg_75509, 2147483647);
                int32_t unsign_arg_75511 = mul32(48271, unsign_arg_75510);
                int32_t unsign_arg_75512 = umod32(unsign_arg_75511, 2147483647);
                double u64_res_75513 = uitofp_i32_f64(unsign_arg_75510);
                double zs_res_75514 = u64_res_75513 / 2.147483647e9;
                double u64_res_75515 = uitofp_i32_f64(unsign_arg_75512);
                double zs_res_75516 = u64_res_75515 / 2.147483647e9;
                double log_res_75517 = futrts_log64(zs_res_75514);
                double zt_res_75518 = -2.0 * log_res_75517;
                double sqrt_res_75519 = futrts_sqrt64(zt_res_75518);
                double zt_res_75520 = 6.283185307179586 * zs_res_75516;
                double cos_res_75521 = futrts_cos64(zt_res_75520);
                double zt_res_75522 = sqrt_res_75519 * cos_res_75521;
                
                ((double *) mem_97633)[i_84703] = zt_res_75522;
            }
            for (int64_t i_84711 = 0; i_84711 < m_49205; i_84711++) {
                int64_t binop_x_93000 = n_49206 * i_84711;
                
                for (int64_t i_84707 = 0; i_84707 < n_49206; i_84707++) {
                    double x_54584 = ((double *) images_mem_96126.mem)[i_54464 *
                                                                       (n_49206 *
                                                                        m_49205) +
                                                                       i_84711 *
                                                                       n_49206 +
                                                                       i_84707];
                    int64_t new_index_93001 = i_84707 + binop_x_93000;
                    double x_54585 = ((double *) mem_97633)[new_index_93001];
                    double x_54586 = sqrt_res_54576 * x_54584;
                    double y_54587 = sqrt_res_54578 * x_54585;
                    double defunc_1_f_res_54588 = x_54586 + y_54587;
                    
                    ((double *) mem_97647)[i_84711 * n_49206 + i_84707] =
                        defunc_1_f_res_54588;
                }
            }
            
            double i64_res_54589 = sitofp_i64_f64(zp_res_54568);
            
            for (int32_t i_86760 = 0; i_86760 < 128; i_86760++) {
                int64_t i_84717 = sext_i32_i64(i_86760);
                double i64_res_75489 = sitofp_i32_f64(i_86760);
                double exp_arg_75490 = -7.252236513367073e-2 * i64_res_75489;
                double exp_res_75491 = futrts_exp64(exp_arg_75490);
                double defunc_0_f_res_75492 = i64_res_54589 * exp_res_75491;
                double sin_res_75494 = futrts_sin64(defunc_0_f_res_75492);
                double cos_res_75495 = futrts_cos64(defunc_0_f_res_75492);
                
                ((double *) mem_97690)[i_84717] = sin_res_75494;
                ((double *) mem_97692)[i_84717] = cos_res_75495;
            }
            for (int64_t i_84731 = 0; i_84731 < x_55816; i_84731++) {
                bool cond_76736 = slt64(i_84731, (int64_t) 1);
                bool cond_f_res_76737 = sle64(y_55842, i_84731);
                bool x_76738 = !cond_76736;
                bool y_76739 = cond_f_res_76737 && x_76738;
                bool cond_76740 = cond_76736 || y_76739;
                bool x_76741 = !cond_76740;
                
                for (int64_t i_84724 = 0; i_84724 < x_55820; i_84724++) {
                    bool cond_f_res_78284 = slt64(i_84724, (int64_t) 1);
                    bool y_78285 = x_76741 && cond_f_res_78284;
                    bool cond_78286 = cond_76740 || y_78285;
                    bool cond_f_res_78287 = sle64(y_55843, i_84724);
                    bool x_78288 = !cond_78286;
                    bool y_78289 = cond_f_res_78287 && x_78288;
                    bool cond_78290 = cond_78286 || y_78289;
                    double defunc_0_f_res_78291;
                    
                    if (cond_78290 == 1) {
                        defunc_0_f_res_78291 = 0.0;
                    } else {
                        int64_t i_78292 = sub64(i_84731, (int64_t) 1);
                        bool x_78293 = sle64((int64_t) 0, i_78292);
                        bool y_78294 = slt64(i_78292, m_49205);
                        bool bounds_check_78295 = x_78293 && y_78294;
                        int64_t i_78296 = sub64(i_84724, (int64_t) 1);
                        bool x_78297 = sle64((int64_t) 0, i_78296);
                        bool y_78298 = slt64(i_78296, n_49206);
                        bool bounds_check_78299 = x_78297 && y_78298;
                        bool index_ok_78300 = bounds_check_78295 &&
                             bounds_check_78299;
                        bool index_certs_78301;
                        
                        if (!index_ok_78300) {
                            set_error(ctx,
                                      msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                "Index [", (long long) i_78292,
                                                ", ", (long long) i_78296,
                                                "] out of bounds for array of shape [",
                                                (long long) m_49205, "][",
                                                (long long) n_49206, "].",
                                                "-> #0  ../layers/conv2d.fut:7:91-116\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  ../layers/conv2d.fut:6:22-7:117\n   #7  ../layers/conv2d.fut:6:6-7:123\n   #8  ../layers/conv2d.fut:22:7-30\n   #9  test_diffusion.fut:57:1-59:11\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        double defunc_0_f_res_f_res_78302 =
                               ((double *) mem_97647)[i_78292 * n_49206 +
                                                      i_78296];
                        
                        defunc_0_f_res_78291 = defunc_0_f_res_f_res_78302;
                    }
                    
                    double defunc_0_f_res_78311;
                    
                    if (cond_78290 == 1) {
                        defunc_0_f_res_78311 = 0.0;
                    } else {
                        int64_t i_78312 = sub64(i_84731, (int64_t) 1);
                        bool x_78313 = sle64((int64_t) 0, i_78312);
                        bool y_78314 = slt64(i_78312, m_49205);
                        bool bounds_check_78315 = x_78313 && y_78314;
                        int64_t i_78316 = sub64(i_84724, (int64_t) 1);
                        bool x_78317 = sle64((int64_t) 0, i_78316);
                        bool y_78318 = slt64(i_78316, n_49206);
                        bool bounds_check_78319 = x_78317 && y_78318;
                        bool index_ok_78320 = bounds_check_78315 &&
                             bounds_check_78319;
                        bool index_certs_78321;
                        
                        if (!index_ok_78320) {
                            set_error(ctx,
                                      msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                "Index [", (long long) i_78312,
                                                ", ", (long long) i_78316,
                                                "] out of bounds for array of shape [",
                                                (long long) m_49205, "][",
                                                (long long) n_49206, "].",
                                                "-> #0  ../layers/conv2d.fut:7:91-116\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  ../layers/conv2d.fut:6:22-7:117\n   #7  ../layers/conv2d.fut:6:6-7:123\n   #8  /prelude/soacs.fut:59:3-10\n   #9  /prelude/array.fut:208:3-34\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        double defunc_0_f_res_f_res_78322 =
                               ((double *) mem_97647)[i_78312 * n_49206 +
                                                      i_78316];
                        
                        defunc_0_f_res_78311 = defunc_0_f_res_f_res_78322;
                    }
                    ((double *) mem_97716)[i_84731 * x_55820 + i_84724] =
                        defunc_0_f_res_78311;
                    ((double *) mem_97720)[i_84731 * x_55820 + i_84724] =
                        defunc_0_f_res_78291;
                }
            }
            for (int64_t i_113916 = 0; i_113916 < (int64_t) 1; i_113916++) {
                if (x_55816 * x_55820 * (int64_t) 8 > 0)
                    memmove(mem_97806 + i_113916 * (x_55820 * x_55816) *
                            (int64_t) 8, mem_97720 + (int64_t) 0, x_55816 *
                            x_55820 * (int64_t) 8);
            }
            for (int64_t i_84740 = 0; i_84740 < new_n_55818; i_84740++) {
                int64_t j_55888 = add64((int64_t) 3, i_84740);
                int64_t i_p_m_t_s_55889 = add64((int64_t) 2, i_84740);
                bool zzero_leq_i_p_m_t_s_55890 = sle64((int64_t) 0,
                                                       i_p_m_t_s_55889);
                bool i_p_m_t_s_leq_w_55891 = slt64(i_p_m_t_s_55889, x_55816);
                bool i_lte_j_55893 = sle64(i_84740, j_55888);
                bool y_55895 = zzero_leq_i_p_m_t_s_55890 &&
                     i_p_m_t_s_leq_w_55891;
                bool y_55896 = i_lte_j_55893 && y_55895;
                
                for (int64_t i_84736 = 0; i_84736 < new_m_55822; i_84736++) {
                    int64_t j_55901 = add64((int64_t) 3, i_84736);
                    int64_t i_p_m_t_s_55902 = add64((int64_t) 2, i_84736);
                    bool zzero_leq_i_p_m_t_s_55903 = sle64((int64_t) 0,
                                                           i_p_m_t_s_55902);
                    bool i_p_m_t_s_leq_w_55904 = slt64(i_p_m_t_s_55902,
                                                       x_55820);
                    bool i_lte_j_55906 = sle64(i_84736, j_55901);
                    bool y_55908 = zzero_leq_i_p_m_t_s_55903 &&
                         i_p_m_t_s_leq_w_55904;
                    bool y_55909 = i_lte_j_55906 && y_55908;
                    bool index_ok_55912 = y_55896 && y_55909;
                    bool index_certs_55913;
                    
                    if (!index_ok_55912) {
                        set_error(ctx,
                                  msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                            "Index [", (long long) i_84740, ":",
                                            (long long) j_55888, ", ",
                                            (long long) i_84736, ":",
                                            (long long) j_55901,
                                            "] out of bounds for array of shape [",
                                            (long long) x_55816, "][",
                                            (long long) x_55820, "].",
                                            "-> #0  ../layers/conv2d.fut:13:90-124\n   #1  ../layers/conv2d.fut:13:69-146\n   #2  /prelude/soacs.fut:59:3-10\n   #3  /prelude/array.fut:200:3-17\n   #4  /prelude/functional.fut:39:59-65\n   #5  /prelude/soacs.fut:59:3-10\n   #6  /prelude/array.fut:208:3-34\n   #7  ../layers/conv2d.fut:13:26-162\n   #8  ../layers/conv2d.fut:26:17-54\n   #9  test_diffusion.fut:57:1-59:11\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    for (int64_t i_113919 = 0; i_113919 < (int64_t) 9;
                         i_113919++) {
                        double tmp_113920 = ((double *) mem_97806)[x_55820 *
                                                                   i_84740 +
                                                                   i_84736 +
                                                                   (squot64(i_113919,
                                                                            (int64_t) 9) *
                                                                    (x_55820 *
                                                                     x_55816) +
                                                                    squot64(i_113919 -
                                                                            squot64(i_113919,
                                                                                    (int64_t) 9) *
                                                                            (int64_t) 9,
                                                                            (int64_t) 3) *
                                                                    x_55820 +
                                                                    (i_113919 -
                                                                     squot64(i_113919,
                                                                             (int64_t) 9) *
                                                                     (int64_t) 9 -
                                                                     squot64(i_113919 -
                                                                             squot64(i_113919,
                                                                                     (int64_t) 9) *
                                                                             (int64_t) 9,
                                                                             (int64_t) 3) *
                                                                     (int64_t) 3))];
                        
                        ((double *) mem_97811)[i_84740 * binop_y_92967 +
                                               i_84736 * (int64_t) 9 +
                                               i_113919] = tmp_113920;
                    }
                }
            }
            for (int32_t i_86761 = 0; i_86761 < 64; i_86761++) {
                int64_t i_84750 = sext_i32_i64(i_86761);
                double x_75471 = ((double *) mem_param_96923.mem)[i_84750];
                int64_t binop_x_92899 = (int64_t) 9 * i_84750;
                
                for (int64_t i_84746 = 0; i_84746 < flat_dim_55927; i_84746++) {
                    int64_t binop_x_92965 = (int64_t) 9 * i_84746;
                    double defunc_2_reduce_res_83876;
                    double redout_84742 = 0.0;
                    
                    for (int32_t i_87649 = 0; i_87649 < 9; i_87649++) {
                        int64_t i_84743 = sext_i32_i64(i_87649);
                        int64_t binop_x_92900 = i_84743 + binop_x_92899;
                        int64_t new_index_92901 = squot64(binop_x_92900,
                                                          (int64_t) 9);
                        int64_t binop_y_92907 = (int64_t) 9 * new_index_92901;
                        int64_t binop_x_92908 = binop_x_92900 - binop_y_92907;
                        int64_t new_index_92909 = squot64(binop_x_92908,
                                                          (int64_t) 9);
                        int64_t binop_y_92925 = (int64_t) 9 * new_index_92909;
                        int64_t binop_x_92926 = binop_x_92908 - binop_y_92925;
                        int64_t new_index_92927 = squot64(binop_x_92926,
                                                          (int64_t) 3);
                        int64_t binop_y_92963 = (int64_t) 3 * new_index_92927;
                        int64_t new_index_92964 = binop_x_92926 - binop_y_92963;
                        double x_78340 =
                               ((double *) mem_param_96918.mem)[new_index_92901 *
                                                                (int64_t) 9 +
                                                                new_index_92909 *
                                                                (int64_t) 9 +
                                                                new_index_92927 *
                                                                (int64_t) 3 +
                                                                new_index_92964];
                        int64_t binop_x_92966 = i_84743 + binop_x_92965;
                        int64_t new_index_92968 = squot64(binop_x_92966,
                                                          binop_y_92967);
                        int64_t binop_y_92976 = binop_y_92967 * new_index_92968;
                        int64_t binop_x_92977 = binop_x_92966 - binop_y_92976;
                        int64_t new_index_92978 = squot64(binop_x_92977,
                                                          (int64_t) 9);
                        int64_t binop_y_92998 = (int64_t) 9 * new_index_92978;
                        int64_t new_index_92999 = binop_x_92977 - binop_y_92998;
                        double x_78341 =
                               ((double *) mem_97811)[new_index_92968 *
                                                      binop_y_92967 +
                                                      new_index_92978 *
                                                      (int64_t) 9 +
                                                      new_index_92999];
                        double defunc_1_f_res_78342 = x_78340 * x_78341;
                        double defunc_1_op_res_78335 = defunc_1_f_res_78342 +
                               redout_84742;
                        double redout_tmp_113923 = defunc_1_op_res_78335;
                        
                        redout_84742 = redout_tmp_113923;
                    }
                    defunc_2_reduce_res_83876 = redout_84742;
                    
                    double defunc_0_f_res_78338 = x_75471 +
                           defunc_2_reduce_res_83876;
                    
                    ((double *) mem_97872)[i_84750 * flat_dim_55927 + i_84746] =
                        defunc_0_f_res_78338;
                }
            }
            for (int32_t i_86762 = 0; i_86762 < 64; i_86762++) {
                int64_t i_84762 = sext_i32_i64(i_86762);
                
                for (int32_t i_87643 = 0; i_87643 < 30; i_87643++) {
                    int64_t i_84758 = sext_i32_i64(i_87643);
                    bool cond_56903 = slt64(i_84758, (int64_t) 1);
                    bool cond_f_res_56904 = sle64((int64_t) 29, i_84758);
                    bool x_56905 = !cond_56903;
                    bool y_56906 = cond_f_res_56904 && x_56905;
                    bool cond_56907 = cond_56903 || y_56906;
                    bool x_56908 = !cond_56907;
                    
                    for (int32_t i_87644 = 0; i_87644 < 30; i_87644++) {
                        int64_t i_84754 = sext_i32_i64(i_87644);
                        bool cond_f_res_56911 = slt64(i_84754, (int64_t) 1);
                        bool y_56912 = x_56908 && cond_f_res_56911;
                        bool cond_56913 = cond_56907 || y_56912;
                        bool cond_f_res_56914 = sle64((int64_t) 29, i_84754);
                        bool x_56915 = !cond_56913;
                        bool y_56916 = cond_f_res_56914 && x_56915;
                        bool cond_56917 = cond_56913 || y_56916;
                        double defunc_0_f_res_56918;
                        
                        if (cond_56917 == 1) {
                            defunc_0_f_res_56918 = 0.0;
                        } else {
                            int64_t i_56919 = sub64(i_84758, (int64_t) 1);
                            bool x_56920 = sle64((int64_t) 0, i_56919);
                            bool y_56921 = slt64(i_56919, (int64_t) 28);
                            bool bounds_check_56922 = x_56920 && y_56921;
                            int64_t i_56923 = sub64(i_84754, (int64_t) 1);
                            bool x_56924 = sle64((int64_t) 0, i_56923);
                            bool y_56925 = slt64(i_56923, (int64_t) 28);
                            bool bounds_check_56926 = x_56924 && y_56925;
                            bool index_ok_56927 = bounds_check_56922 &&
                                 bounds_check_56926;
                            bool index_certs_56928;
                            
                            if (!index_ok_56927) {
                                set_error(ctx,
                                          msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                    "Index [",
                                                    (long long) i_56919, ", ",
                                                    (long long) i_56923,
                                                    "] out of bounds for array of shape [",
                                                    (long long) (int64_t) 28,
                                                    "][",
                                                    (long long) (int64_t) 28,
                                                    "].",
                                                    "-> #0  ../layers/conv2d.fut:7:91-116\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  ../layers/conv2d.fut:6:22-7:117\n   #7  ../layers/conv2d.fut:6:6-7:123\n   #8  ../layers/conv2d.fut:22:7-30\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t binop_x_92883 = (int64_t) 784 * i_84762;
                            int64_t binop_y_92884 = (int64_t) 28 * i_56919;
                            int64_t binop_x_92885 = binop_x_92883 +
                                    binop_y_92884;
                            int64_t binop_x_92886 = i_56923 + binop_x_92885;
                            int64_t new_index_92887 = squot64(binop_x_92886,
                                                              flat_dim_55927);
                            int64_t binop_y_92897 = flat_dim_55927 *
                                    new_index_92887;
                            int64_t new_index_92898 = binop_x_92886 -
                                    binop_y_92897;
                            double defunc_0_f_res_f_res_56929 =
                                   ((double *) mem_97872)[new_index_92887 *
                                                          flat_dim_55927 +
                                                          new_index_92898];
                            
                            defunc_0_f_res_56918 = defunc_0_f_res_f_res_56929;
                        }
                        ((double *) mem_97915)[i_84762 * (int64_t) 900 +
                                               i_84758 * (int64_t) 30 +
                                               i_84754] = defunc_0_f_res_56918;
                    }
                }
            }
            for (int32_t i_86763 = 0; i_86763 < 28; i_86763++) {
                int64_t i_84770 = sext_i32_i64(i_86763);
                int64_t j_56948 = add64((int64_t) 3, i_84770);
                int64_t i_p_m_t_s_56949 = add64((int64_t) 2, i_84770);
                bool zzero_leq_i_p_m_t_s_56950 = sle64((int64_t) 0,
                                                       i_p_m_t_s_56949);
                bool i_p_m_t_s_leq_w_56951 = slt64(i_p_m_t_s_56949,
                                                   (int64_t) 30);
                bool zzero_lte_i_56952 = sle64((int64_t) 0, i_84770);
                bool i_lte_j_56953 = sle64(i_84770, j_56948);
                bool y_56954 = i_p_m_t_s_leq_w_56951 && zzero_lte_i_56952;
                bool y_56955 = zzero_leq_i_p_m_t_s_56950 && y_56954;
                bool y_56956 = i_lte_j_56953 && y_56955;
                bool forwards_ok_56957 = zzero_lte_i_56952 && y_56956;
                
                for (int32_t i_87638 = 0; i_87638 < 28; i_87638++) {
                    int64_t i_84766 = sext_i32_i64(i_87638);
                    int64_t j_56961 = add64((int64_t) 3, i_84766);
                    int64_t i_p_m_t_s_56962 = add64((int64_t) 2, i_84766);
                    bool zzero_leq_i_p_m_t_s_56963 = sle64((int64_t) 0,
                                                           i_p_m_t_s_56962);
                    bool i_p_m_t_s_leq_w_56964 = slt64(i_p_m_t_s_56962,
                                                       (int64_t) 30);
                    bool zzero_lte_i_56965 = sle64((int64_t) 0, i_84766);
                    bool i_lte_j_56966 = sle64(i_84766, j_56961);
                    bool y_56967 = i_p_m_t_s_leq_w_56964 && zzero_lte_i_56965;
                    bool y_56968 = zzero_leq_i_p_m_t_s_56963 && y_56967;
                    bool y_56969 = i_lte_j_56966 && y_56968;
                    bool forwards_ok_56970 = zzero_lte_i_56965 && y_56969;
                    bool index_ok_56972 = forwards_ok_56957 &&
                         forwards_ok_56970;
                    bool index_certs_56973;
                    
                    if (!index_ok_56972) {
                        set_error(ctx,
                                  msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                            "Index [", (long long) i_84770, ":",
                                            (long long) j_56948, ", ",
                                            (long long) i_84766, ":",
                                            (long long) j_56961,
                                            "] out of bounds for array of shape [",
                                            (long long) (int64_t) 30, "][",
                                            (long long) (int64_t) 30, "].",
                                            "-> #0  ../layers/conv2d.fut:13:90-124\n   #1  ../layers/conv2d.fut:13:69-146\n   #2  /prelude/soacs.fut:59:3-10\n   #3  /prelude/array.fut:200:3-17\n   #4  /prelude/functional.fut:39:59-65\n   #5  /prelude/soacs.fut:59:3-10\n   #6  /prelude/array.fut:208:3-34\n   #7  ../layers/conv2d.fut:13:26-162\n   #8  ../layers/conv2d.fut:26:17-54\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    for (int64_t i_113929 = 0; i_113929 < (int64_t) 576;
                         i_113929++) {
                        double tmp_113930 =
                               ((double *) mem_97915)[(int64_t) 30 * i_84770 +
                                                      i_84766 +
                                                      (squot64(i_113929,
                                                               (int64_t) 9) *
                                                       (int64_t) 900 +
                                                       squot64(i_113929 -
                                                               squot64(i_113929,
                                                                       (int64_t) 9) *
                                                               (int64_t) 9,
                                                               (int64_t) 3) *
                                                       (int64_t) 30 +
                                                       (i_113929 -
                                                        squot64(i_113929,
                                                                (int64_t) 9) *
                                                        (int64_t) 9 -
                                                        squot64(i_113929 -
                                                                squot64(i_113929,
                                                                        (int64_t) 9) *
                                                                (int64_t) 9,
                                                                (int64_t) 3) *
                                                        (int64_t) 3))];
                        
                        ((double *) mem_97999)[i_84770 * (int64_t) 16128 +
                                               i_84766 * (int64_t) 576 +
                                               i_113929] = tmp_113930;
                    }
                }
            }
            for (int32_t i_86764 = 0; i_86764 < 128; i_86764++) {
                int64_t i_84780 = sext_i32_i64(i_86764);
                double x_75453 = ((double *) mem_param_96942.mem)[i_84780];
                int64_t binop_x_92789 = (int64_t) 576 * i_84780;
                
                for (int32_t i_87636 = 0; i_87636 < 784; i_87636++) {
                    int64_t i_84776 = sext_i32_i64(i_87636);
                    int64_t binop_x_92855 = (int64_t) 576 * i_84776;
                    double defunc_2_reduce_res_83881;
                    double redout_84772 = 0.0;
                    
                    for (int32_t i_87637 = 0; i_87637 < 576; i_87637++) {
                        int64_t i_84773 = sext_i32_i64(i_87637);
                        int64_t binop_x_92790 = i_84773 + binop_x_92789;
                        int64_t new_index_92791 = squot64(binop_x_92790,
                                                          (int64_t) 576);
                        int64_t binop_y_92797 = (int64_t) 576 * new_index_92791;
                        int64_t binop_x_92798 = binop_x_92790 - binop_y_92797;
                        int64_t new_index_92799 = squot64(binop_x_92798,
                                                          (int64_t) 9);
                        int64_t binop_y_92815 = (int64_t) 9 * new_index_92799;
                        int64_t binop_x_92816 = binop_x_92798 - binop_y_92815;
                        int64_t new_index_92817 = squot64(binop_x_92816,
                                                          (int64_t) 3);
                        int64_t binop_y_92853 = (int64_t) 3 * new_index_92817;
                        int64_t new_index_92854 = binop_x_92816 - binop_y_92853;
                        double x_78364 =
                               ((double *) mem_param_96937.mem)[new_index_92791 *
                                                                (int64_t) 576 +
                                                                new_index_92799 *
                                                                (int64_t) 9 +
                                                                new_index_92817 *
                                                                (int64_t) 3 +
                                                                new_index_92854];
                        int64_t binop_x_92856 = i_84773 + binop_x_92855;
                        int64_t new_index_92857 = squot64(binop_x_92856,
                                                          (int64_t) 16128);
                        int64_t binop_y_92863 = (int64_t) 16128 *
                                new_index_92857;
                        int64_t binop_x_92864 = binop_x_92856 - binop_y_92863;
                        int64_t new_index_92865 = squot64(binop_x_92864,
                                                          (int64_t) 576);
                        int64_t binop_y_92881 = (int64_t) 576 * new_index_92865;
                        int64_t new_index_92882 = binop_x_92864 - binop_y_92881;
                        double x_78365 =
                               ((double *) mem_97999)[new_index_92857 *
                                                      (int64_t) 16128 +
                                                      new_index_92865 *
                                                      (int64_t) 576 +
                                                      new_index_92882];
                        double defunc_1_f_res_78366 = x_78364 * x_78365;
                        double defunc_1_op_res_78359 = defunc_1_f_res_78366 +
                               redout_84772;
                        double redout_tmp_113933 = defunc_1_op_res_78359;
                        
                        redout_84772 = redout_tmp_113933;
                    }
                    defunc_2_reduce_res_83881 = redout_84772;
                    
                    double defunc_0_f_res_78362 = x_75453 +
                           defunc_2_reduce_res_83881;
                    
                    ((double *) mem_98051)[i_84780 * (int64_t) 784 + i_84776] =
                        defunc_0_f_res_78362;
                }
            }
            for (int32_t i_86765 = 0; i_86765 < 128; i_86765++) {
                int64_t i_84792 = sext_i32_i64(i_86765);
                int64_t binop_x_92773 = (int64_t) 784 * i_84792;
                
                for (int32_t i_87634 = 0; i_87634 < 28; i_87634++) {
                    int64_t i_84788 = sext_i32_i64(i_87634);
                    int64_t binop_y_92774 = (int64_t) 28 * i_84788;
                    int64_t binop_x_92775 = binop_x_92773 + binop_y_92774;
                    
                    for (int32_t i_87635 = 0; i_87635 < 28; i_87635++) {
                        int64_t i_84784 = sext_i32_i64(i_87635);
                        int64_t binop_x_92776 = i_84784 + binop_x_92775;
                        int64_t new_index_92777 = squot64(binop_x_92776,
                                                          (int64_t) 784);
                        int64_t binop_y_92787 = (int64_t) 784 * new_index_92777;
                        int64_t new_index_92788 = binop_x_92776 - binop_y_92787;
                        double x_57016 =
                               ((double *) mem_98051)[new_index_92777 *
                                                      (int64_t) 784 +
                                                      new_index_92788];
                        double max_res_57017 = fmax64(0.0, x_57016);
                        
                        ((double *) mem_98091)[i_84792 * (int64_t) 784 +
                                               i_84788 * (int64_t) 28 +
                                               i_84784] = max_res_57017;
                    }
                }
            }
            for (int32_t i_86766 = 0; i_86766 < 32; i_86766++) {
                int64_t i_84796 = sext_i32_i64(i_86766);
                int64_t i_57028 = mul64((int64_t) 4, i_84796);
                int64_t x_57029 = add64((int64_t) 1, i_84796);
                int64_t j_57030 = mul64((int64_t) 4, x_57029);
                int64_t j_m_i_57031 = sub64(j_57030, i_57028);
                bool empty_slice_57032 = j_m_i_57031 == (int64_t) 0;
                int64_t m_57033 = sub64(j_m_i_57031, (int64_t) 1);
                int64_t i_p_m_t_s_57034 = add64(i_57028, m_57033);
                bool zzero_leq_i_p_m_t_s_57035 = sle64((int64_t) 0,
                                                       i_p_m_t_s_57034);
                bool i_p_m_t_s_leq_w_57036 = slt64(i_p_m_t_s_57034,
                                                   (int64_t) 128);
                bool zzero_lte_i_57037 = sle64((int64_t) 0, i_57028);
                bool i_lte_j_57038 = sle64(i_57028, j_57030);
                bool y_57039 = i_p_m_t_s_leq_w_57036 && zzero_lte_i_57037;
                bool y_57040 = zzero_leq_i_p_m_t_s_57035 && y_57039;
                bool y_57041 = i_lte_j_57038 && y_57040;
                bool forwards_ok_57042 = zzero_lte_i_57037 && y_57041;
                bool ok_or_empty_57043 = empty_slice_57032 || forwards_ok_57042;
                bool index_certs_57044;
                
                if (!ok_or_empty_57043) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Index [", (long long) i_57028, ":",
                                        (long long) j_57030,
                                        "] out of bounds for array of shape [",
                                        (long long) (int64_t) 128, "].",
                                        "-> #0  ../layers/groupnorm.fut:2:31-70\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  ../layers/groupnorm.fut:2:3-97\n   #4  ../layers/groupnorm.fut:15:19-54\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool dim_match_57045 = (int64_t) 4 == j_m_i_57031;
                bool empty_or_match_cert_57046;
                
                if (!dim_match_57045) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Value of (core language) shape (",
                                        (long long) j_m_i_57031, ", ",
                                        (long long) (int64_t) 28, ", ",
                                        (long long) (int64_t) 28,
                                        ") cannot match shape of type `[",
                                        (long long) (int64_t) 4, "][",
                                        (long long) (int64_t) 28, "][",
                                        (long long) (int64_t) 28, "]f64`.",
                                        "-> #0  ../layers/groupnorm.fut:2:31-96\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  ../layers/groupnorm.fut:2:3-97\n   #4  ../layers/groupnorm.fut:15:19-54\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if ((int64_t) 25088 > 0)
                    memmove(mem_98175 + i_84796 * (int64_t) 3136 * (int64_t) 8,
                            mem_98091 + (int64_t) 784 * i_57028 * (int64_t) 8,
                            (int64_t) 25088);
            }
            for (int32_t i_86767 = 0; i_86767 < 32; i_86767++) {
                int64_t i_84806 = sext_i32_i64(i_86767);
                int64_t binop_x_92707 = (int64_t) 3136 * i_84806;
                double defunc_2_reduce_res_83885;
                double redout_84798 = 0.0;
                
                for (int32_t i_87630 = 0; i_87630 < 3136; i_87630++) {
                    int64_t i_84799 = sext_i32_i64(i_87630);
                    int64_t binop_x_92708 = i_84799 + binop_x_92707;
                    int64_t new_index_92709 = squot64(binop_x_92708,
                                                      (int64_t) 3136);
                    int64_t binop_y_92715 = (int64_t) 3136 * new_index_92709;
                    int64_t binop_x_92716 = binop_x_92708 - binop_y_92715;
                    int64_t new_index_92717 = squot64(binop_x_92716,
                                                      (int64_t) 784);
                    int64_t binop_y_92733 = (int64_t) 784 * new_index_92717;
                    int64_t binop_x_92734 = binop_x_92716 - binop_y_92733;
                    int64_t new_index_92735 = squot64(binop_x_92734,
                                                      (int64_t) 28);
                    int64_t binop_y_92771 = (int64_t) 28 * new_index_92735;
                    int64_t new_index_92772 = binop_x_92734 - binop_y_92771;
                    double x_57062 = ((double *) mem_98175)[new_index_92709 *
                                                            (int64_t) 3136 +
                                                            new_index_92717 *
                                                            (int64_t) 784 +
                                                            new_index_92735 *
                                                            (int64_t) 28 +
                                                            new_index_92772];
                    double defunc_1_op_res_57061 = x_57062 + redout_84798;
                    double redout_tmp_113940 = defunc_1_op_res_57061;
                    
                    redout_84798 = redout_tmp_113940;
                }
                defunc_2_reduce_res_83885 = redout_84798;
                
                double calc_mean_flat_res_57063 = defunc_2_reduce_res_83885 /
                       3136.0;
                double defunc_2_reduce_res_83886;
                double redout_84800 = 0.0;
                
                for (int32_t i_87631 = 0; i_87631 < 3136; i_87631++) {
                    int64_t i_84801 = sext_i32_i64(i_87631);
                    int64_t binop_x_92642 = i_84801 + binop_x_92707;
                    int64_t new_index_92643 = squot64(binop_x_92642,
                                                      (int64_t) 3136);
                    int64_t binop_y_92649 = (int64_t) 3136 * new_index_92643;
                    int64_t binop_x_92650 = binop_x_92642 - binop_y_92649;
                    int64_t new_index_92651 = squot64(binop_x_92650,
                                                      (int64_t) 784);
                    int64_t binop_y_92667 = (int64_t) 784 * new_index_92651;
                    int64_t binop_x_92668 = binop_x_92650 - binop_y_92667;
                    int64_t new_index_92669 = squot64(binop_x_92668,
                                                      (int64_t) 28);
                    int64_t binop_y_92705 = (int64_t) 28 * new_index_92669;
                    int64_t new_index_92706 = binop_x_92668 - binop_y_92705;
                    double x_57070 = ((double *) mem_98175)[new_index_92643 *
                                                            (int64_t) 3136 +
                                                            new_index_92651 *
                                                            (int64_t) 784 +
                                                            new_index_92669 *
                                                            (int64_t) 28 +
                                                            new_index_92706];
                    double x_57067 = x_57070 - calc_mean_flat_res_57063;
                    double x_57068 = fpow64(x_57067, 2.0);
                    double defunc_1_op_res_57069 = x_57068 + redout_84800;
                    double redout_tmp_113941 = defunc_1_op_res_57069;
                    
                    redout_84800 = redout_tmp_113941;
                }
                defunc_2_reduce_res_83886 = redout_84800;
                
                double defunc_0_f_res_57071 = defunc_2_reduce_res_83886 /
                       3136.0;
                
                ((double *) mem_98205)[i_84806] = calc_mean_flat_res_57063;
                ((double *) mem_98207)[i_84806] = defunc_0_f_res_57071;
            }
            for (int32_t i_86768 = 0; i_86768 < 128; i_86768++) {
                int64_t i_84841 = sext_i32_i64(i_86768);
                double x_75373 = ((double *) mem_param_96955.mem)[i_84841];
                bool x_75374 = sle64((int64_t) 0, i_84841);
                bool y_75375 = slt64(i_84841, (int64_t) 128);
                bool bounds_check_75376 = x_75374 && y_75375;
                int64_t i_75377 = sdiv64(i_84841, (int64_t) 4);
                bool x_75378 = sle64((int64_t) 0, i_75377);
                bool y_75379 = slt64(i_75377, (int64_t) 32);
                bool bounds_check_75380 = x_75378 && y_75379;
                bool index_certs_75381;
                
                if (!bounds_check_75380) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Index [", (long long) i_75377,
                                        "] out of bounds for array of shape [",
                                        (long long) (int64_t) 32, "].",
                                        "-> #0  ../layers/groupnorm.fut:17:57-77\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  /prelude/functional.fut:39:59-65\n   #7  /prelude/soacs.fut:59:3-10\n   #8  /prelude/array.fut:216:3-39\n   #9  ../layers/groupnorm.fut:17:13-119\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                double y_75382 = ((double *) mem_98205)[i_75377];
                double x_75383 = ((double *) mem_98207)[i_75377];
                double sqrt_arg_75384 = 1.0e-5 + x_75383;
                double sqrt_res_75385 = futrts_sqrt64(sqrt_arg_75384);
                double defunc_2_reduce_res_83890;
                double redout_84809 = 0.0;
                
                for (int32_t i_87609 = 0; i_87609 < 256; i_87609++) {
                    int64_t i_84810 = sext_i32_i64(i_87609);
                    bool index_concat_cmp_87623 = sle64((int64_t) 128, i_84810);
                    double index_concat_branch_87627;
                    
                    if (index_concat_cmp_87623 == 1) {
                        int64_t index_concat_i_87624 = sub64(i_84810,
                                                             (int64_t) 128);
                        double index_concat_87625 =
                               ((double *) mem_97692)[index_concat_i_87624];
                        
                        index_concat_branch_87627 = index_concat_87625;
                    } else {
                        double index_concat_87626 =
                               ((double *) mem_97690)[i_84810];
                        
                        index_concat_branch_87627 = index_concat_87626;
                    }
                    
                    double x_78377 = ((double *) mem_param_96950.mem)[i_84841 *
                                                                      (int64_t) 256 +
                                                                      i_84810];
                    double defunc_1_f_res_78378 = x_78377 *
                           index_concat_branch_87627;
                    double defunc_1_op_res_75410 = defunc_1_f_res_78378 +
                           redout_84809;
                    double redout_tmp_113946 = defunc_1_op_res_75410;
                    
                    redout_84809 = redout_tmp_113946;
                }
                defunc_2_reduce_res_83890 = redout_84809;
                
                double defunc_1_f_res_75412 = x_75373 +
                       defunc_2_reduce_res_83890;
                double max_res_75414 = fmax64(0.0, defunc_1_f_res_75412);
                
                for (int32_t i_87610 = 0; i_87610 < 28; i_87610++) {
                    int64_t i_84822 = sext_i32_i64(i_87610);
                    bool x_78382 = sle64((int64_t) 0, i_84822);
                    bool y_78383 = slt64(i_84822, (int64_t) 28);
                    bool bounds_check_78384 = x_78382 && y_78383;
                    
                    for (int32_t i_87617 = 0; i_87617 < 28; i_87617++) {
                        int64_t i_84815 = sext_i32_i64(i_87617);
                        bool x_78402 = sle64((int64_t) 0, i_84815);
                        bool y_78403 = slt64(i_84815, (int64_t) 28);
                        bool bounds_check_78404 = x_78402 && y_78403;
                        bool y_78405 = bounds_check_75376 && bounds_check_78404;
                        bool index_ok_78406 = bounds_check_78384 && y_78405;
                        bool index_certs_78407;
                        
                        if (!index_ok_78406) {
                            set_error(ctx,
                                      msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                "Index [", (long long) i_84841,
                                                ", ", (long long) i_84822, ", ",
                                                (long long) i_84815,
                                                "] out of bounds for array of shape [",
                                                (long long) (int64_t) 128, "][",
                                                (long long) (int64_t) 28, "][",
                                                (long long) (int64_t) 28, "].",
                                                "-> #0  ../layers/groupnorm.fut:17:44-53\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  /prelude/functional.fut:39:59-65\n   #7  /prelude/soacs.fut:59:3-10\n   #8  /prelude/array.fut:216:3-39\n   #9  ../layers/groupnorm.fut:17:13-119\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        double x_78408 = ((double *) mem_98091)[i_84841 *
                                                                (int64_t) 784 +
                                                                i_84822 *
                                                                (int64_t) 28 +
                                                                i_84815];
                        double x_78409 = x_78408 - y_75382;
                        double defunc_0_f_res_78410 = x_78409 / sqrt_res_75385;
                        double defunc_0_f_res_78412 = max_res_75414 +
                               defunc_0_f_res_78410;
                        
                        ((double *) mem_98231)[i_84841 * (int64_t) 784 +
                                               i_84822 * (int64_t) 28 +
                                               i_84815] = defunc_0_f_res_78412;
                        ((double *) mem_98235)[i_84841 * (int64_t) 784 +
                                               i_84822 * (int64_t) 28 +
                                               i_84815] = defunc_0_f_res_78410;
                    }
                }
                for (int32_t i_87611 = 0; i_87611 < 30; i_87611++) {
                    int64_t i_84831 = sext_i32_i64(i_87611);
                    bool cond_75424 = slt64(i_84831, (int64_t) 1);
                    bool cond_f_res_75425 = sle64((int64_t) 29, i_84831);
                    bool x_75426 = !cond_75424;
                    bool y_75427 = cond_f_res_75425 && x_75426;
                    bool cond_75428 = cond_75424 || y_75427;
                    bool x_75429 = !cond_75428;
                    
                    for (int32_t i_87612 = 0; i_87612 < 30; i_87612++) {
                        int64_t i_84827 = sext_i32_i64(i_87612);
                        bool cond_f_res_75432 = slt64(i_84827, (int64_t) 1);
                        bool y_75433 = x_75429 && cond_f_res_75432;
                        bool cond_75434 = cond_75428 || y_75433;
                        bool cond_f_res_75435 = sle64((int64_t) 29, i_84827);
                        bool x_75436 = !cond_75434;
                        bool y_75437 = cond_f_res_75435 && x_75436;
                        bool cond_75438 = cond_75434 || y_75437;
                        double defunc_0_f_res_75439;
                        
                        if (cond_75438 == 1) {
                            defunc_0_f_res_75439 = 0.0;
                        } else {
                            int64_t i_75440 = sub64(i_84831, (int64_t) 1);
                            bool x_75441 = sle64((int64_t) 0, i_75440);
                            bool y_75442 = slt64(i_75440, (int64_t) 28);
                            bool bounds_check_75443 = x_75441 && y_75442;
                            int64_t i_75444 = sub64(i_84827, (int64_t) 1);
                            bool x_75445 = sle64((int64_t) 0, i_75444);
                            bool y_75446 = slt64(i_75444, (int64_t) 28);
                            bool bounds_check_75447 = x_75445 && y_75446;
                            bool index_ok_75448 = bounds_check_75443 &&
                                 bounds_check_75447;
                            bool index_certs_75449;
                            
                            if (!index_ok_75448) {
                                set_error(ctx,
                                          msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                    "Index [",
                                                    (long long) i_75440, ", ",
                                                    (long long) i_75444,
                                                    "] out of bounds for array of shape [",
                                                    (long long) (int64_t) 28,
                                                    "][",
                                                    (long long) (int64_t) 28,
                                                    "].",
                                                    "-> #0  ../layers/conv2d.fut:7:91-116\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  ../layers/conv2d.fut:6:22-7:117\n   #7  ../layers/conv2d.fut:6:6-7:123\n   #8  ../layers/conv2d.fut:22:7-30\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            double defunc_0_f_res_f_res_75450 =
                                   ((double *) mem_98231)[i_84841 *
                                                          (int64_t) 784 +
                                                          i_75440 *
                                                          (int64_t) 28 +
                                                          i_75444];
                            
                            defunc_0_f_res_75439 = defunc_0_f_res_f_res_75450;
                        }
                        ((double *) mem_98229)[i_84841 * (int64_t) 900 +
                                               i_84831 * (int64_t) 30 +
                                               i_84827] = defunc_0_f_res_75439;
                    }
                }
                ((double *) mem_98233)[i_84841] = defunc_1_f_res_75412;
            }
            for (int32_t i_86769 = 0; i_86769 < 28; i_86769++) {
                int64_t i_84852 = sext_i32_i64(i_86769);
                int64_t j_57187 = add64((int64_t) 3, i_84852);
                int64_t i_p_m_t_s_57188 = add64((int64_t) 2, i_84852);
                bool zzero_leq_i_p_m_t_s_57189 = sle64((int64_t) 0,
                                                       i_p_m_t_s_57188);
                bool i_p_m_t_s_leq_w_57190 = slt64(i_p_m_t_s_57188,
                                                   (int64_t) 30);
                bool zzero_lte_i_57191 = sle64((int64_t) 0, i_84852);
                bool i_lte_j_57192 = sle64(i_84852, j_57187);
                bool y_57193 = i_p_m_t_s_leq_w_57190 && zzero_lte_i_57191;
                bool y_57194 = zzero_leq_i_p_m_t_s_57189 && y_57193;
                bool y_57195 = i_lte_j_57192 && y_57194;
                bool forwards_ok_57196 = zzero_lte_i_57191 && y_57195;
                
                for (int32_t i_87604 = 0; i_87604 < 28; i_87604++) {
                    int64_t i_84848 = sext_i32_i64(i_87604);
                    int64_t j_57200 = add64((int64_t) 3, i_84848);
                    int64_t i_p_m_t_s_57201 = add64((int64_t) 2, i_84848);
                    bool zzero_leq_i_p_m_t_s_57202 = sle64((int64_t) 0,
                                                           i_p_m_t_s_57201);
                    bool i_p_m_t_s_leq_w_57203 = slt64(i_p_m_t_s_57201,
                                                       (int64_t) 30);
                    bool zzero_lte_i_57204 = sle64((int64_t) 0, i_84848);
                    bool i_lte_j_57205 = sle64(i_84848, j_57200);
                    bool y_57206 = i_p_m_t_s_leq_w_57203 && zzero_lte_i_57204;
                    bool y_57207 = zzero_leq_i_p_m_t_s_57202 && y_57206;
                    bool y_57208 = i_lte_j_57205 && y_57207;
                    bool forwards_ok_57209 = zzero_lte_i_57204 && y_57208;
                    bool index_ok_57211 = forwards_ok_57196 &&
                         forwards_ok_57209;
                    bool index_certs_57212;
                    
                    if (!index_ok_57211) {
                        set_error(ctx,
                                  msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                            "Index [", (long long) i_84852, ":",
                                            (long long) j_57187, ", ",
                                            (long long) i_84848, ":",
                                            (long long) j_57200,
                                            "] out of bounds for array of shape [",
                                            (long long) (int64_t) 30, "][",
                                            (long long) (int64_t) 30, "].",
                                            "-> #0  ../layers/conv2d.fut:13:90-124\n   #1  ../layers/conv2d.fut:13:69-146\n   #2  /prelude/soacs.fut:59:3-10\n   #3  /prelude/array.fut:200:3-17\n   #4  /prelude/functional.fut:39:59-65\n   #5  /prelude/soacs.fut:59:3-10\n   #6  /prelude/array.fut:208:3-34\n   #7  ../layers/conv2d.fut:13:26-162\n   #8  ../layers/conv2d.fut:26:17-54\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    for (int64_t i_113955 = 0; i_113955 < (int64_t) 1152;
                         i_113955++) {
                        double tmp_113956 =
                               ((double *) mem_98229)[(int64_t) 30 * i_84852 +
                                                      i_84848 +
                                                      (squot64(i_113955,
                                                               (int64_t) 9) *
                                                       (int64_t) 900 +
                                                       squot64(i_113955 -
                                                               squot64(i_113955,
                                                                       (int64_t) 9) *
                                                               (int64_t) 9,
                                                               (int64_t) 3) *
                                                       (int64_t) 30 +
                                                       (i_113955 -
                                                        squot64(i_113955,
                                                                (int64_t) 9) *
                                                        (int64_t) 9 -
                                                        squot64(i_113955 -
                                                                squot64(i_113955,
                                                                        (int64_t) 9) *
                                                                (int64_t) 9,
                                                                (int64_t) 3) *
                                                        (int64_t) 3))];
                        
                        ((double *) mem_98493)[i_84852 * (int64_t) 32256 +
                                               i_84848 * (int64_t) 1152 +
                                               i_113955] = tmp_113956;
                    }
                }
            }
            for (int32_t i_86770 = 0; i_86770 < 128; i_86770++) {
                int64_t i_84862 = sext_i32_i64(i_86770);
                double x_75224 = ((double *) mem_param_96974.mem)[i_84862];
                int64_t binop_x_92547 = (int64_t) 1152 * i_84862;
                
                for (int32_t i_87602 = 0; i_87602 < 784; i_87602++) {
                    int64_t i_84858 = sext_i32_i64(i_87602);
                    int64_t binop_x_92613 = (int64_t) 1152 * i_84858;
                    double defunc_2_reduce_res_83895;
                    double redout_84854 = 0.0;
                    
                    for (int32_t i_87603 = 0; i_87603 < 1152; i_87603++) {
                        int64_t i_84855 = sext_i32_i64(i_87603);
                        int64_t binop_x_92548 = i_84855 + binop_x_92547;
                        int64_t new_index_92549 = squot64(binop_x_92548,
                                                          (int64_t) 1152);
                        int64_t binop_y_92555 = (int64_t) 1152 *
                                new_index_92549;
                        int64_t binop_x_92556 = binop_x_92548 - binop_y_92555;
                        int64_t new_index_92557 = squot64(binop_x_92556,
                                                          (int64_t) 9);
                        int64_t binop_y_92573 = (int64_t) 9 * new_index_92557;
                        int64_t binop_x_92574 = binop_x_92556 - binop_y_92573;
                        int64_t new_index_92575 = squot64(binop_x_92574,
                                                          (int64_t) 3);
                        int64_t binop_y_92611 = (int64_t) 3 * new_index_92575;
                        int64_t new_index_92612 = binop_x_92574 - binop_y_92611;
                        double x_78438 =
                               ((double *) mem_param_96969.mem)[new_index_92549 *
                                                                (int64_t) 1152 +
                                                                new_index_92557 *
                                                                (int64_t) 9 +
                                                                new_index_92575 *
                                                                (int64_t) 3 +
                                                                new_index_92612];
                        int64_t binop_x_92614 = i_84855 + binop_x_92613;
                        int64_t new_index_92615 = squot64(binop_x_92614,
                                                          (int64_t) 32256);
                        int64_t binop_y_92621 = (int64_t) 32256 *
                                new_index_92615;
                        int64_t binop_x_92622 = binop_x_92614 - binop_y_92621;
                        int64_t new_index_92623 = squot64(binop_x_92622,
                                                          (int64_t) 1152);
                        int64_t binop_y_92639 = (int64_t) 1152 *
                                new_index_92623;
                        int64_t new_index_92640 = binop_x_92622 - binop_y_92639;
                        double x_78439 =
                               ((double *) mem_98493)[new_index_92615 *
                                                      (int64_t) 32256 +
                                                      new_index_92623 *
                                                      (int64_t) 1152 +
                                                      new_index_92640];
                        double defunc_1_f_res_78440 = x_78438 * x_78439;
                        double defunc_1_op_res_78433 = defunc_1_f_res_78440 +
                               redout_84854;
                        double redout_tmp_113959 = defunc_1_op_res_78433;
                        
                        redout_84854 = redout_tmp_113959;
                    }
                    defunc_2_reduce_res_83895 = redout_84854;
                    
                    double defunc_0_f_res_78436 = x_75224 +
                           defunc_2_reduce_res_83895;
                    
                    ((double *) mem_98545)[i_84862 * (int64_t) 784 + i_84858] =
                        defunc_0_f_res_78436;
                }
            }
            for (int32_t i_86771 = 0; i_86771 < 128; i_86771++) {
                int64_t i_84874 = sext_i32_i64(i_86771);
                int64_t binop_x_92531 = (int64_t) 784 * i_84874;
                
                for (int32_t i_87600 = 0; i_87600 < 28; i_87600++) {
                    int64_t i_84870 = sext_i32_i64(i_87600);
                    int64_t binop_y_92532 = (int64_t) 28 * i_84870;
                    int64_t binop_x_92533 = binop_x_92531 + binop_y_92532;
                    
                    for (int32_t i_87601 = 0; i_87601 < 28; i_87601++) {
                        int64_t i_84866 = sext_i32_i64(i_87601);
                        int64_t binop_x_92534 = i_84866 + binop_x_92533;
                        int64_t new_index_92535 = squot64(binop_x_92534,
                                                          (int64_t) 784);
                        int64_t binop_y_92545 = (int64_t) 784 * new_index_92535;
                        int64_t new_index_92546 = binop_x_92534 - binop_y_92545;
                        double x_57255 =
                               ((double *) mem_98545)[new_index_92535 *
                                                      (int64_t) 784 +
                                                      new_index_92546];
                        double max_res_57256 = fmax64(0.0, x_57255);
                        
                        ((double *) mem_98585)[i_84874 * (int64_t) 784 +
                                               i_84870 * (int64_t) 28 +
                                               i_84866] = max_res_57256;
                    }
                }
            }
            for (int32_t i_86772 = 0; i_86772 < 32; i_86772++) {
                int64_t i_84878 = sext_i32_i64(i_86772);
                int64_t i_57259 = mul64((int64_t) 4, i_84878);
                int64_t x_57260 = add64((int64_t) 1, i_84878);
                int64_t j_57261 = mul64((int64_t) 4, x_57260);
                int64_t j_m_i_57262 = sub64(j_57261, i_57259);
                bool empty_slice_57263 = j_m_i_57262 == (int64_t) 0;
                int64_t m_57264 = sub64(j_m_i_57262, (int64_t) 1);
                int64_t i_p_m_t_s_57265 = add64(i_57259, m_57264);
                bool zzero_leq_i_p_m_t_s_57266 = sle64((int64_t) 0,
                                                       i_p_m_t_s_57265);
                bool i_p_m_t_s_leq_w_57267 = slt64(i_p_m_t_s_57265,
                                                   (int64_t) 128);
                bool zzero_lte_i_57268 = sle64((int64_t) 0, i_57259);
                bool i_lte_j_57269 = sle64(i_57259, j_57261);
                bool y_57270 = i_p_m_t_s_leq_w_57267 && zzero_lte_i_57268;
                bool y_57271 = zzero_leq_i_p_m_t_s_57266 && y_57270;
                bool y_57272 = i_lte_j_57269 && y_57271;
                bool forwards_ok_57273 = zzero_lte_i_57268 && y_57272;
                bool ok_or_empty_57274 = empty_slice_57263 || forwards_ok_57273;
                bool index_certs_57275;
                
                if (!ok_or_empty_57274) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Index [", (long long) i_57259, ":",
                                        (long long) j_57261,
                                        "] out of bounds for array of shape [",
                                        (long long) (int64_t) 128, "].",
                                        "-> #0  ../layers/groupnorm.fut:2:31-70\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  ../layers/groupnorm.fut:2:3-97\n   #4  ../layers/groupnorm.fut:15:19-54\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool dim_match_57276 = (int64_t) 4 == j_m_i_57262;
                bool empty_or_match_cert_57277;
                
                if (!dim_match_57276) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Value of (core language) shape (",
                                        (long long) j_m_i_57262, ", ",
                                        (long long) (int64_t) 28, ", ",
                                        (long long) (int64_t) 28,
                                        ") cannot match shape of type `[",
                                        (long long) (int64_t) 4, "][",
                                        (long long) (int64_t) 28, "][",
                                        (long long) (int64_t) 28, "]f64`.",
                                        "-> #0  ../layers/groupnorm.fut:2:31-96\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  ../layers/groupnorm.fut:2:3-97\n   #4  ../layers/groupnorm.fut:15:19-54\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if ((int64_t) 25088 > 0)
                    memmove(mem_98669 + i_84878 * (int64_t) 3136 * (int64_t) 8,
                            mem_98585 + (int64_t) 784 * i_57259 * (int64_t) 8,
                            (int64_t) 25088);
            }
            for (int32_t i_86773 = 0; i_86773 < 32; i_86773++) {
                int64_t i_84888 = sext_i32_i64(i_86773);
                int64_t binop_x_92465 = (int64_t) 3136 * i_84888;
                double defunc_2_reduce_res_83899;
                double redout_84880 = 0.0;
                
                for (int32_t i_87596 = 0; i_87596 < 3136; i_87596++) {
                    int64_t i_84881 = sext_i32_i64(i_87596);
                    int64_t binop_x_92466 = i_84881 + binop_x_92465;
                    int64_t new_index_92467 = squot64(binop_x_92466,
                                                      (int64_t) 3136);
                    int64_t binop_y_92473 = (int64_t) 3136 * new_index_92467;
                    int64_t binop_x_92474 = binop_x_92466 - binop_y_92473;
                    int64_t new_index_92475 = squot64(binop_x_92474,
                                                      (int64_t) 784);
                    int64_t binop_y_92491 = (int64_t) 784 * new_index_92475;
                    int64_t binop_x_92492 = binop_x_92474 - binop_y_92491;
                    int64_t new_index_92493 = squot64(binop_x_92492,
                                                      (int64_t) 28);
                    int64_t binop_y_92529 = (int64_t) 28 * new_index_92493;
                    int64_t new_index_92530 = binop_x_92492 - binop_y_92529;
                    double x_57287 = ((double *) mem_98669)[new_index_92467 *
                                                            (int64_t) 3136 +
                                                            new_index_92475 *
                                                            (int64_t) 784 +
                                                            new_index_92493 *
                                                            (int64_t) 28 +
                                                            new_index_92530];
                    double defunc_1_op_res_57286 = x_57287 + redout_84880;
                    double redout_tmp_113966 = defunc_1_op_res_57286;
                    
                    redout_84880 = redout_tmp_113966;
                }
                defunc_2_reduce_res_83899 = redout_84880;
                
                double calc_mean_flat_res_57288 = defunc_2_reduce_res_83899 /
                       3136.0;
                double defunc_2_reduce_res_83900;
                double redout_84882 = 0.0;
                
                for (int32_t i_87597 = 0; i_87597 < 3136; i_87597++) {
                    int64_t i_84883 = sext_i32_i64(i_87597);
                    int64_t binop_x_92400 = i_84883 + binop_x_92465;
                    int64_t new_index_92401 = squot64(binop_x_92400,
                                                      (int64_t) 3136);
                    int64_t binop_y_92407 = (int64_t) 3136 * new_index_92401;
                    int64_t binop_x_92408 = binop_x_92400 - binop_y_92407;
                    int64_t new_index_92409 = squot64(binop_x_92408,
                                                      (int64_t) 784);
                    int64_t binop_y_92425 = (int64_t) 784 * new_index_92409;
                    int64_t binop_x_92426 = binop_x_92408 - binop_y_92425;
                    int64_t new_index_92427 = squot64(binop_x_92426,
                                                      (int64_t) 28);
                    int64_t binop_y_92463 = (int64_t) 28 * new_index_92427;
                    int64_t new_index_92464 = binop_x_92426 - binop_y_92463;
                    double x_57295 = ((double *) mem_98669)[new_index_92401 *
                                                            (int64_t) 3136 +
                                                            new_index_92409 *
                                                            (int64_t) 784 +
                                                            new_index_92427 *
                                                            (int64_t) 28 +
                                                            new_index_92464];
                    double x_57292 = x_57295 - calc_mean_flat_res_57288;
                    double x_57293 = fpow64(x_57292, 2.0);
                    double defunc_1_op_res_57294 = x_57293 + redout_84882;
                    double redout_tmp_113967 = defunc_1_op_res_57294;
                    
                    redout_84882 = redout_tmp_113967;
                }
                defunc_2_reduce_res_83900 = redout_84882;
                
                double defunc_0_f_res_57296 = defunc_2_reduce_res_83900 /
                       3136.0;
                
                ((double *) mem_98699)[i_84888] = calc_mean_flat_res_57288;
                ((double *) mem_98701)[i_84888] = defunc_0_f_res_57296;
            }
            for (int32_t i_86774 = 0; i_86774 < 128; i_86774++) {
                int64_t i_84911 = sext_i32_i64(i_86774);
                bool x_75164 = sle64((int64_t) 0, i_84911);
                bool y_75165 = slt64(i_84911, (int64_t) 128);
                bool bounds_check_75166 = x_75164 && y_75165;
                int64_t i_75167 = sdiv64(i_84911, (int64_t) 4);
                bool x_75168 = sle64((int64_t) 0, i_75167);
                bool y_75169 = slt64(i_75167, (int64_t) 32);
                bool bounds_check_75170 = x_75168 && y_75169;
                bool index_certs_75171;
                
                if (!bounds_check_75170) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Index [", (long long) i_75167,
                                        "] out of bounds for array of shape [",
                                        (long long) (int64_t) 32, "].",
                                        "-> #0  ../layers/groupnorm.fut:17:57-77\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  /prelude/functional.fut:39:59-65\n   #7  /prelude/soacs.fut:59:3-10\n   #8  /prelude/array.fut:216:3-39\n   #9  ../layers/groupnorm.fut:17:13-119\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                double y_75172 = ((double *) mem_98699)[i_75167];
                double x_75173 = ((double *) mem_98701)[i_75167];
                double sqrt_arg_75174 = 1.0e-5 + x_75173;
                double sqrt_res_75175 = futrts_sqrt64(sqrt_arg_75174);
                
                for (int32_t i_87582 = 0; i_87582 < 28; i_87582++) {
                    int64_t i_84897 = sext_i32_i64(i_87582);
                    bool x_75178 = sle64((int64_t) 0, i_84897);
                    bool y_75179 = slt64(i_84897, (int64_t) 28);
                    bool bounds_check_75180 = x_75178 && y_75179;
                    
                    for (int32_t i_87589 = 0; i_87589 < 28; i_87589++) {
                        int64_t i_84893 = sext_i32_i64(i_87589);
                        bool x_75183 = sle64((int64_t) 0, i_84893);
                        bool y_75184 = slt64(i_84893, (int64_t) 28);
                        bool bounds_check_75185 = x_75183 && y_75184;
                        bool y_75186 = bounds_check_75166 && bounds_check_75185;
                        bool index_ok_75187 = bounds_check_75180 && y_75186;
                        bool index_certs_75188;
                        
                        if (!index_ok_75187) {
                            set_error(ctx,
                                      msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                "Index [", (long long) i_84911,
                                                ", ", (long long) i_84897, ", ",
                                                (long long) i_84893,
                                                "] out of bounds for array of shape [",
                                                (long long) (int64_t) 128, "][",
                                                (long long) (int64_t) 28, "][",
                                                (long long) (int64_t) 28, "].",
                                                "-> #0  ../layers/groupnorm.fut:17:44-53\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  /prelude/functional.fut:39:59-65\n   #7  /prelude/soacs.fut:59:3-10\n   #8  /prelude/array.fut:216:3-39\n   #9  ../layers/groupnorm.fut:17:13-119\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        double x_75189 = ((double *) mem_98585)[i_84911 *
                                                                (int64_t) 784 +
                                                                i_84897 *
                                                                (int64_t) 28 +
                                                                i_84893];
                        double x_75190 = x_75189 - y_75172;
                        double defunc_0_f_res_75191 = x_75190 / sqrt_res_75175;
                        
                        ((double *) mem_98725)[i_84911 * (int64_t) 784 +
                                               i_84897 * (int64_t) 28 +
                                               i_84893] = defunc_0_f_res_75191;
                    }
                }
                for (int32_t i_87583 = 0; i_87583 < 30; i_87583++) {
                    int64_t i_84905 = sext_i32_i64(i_87583);
                    bool cond_75195 = slt64(i_84905, (int64_t) 1);
                    bool cond_f_res_75196 = sle64((int64_t) 29, i_84905);
                    bool x_75197 = !cond_75195;
                    bool y_75198 = cond_f_res_75196 && x_75197;
                    bool cond_75199 = cond_75195 || y_75198;
                    bool x_75200 = !cond_75199;
                    
                    for (int32_t i_87584 = 0; i_87584 < 30; i_87584++) {
                        int64_t i_84901 = sext_i32_i64(i_87584);
                        bool cond_f_res_75203 = slt64(i_84901, (int64_t) 1);
                        bool y_75204 = x_75200 && cond_f_res_75203;
                        bool cond_75205 = cond_75199 || y_75204;
                        bool cond_f_res_75206 = sle64((int64_t) 29, i_84901);
                        bool x_75207 = !cond_75205;
                        bool y_75208 = cond_f_res_75206 && x_75207;
                        bool cond_75209 = cond_75205 || y_75208;
                        double defunc_0_f_res_75210;
                        
                        if (cond_75209 == 1) {
                            defunc_0_f_res_75210 = 0.0;
                        } else {
                            int64_t i_75211 = sub64(i_84905, (int64_t) 1);
                            bool x_75212 = sle64((int64_t) 0, i_75211);
                            bool y_75213 = slt64(i_75211, (int64_t) 28);
                            bool bounds_check_75214 = x_75212 && y_75213;
                            int64_t i_75215 = sub64(i_84901, (int64_t) 1);
                            bool x_75216 = sle64((int64_t) 0, i_75215);
                            bool y_75217 = slt64(i_75215, (int64_t) 28);
                            bool bounds_check_75218 = x_75216 && y_75217;
                            bool index_ok_75219 = bounds_check_75214 &&
                                 bounds_check_75218;
                            bool index_certs_75220;
                            
                            if (!index_ok_75219) {
                                set_error(ctx,
                                          msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                    "Index [",
                                                    (long long) i_75211, ", ",
                                                    (long long) i_75215,
                                                    "] out of bounds for array of shape [",
                                                    (long long) (int64_t) 28,
                                                    "][",
                                                    (long long) (int64_t) 28,
                                                    "].",
                                                    "-> #0  ../layers/conv2d.fut:7:91-116\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  ../layers/conv2d.fut:6:22-7:117\n   #7  ../layers/conv2d.fut:6:6-7:123\n   #8  ../layers/conv2d.fut:22:7-30\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            double defunc_0_f_res_f_res_75221 =
                                   ((double *) mem_98725)[i_84911 *
                                                          (int64_t) 784 +
                                                          i_75211 *
                                                          (int64_t) 28 +
                                                          i_75215];
                            
                            defunc_0_f_res_75210 = defunc_0_f_res_f_res_75221;
                        }
                        ((double *) mem_98723)[i_84911 * (int64_t) 900 +
                                               i_84905 * (int64_t) 30 +
                                               i_84901] = defunc_0_f_res_75210;
                    }
                }
            }
            for (int32_t i_86775 = 0; i_86775 < 28; i_86775++) {
                int64_t i_84920 = sext_i32_i64(i_86775);
                int64_t j_57414 = add64((int64_t) 3, i_84920);
                int64_t i_p_m_t_s_57415 = add64((int64_t) 2, i_84920);
                bool zzero_leq_i_p_m_t_s_57416 = sle64((int64_t) 0,
                                                       i_p_m_t_s_57415);
                bool i_p_m_t_s_leq_w_57417 = slt64(i_p_m_t_s_57415,
                                                   (int64_t) 30);
                bool zzero_lte_i_57418 = sle64((int64_t) 0, i_84920);
                bool i_lte_j_57419 = sle64(i_84920, j_57414);
                bool y_57420 = i_p_m_t_s_leq_w_57417 && zzero_lte_i_57418;
                bool y_57421 = zzero_leq_i_p_m_t_s_57416 && y_57420;
                bool y_57422 = i_lte_j_57419 && y_57421;
                bool forwards_ok_57423 = zzero_lte_i_57418 && y_57422;
                
                for (int32_t i_87577 = 0; i_87577 < 28; i_87577++) {
                    int64_t i_84916 = sext_i32_i64(i_87577);
                    int64_t j_57427 = add64((int64_t) 3, i_84916);
                    int64_t i_p_m_t_s_57428 = add64((int64_t) 2, i_84916);
                    bool zzero_leq_i_p_m_t_s_57429 = sle64((int64_t) 0,
                                                           i_p_m_t_s_57428);
                    bool i_p_m_t_s_leq_w_57430 = slt64(i_p_m_t_s_57428,
                                                       (int64_t) 30);
                    bool zzero_lte_i_57431 = sle64((int64_t) 0, i_84916);
                    bool i_lte_j_57432 = sle64(i_84916, j_57427);
                    bool y_57433 = i_p_m_t_s_leq_w_57430 && zzero_lte_i_57431;
                    bool y_57434 = zzero_leq_i_p_m_t_s_57429 && y_57433;
                    bool y_57435 = i_lte_j_57432 && y_57434;
                    bool forwards_ok_57436 = zzero_lte_i_57431 && y_57435;
                    bool index_ok_57438 = forwards_ok_57423 &&
                         forwards_ok_57436;
                    bool index_certs_57439;
                    
                    if (!index_ok_57438) {
                        set_error(ctx,
                                  msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                            "Index [", (long long) i_84920, ":",
                                            (long long) j_57414, ", ",
                                            (long long) i_84916, ":",
                                            (long long) j_57427,
                                            "] out of bounds for array of shape [",
                                            (long long) (int64_t) 30, "][",
                                            (long long) (int64_t) 30, "].",
                                            "-> #0  ../layers/conv2d.fut:13:90-124\n   #1  ../layers/conv2d.fut:13:69-146\n   #2  /prelude/soacs.fut:59:3-10\n   #3  /prelude/array.fut:200:3-17\n   #4  /prelude/functional.fut:39:59-65\n   #5  /prelude/soacs.fut:59:3-10\n   #6  /prelude/array.fut:208:3-34\n   #7  ../layers/conv2d.fut:13:26-162\n   #8  ../layers/conv2d.fut:26:17-54\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    for (int64_t i_113976 = 0; i_113976 < (int64_t) 1152;
                         i_113976++) {
                        double tmp_113977 =
                               ((double *) mem_98723)[(int64_t) 30 * i_84920 +
                                                      i_84916 +
                                                      (squot64(i_113976,
                                                               (int64_t) 9) *
                                                       (int64_t) 900 +
                                                       squot64(i_113976 -
                                                               squot64(i_113976,
                                                                       (int64_t) 9) *
                                                               (int64_t) 9,
                                                               (int64_t) 3) *
                                                       (int64_t) 30 +
                                                       (i_113976 -
                                                        squot64(i_113976,
                                                                (int64_t) 9) *
                                                        (int64_t) 9 -
                                                        squot64(i_113976 -
                                                                squot64(i_113976,
                                                                        (int64_t) 9) *
                                                                (int64_t) 9,
                                                                (int64_t) 3) *
                                                        (int64_t) 3))];
                        
                        ((double *) mem_98891)[i_84920 * (int64_t) 32256 +
                                               i_84916 * (int64_t) 1152 +
                                               i_113976] = tmp_113977;
                    }
                }
            }
            for (int32_t i_86776 = 0; i_86776 < 256; i_86776++) {
                int64_t i_84930 = sext_i32_i64(i_86776);
                double x_75146 = ((double *) mem_param_96993.mem)[i_84930];
                int64_t binop_x_92305 = (int64_t) 1152 * i_84930;
                
                for (int32_t i_87575 = 0; i_87575 < 784; i_87575++) {
                    int64_t i_84926 = sext_i32_i64(i_87575);
                    int64_t binop_x_92371 = (int64_t) 1152 * i_84926;
                    double defunc_2_reduce_res_83906;
                    double redout_84922 = 0.0;
                    
                    for (int32_t i_87576 = 0; i_87576 < 1152; i_87576++) {
                        int64_t i_84923 = sext_i32_i64(i_87576);
                        int64_t binop_x_92306 = i_84923 + binop_x_92305;
                        int64_t new_index_92307 = squot64(binop_x_92306,
                                                          (int64_t) 1152);
                        int64_t binop_y_92313 = (int64_t) 1152 *
                                new_index_92307;
                        int64_t binop_x_92314 = binop_x_92306 - binop_y_92313;
                        int64_t new_index_92315 = squot64(binop_x_92314,
                                                          (int64_t) 9);
                        int64_t binop_y_92331 = (int64_t) 9 * new_index_92315;
                        int64_t binop_x_92332 = binop_x_92314 - binop_y_92331;
                        int64_t new_index_92333 = squot64(binop_x_92332,
                                                          (int64_t) 3);
                        int64_t binop_y_92369 = (int64_t) 3 * new_index_92333;
                        int64_t new_index_92370 = binop_x_92332 - binop_y_92369;
                        double x_78468 =
                               ((double *) mem_param_96988.mem)[new_index_92307 *
                                                                (int64_t) 1152 +
                                                                new_index_92315 *
                                                                (int64_t) 9 +
                                                                new_index_92333 *
                                                                (int64_t) 3 +
                                                                new_index_92370];
                        int64_t binop_x_92372 = i_84923 + binop_x_92371;
                        int64_t new_index_92373 = squot64(binop_x_92372,
                                                          (int64_t) 32256);
                        int64_t binop_y_92379 = (int64_t) 32256 *
                                new_index_92373;
                        int64_t binop_x_92380 = binop_x_92372 - binop_y_92379;
                        int64_t new_index_92381 = squot64(binop_x_92380,
                                                          (int64_t) 1152);
                        int64_t binop_y_92397 = (int64_t) 1152 *
                                new_index_92381;
                        int64_t new_index_92398 = binop_x_92380 - binop_y_92397;
                        double x_78469 =
                               ((double *) mem_98891)[new_index_92373 *
                                                      (int64_t) 32256 +
                                                      new_index_92381 *
                                                      (int64_t) 1152 +
                                                      new_index_92398];
                        double defunc_1_f_res_78470 = x_78468 * x_78469;
                        double defunc_1_op_res_78463 = defunc_1_f_res_78470 +
                               redout_84922;
                        double redout_tmp_113980 = defunc_1_op_res_78463;
                        
                        redout_84922 = redout_tmp_113980;
                    }
                    defunc_2_reduce_res_83906 = redout_84922;
                    
                    double defunc_0_f_res_78466 = x_75146 +
                           defunc_2_reduce_res_83906;
                    
                    ((double *) mem_98943)[i_84930 * (int64_t) 784 + i_84926] =
                        defunc_0_f_res_78466;
                }
            }
            for (int32_t i_86777 = 0; i_86777 < 256; i_86777++) {
                int64_t i_84942 = sext_i32_i64(i_86777);
                int64_t binop_x_92289 = (int64_t) 784 * i_84942;
                
                for (int32_t i_87573 = 0; i_87573 < 28; i_87573++) {
                    int64_t i_84938 = sext_i32_i64(i_87573);
                    int64_t binop_y_92290 = (int64_t) 28 * i_84938;
                    int64_t binop_x_92291 = binop_x_92289 + binop_y_92290;
                    
                    for (int32_t i_87574 = 0; i_87574 < 28; i_87574++) {
                        int64_t i_84934 = sext_i32_i64(i_87574);
                        int64_t binop_x_92292 = i_84934 + binop_x_92291;
                        int64_t new_index_92293 = squot64(binop_x_92292,
                                                          (int64_t) 784);
                        int64_t binop_y_92303 = (int64_t) 784 * new_index_92293;
                        int64_t new_index_92304 = binop_x_92292 - binop_y_92303;
                        double x_57482 =
                               ((double *) mem_98943)[new_index_92293 *
                                                      (int64_t) 784 +
                                                      new_index_92304];
                        double max_res_57483 = fmax64(0.0, x_57482);
                        
                        ((double *) mem_98983)[i_84942 * (int64_t) 784 +
                                               i_84938 * (int64_t) 28 +
                                               i_84934] = max_res_57483;
                    }
                }
            }
            for (int32_t i_86778 = 0; i_86778 < 32; i_86778++) {
                int64_t i_84946 = sext_i32_i64(i_86778);
                int64_t i_57494 = mul64((int64_t) 8, i_84946);
                int64_t x_57495 = add64((int64_t) 1, i_84946);
                int64_t j_57496 = mul64((int64_t) 8, x_57495);
                int64_t j_m_i_57497 = sub64(j_57496, i_57494);
                bool empty_slice_57498 = j_m_i_57497 == (int64_t) 0;
                int64_t m_57499 = sub64(j_m_i_57497, (int64_t) 1);
                int64_t i_p_m_t_s_57500 = add64(i_57494, m_57499);
                bool zzero_leq_i_p_m_t_s_57501 = sle64((int64_t) 0,
                                                       i_p_m_t_s_57500);
                bool i_p_m_t_s_leq_w_57502 = slt64(i_p_m_t_s_57500,
                                                   (int64_t) 256);
                bool zzero_lte_i_57503 = sle64((int64_t) 0, i_57494);
                bool i_lte_j_57504 = sle64(i_57494, j_57496);
                bool y_57505 = i_p_m_t_s_leq_w_57502 && zzero_lte_i_57503;
                bool y_57506 = zzero_leq_i_p_m_t_s_57501 && y_57505;
                bool y_57507 = i_lte_j_57504 && y_57506;
                bool forwards_ok_57508 = zzero_lte_i_57503 && y_57507;
                bool ok_or_empty_57509 = empty_slice_57498 || forwards_ok_57508;
                bool index_certs_57510;
                
                if (!ok_or_empty_57509) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Index [", (long long) i_57494, ":",
                                        (long long) j_57496,
                                        "] out of bounds for array of shape [",
                                        (long long) (int64_t) 256, "].",
                                        "-> #0  ../layers/groupnorm.fut:2:31-70\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  ../layers/groupnorm.fut:2:3-97\n   #4  ../layers/groupnorm.fut:15:19-54\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool dim_match_57511 = (int64_t) 8 == j_m_i_57497;
                bool empty_or_match_cert_57512;
                
                if (!dim_match_57511) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Value of (core language) shape (",
                                        (long long) j_m_i_57497, ", ",
                                        (long long) (int64_t) 28, ", ",
                                        (long long) (int64_t) 28,
                                        ") cannot match shape of type `[",
                                        (long long) (int64_t) 8, "][",
                                        (long long) (int64_t) 28, "][",
                                        (long long) (int64_t) 28, "]f64`.",
                                        "-> #0  ../layers/groupnorm.fut:2:31-96\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  ../layers/groupnorm.fut:2:3-97\n   #4  ../layers/groupnorm.fut:15:19-54\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if ((int64_t) 50176 > 0)
                    memmove(mem_99067 + i_84946 * (int64_t) 6272 * (int64_t) 8,
                            mem_98983 + (int64_t) 784 * i_57494 * (int64_t) 8,
                            (int64_t) 50176);
            }
            for (int32_t i_86779 = 0; i_86779 < 32; i_86779++) {
                int64_t i_84956 = sext_i32_i64(i_86779);
                int64_t binop_x_92223 = (int64_t) 6272 * i_84956;
                double defunc_2_reduce_res_83910;
                double redout_84948 = 0.0;
                
                for (int32_t i_87569 = 0; i_87569 < 6272; i_87569++) {
                    int64_t i_84949 = sext_i32_i64(i_87569);
                    int64_t binop_x_92224 = i_84949 + binop_x_92223;
                    int64_t new_index_92225 = squot64(binop_x_92224,
                                                      (int64_t) 6272);
                    int64_t binop_y_92231 = (int64_t) 6272 * new_index_92225;
                    int64_t binop_x_92232 = binop_x_92224 - binop_y_92231;
                    int64_t new_index_92233 = squot64(binop_x_92232,
                                                      (int64_t) 784);
                    int64_t binop_y_92249 = (int64_t) 784 * new_index_92233;
                    int64_t binop_x_92250 = binop_x_92232 - binop_y_92249;
                    int64_t new_index_92251 = squot64(binop_x_92250,
                                                      (int64_t) 28);
                    int64_t binop_y_92287 = (int64_t) 28 * new_index_92251;
                    int64_t new_index_92288 = binop_x_92250 - binop_y_92287;
                    double x_57528 = ((double *) mem_99067)[new_index_92225 *
                                                            (int64_t) 6272 +
                                                            new_index_92233 *
                                                            (int64_t) 784 +
                                                            new_index_92251 *
                                                            (int64_t) 28 +
                                                            new_index_92288];
                    double defunc_1_op_res_57527 = x_57528 + redout_84948;
                    double redout_tmp_113987 = defunc_1_op_res_57527;
                    
                    redout_84948 = redout_tmp_113987;
                }
                defunc_2_reduce_res_83910 = redout_84948;
                
                double calc_mean_flat_res_57529 = defunc_2_reduce_res_83910 /
                       6272.0;
                double defunc_2_reduce_res_83911;
                double redout_84950 = 0.0;
                
                for (int32_t i_87570 = 0; i_87570 < 6272; i_87570++) {
                    int64_t i_84951 = sext_i32_i64(i_87570);
                    int64_t binop_x_92158 = i_84951 + binop_x_92223;
                    int64_t new_index_92159 = squot64(binop_x_92158,
                                                      (int64_t) 6272);
                    int64_t binop_y_92165 = (int64_t) 6272 * new_index_92159;
                    int64_t binop_x_92166 = binop_x_92158 - binop_y_92165;
                    int64_t new_index_92167 = squot64(binop_x_92166,
                                                      (int64_t) 784);
                    int64_t binop_y_92183 = (int64_t) 784 * new_index_92167;
                    int64_t binop_x_92184 = binop_x_92166 - binop_y_92183;
                    int64_t new_index_92185 = squot64(binop_x_92184,
                                                      (int64_t) 28);
                    int64_t binop_y_92221 = (int64_t) 28 * new_index_92185;
                    int64_t new_index_92222 = binop_x_92184 - binop_y_92221;
                    double x_57536 = ((double *) mem_99067)[new_index_92159 *
                                                            (int64_t) 6272 +
                                                            new_index_92167 *
                                                            (int64_t) 784 +
                                                            new_index_92185 *
                                                            (int64_t) 28 +
                                                            new_index_92222];
                    double x_57533 = x_57536 - calc_mean_flat_res_57529;
                    double x_57534 = fpow64(x_57533, 2.0);
                    double defunc_1_op_res_57535 = x_57534 + redout_84950;
                    double redout_tmp_113988 = defunc_1_op_res_57535;
                    
                    redout_84950 = redout_tmp_113988;
                }
                defunc_2_reduce_res_83911 = redout_84950;
                
                double defunc_0_f_res_57537 = defunc_2_reduce_res_83911 /
                       6272.0;
                
                ((double *) mem_99097)[i_84956] = calc_mean_flat_res_57529;
                ((double *) mem_99099)[i_84956] = defunc_0_f_res_57537;
            }
            for (int32_t i_86780 = 0; i_86780 < 256; i_86780++) {
                int64_t i_84991 = sext_i32_i64(i_86780);
                double x_75066 = ((double *) mem_param_97006.mem)[i_84991];
                bool x_75067 = sle64((int64_t) 0, i_84991);
                bool y_75068 = slt64(i_84991, (int64_t) 256);
                bool bounds_check_75069 = x_75067 && y_75068;
                int64_t i_75070 = sdiv64(i_84991, (int64_t) 8);
                bool x_75071 = sle64((int64_t) 0, i_75070);
                bool y_75072 = slt64(i_75070, (int64_t) 32);
                bool bounds_check_75073 = x_75071 && y_75072;
                bool index_certs_75074;
                
                if (!bounds_check_75073) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Index [", (long long) i_75070,
                                        "] out of bounds for array of shape [",
                                        (long long) (int64_t) 32, "].",
                                        "-> #0  ../layers/groupnorm.fut:17:57-77\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  /prelude/functional.fut:39:59-65\n   #7  /prelude/soacs.fut:59:3-10\n   #8  /prelude/array.fut:216:3-39\n   #9  ../layers/groupnorm.fut:17:13-119\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                double y_75075 = ((double *) mem_99097)[i_75070];
                double x_75076 = ((double *) mem_99099)[i_75070];
                double sqrt_arg_75077 = 1.0e-5 + x_75076;
                double sqrt_res_75078 = futrts_sqrt64(sqrt_arg_75077);
                double defunc_2_reduce_res_83915;
                double redout_84959 = 0.0;
                
                for (int32_t i_87548 = 0; i_87548 < 256; i_87548++) {
                    int64_t i_84960 = sext_i32_i64(i_87548);
                    bool index_concat_cmp_87562 = sle64((int64_t) 128, i_84960);
                    double index_concat_branch_87566;
                    
                    if (index_concat_cmp_87562 == 1) {
                        int64_t index_concat_i_87563 = sub64(i_84960,
                                                             (int64_t) 128);
                        double index_concat_87564 =
                               ((double *) mem_97692)[index_concat_i_87563];
                        
                        index_concat_branch_87566 = index_concat_87564;
                    } else {
                        double index_concat_87565 =
                               ((double *) mem_97690)[i_84960];
                        
                        index_concat_branch_87566 = index_concat_87565;
                    }
                    
                    double x_78481 = ((double *) mem_param_97001.mem)[i_84991 *
                                                                      (int64_t) 256 +
                                                                      i_84960];
                    double defunc_1_f_res_78482 = x_78481 *
                           index_concat_branch_87566;
                    double defunc_1_op_res_75103 = defunc_1_f_res_78482 +
                           redout_84959;
                    double redout_tmp_113993 = defunc_1_op_res_75103;
                    
                    redout_84959 = redout_tmp_113993;
                }
                defunc_2_reduce_res_83915 = redout_84959;
                
                double defunc_1_f_res_75105 = x_75066 +
                       defunc_2_reduce_res_83915;
                double max_res_75107 = fmax64(0.0, defunc_1_f_res_75105);
                
                for (int32_t i_87549 = 0; i_87549 < 28; i_87549++) {
                    int64_t i_84972 = sext_i32_i64(i_87549);
                    bool x_78486 = sle64((int64_t) 0, i_84972);
                    bool y_78487 = slt64(i_84972, (int64_t) 28);
                    bool bounds_check_78488 = x_78486 && y_78487;
                    
                    for (int32_t i_87556 = 0; i_87556 < 28; i_87556++) {
                        int64_t i_84965 = sext_i32_i64(i_87556);
                        bool x_78506 = sle64((int64_t) 0, i_84965);
                        bool y_78507 = slt64(i_84965, (int64_t) 28);
                        bool bounds_check_78508 = x_78506 && y_78507;
                        bool y_78509 = bounds_check_75069 && bounds_check_78508;
                        bool index_ok_78510 = bounds_check_78488 && y_78509;
                        bool index_certs_78511;
                        
                        if (!index_ok_78510) {
                            set_error(ctx,
                                      msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                "Index [", (long long) i_84991,
                                                ", ", (long long) i_84972, ", ",
                                                (long long) i_84965,
                                                "] out of bounds for array of shape [",
                                                (long long) (int64_t) 256, "][",
                                                (long long) (int64_t) 28, "][",
                                                (long long) (int64_t) 28, "].",
                                                "-> #0  ../layers/groupnorm.fut:17:44-53\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  /prelude/functional.fut:39:59-65\n   #7  /prelude/soacs.fut:59:3-10\n   #8  /prelude/array.fut:216:3-39\n   #9  ../layers/groupnorm.fut:17:13-119\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        double x_78512 = ((double *) mem_98983)[i_84991 *
                                                                (int64_t) 784 +
                                                                i_84972 *
                                                                (int64_t) 28 +
                                                                i_84965];
                        double x_78513 = x_78512 - y_75075;
                        double defunc_0_f_res_78514 = x_78513 / sqrt_res_75078;
                        double defunc_0_f_res_78516 = max_res_75107 +
                               defunc_0_f_res_78514;
                        
                        ((double *) mem_99123)[i_84991 * (int64_t) 784 +
                                               i_84972 * (int64_t) 28 +
                                               i_84965] = defunc_0_f_res_78516;
                        ((double *) mem_99127)[i_84991 * (int64_t) 784 +
                                               i_84972 * (int64_t) 28 +
                                               i_84965] = defunc_0_f_res_78514;
                    }
                }
                for (int32_t i_87550 = 0; i_87550 < 30; i_87550++) {
                    int64_t i_84981 = sext_i32_i64(i_87550);
                    bool cond_75117 = slt64(i_84981, (int64_t) 1);
                    bool cond_f_res_75118 = sle64((int64_t) 29, i_84981);
                    bool x_75119 = !cond_75117;
                    bool y_75120 = cond_f_res_75118 && x_75119;
                    bool cond_75121 = cond_75117 || y_75120;
                    bool x_75122 = !cond_75121;
                    
                    for (int32_t i_87551 = 0; i_87551 < 30; i_87551++) {
                        int64_t i_84977 = sext_i32_i64(i_87551);
                        bool cond_f_res_75125 = slt64(i_84977, (int64_t) 1);
                        bool y_75126 = x_75122 && cond_f_res_75125;
                        bool cond_75127 = cond_75121 || y_75126;
                        bool cond_f_res_75128 = sle64((int64_t) 29, i_84977);
                        bool x_75129 = !cond_75127;
                        bool y_75130 = cond_f_res_75128 && x_75129;
                        bool cond_75131 = cond_75127 || y_75130;
                        double defunc_0_f_res_75132;
                        
                        if (cond_75131 == 1) {
                            defunc_0_f_res_75132 = 0.0;
                        } else {
                            int64_t i_75133 = sub64(i_84981, (int64_t) 1);
                            bool x_75134 = sle64((int64_t) 0, i_75133);
                            bool y_75135 = slt64(i_75133, (int64_t) 28);
                            bool bounds_check_75136 = x_75134 && y_75135;
                            int64_t i_75137 = sub64(i_84977, (int64_t) 1);
                            bool x_75138 = sle64((int64_t) 0, i_75137);
                            bool y_75139 = slt64(i_75137, (int64_t) 28);
                            bool bounds_check_75140 = x_75138 && y_75139;
                            bool index_ok_75141 = bounds_check_75136 &&
                                 bounds_check_75140;
                            bool index_certs_75142;
                            
                            if (!index_ok_75141) {
                                set_error(ctx,
                                          msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                    "Index [",
                                                    (long long) i_75133, ", ",
                                                    (long long) i_75137,
                                                    "] out of bounds for array of shape [",
                                                    (long long) (int64_t) 28,
                                                    "][",
                                                    (long long) (int64_t) 28,
                                                    "].",
                                                    "-> #0  ../layers/conv2d.fut:7:91-116\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  ../layers/conv2d.fut:6:22-7:117\n   #7  ../layers/conv2d.fut:6:6-7:123\n   #8  ../layers/conv2d.fut:22:7-30\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            double defunc_0_f_res_f_res_75143 =
                                   ((double *) mem_99123)[i_84991 *
                                                          (int64_t) 784 +
                                                          i_75133 *
                                                          (int64_t) 28 +
                                                          i_75137];
                            
                            defunc_0_f_res_75132 = defunc_0_f_res_f_res_75143;
                        }
                        ((double *) mem_99121)[i_84991 * (int64_t) 900 +
                                               i_84981 * (int64_t) 30 +
                                               i_84977] = defunc_0_f_res_75132;
                    }
                }
                ((double *) mem_99125)[i_84991] = defunc_1_f_res_75105;
            }
            for (int32_t i_86781 = 0; i_86781 < 28; i_86781++) {
                int64_t i_85002 = sext_i32_i64(i_86781);
                int64_t j_57653 = add64((int64_t) 3, i_85002);
                int64_t i_p_m_t_s_57654 = add64((int64_t) 2, i_85002);
                bool zzero_leq_i_p_m_t_s_57655 = sle64((int64_t) 0,
                                                       i_p_m_t_s_57654);
                bool i_p_m_t_s_leq_w_57656 = slt64(i_p_m_t_s_57654,
                                                   (int64_t) 30);
                bool zzero_lte_i_57657 = sle64((int64_t) 0, i_85002);
                bool i_lte_j_57658 = sle64(i_85002, j_57653);
                bool y_57659 = i_p_m_t_s_leq_w_57656 && zzero_lte_i_57657;
                bool y_57660 = zzero_leq_i_p_m_t_s_57655 && y_57659;
                bool y_57661 = i_lte_j_57658 && y_57660;
                bool forwards_ok_57662 = zzero_lte_i_57657 && y_57661;
                
                for (int32_t i_87543 = 0; i_87543 < 28; i_87543++) {
                    int64_t i_84998 = sext_i32_i64(i_87543);
                    int64_t j_57666 = add64((int64_t) 3, i_84998);
                    int64_t i_p_m_t_s_57667 = add64((int64_t) 2, i_84998);
                    bool zzero_leq_i_p_m_t_s_57668 = sle64((int64_t) 0,
                                                           i_p_m_t_s_57667);
                    bool i_p_m_t_s_leq_w_57669 = slt64(i_p_m_t_s_57667,
                                                       (int64_t) 30);
                    bool zzero_lte_i_57670 = sle64((int64_t) 0, i_84998);
                    bool i_lte_j_57671 = sle64(i_84998, j_57666);
                    bool y_57672 = i_p_m_t_s_leq_w_57669 && zzero_lte_i_57670;
                    bool y_57673 = zzero_leq_i_p_m_t_s_57668 && y_57672;
                    bool y_57674 = i_lte_j_57671 && y_57673;
                    bool forwards_ok_57675 = zzero_lte_i_57670 && y_57674;
                    bool index_ok_57677 = forwards_ok_57662 &&
                         forwards_ok_57675;
                    bool index_certs_57678;
                    
                    if (!index_ok_57677) {
                        set_error(ctx,
                                  msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                            "Index [", (long long) i_85002, ":",
                                            (long long) j_57653, ", ",
                                            (long long) i_84998, ":",
                                            (long long) j_57666,
                                            "] out of bounds for array of shape [",
                                            (long long) (int64_t) 30, "][",
                                            (long long) (int64_t) 30, "].",
                                            "-> #0  ../layers/conv2d.fut:13:90-124\n   #1  ../layers/conv2d.fut:13:69-146\n   #2  /prelude/soacs.fut:59:3-10\n   #3  /prelude/array.fut:200:3-17\n   #4  /prelude/functional.fut:39:59-65\n   #5  /prelude/soacs.fut:59:3-10\n   #6  /prelude/array.fut:208:3-34\n   #7  ../layers/conv2d.fut:13:26-162\n   #8  ../layers/conv2d.fut:26:17-54\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    for (int64_t i_114002 = 0; i_114002 < (int64_t) 2304;
                         i_114002++) {
                        double tmp_114003 =
                               ((double *) mem_99121)[(int64_t) 30 * i_85002 +
                                                      i_84998 +
                                                      (squot64(i_114002,
                                                               (int64_t) 9) *
                                                       (int64_t) 900 +
                                                       squot64(i_114002 -
                                                               squot64(i_114002,
                                                                       (int64_t) 9) *
                                                               (int64_t) 9,
                                                               (int64_t) 3) *
                                                       (int64_t) 30 +
                                                       (i_114002 -
                                                        squot64(i_114002,
                                                                (int64_t) 9) *
                                                        (int64_t) 9 -
                                                        squot64(i_114002 -
                                                                squot64(i_114002,
                                                                        (int64_t) 9) *
                                                                (int64_t) 9,
                                                                (int64_t) 3) *
                                                        (int64_t) 3))];
                        
                        ((double *) mem_99385)[i_85002 * (int64_t) 64512 +
                                               i_84998 * (int64_t) 2304 +
                                               i_114002] = tmp_114003;
                    }
                }
            }
            for (int32_t i_86782 = 0; i_86782 < 256; i_86782++) {
                int64_t i_85012 = sext_i32_i64(i_86782);
                double x_74917 = ((double *) mem_param_97025.mem)[i_85012];
                int64_t binop_x_92063 = (int64_t) 2304 * i_85012;
                
                for (int32_t i_87541 = 0; i_87541 < 784; i_87541++) {
                    int64_t i_85008 = sext_i32_i64(i_87541);
                    int64_t binop_x_92129 = (int64_t) 2304 * i_85008;
                    double defunc_2_reduce_res_83920;
                    double redout_85004 = 0.0;
                    
                    for (int32_t i_87542 = 0; i_87542 < 2304; i_87542++) {
                        int64_t i_85005 = sext_i32_i64(i_87542);
                        int64_t binop_x_92064 = i_85005 + binop_x_92063;
                        int64_t new_index_92065 = squot64(binop_x_92064,
                                                          (int64_t) 2304);
                        int64_t binop_y_92071 = (int64_t) 2304 *
                                new_index_92065;
                        int64_t binop_x_92072 = binop_x_92064 - binop_y_92071;
                        int64_t new_index_92073 = squot64(binop_x_92072,
                                                          (int64_t) 9);
                        int64_t binop_y_92089 = (int64_t) 9 * new_index_92073;
                        int64_t binop_x_92090 = binop_x_92072 - binop_y_92089;
                        int64_t new_index_92091 = squot64(binop_x_92090,
                                                          (int64_t) 3);
                        int64_t binop_y_92127 = (int64_t) 3 * new_index_92091;
                        int64_t new_index_92128 = binop_x_92090 - binop_y_92127;
                        double x_78542 =
                               ((double *) mem_param_97020.mem)[new_index_92065 *
                                                                (int64_t) 2304 +
                                                                new_index_92073 *
                                                                (int64_t) 9 +
                                                                new_index_92091 *
                                                                (int64_t) 3 +
                                                                new_index_92128];
                        int64_t binop_x_92130 = i_85005 + binop_x_92129;
                        int64_t new_index_92131 = squot64(binop_x_92130,
                                                          (int64_t) 64512);
                        int64_t binop_y_92137 = (int64_t) 64512 *
                                new_index_92131;
                        int64_t binop_x_92138 = binop_x_92130 - binop_y_92137;
                        int64_t new_index_92139 = squot64(binop_x_92138,
                                                          (int64_t) 2304);
                        int64_t binop_y_92155 = (int64_t) 2304 *
                                new_index_92139;
                        int64_t new_index_92156 = binop_x_92138 - binop_y_92155;
                        double x_78543 =
                               ((double *) mem_99385)[new_index_92131 *
                                                      (int64_t) 64512 +
                                                      new_index_92139 *
                                                      (int64_t) 2304 +
                                                      new_index_92156];
                        double defunc_1_f_res_78544 = x_78542 * x_78543;
                        double defunc_1_op_res_78537 = defunc_1_f_res_78544 +
                               redout_85004;
                        double redout_tmp_114006 = defunc_1_op_res_78537;
                        
                        redout_85004 = redout_tmp_114006;
                    }
                    defunc_2_reduce_res_83920 = redout_85004;
                    
                    double defunc_0_f_res_78540 = x_74917 +
                           defunc_2_reduce_res_83920;
                    
                    ((double *) mem_99437)[i_85012 * (int64_t) 784 + i_85008] =
                        defunc_0_f_res_78540;
                }
            }
            for (int32_t i_86783 = 0; i_86783 < 256; i_86783++) {
                int64_t i_85024 = sext_i32_i64(i_86783);
                int64_t binop_x_92047 = (int64_t) 784 * i_85024;
                
                for (int32_t i_87539 = 0; i_87539 < 28; i_87539++) {
                    int64_t i_85020 = sext_i32_i64(i_87539);
                    int64_t binop_y_92048 = (int64_t) 28 * i_85020;
                    int64_t binop_x_92049 = binop_x_92047 + binop_y_92048;
                    
                    for (int32_t i_87540 = 0; i_87540 < 28; i_87540++) {
                        int64_t i_85016 = sext_i32_i64(i_87540);
                        int64_t binop_x_92050 = i_85016 + binop_x_92049;
                        int64_t new_index_92051 = squot64(binop_x_92050,
                                                          (int64_t) 784);
                        int64_t binop_y_92061 = (int64_t) 784 * new_index_92051;
                        int64_t new_index_92062 = binop_x_92050 - binop_y_92061;
                        double x_57721 =
                               ((double *) mem_99437)[new_index_92051 *
                                                      (int64_t) 784 +
                                                      new_index_92062];
                        double max_res_57722 = fmax64(0.0, x_57721);
                        
                        ((double *) mem_99477)[i_85024 * (int64_t) 784 +
                                               i_85020 * (int64_t) 28 +
                                               i_85016] = max_res_57722;
                    }
                }
            }
            for (int32_t i_86784 = 0; i_86784 < 32; i_86784++) {
                int64_t i_85028 = sext_i32_i64(i_86784);
                int64_t i_57725 = mul64((int64_t) 8, i_85028);
                int64_t x_57726 = add64((int64_t) 1, i_85028);
                int64_t j_57727 = mul64((int64_t) 8, x_57726);
                int64_t j_m_i_57728 = sub64(j_57727, i_57725);
                bool empty_slice_57729 = j_m_i_57728 == (int64_t) 0;
                int64_t m_57730 = sub64(j_m_i_57728, (int64_t) 1);
                int64_t i_p_m_t_s_57731 = add64(i_57725, m_57730);
                bool zzero_leq_i_p_m_t_s_57732 = sle64((int64_t) 0,
                                                       i_p_m_t_s_57731);
                bool i_p_m_t_s_leq_w_57733 = slt64(i_p_m_t_s_57731,
                                                   (int64_t) 256);
                bool zzero_lte_i_57734 = sle64((int64_t) 0, i_57725);
                bool i_lte_j_57735 = sle64(i_57725, j_57727);
                bool y_57736 = i_p_m_t_s_leq_w_57733 && zzero_lte_i_57734;
                bool y_57737 = zzero_leq_i_p_m_t_s_57732 && y_57736;
                bool y_57738 = i_lte_j_57735 && y_57737;
                bool forwards_ok_57739 = zzero_lte_i_57734 && y_57738;
                bool ok_or_empty_57740 = empty_slice_57729 || forwards_ok_57739;
                bool index_certs_57741;
                
                if (!ok_or_empty_57740) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Index [", (long long) i_57725, ":",
                                        (long long) j_57727,
                                        "] out of bounds for array of shape [",
                                        (long long) (int64_t) 256, "].",
                                        "-> #0  ../layers/groupnorm.fut:2:31-70\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  ../layers/groupnorm.fut:2:3-97\n   #4  ../layers/groupnorm.fut:15:19-54\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool dim_match_57742 = (int64_t) 8 == j_m_i_57728;
                bool empty_or_match_cert_57743;
                
                if (!dim_match_57742) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Value of (core language) shape (",
                                        (long long) j_m_i_57728, ", ",
                                        (long long) (int64_t) 28, ", ",
                                        (long long) (int64_t) 28,
                                        ") cannot match shape of type `[",
                                        (long long) (int64_t) 8, "][",
                                        (long long) (int64_t) 28, "][",
                                        (long long) (int64_t) 28, "]f64`.",
                                        "-> #0  ../layers/groupnorm.fut:2:31-96\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  ../layers/groupnorm.fut:2:3-97\n   #4  ../layers/groupnorm.fut:15:19-54\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if ((int64_t) 50176 > 0)
                    memmove(mem_99561 + i_85028 * (int64_t) 6272 * (int64_t) 8,
                            mem_99477 + (int64_t) 784 * i_57725 * (int64_t) 8,
                            (int64_t) 50176);
            }
            for (int32_t i_86785 = 0; i_86785 < 32; i_86785++) {
                int64_t i_85038 = sext_i32_i64(i_86785);
                int64_t binop_x_91981 = (int64_t) 6272 * i_85038;
                double defunc_2_reduce_res_83924;
                double redout_85030 = 0.0;
                
                for (int32_t i_87535 = 0; i_87535 < 6272; i_87535++) {
                    int64_t i_85031 = sext_i32_i64(i_87535);
                    int64_t binop_x_91982 = i_85031 + binop_x_91981;
                    int64_t new_index_91983 = squot64(binop_x_91982,
                                                      (int64_t) 6272);
                    int64_t binop_y_91989 = (int64_t) 6272 * new_index_91983;
                    int64_t binop_x_91990 = binop_x_91982 - binop_y_91989;
                    int64_t new_index_91991 = squot64(binop_x_91990,
                                                      (int64_t) 784);
                    int64_t binop_y_92007 = (int64_t) 784 * new_index_91991;
                    int64_t binop_x_92008 = binop_x_91990 - binop_y_92007;
                    int64_t new_index_92009 = squot64(binop_x_92008,
                                                      (int64_t) 28);
                    int64_t binop_y_92045 = (int64_t) 28 * new_index_92009;
                    int64_t new_index_92046 = binop_x_92008 - binop_y_92045;
                    double x_57753 = ((double *) mem_99561)[new_index_91983 *
                                                            (int64_t) 6272 +
                                                            new_index_91991 *
                                                            (int64_t) 784 +
                                                            new_index_92009 *
                                                            (int64_t) 28 +
                                                            new_index_92046];
                    double defunc_1_op_res_57752 = x_57753 + redout_85030;
                    double redout_tmp_114013 = defunc_1_op_res_57752;
                    
                    redout_85030 = redout_tmp_114013;
                }
                defunc_2_reduce_res_83924 = redout_85030;
                
                double calc_mean_flat_res_57754 = defunc_2_reduce_res_83924 /
                       6272.0;
                double defunc_2_reduce_res_83925;
                double redout_85032 = 0.0;
                
                for (int32_t i_87536 = 0; i_87536 < 6272; i_87536++) {
                    int64_t i_85033 = sext_i32_i64(i_87536);
                    int64_t binop_x_91916 = i_85033 + binop_x_91981;
                    int64_t new_index_91917 = squot64(binop_x_91916,
                                                      (int64_t) 6272);
                    int64_t binop_y_91923 = (int64_t) 6272 * new_index_91917;
                    int64_t binop_x_91924 = binop_x_91916 - binop_y_91923;
                    int64_t new_index_91925 = squot64(binop_x_91924,
                                                      (int64_t) 784);
                    int64_t binop_y_91941 = (int64_t) 784 * new_index_91925;
                    int64_t binop_x_91942 = binop_x_91924 - binop_y_91941;
                    int64_t new_index_91943 = squot64(binop_x_91942,
                                                      (int64_t) 28);
                    int64_t binop_y_91979 = (int64_t) 28 * new_index_91943;
                    int64_t new_index_91980 = binop_x_91942 - binop_y_91979;
                    double x_57761 = ((double *) mem_99561)[new_index_91917 *
                                                            (int64_t) 6272 +
                                                            new_index_91925 *
                                                            (int64_t) 784 +
                                                            new_index_91943 *
                                                            (int64_t) 28 +
                                                            new_index_91980];
                    double x_57758 = x_57761 - calc_mean_flat_res_57754;
                    double x_57759 = fpow64(x_57758, 2.0);
                    double defunc_1_op_res_57760 = x_57759 + redout_85032;
                    double redout_tmp_114014 = defunc_1_op_res_57760;
                    
                    redout_85032 = redout_tmp_114014;
                }
                defunc_2_reduce_res_83925 = redout_85032;
                
                double defunc_0_f_res_57762 = defunc_2_reduce_res_83925 /
                       6272.0;
                
                ((double *) mem_99591)[i_85038] = calc_mean_flat_res_57754;
                ((double *) mem_99593)[i_85038] = defunc_0_f_res_57762;
            }
            for (int32_t i_86786 = 0; i_86786 < 256; i_86786++) {
                int64_t i_85051 = sext_i32_i64(i_86786);
                bool x_57765 = sle64((int64_t) 0, i_85051);
                bool y_57766 = slt64(i_85051, (int64_t) 256);
                bool bounds_check_57767 = x_57765 && y_57766;
                int64_t i_57768 = sdiv64(i_85051, (int64_t) 8);
                bool x_57769 = sle64((int64_t) 0, i_57768);
                bool y_57770 = slt64(i_57768, (int64_t) 32);
                bool bounds_check_57771 = x_57769 && y_57770;
                bool index_certs_57772;
                
                if (!bounds_check_57771) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Index [", (long long) i_57768,
                                        "] out of bounds for array of shape [",
                                        (long long) (int64_t) 32, "].",
                                        "-> #0  ../layers/groupnorm.fut:17:57-77\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  /prelude/functional.fut:39:59-65\n   #7  /prelude/soacs.fut:59:3-10\n   #8  /prelude/array.fut:216:3-39\n   #9  ../layers/groupnorm.fut:17:13-119\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                double y_57773 = ((double *) mem_99591)[i_57768];
                double x_57774 = ((double *) mem_99593)[i_57768];
                double sqrt_arg_57775 = 1.0e-5 + x_57774;
                double sqrt_res_57776 = futrts_sqrt64(sqrt_arg_57775);
                
                for (int32_t i_87527 = 0; i_87527 < 28; i_87527++) {
                    int64_t i_85047 = sext_i32_i64(i_87527);
                    bool x_57779 = sle64((int64_t) 0, i_85047);
                    bool y_57780 = slt64(i_85047, (int64_t) 28);
                    bool bounds_check_57781 = x_57779 && y_57780;
                    
                    for (int32_t i_87528 = 0; i_87528 < 28; i_87528++) {
                        int64_t i_85043 = sext_i32_i64(i_87528);
                        bool x_57784 = sle64((int64_t) 0, i_85043);
                        bool y_57785 = slt64(i_85043, (int64_t) 28);
                        bool bounds_check_57786 = x_57784 && y_57785;
                        bool y_57787 = bounds_check_57767 && bounds_check_57786;
                        bool index_ok_57788 = bounds_check_57781 && y_57787;
                        bool index_certs_57789;
                        
                        if (!index_ok_57788) {
                            set_error(ctx,
                                      msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                "Index [", (long long) i_85051,
                                                ", ", (long long) i_85047, ", ",
                                                (long long) i_85043,
                                                "] out of bounds for array of shape [",
                                                (long long) (int64_t) 256, "][",
                                                (long long) (int64_t) 28, "][",
                                                (long long) (int64_t) 28, "].",
                                                "-> #0  ../layers/groupnorm.fut:17:44-53\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  /prelude/functional.fut:39:59-65\n   #7  /prelude/soacs.fut:59:3-10\n   #8  /prelude/array.fut:216:3-39\n   #9  ../layers/groupnorm.fut:17:13-119\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        double x_57790 = ((double *) mem_99477)[i_85051 *
                                                                (int64_t) 784 +
                                                                i_85047 *
                                                                (int64_t) 28 +
                                                                i_85043];
                        double x_57791 = x_57790 - y_57773;
                        double defunc_0_f_res_57792 = x_57791 / sqrt_res_57776;
                        
                        ((double *) mem_99615)[i_85051 * (int64_t) 784 +
                                               i_85047 * (int64_t) 28 +
                                               i_85043] = defunc_0_f_res_57792;
                    }
                }
            }
            for (int32_t i_86787 = 0; i_86787 < 512; i_86787++) {
                int64_t i_85063 = sext_i32_i64(i_86787);
                
                for (int32_t i_87515 = 0; i_87515 < 30; i_87515++) {
                    int64_t i_85059 = sext_i32_i64(i_87515);
                    bool cond_57835 = slt64(i_85059, (int64_t) 1);
                    bool cond_f_res_57836 = sle64((int64_t) 29, i_85059);
                    bool x_57837 = !cond_57835;
                    bool y_57838 = cond_f_res_57836 && x_57837;
                    bool cond_57839 = cond_57835 || y_57838;
                    bool x_57840 = !cond_57839;
                    
                    for (int32_t i_87516 = 0; i_87516 < 30; i_87516++) {
                        int64_t i_85055 = sext_i32_i64(i_87516);
                        bool cond_f_res_57843 = slt64(i_85055, (int64_t) 1);
                        bool y_57844 = x_57840 && cond_f_res_57843;
                        bool cond_57845 = cond_57839 || y_57844;
                        bool cond_f_res_57846 = sle64((int64_t) 29, i_85055);
                        bool x_57847 = !cond_57845;
                        bool y_57848 = cond_f_res_57846 && x_57847;
                        bool cond_57849 = cond_57845 || y_57848;
                        double defunc_0_f_res_57850;
                        
                        if (cond_57849 == 1) {
                            defunc_0_f_res_57850 = 0.0;
                        } else {
                            int64_t i_57851 = sub64(i_85059, (int64_t) 1);
                            bool x_57852 = sle64((int64_t) 0, i_57851);
                            bool y_57853 = slt64(i_57851, (int64_t) 28);
                            bool bounds_check_57854 = x_57852 && y_57853;
                            int64_t i_57855 = sub64(i_85055, (int64_t) 1);
                            bool x_57856 = sle64((int64_t) 0, i_57855);
                            bool y_57857 = slt64(i_57855, (int64_t) 28);
                            bool bounds_check_57858 = x_57856 && y_57857;
                            bool index_ok_57859 = bounds_check_57854 &&
                                 bounds_check_57858;
                            bool index_certs_57860;
                            
                            if (!index_ok_57859) {
                                set_error(ctx,
                                          msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                    "Index [",
                                                    (long long) i_57851, ", ",
                                                    (long long) i_57855,
                                                    "] out of bounds for array of shape [",
                                                    (long long) (int64_t) 28,
                                                    "][",
                                                    (long long) (int64_t) 28,
                                                    "].",
                                                    "-> #0  ../layers/conv2d.fut:7:91-116\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  ../layers/conv2d.fut:6:22-7:117\n   #7  ../layers/conv2d.fut:6:6-7:123\n   #8  ../layers/conv2d.fut:22:7-30\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            bool index_concat_cmp_87518 = sle64((int64_t) 256,
                                                                i_85063);
                            double index_concat_branch_87522;
                            
                            if (index_concat_cmp_87518 == 1) {
                                int64_t index_concat_i_87519 = sub64(i_85063,
                                                                     (int64_t) 256);
                                double index_concat_87520 =
                                       ((double *) mem_99615)[index_concat_i_87519 *
                                                              (int64_t) 784 +
                                                              i_57851 *
                                                              (int64_t) 28 +
                                                              i_57855];
                                
                                index_concat_branch_87522 = index_concat_87520;
                            } else {
                                double index_concat_87521 =
                                       ((double *) mem_99615)[i_85063 *
                                                              (int64_t) 784 +
                                                              i_57851 *
                                                              (int64_t) 28 +
                                                              i_57855];
                                
                                index_concat_branch_87522 = index_concat_87521;
                            }
                            defunc_0_f_res_57850 = index_concat_branch_87522;
                        }
                        ((double *) mem_99699)[i_85063 * (int64_t) 900 +
                                               i_85059 * (int64_t) 30 +
                                               i_85055] = defunc_0_f_res_57850;
                    }
                }
            }
            for (int32_t i_86788 = 0; i_86788 < 28; i_86788++) {
                int64_t i_85071 = sext_i32_i64(i_86788);
                int64_t j_57880 = add64((int64_t) 3, i_85071);
                int64_t i_p_m_t_s_57881 = add64((int64_t) 2, i_85071);
                bool zzero_leq_i_p_m_t_s_57882 = sle64((int64_t) 0,
                                                       i_p_m_t_s_57881);
                bool i_p_m_t_s_leq_w_57883 = slt64(i_p_m_t_s_57881,
                                                   (int64_t) 30);
                bool zzero_lte_i_57884 = sle64((int64_t) 0, i_85071);
                bool i_lte_j_57885 = sle64(i_85071, j_57880);
                bool y_57886 = i_p_m_t_s_leq_w_57883 && zzero_lte_i_57884;
                bool y_57887 = zzero_leq_i_p_m_t_s_57882 && y_57886;
                bool y_57888 = i_lte_j_57885 && y_57887;
                bool forwards_ok_57889 = zzero_lte_i_57884 && y_57888;
                
                for (int32_t i_87510 = 0; i_87510 < 28; i_87510++) {
                    int64_t i_85067 = sext_i32_i64(i_87510);
                    int64_t j_57893 = add64((int64_t) 3, i_85067);
                    int64_t i_p_m_t_s_57894 = add64((int64_t) 2, i_85067);
                    bool zzero_leq_i_p_m_t_s_57895 = sle64((int64_t) 0,
                                                           i_p_m_t_s_57894);
                    bool i_p_m_t_s_leq_w_57896 = slt64(i_p_m_t_s_57894,
                                                       (int64_t) 30);
                    bool zzero_lte_i_57897 = sle64((int64_t) 0, i_85067);
                    bool i_lte_j_57898 = sle64(i_85067, j_57893);
                    bool y_57899 = i_p_m_t_s_leq_w_57896 && zzero_lte_i_57897;
                    bool y_57900 = zzero_leq_i_p_m_t_s_57895 && y_57899;
                    bool y_57901 = i_lte_j_57898 && y_57900;
                    bool forwards_ok_57902 = zzero_lte_i_57897 && y_57901;
                    bool index_ok_57904 = forwards_ok_57889 &&
                         forwards_ok_57902;
                    bool index_certs_57905;
                    
                    if (!index_ok_57904) {
                        set_error(ctx,
                                  msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                            "Index [", (long long) i_85071, ":",
                                            (long long) j_57880, ", ",
                                            (long long) i_85067, ":",
                                            (long long) j_57893,
                                            "] out of bounds for array of shape [",
                                            (long long) (int64_t) 30, "][",
                                            (long long) (int64_t) 30, "].",
                                            "-> #0  ../layers/conv2d.fut:13:90-124\n   #1  ../layers/conv2d.fut:13:69-146\n   #2  /prelude/soacs.fut:59:3-10\n   #3  /prelude/array.fut:200:3-17\n   #4  /prelude/functional.fut:39:59-65\n   #5  /prelude/soacs.fut:59:3-10\n   #6  /prelude/array.fut:208:3-34\n   #7  ../layers/conv2d.fut:13:26-162\n   #8  ../layers/conv2d.fut:26:17-54\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    for (int64_t i_114023 = 0; i_114023 < (int64_t) 4608;
                         i_114023++) {
                        double tmp_114024 =
                               ((double *) mem_99699)[(int64_t) 30 * i_85071 +
                                                      i_85067 +
                                                      (squot64(i_114023,
                                                               (int64_t) 9) *
                                                       (int64_t) 900 +
                                                       squot64(i_114023 -
                                                               squot64(i_114023,
                                                                       (int64_t) 9) *
                                                               (int64_t) 9,
                                                               (int64_t) 3) *
                                                       (int64_t) 30 +
                                                       (i_114023 -
                                                        squot64(i_114023,
                                                                (int64_t) 9) *
                                                        (int64_t) 9 -
                                                        squot64(i_114023 -
                                                                squot64(i_114023,
                                                                        (int64_t) 9) *
                                                                (int64_t) 9,
                                                                (int64_t) 3) *
                                                        (int64_t) 3))];
                        
                        ((double *) mem_99783)[i_85071 * (int64_t) 129024 +
                                               i_85067 * (int64_t) 4608 +
                                               i_114023] = tmp_114024;
                    }
                }
            }
            for (int32_t i_86789 = 0; i_86789 < 128; i_86789++) {
                int64_t i_85081 = sext_i32_i64(i_86789);
                double x_74899 = ((double *) mem_param_97044.mem)[i_85081];
                int64_t binop_x_91821 = (int64_t) 4608 * i_85081;
                
                for (int32_t i_87508 = 0; i_87508 < 784; i_87508++) {
                    int64_t i_85077 = sext_i32_i64(i_87508);
                    int64_t binop_x_91887 = (int64_t) 4608 * i_85077;
                    double defunc_2_reduce_res_83931;
                    double redout_85073 = 0.0;
                    
                    for (int32_t i_87509 = 0; i_87509 < 4608; i_87509++) {
                        int64_t i_85074 = sext_i32_i64(i_87509);
                        int64_t binop_x_91822 = i_85074 + binop_x_91821;
                        int64_t new_index_91823 = squot64(binop_x_91822,
                                                          (int64_t) 4608);
                        int64_t binop_y_91829 = (int64_t) 4608 *
                                new_index_91823;
                        int64_t binop_x_91830 = binop_x_91822 - binop_y_91829;
                        int64_t new_index_91831 = squot64(binop_x_91830,
                                                          (int64_t) 9);
                        int64_t binop_y_91847 = (int64_t) 9 * new_index_91831;
                        int64_t binop_x_91848 = binop_x_91830 - binop_y_91847;
                        int64_t new_index_91849 = squot64(binop_x_91848,
                                                          (int64_t) 3);
                        int64_t binop_y_91885 = (int64_t) 3 * new_index_91849;
                        int64_t new_index_91886 = binop_x_91848 - binop_y_91885;
                        double x_78572 =
                               ((double *) mem_param_97039.mem)[new_index_91823 *
                                                                (int64_t) 4608 +
                                                                new_index_91831 *
                                                                (int64_t) 9 +
                                                                new_index_91849 *
                                                                (int64_t) 3 +
                                                                new_index_91886];
                        int64_t binop_x_91888 = i_85074 + binop_x_91887;
                        int64_t new_index_91889 = squot64(binop_x_91888,
                                                          (int64_t) 129024);
                        int64_t binop_y_91895 = (int64_t) 129024 *
                                new_index_91889;
                        int64_t binop_x_91896 = binop_x_91888 - binop_y_91895;
                        int64_t new_index_91897 = squot64(binop_x_91896,
                                                          (int64_t) 4608);
                        int64_t binop_y_91913 = (int64_t) 4608 *
                                new_index_91897;
                        int64_t new_index_91914 = binop_x_91896 - binop_y_91913;
                        double x_78573 =
                               ((double *) mem_99783)[new_index_91889 *
                                                      (int64_t) 129024 +
                                                      new_index_91897 *
                                                      (int64_t) 4608 +
                                                      new_index_91914];
                        double defunc_1_f_res_78574 = x_78572 * x_78573;
                        double defunc_1_op_res_78567 = defunc_1_f_res_78574 +
                               redout_85073;
                        double redout_tmp_114027 = defunc_1_op_res_78567;
                        
                        redout_85073 = redout_tmp_114027;
                    }
                    defunc_2_reduce_res_83931 = redout_85073;
                    
                    double defunc_0_f_res_78570 = x_74899 +
                           defunc_2_reduce_res_83931;
                    
                    ((double *) mem_99835)[i_85081 * (int64_t) 784 + i_85077] =
                        defunc_0_f_res_78570;
                }
            }
            for (int32_t i_86790 = 0; i_86790 < 128; i_86790++) {
                int64_t i_85093 = sext_i32_i64(i_86790);
                int64_t binop_x_91805 = (int64_t) 784 * i_85093;
                
                for (int32_t i_87506 = 0; i_87506 < 28; i_87506++) {
                    int64_t i_85089 = sext_i32_i64(i_87506);
                    int64_t binop_y_91806 = (int64_t) 28 * i_85089;
                    int64_t binop_x_91807 = binop_x_91805 + binop_y_91806;
                    
                    for (int32_t i_87507 = 0; i_87507 < 28; i_87507++) {
                        int64_t i_85085 = sext_i32_i64(i_87507);
                        int64_t binop_x_91808 = i_85085 + binop_x_91807;
                        int64_t new_index_91809 = squot64(binop_x_91808,
                                                          (int64_t) 784);
                        int64_t binop_y_91819 = (int64_t) 784 * new_index_91809;
                        int64_t new_index_91820 = binop_x_91808 - binop_y_91819;
                        double x_57948 =
                               ((double *) mem_99835)[new_index_91809 *
                                                      (int64_t) 784 +
                                                      new_index_91820];
                        double max_res_57949 = fmax64(0.0, x_57948);
                        
                        ((double *) mem_99875)[i_85093 * (int64_t) 784 +
                                               i_85089 * (int64_t) 28 +
                                               i_85085] = max_res_57949;
                    }
                }
            }
            for (int32_t i_86791 = 0; i_86791 < 32; i_86791++) {
                int64_t i_85097 = sext_i32_i64(i_86791);
                int64_t i_57960 = mul64((int64_t) 4, i_85097);
                int64_t x_57961 = add64((int64_t) 1, i_85097);
                int64_t j_57962 = mul64((int64_t) 4, x_57961);
                int64_t j_m_i_57963 = sub64(j_57962, i_57960);
                bool empty_slice_57964 = j_m_i_57963 == (int64_t) 0;
                int64_t m_57965 = sub64(j_m_i_57963, (int64_t) 1);
                int64_t i_p_m_t_s_57966 = add64(i_57960, m_57965);
                bool zzero_leq_i_p_m_t_s_57967 = sle64((int64_t) 0,
                                                       i_p_m_t_s_57966);
                bool i_p_m_t_s_leq_w_57968 = slt64(i_p_m_t_s_57966,
                                                   (int64_t) 128);
                bool zzero_lte_i_57969 = sle64((int64_t) 0, i_57960);
                bool i_lte_j_57970 = sle64(i_57960, j_57962);
                bool y_57971 = i_p_m_t_s_leq_w_57968 && zzero_lte_i_57969;
                bool y_57972 = zzero_leq_i_p_m_t_s_57967 && y_57971;
                bool y_57973 = i_lte_j_57970 && y_57972;
                bool forwards_ok_57974 = zzero_lte_i_57969 && y_57973;
                bool ok_or_empty_57975 = empty_slice_57964 || forwards_ok_57974;
                bool index_certs_57976;
                
                if (!ok_or_empty_57975) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Index [", (long long) i_57960, ":",
                                        (long long) j_57962,
                                        "] out of bounds for array of shape [",
                                        (long long) (int64_t) 128, "].",
                                        "-> #0  ../layers/groupnorm.fut:2:31-70\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  ../layers/groupnorm.fut:2:3-97\n   #4  ../layers/groupnorm.fut:15:19-54\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool dim_match_57977 = (int64_t) 4 == j_m_i_57963;
                bool empty_or_match_cert_57978;
                
                if (!dim_match_57977) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Value of (core language) shape (",
                                        (long long) j_m_i_57963, ", ",
                                        (long long) (int64_t) 28, ", ",
                                        (long long) (int64_t) 28,
                                        ") cannot match shape of type `[",
                                        (long long) (int64_t) 4, "][",
                                        (long long) (int64_t) 28, "][",
                                        (long long) (int64_t) 28, "]f64`.",
                                        "-> #0  ../layers/groupnorm.fut:2:31-96\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  ../layers/groupnorm.fut:2:3-97\n   #4  ../layers/groupnorm.fut:15:19-54\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if ((int64_t) 25088 > 0)
                    memmove(mem_99959 + i_85097 * (int64_t) 3136 * (int64_t) 8,
                            mem_99875 + (int64_t) 784 * i_57960 * (int64_t) 8,
                            (int64_t) 25088);
            }
            for (int32_t i_86792 = 0; i_86792 < 32; i_86792++) {
                int64_t i_85107 = sext_i32_i64(i_86792);
                int64_t binop_x_91739 = (int64_t) 3136 * i_85107;
                double defunc_2_reduce_res_83935;
                double redout_85099 = 0.0;
                
                for (int32_t i_87502 = 0; i_87502 < 3136; i_87502++) {
                    int64_t i_85100 = sext_i32_i64(i_87502);
                    int64_t binop_x_91740 = i_85100 + binop_x_91739;
                    int64_t new_index_91741 = squot64(binop_x_91740,
                                                      (int64_t) 3136);
                    int64_t binop_y_91747 = (int64_t) 3136 * new_index_91741;
                    int64_t binop_x_91748 = binop_x_91740 - binop_y_91747;
                    int64_t new_index_91749 = squot64(binop_x_91748,
                                                      (int64_t) 784);
                    int64_t binop_y_91765 = (int64_t) 784 * new_index_91749;
                    int64_t binop_x_91766 = binop_x_91748 - binop_y_91765;
                    int64_t new_index_91767 = squot64(binop_x_91766,
                                                      (int64_t) 28);
                    int64_t binop_y_91803 = (int64_t) 28 * new_index_91767;
                    int64_t new_index_91804 = binop_x_91766 - binop_y_91803;
                    double x_57994 = ((double *) mem_99959)[new_index_91741 *
                                                            (int64_t) 3136 +
                                                            new_index_91749 *
                                                            (int64_t) 784 +
                                                            new_index_91767 *
                                                            (int64_t) 28 +
                                                            new_index_91804];
                    double defunc_1_op_res_57993 = x_57994 + redout_85099;
                    double redout_tmp_114034 = defunc_1_op_res_57993;
                    
                    redout_85099 = redout_tmp_114034;
                }
                defunc_2_reduce_res_83935 = redout_85099;
                
                double calc_mean_flat_res_57995 = defunc_2_reduce_res_83935 /
                       3136.0;
                double defunc_2_reduce_res_83936;
                double redout_85101 = 0.0;
                
                for (int32_t i_87503 = 0; i_87503 < 3136; i_87503++) {
                    int64_t i_85102 = sext_i32_i64(i_87503);
                    int64_t binop_x_91674 = i_85102 + binop_x_91739;
                    int64_t new_index_91675 = squot64(binop_x_91674,
                                                      (int64_t) 3136);
                    int64_t binop_y_91681 = (int64_t) 3136 * new_index_91675;
                    int64_t binop_x_91682 = binop_x_91674 - binop_y_91681;
                    int64_t new_index_91683 = squot64(binop_x_91682,
                                                      (int64_t) 784);
                    int64_t binop_y_91699 = (int64_t) 784 * new_index_91683;
                    int64_t binop_x_91700 = binop_x_91682 - binop_y_91699;
                    int64_t new_index_91701 = squot64(binop_x_91700,
                                                      (int64_t) 28);
                    int64_t binop_y_91737 = (int64_t) 28 * new_index_91701;
                    int64_t new_index_91738 = binop_x_91700 - binop_y_91737;
                    double x_58002 = ((double *) mem_99959)[new_index_91675 *
                                                            (int64_t) 3136 +
                                                            new_index_91683 *
                                                            (int64_t) 784 +
                                                            new_index_91701 *
                                                            (int64_t) 28 +
                                                            new_index_91738];
                    double x_57999 = x_58002 - calc_mean_flat_res_57995;
                    double x_58000 = fpow64(x_57999, 2.0);
                    double defunc_1_op_res_58001 = x_58000 + redout_85101;
                    double redout_tmp_114035 = defunc_1_op_res_58001;
                    
                    redout_85101 = redout_tmp_114035;
                }
                defunc_2_reduce_res_83936 = redout_85101;
                
                double defunc_0_f_res_58003 = defunc_2_reduce_res_83936 /
                       3136.0;
                
                ((double *) mem_99989)[i_85107] = calc_mean_flat_res_57995;
                ((double *) mem_99991)[i_85107] = defunc_0_f_res_58003;
            }
            for (int32_t i_86793 = 0; i_86793 < 128; i_86793++) {
                int64_t i_85142 = sext_i32_i64(i_86793);
                double x_74819 = ((double *) mem_param_97057.mem)[i_85142];
                bool x_74820 = sle64((int64_t) 0, i_85142);
                bool y_74821 = slt64(i_85142, (int64_t) 128);
                bool bounds_check_74822 = x_74820 && y_74821;
                int64_t i_74823 = sdiv64(i_85142, (int64_t) 4);
                bool x_74824 = sle64((int64_t) 0, i_74823);
                bool y_74825 = slt64(i_74823, (int64_t) 32);
                bool bounds_check_74826 = x_74824 && y_74825;
                bool index_certs_74827;
                
                if (!bounds_check_74826) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Index [", (long long) i_74823,
                                        "] out of bounds for array of shape [",
                                        (long long) (int64_t) 32, "].",
                                        "-> #0  ../layers/groupnorm.fut:17:57-77\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  /prelude/functional.fut:39:59-65\n   #7  /prelude/soacs.fut:59:3-10\n   #8  /prelude/array.fut:216:3-39\n   #9  ../layers/groupnorm.fut:17:13-119\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                double y_74828 = ((double *) mem_99989)[i_74823];
                double x_74829 = ((double *) mem_99991)[i_74823];
                double sqrt_arg_74830 = 1.0e-5 + x_74829;
                double sqrt_res_74831 = futrts_sqrt64(sqrt_arg_74830);
                double defunc_2_reduce_res_83940;
                double redout_85110 = 0.0;
                
                for (int32_t i_87481 = 0; i_87481 < 256; i_87481++) {
                    int64_t i_85111 = sext_i32_i64(i_87481);
                    bool index_concat_cmp_87495 = sle64((int64_t) 128, i_85111);
                    double index_concat_branch_87499;
                    
                    if (index_concat_cmp_87495 == 1) {
                        int64_t index_concat_i_87496 = sub64(i_85111,
                                                             (int64_t) 128);
                        double index_concat_87497 =
                               ((double *) mem_97692)[index_concat_i_87496];
                        
                        index_concat_branch_87499 = index_concat_87497;
                    } else {
                        double index_concat_87498 =
                               ((double *) mem_97690)[i_85111];
                        
                        index_concat_branch_87499 = index_concat_87498;
                    }
                    
                    double x_78585 = ((double *) mem_param_97052.mem)[i_85142 *
                                                                      (int64_t) 256 +
                                                                      i_85111];
                    double defunc_1_f_res_78586 = x_78585 *
                           index_concat_branch_87499;
                    double defunc_1_op_res_74856 = defunc_1_f_res_78586 +
                           redout_85110;
                    double redout_tmp_114040 = defunc_1_op_res_74856;
                    
                    redout_85110 = redout_tmp_114040;
                }
                defunc_2_reduce_res_83940 = redout_85110;
                
                double defunc_1_f_res_74858 = x_74819 +
                       defunc_2_reduce_res_83940;
                double max_res_74860 = fmax64(0.0, defunc_1_f_res_74858);
                
                for (int32_t i_87482 = 0; i_87482 < 28; i_87482++) {
                    int64_t i_85123 = sext_i32_i64(i_87482);
                    bool x_78590 = sle64((int64_t) 0, i_85123);
                    bool y_78591 = slt64(i_85123, (int64_t) 28);
                    bool bounds_check_78592 = x_78590 && y_78591;
                    
                    for (int32_t i_87489 = 0; i_87489 < 28; i_87489++) {
                        int64_t i_85116 = sext_i32_i64(i_87489);
                        bool x_78610 = sle64((int64_t) 0, i_85116);
                        bool y_78611 = slt64(i_85116, (int64_t) 28);
                        bool bounds_check_78612 = x_78610 && y_78611;
                        bool y_78613 = bounds_check_74822 && bounds_check_78612;
                        bool index_ok_78614 = bounds_check_78592 && y_78613;
                        bool index_certs_78615;
                        
                        if (!index_ok_78614) {
                            set_error(ctx,
                                      msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                "Index [", (long long) i_85142,
                                                ", ", (long long) i_85123, ", ",
                                                (long long) i_85116,
                                                "] out of bounds for array of shape [",
                                                (long long) (int64_t) 128, "][",
                                                (long long) (int64_t) 28, "][",
                                                (long long) (int64_t) 28, "].",
                                                "-> #0  ../layers/groupnorm.fut:17:44-53\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  /prelude/functional.fut:39:59-65\n   #7  /prelude/soacs.fut:59:3-10\n   #8  /prelude/array.fut:216:3-39\n   #9  ../layers/groupnorm.fut:17:13-119\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        double x_78616 = ((double *) mem_99875)[i_85142 *
                                                                (int64_t) 784 +
                                                                i_85123 *
                                                                (int64_t) 28 +
                                                                i_85116];
                        double x_78617 = x_78616 - y_74828;
                        double defunc_0_f_res_78618 = x_78617 / sqrt_res_74831;
                        double defunc_0_f_res_78620 = max_res_74860 +
                               defunc_0_f_res_78618;
                        
                        ((double *) mem_100015)[i_85142 * (int64_t) 784 +
                                                i_85123 * (int64_t) 28 +
                                                i_85116] = defunc_0_f_res_78620;
                        ((double *) mem_100019)[i_85142 * (int64_t) 784 +
                                                i_85123 * (int64_t) 28 +
                                                i_85116] = defunc_0_f_res_78618;
                    }
                }
                for (int32_t i_87483 = 0; i_87483 < 30; i_87483++) {
                    int64_t i_85132 = sext_i32_i64(i_87483);
                    bool cond_74870 = slt64(i_85132, (int64_t) 1);
                    bool cond_f_res_74871 = sle64((int64_t) 29, i_85132);
                    bool x_74872 = !cond_74870;
                    bool y_74873 = cond_f_res_74871 && x_74872;
                    bool cond_74874 = cond_74870 || y_74873;
                    bool x_74875 = !cond_74874;
                    
                    for (int32_t i_87484 = 0; i_87484 < 30; i_87484++) {
                        int64_t i_85128 = sext_i32_i64(i_87484);
                        bool cond_f_res_74878 = slt64(i_85128, (int64_t) 1);
                        bool y_74879 = x_74875 && cond_f_res_74878;
                        bool cond_74880 = cond_74874 || y_74879;
                        bool cond_f_res_74881 = sle64((int64_t) 29, i_85128);
                        bool x_74882 = !cond_74880;
                        bool y_74883 = cond_f_res_74881 && x_74882;
                        bool cond_74884 = cond_74880 || y_74883;
                        double defunc_0_f_res_74885;
                        
                        if (cond_74884 == 1) {
                            defunc_0_f_res_74885 = 0.0;
                        } else {
                            int64_t i_74886 = sub64(i_85132, (int64_t) 1);
                            bool x_74887 = sle64((int64_t) 0, i_74886);
                            bool y_74888 = slt64(i_74886, (int64_t) 28);
                            bool bounds_check_74889 = x_74887 && y_74888;
                            int64_t i_74890 = sub64(i_85128, (int64_t) 1);
                            bool x_74891 = sle64((int64_t) 0, i_74890);
                            bool y_74892 = slt64(i_74890, (int64_t) 28);
                            bool bounds_check_74893 = x_74891 && y_74892;
                            bool index_ok_74894 = bounds_check_74889 &&
                                 bounds_check_74893;
                            bool index_certs_74895;
                            
                            if (!index_ok_74894) {
                                set_error(ctx,
                                          msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                    "Index [",
                                                    (long long) i_74886, ", ",
                                                    (long long) i_74890,
                                                    "] out of bounds for array of shape [",
                                                    (long long) (int64_t) 28,
                                                    "][",
                                                    (long long) (int64_t) 28,
                                                    "].",
                                                    "-> #0  ../layers/conv2d.fut:7:91-116\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  ../layers/conv2d.fut:6:22-7:117\n   #7  ../layers/conv2d.fut:6:6-7:123\n   #8  ../layers/conv2d.fut:22:7-30\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            double defunc_0_f_res_f_res_74896 =
                                   ((double *) mem_100015)[i_85142 *
                                                           (int64_t) 784 +
                                                           i_74886 *
                                                           (int64_t) 28 +
                                                           i_74890];
                            
                            defunc_0_f_res_74885 = defunc_0_f_res_f_res_74896;
                        }
                        ((double *) mem_100013)[i_85142 * (int64_t) 900 +
                                                i_85132 * (int64_t) 30 +
                                                i_85128] = defunc_0_f_res_74885;
                    }
                }
                ((double *) mem_100017)[i_85142] = defunc_1_f_res_74858;
            }
            for (int32_t i_86794 = 0; i_86794 < 28; i_86794++) {
                int64_t i_85153 = sext_i32_i64(i_86794);
                int64_t j_58119 = add64((int64_t) 3, i_85153);
                int64_t i_p_m_t_s_58120 = add64((int64_t) 2, i_85153);
                bool zzero_leq_i_p_m_t_s_58121 = sle64((int64_t) 0,
                                                       i_p_m_t_s_58120);
                bool i_p_m_t_s_leq_w_58122 = slt64(i_p_m_t_s_58120,
                                                   (int64_t) 30);
                bool zzero_lte_i_58123 = sle64((int64_t) 0, i_85153);
                bool i_lte_j_58124 = sle64(i_85153, j_58119);
                bool y_58125 = i_p_m_t_s_leq_w_58122 && zzero_lte_i_58123;
                bool y_58126 = zzero_leq_i_p_m_t_s_58121 && y_58125;
                bool y_58127 = i_lte_j_58124 && y_58126;
                bool forwards_ok_58128 = zzero_lte_i_58123 && y_58127;
                
                for (int32_t i_87476 = 0; i_87476 < 28; i_87476++) {
                    int64_t i_85149 = sext_i32_i64(i_87476);
                    int64_t j_58132 = add64((int64_t) 3, i_85149);
                    int64_t i_p_m_t_s_58133 = add64((int64_t) 2, i_85149);
                    bool zzero_leq_i_p_m_t_s_58134 = sle64((int64_t) 0,
                                                           i_p_m_t_s_58133);
                    bool i_p_m_t_s_leq_w_58135 = slt64(i_p_m_t_s_58133,
                                                       (int64_t) 30);
                    bool zzero_lte_i_58136 = sle64((int64_t) 0, i_85149);
                    bool i_lte_j_58137 = sle64(i_85149, j_58132);
                    bool y_58138 = i_p_m_t_s_leq_w_58135 && zzero_lte_i_58136;
                    bool y_58139 = zzero_leq_i_p_m_t_s_58134 && y_58138;
                    bool y_58140 = i_lte_j_58137 && y_58139;
                    bool forwards_ok_58141 = zzero_lte_i_58136 && y_58140;
                    bool index_ok_58143 = forwards_ok_58128 &&
                         forwards_ok_58141;
                    bool index_certs_58144;
                    
                    if (!index_ok_58143) {
                        set_error(ctx,
                                  msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                            "Index [", (long long) i_85153, ":",
                                            (long long) j_58119, ", ",
                                            (long long) i_85149, ":",
                                            (long long) j_58132,
                                            "] out of bounds for array of shape [",
                                            (long long) (int64_t) 30, "][",
                                            (long long) (int64_t) 30, "].",
                                            "-> #0  ../layers/conv2d.fut:13:90-124\n   #1  ../layers/conv2d.fut:13:69-146\n   #2  /prelude/soacs.fut:59:3-10\n   #3  /prelude/array.fut:200:3-17\n   #4  /prelude/functional.fut:39:59-65\n   #5  /prelude/soacs.fut:59:3-10\n   #6  /prelude/array.fut:208:3-34\n   #7  ../layers/conv2d.fut:13:26-162\n   #8  ../layers/conv2d.fut:26:17-54\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    for (int64_t i_114049 = 0; i_114049 < (int64_t) 1152;
                         i_114049++) {
                        double tmp_114050 =
                               ((double *) mem_100013)[(int64_t) 30 * i_85153 +
                                                       i_85149 +
                                                       (squot64(i_114049,
                                                                (int64_t) 9) *
                                                        (int64_t) 900 +
                                                        squot64(i_114049 -
                                                                squot64(i_114049,
                                                                        (int64_t) 9) *
                                                                (int64_t) 9,
                                                                (int64_t) 3) *
                                                        (int64_t) 30 +
                                                        (i_114049 -
                                                         squot64(i_114049,
                                                                 (int64_t) 9) *
                                                         (int64_t) 9 -
                                                         squot64(i_114049 -
                                                                 squot64(i_114049,
                                                                         (int64_t) 9) *
                                                                 (int64_t) 9,
                                                                 (int64_t) 3) *
                                                         (int64_t) 3))];
                        
                        ((double *) mem_100277)[i_85153 * (int64_t) 32256 +
                                                i_85149 * (int64_t) 1152 +
                                                i_114049] = tmp_114050;
                    }
                }
            }
            for (int32_t i_86795 = 0; i_86795 < 128; i_86795++) {
                int64_t i_85163 = sext_i32_i64(i_86795);
                double x_74670 = ((double *) mem_param_97076.mem)[i_85163];
                int64_t binop_x_91579 = (int64_t) 1152 * i_85163;
                
                for (int32_t i_87474 = 0; i_87474 < 784; i_87474++) {
                    int64_t i_85159 = sext_i32_i64(i_87474);
                    int64_t binop_x_91645 = (int64_t) 1152 * i_85159;
                    double defunc_2_reduce_res_83945;
                    double redout_85155 = 0.0;
                    
                    for (int32_t i_87475 = 0; i_87475 < 1152; i_87475++) {
                        int64_t i_85156 = sext_i32_i64(i_87475);
                        int64_t binop_x_91580 = i_85156 + binop_x_91579;
                        int64_t new_index_91581 = squot64(binop_x_91580,
                                                          (int64_t) 1152);
                        int64_t binop_y_91587 = (int64_t) 1152 *
                                new_index_91581;
                        int64_t binop_x_91588 = binop_x_91580 - binop_y_91587;
                        int64_t new_index_91589 = squot64(binop_x_91588,
                                                          (int64_t) 9);
                        int64_t binop_y_91605 = (int64_t) 9 * new_index_91589;
                        int64_t binop_x_91606 = binop_x_91588 - binop_y_91605;
                        int64_t new_index_91607 = squot64(binop_x_91606,
                                                          (int64_t) 3);
                        int64_t binop_y_91643 = (int64_t) 3 * new_index_91607;
                        int64_t new_index_91644 = binop_x_91606 - binop_y_91643;
                        double x_78646 =
                               ((double *) mem_param_97071.mem)[new_index_91581 *
                                                                (int64_t) 1152 +
                                                                new_index_91589 *
                                                                (int64_t) 9 +
                                                                new_index_91607 *
                                                                (int64_t) 3 +
                                                                new_index_91644];
                        int64_t binop_x_91646 = i_85156 + binop_x_91645;
                        int64_t new_index_91647 = squot64(binop_x_91646,
                                                          (int64_t) 32256);
                        int64_t binop_y_91653 = (int64_t) 32256 *
                                new_index_91647;
                        int64_t binop_x_91654 = binop_x_91646 - binop_y_91653;
                        int64_t new_index_91655 = squot64(binop_x_91654,
                                                          (int64_t) 1152);
                        int64_t binop_y_91671 = (int64_t) 1152 *
                                new_index_91655;
                        int64_t new_index_91672 = binop_x_91654 - binop_y_91671;
                        double x_78647 =
                               ((double *) mem_100277)[new_index_91647 *
                                                       (int64_t) 32256 +
                                                       new_index_91655 *
                                                       (int64_t) 1152 +
                                                       new_index_91672];
                        double defunc_1_f_res_78648 = x_78646 * x_78647;
                        double defunc_1_op_res_78641 = defunc_1_f_res_78648 +
                               redout_85155;
                        double redout_tmp_114053 = defunc_1_op_res_78641;
                        
                        redout_85155 = redout_tmp_114053;
                    }
                    defunc_2_reduce_res_83945 = redout_85155;
                    
                    double defunc_0_f_res_78644 = x_74670 +
                           defunc_2_reduce_res_83945;
                    
                    ((double *) mem_100329)[i_85163 * (int64_t) 784 + i_85159] =
                        defunc_0_f_res_78644;
                }
            }
            for (int32_t i_86796 = 0; i_86796 < 128; i_86796++) {
                int64_t i_85175 = sext_i32_i64(i_86796);
                int64_t binop_x_91563 = (int64_t) 784 * i_85175;
                
                for (int32_t i_87472 = 0; i_87472 < 28; i_87472++) {
                    int64_t i_85171 = sext_i32_i64(i_87472);
                    int64_t binop_y_91564 = (int64_t) 28 * i_85171;
                    int64_t binop_x_91565 = binop_x_91563 + binop_y_91564;
                    
                    for (int32_t i_87473 = 0; i_87473 < 28; i_87473++) {
                        int64_t i_85167 = sext_i32_i64(i_87473);
                        int64_t binop_x_91566 = i_85167 + binop_x_91565;
                        int64_t new_index_91567 = squot64(binop_x_91566,
                                                          (int64_t) 784);
                        int64_t binop_y_91577 = (int64_t) 784 * new_index_91567;
                        int64_t new_index_91578 = binop_x_91566 - binop_y_91577;
                        double x_58187 =
                               ((double *) mem_100329)[new_index_91567 *
                                                       (int64_t) 784 +
                                                       new_index_91578];
                        double max_res_58188 = fmax64(0.0, x_58187);
                        
                        ((double *) mem_100369)[i_85175 * (int64_t) 784 +
                                                i_85171 * (int64_t) 28 +
                                                i_85167] = max_res_58188;
                    }
                }
            }
            for (int32_t i_86797 = 0; i_86797 < 32; i_86797++) {
                int64_t i_85179 = sext_i32_i64(i_86797);
                int64_t i_58191 = mul64((int64_t) 4, i_85179);
                int64_t x_58192 = add64((int64_t) 1, i_85179);
                int64_t j_58193 = mul64((int64_t) 4, x_58192);
                int64_t j_m_i_58194 = sub64(j_58193, i_58191);
                bool empty_slice_58195 = j_m_i_58194 == (int64_t) 0;
                int64_t m_58196 = sub64(j_m_i_58194, (int64_t) 1);
                int64_t i_p_m_t_s_58197 = add64(i_58191, m_58196);
                bool zzero_leq_i_p_m_t_s_58198 = sle64((int64_t) 0,
                                                       i_p_m_t_s_58197);
                bool i_p_m_t_s_leq_w_58199 = slt64(i_p_m_t_s_58197,
                                                   (int64_t) 128);
                bool zzero_lte_i_58200 = sle64((int64_t) 0, i_58191);
                bool i_lte_j_58201 = sle64(i_58191, j_58193);
                bool y_58202 = i_p_m_t_s_leq_w_58199 && zzero_lte_i_58200;
                bool y_58203 = zzero_leq_i_p_m_t_s_58198 && y_58202;
                bool y_58204 = i_lte_j_58201 && y_58203;
                bool forwards_ok_58205 = zzero_lte_i_58200 && y_58204;
                bool ok_or_empty_58206 = empty_slice_58195 || forwards_ok_58205;
                bool index_certs_58207;
                
                if (!ok_or_empty_58206) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Index [", (long long) i_58191, ":",
                                        (long long) j_58193,
                                        "] out of bounds for array of shape [",
                                        (long long) (int64_t) 128, "].",
                                        "-> #0  ../layers/groupnorm.fut:2:31-70\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  ../layers/groupnorm.fut:2:3-97\n   #4  ../layers/groupnorm.fut:15:19-54\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool dim_match_58208 = (int64_t) 4 == j_m_i_58194;
                bool empty_or_match_cert_58209;
                
                if (!dim_match_58208) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Value of (core language) shape (",
                                        (long long) j_m_i_58194, ", ",
                                        (long long) (int64_t) 28, ", ",
                                        (long long) (int64_t) 28,
                                        ") cannot match shape of type `[",
                                        (long long) (int64_t) 4, "][",
                                        (long long) (int64_t) 28, "][",
                                        (long long) (int64_t) 28, "]f64`.",
                                        "-> #0  ../layers/groupnorm.fut:2:31-96\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  ../layers/groupnorm.fut:2:3-97\n   #4  ../layers/groupnorm.fut:15:19-54\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if ((int64_t) 25088 > 0)
                    memmove(mem_100453 + i_85179 * (int64_t) 3136 * (int64_t) 8,
                            mem_100369 + (int64_t) 784 * i_58191 * (int64_t) 8,
                            (int64_t) 25088);
            }
            for (int32_t i_86798 = 0; i_86798 < 32; i_86798++) {
                int64_t i_85189 = sext_i32_i64(i_86798);
                int64_t binop_x_91497 = (int64_t) 3136 * i_85189;
                double defunc_2_reduce_res_83949;
                double redout_85181 = 0.0;
                
                for (int32_t i_87468 = 0; i_87468 < 3136; i_87468++) {
                    int64_t i_85182 = sext_i32_i64(i_87468);
                    int64_t binop_x_91498 = i_85182 + binop_x_91497;
                    int64_t new_index_91499 = squot64(binop_x_91498,
                                                      (int64_t) 3136);
                    int64_t binop_y_91505 = (int64_t) 3136 * new_index_91499;
                    int64_t binop_x_91506 = binop_x_91498 - binop_y_91505;
                    int64_t new_index_91507 = squot64(binop_x_91506,
                                                      (int64_t) 784);
                    int64_t binop_y_91523 = (int64_t) 784 * new_index_91507;
                    int64_t binop_x_91524 = binop_x_91506 - binop_y_91523;
                    int64_t new_index_91525 = squot64(binop_x_91524,
                                                      (int64_t) 28);
                    int64_t binop_y_91561 = (int64_t) 28 * new_index_91525;
                    int64_t new_index_91562 = binop_x_91524 - binop_y_91561;
                    double x_58219 = ((double *) mem_100453)[new_index_91499 *
                                                             (int64_t) 3136 +
                                                             new_index_91507 *
                                                             (int64_t) 784 +
                                                             new_index_91525 *
                                                             (int64_t) 28 +
                                                             new_index_91562];
                    double defunc_1_op_res_58218 = x_58219 + redout_85181;
                    double redout_tmp_114060 = defunc_1_op_res_58218;
                    
                    redout_85181 = redout_tmp_114060;
                }
                defunc_2_reduce_res_83949 = redout_85181;
                
                double calc_mean_flat_res_58220 = defunc_2_reduce_res_83949 /
                       3136.0;
                double defunc_2_reduce_res_83950;
                double redout_85183 = 0.0;
                
                for (int32_t i_87469 = 0; i_87469 < 3136; i_87469++) {
                    int64_t i_85184 = sext_i32_i64(i_87469);
                    int64_t binop_x_91432 = i_85184 + binop_x_91497;
                    int64_t new_index_91433 = squot64(binop_x_91432,
                                                      (int64_t) 3136);
                    int64_t binop_y_91439 = (int64_t) 3136 * new_index_91433;
                    int64_t binop_x_91440 = binop_x_91432 - binop_y_91439;
                    int64_t new_index_91441 = squot64(binop_x_91440,
                                                      (int64_t) 784);
                    int64_t binop_y_91457 = (int64_t) 784 * new_index_91441;
                    int64_t binop_x_91458 = binop_x_91440 - binop_y_91457;
                    int64_t new_index_91459 = squot64(binop_x_91458,
                                                      (int64_t) 28);
                    int64_t binop_y_91495 = (int64_t) 28 * new_index_91459;
                    int64_t new_index_91496 = binop_x_91458 - binop_y_91495;
                    double x_58227 = ((double *) mem_100453)[new_index_91433 *
                                                             (int64_t) 3136 +
                                                             new_index_91441 *
                                                             (int64_t) 784 +
                                                             new_index_91459 *
                                                             (int64_t) 28 +
                                                             new_index_91496];
                    double x_58224 = x_58227 - calc_mean_flat_res_58220;
                    double x_58225 = fpow64(x_58224, 2.0);
                    double defunc_1_op_res_58226 = x_58225 + redout_85183;
                    double redout_tmp_114061 = defunc_1_op_res_58226;
                    
                    redout_85183 = redout_tmp_114061;
                }
                defunc_2_reduce_res_83950 = redout_85183;
                
                double defunc_0_f_res_58228 = defunc_2_reduce_res_83950 /
                       3136.0;
                
                ((double *) mem_100483)[i_85189] = calc_mean_flat_res_58220;
                ((double *) mem_100485)[i_85189] = defunc_0_f_res_58228;
            }
            for (int32_t i_86799 = 0; i_86799 < 128; i_86799++) {
                int64_t i_85202 = sext_i32_i64(i_86799);
                bool x_58231 = sle64((int64_t) 0, i_85202);
                bool y_58232 = slt64(i_85202, (int64_t) 128);
                bool bounds_check_58233 = x_58231 && y_58232;
                int64_t i_58234 = sdiv64(i_85202, (int64_t) 4);
                bool x_58235 = sle64((int64_t) 0, i_58234);
                bool y_58236 = slt64(i_58234, (int64_t) 32);
                bool bounds_check_58237 = x_58235 && y_58236;
                bool index_certs_58238;
                
                if (!bounds_check_58237) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Index [", (long long) i_58234,
                                        "] out of bounds for array of shape [",
                                        (long long) (int64_t) 32, "].",
                                        "-> #0  ../layers/groupnorm.fut:17:57-77\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  /prelude/functional.fut:39:59-65\n   #7  /prelude/soacs.fut:59:3-10\n   #8  /prelude/array.fut:216:3-39\n   #9  ../layers/groupnorm.fut:17:13-119\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                double y_58239 = ((double *) mem_100483)[i_58234];
                double x_58240 = ((double *) mem_100485)[i_58234];
                double sqrt_arg_58241 = 1.0e-5 + x_58240;
                double sqrt_res_58242 = futrts_sqrt64(sqrt_arg_58241);
                
                for (int32_t i_87460 = 0; i_87460 < 28; i_87460++) {
                    int64_t i_85198 = sext_i32_i64(i_87460);
                    bool x_58245 = sle64((int64_t) 0, i_85198);
                    bool y_58246 = slt64(i_85198, (int64_t) 28);
                    bool bounds_check_58247 = x_58245 && y_58246;
                    
                    for (int32_t i_87461 = 0; i_87461 < 28; i_87461++) {
                        int64_t i_85194 = sext_i32_i64(i_87461);
                        bool x_58250 = sle64((int64_t) 0, i_85194);
                        bool y_58251 = slt64(i_85194, (int64_t) 28);
                        bool bounds_check_58252 = x_58250 && y_58251;
                        bool y_58253 = bounds_check_58233 && bounds_check_58252;
                        bool index_ok_58254 = bounds_check_58247 && y_58253;
                        bool index_certs_58255;
                        
                        if (!index_ok_58254) {
                            set_error(ctx,
                                      msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                "Index [", (long long) i_85202,
                                                ", ", (long long) i_85198, ", ",
                                                (long long) i_85194,
                                                "] out of bounds for array of shape [",
                                                (long long) (int64_t) 128, "][",
                                                (long long) (int64_t) 28, "][",
                                                (long long) (int64_t) 28, "].",
                                                "-> #0  ../layers/groupnorm.fut:17:44-53\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  /prelude/functional.fut:39:59-65\n   #7  /prelude/soacs.fut:59:3-10\n   #8  /prelude/array.fut:216:3-39\n   #9  ../layers/groupnorm.fut:17:13-119\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        double x_58256 = ((double *) mem_100369)[i_85202 *
                                                                 (int64_t) 784 +
                                                                 i_85198 *
                                                                 (int64_t) 28 +
                                                                 i_85194];
                        double x_58257 = x_58256 - y_58239;
                        double defunc_0_f_res_58258 = x_58257 / sqrt_res_58242;
                        
                        ((double *) mem_100507)[i_85202 * (int64_t) 784 +
                                                i_85198 * (int64_t) 28 +
                                                i_85194] = defunc_0_f_res_58258;
                    }
                }
            }
            for (int32_t i_86800 = 0; i_86800 < 256; i_86800++) {
                int64_t i_85214 = sext_i32_i64(i_86800);
                
                for (int32_t i_87448 = 0; i_87448 < 30; i_87448++) {
                    int64_t i_85210 = sext_i32_i64(i_87448);
                    bool cond_58301 = slt64(i_85210, (int64_t) 1);
                    bool cond_f_res_58302 = sle64((int64_t) 29, i_85210);
                    bool x_58303 = !cond_58301;
                    bool y_58304 = cond_f_res_58302 && x_58303;
                    bool cond_58305 = cond_58301 || y_58304;
                    bool x_58306 = !cond_58305;
                    
                    for (int32_t i_87449 = 0; i_87449 < 30; i_87449++) {
                        int64_t i_85206 = sext_i32_i64(i_87449);
                        bool cond_f_res_58309 = slt64(i_85206, (int64_t) 1);
                        bool y_58310 = x_58306 && cond_f_res_58309;
                        bool cond_58311 = cond_58305 || y_58310;
                        bool cond_f_res_58312 = sle64((int64_t) 29, i_85206);
                        bool x_58313 = !cond_58311;
                        bool y_58314 = cond_f_res_58312 && x_58313;
                        bool cond_58315 = cond_58311 || y_58314;
                        double defunc_0_f_res_58316;
                        
                        if (cond_58315 == 1) {
                            defunc_0_f_res_58316 = 0.0;
                        } else {
                            int64_t i_58317 = sub64(i_85210, (int64_t) 1);
                            bool x_58318 = sle64((int64_t) 0, i_58317);
                            bool y_58319 = slt64(i_58317, (int64_t) 28);
                            bool bounds_check_58320 = x_58318 && y_58319;
                            int64_t i_58321 = sub64(i_85206, (int64_t) 1);
                            bool x_58322 = sle64((int64_t) 0, i_58321);
                            bool y_58323 = slt64(i_58321, (int64_t) 28);
                            bool bounds_check_58324 = x_58322 && y_58323;
                            bool index_ok_58325 = bounds_check_58320 &&
                                 bounds_check_58324;
                            bool index_certs_58326;
                            
                            if (!index_ok_58325) {
                                set_error(ctx,
                                          msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                    "Index [",
                                                    (long long) i_58317, ", ",
                                                    (long long) i_58321,
                                                    "] out of bounds for array of shape [",
                                                    (long long) (int64_t) 28,
                                                    "][",
                                                    (long long) (int64_t) 28,
                                                    "].",
                                                    "-> #0  ../layers/conv2d.fut:7:91-116\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  ../layers/conv2d.fut:6:22-7:117\n   #7  ../layers/conv2d.fut:6:6-7:123\n   #8  ../layers/conv2d.fut:22:7-30\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            bool index_concat_cmp_87451 = sle64((int64_t) 128,
                                                                i_85214);
                            double index_concat_branch_87455;
                            
                            if (index_concat_cmp_87451 == 1) {
                                int64_t index_concat_i_87452 = sub64(i_85214,
                                                                     (int64_t) 128);
                                double index_concat_87453 =
                                       ((double *) mem_98725)[index_concat_i_87452 *
                                                              (int64_t) 784 +
                                                              i_58317 *
                                                              (int64_t) 28 +
                                                              i_58321];
                                
                                index_concat_branch_87455 = index_concat_87453;
                            } else {
                                double index_concat_87454 =
                                       ((double *) mem_100507)[i_85214 *
                                                               (int64_t) 784 +
                                                               i_58317 *
                                                               (int64_t) 28 +
                                                               i_58321];
                                
                                index_concat_branch_87455 = index_concat_87454;
                            }
                            defunc_0_f_res_58316 = index_concat_branch_87455;
                        }
                        ((double *) mem_100591)[i_85214 * (int64_t) 900 +
                                                i_85210 * (int64_t) 30 +
                                                i_85206] = defunc_0_f_res_58316;
                    }
                }
            }
            for (int32_t i_86801 = 0; i_86801 < 28; i_86801++) {
                int64_t i_85222 = sext_i32_i64(i_86801);
                int64_t j_58346 = add64((int64_t) 3, i_85222);
                int64_t i_p_m_t_s_58347 = add64((int64_t) 2, i_85222);
                bool zzero_leq_i_p_m_t_s_58348 = sle64((int64_t) 0,
                                                       i_p_m_t_s_58347);
                bool i_p_m_t_s_leq_w_58349 = slt64(i_p_m_t_s_58347,
                                                   (int64_t) 30);
                bool zzero_lte_i_58350 = sle64((int64_t) 0, i_85222);
                bool i_lte_j_58351 = sle64(i_85222, j_58346);
                bool y_58352 = i_p_m_t_s_leq_w_58349 && zzero_lte_i_58350;
                bool y_58353 = zzero_leq_i_p_m_t_s_58348 && y_58352;
                bool y_58354 = i_lte_j_58351 && y_58353;
                bool forwards_ok_58355 = zzero_lte_i_58350 && y_58354;
                
                for (int32_t i_87443 = 0; i_87443 < 28; i_87443++) {
                    int64_t i_85218 = sext_i32_i64(i_87443);
                    int64_t j_58359 = add64((int64_t) 3, i_85218);
                    int64_t i_p_m_t_s_58360 = add64((int64_t) 2, i_85218);
                    bool zzero_leq_i_p_m_t_s_58361 = sle64((int64_t) 0,
                                                           i_p_m_t_s_58360);
                    bool i_p_m_t_s_leq_w_58362 = slt64(i_p_m_t_s_58360,
                                                       (int64_t) 30);
                    bool zzero_lte_i_58363 = sle64((int64_t) 0, i_85218);
                    bool i_lte_j_58364 = sle64(i_85218, j_58359);
                    bool y_58365 = i_p_m_t_s_leq_w_58362 && zzero_lte_i_58363;
                    bool y_58366 = zzero_leq_i_p_m_t_s_58361 && y_58365;
                    bool y_58367 = i_lte_j_58364 && y_58366;
                    bool forwards_ok_58368 = zzero_lte_i_58363 && y_58367;
                    bool index_ok_58370 = forwards_ok_58355 &&
                         forwards_ok_58368;
                    bool index_certs_58371;
                    
                    if (!index_ok_58370) {
                        set_error(ctx,
                                  msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                            "Index [", (long long) i_85222, ":",
                                            (long long) j_58346, ", ",
                                            (long long) i_85218, ":",
                                            (long long) j_58359,
                                            "] out of bounds for array of shape [",
                                            (long long) (int64_t) 30, "][",
                                            (long long) (int64_t) 30, "].",
                                            "-> #0  ../layers/conv2d.fut:13:90-124\n   #1  ../layers/conv2d.fut:13:69-146\n   #2  /prelude/soacs.fut:59:3-10\n   #3  /prelude/array.fut:200:3-17\n   #4  /prelude/functional.fut:39:59-65\n   #5  /prelude/soacs.fut:59:3-10\n   #6  /prelude/array.fut:208:3-34\n   #7  ../layers/conv2d.fut:13:26-162\n   #8  ../layers/conv2d.fut:26:17-54\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    for (int64_t i_114070 = 0; i_114070 < (int64_t) 2304;
                         i_114070++) {
                        double tmp_114071 =
                               ((double *) mem_100591)[(int64_t) 30 * i_85222 +
                                                       i_85218 +
                                                       (squot64(i_114070,
                                                                (int64_t) 9) *
                                                        (int64_t) 900 +
                                                        squot64(i_114070 -
                                                                squot64(i_114070,
                                                                        (int64_t) 9) *
                                                                (int64_t) 9,
                                                                (int64_t) 3) *
                                                        (int64_t) 30 +
                                                        (i_114070 -
                                                         squot64(i_114070,
                                                                 (int64_t) 9) *
                                                         (int64_t) 9 -
                                                         squot64(i_114070 -
                                                                 squot64(i_114070,
                                                                         (int64_t) 9) *
                                                                 (int64_t) 9,
                                                                 (int64_t) 3) *
                                                         (int64_t) 3))];
                        
                        ((double *) mem_100675)[i_85222 * (int64_t) 64512 +
                                                i_85218 * (int64_t) 2304 +
                                                i_114070] = tmp_114071;
                    }
                }
            }
            for (int32_t i_86802 = 0; i_86802 < 64; i_86802++) {
                int64_t i_85232 = sext_i32_i64(i_86802);
                double x_74652 = ((double *) mem_param_97095.mem)[i_85232];
                int64_t binop_x_91337 = (int64_t) 2304 * i_85232;
                
                for (int32_t i_87441 = 0; i_87441 < 784; i_87441++) {
                    int64_t i_85228 = sext_i32_i64(i_87441);
                    int64_t binop_x_91403 = (int64_t) 2304 * i_85228;
                    double defunc_2_reduce_res_83956;
                    double redout_85224 = 0.0;
                    
                    for (int32_t i_87442 = 0; i_87442 < 2304; i_87442++) {
                        int64_t i_85225 = sext_i32_i64(i_87442);
                        int64_t binop_x_91338 = i_85225 + binop_x_91337;
                        int64_t new_index_91339 = squot64(binop_x_91338,
                                                          (int64_t) 2304);
                        int64_t binop_y_91345 = (int64_t) 2304 *
                                new_index_91339;
                        int64_t binop_x_91346 = binop_x_91338 - binop_y_91345;
                        int64_t new_index_91347 = squot64(binop_x_91346,
                                                          (int64_t) 9);
                        int64_t binop_y_91363 = (int64_t) 9 * new_index_91347;
                        int64_t binop_x_91364 = binop_x_91346 - binop_y_91363;
                        int64_t new_index_91365 = squot64(binop_x_91364,
                                                          (int64_t) 3);
                        int64_t binop_y_91401 = (int64_t) 3 * new_index_91365;
                        int64_t new_index_91402 = binop_x_91364 - binop_y_91401;
                        double x_78676 =
                               ((double *) mem_param_97090.mem)[new_index_91339 *
                                                                (int64_t) 2304 +
                                                                new_index_91347 *
                                                                (int64_t) 9 +
                                                                new_index_91365 *
                                                                (int64_t) 3 +
                                                                new_index_91402];
                        int64_t binop_x_91404 = i_85225 + binop_x_91403;
                        int64_t new_index_91405 = squot64(binop_x_91404,
                                                          (int64_t) 64512);
                        int64_t binop_y_91411 = (int64_t) 64512 *
                                new_index_91405;
                        int64_t binop_x_91412 = binop_x_91404 - binop_y_91411;
                        int64_t new_index_91413 = squot64(binop_x_91412,
                                                          (int64_t) 2304);
                        int64_t binop_y_91429 = (int64_t) 2304 *
                                new_index_91413;
                        int64_t new_index_91430 = binop_x_91412 - binop_y_91429;
                        double x_78677 =
                               ((double *) mem_100675)[new_index_91405 *
                                                       (int64_t) 64512 +
                                                       new_index_91413 *
                                                       (int64_t) 2304 +
                                                       new_index_91430];
                        double defunc_1_f_res_78678 = x_78676 * x_78677;
                        double defunc_1_op_res_78671 = defunc_1_f_res_78678 +
                               redout_85224;
                        double redout_tmp_114074 = defunc_1_op_res_78671;
                        
                        redout_85224 = redout_tmp_114074;
                    }
                    defunc_2_reduce_res_83956 = redout_85224;
                    
                    double defunc_0_f_res_78674 = x_74652 +
                           defunc_2_reduce_res_83956;
                    
                    ((double *) mem_100727)[i_85232 * (int64_t) 784 + i_85228] =
                        defunc_0_f_res_78674;
                }
            }
            for (int32_t i_86803 = 0; i_86803 < 64; i_86803++) {
                int64_t i_85244 = sext_i32_i64(i_86803);
                int64_t binop_x_91321 = (int64_t) 784 * i_85244;
                
                for (int32_t i_87439 = 0; i_87439 < 28; i_87439++) {
                    int64_t i_85240 = sext_i32_i64(i_87439);
                    int64_t binop_y_91322 = (int64_t) 28 * i_85240;
                    int64_t binop_x_91323 = binop_x_91321 + binop_y_91322;
                    
                    for (int32_t i_87440 = 0; i_87440 < 28; i_87440++) {
                        int64_t i_85236 = sext_i32_i64(i_87440);
                        int64_t binop_x_91324 = i_85236 + binop_x_91323;
                        int64_t new_index_91325 = squot64(binop_x_91324,
                                                          (int64_t) 784);
                        int64_t binop_y_91335 = (int64_t) 784 * new_index_91325;
                        int64_t new_index_91336 = binop_x_91324 - binop_y_91335;
                        double x_58414 =
                               ((double *) mem_100727)[new_index_91325 *
                                                       (int64_t) 784 +
                                                       new_index_91336];
                        double max_res_58415 = fmax64(0.0, x_58414);
                        
                        ((double *) mem_100767)[i_85244 * (int64_t) 784 +
                                                i_85240 * (int64_t) 28 +
                                                i_85236] = max_res_58415;
                    }
                }
            }
            for (int32_t i_86804 = 0; i_86804 < 32; i_86804++) {
                int64_t i_85248 = sext_i32_i64(i_86804);
                int64_t i_58426 = mul64((int64_t) 2, i_85248);
                int64_t x_58427 = add64((int64_t) 1, i_85248);
                int64_t j_58428 = mul64((int64_t) 2, x_58427);
                int64_t j_m_i_58429 = sub64(j_58428, i_58426);
                bool empty_slice_58430 = j_m_i_58429 == (int64_t) 0;
                int64_t m_58431 = sub64(j_m_i_58429, (int64_t) 1);
                int64_t i_p_m_t_s_58432 = add64(i_58426, m_58431);
                bool zzero_leq_i_p_m_t_s_58433 = sle64((int64_t) 0,
                                                       i_p_m_t_s_58432);
                bool i_p_m_t_s_leq_w_58434 = slt64(i_p_m_t_s_58432,
                                                   (int64_t) 64);
                bool zzero_lte_i_58435 = sle64((int64_t) 0, i_58426);
                bool i_lte_j_58436 = sle64(i_58426, j_58428);
                bool y_58437 = i_p_m_t_s_leq_w_58434 && zzero_lte_i_58435;
                bool y_58438 = zzero_leq_i_p_m_t_s_58433 && y_58437;
                bool y_58439 = i_lte_j_58436 && y_58438;
                bool forwards_ok_58440 = zzero_lte_i_58435 && y_58439;
                bool ok_or_empty_58441 = empty_slice_58430 || forwards_ok_58440;
                bool index_certs_58442;
                
                if (!ok_or_empty_58441) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Index [", (long long) i_58426, ":",
                                        (long long) j_58428,
                                        "] out of bounds for array of shape [",
                                        (long long) (int64_t) 64, "].",
                                        "-> #0  ../layers/groupnorm.fut:2:31-70\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  ../layers/groupnorm.fut:2:3-97\n   #4  ../layers/groupnorm.fut:15:19-54\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool dim_match_58443 = (int64_t) 2 == j_m_i_58429;
                bool empty_or_match_cert_58444;
                
                if (!dim_match_58443) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Value of (core language) shape (",
                                        (long long) j_m_i_58429, ", ",
                                        (long long) (int64_t) 28, ", ",
                                        (long long) (int64_t) 28,
                                        ") cannot match shape of type `[",
                                        (long long) (int64_t) 2, "][",
                                        (long long) (int64_t) 28, "][",
                                        (long long) (int64_t) 28, "]f64`.",
                                        "-> #0  ../layers/groupnorm.fut:2:31-96\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  ../layers/groupnorm.fut:2:3-97\n   #4  ../layers/groupnorm.fut:15:19-54\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if ((int64_t) 12544 > 0)
                    memmove(mem_100851 + i_85248 * (int64_t) 1568 * (int64_t) 8,
                            mem_100767 + (int64_t) 784 * i_58426 * (int64_t) 8,
                            (int64_t) 12544);
            }
            for (int32_t i_86805 = 0; i_86805 < 32; i_86805++) {
                int64_t i_85258 = sext_i32_i64(i_86805);
                int64_t binop_x_91255 = (int64_t) 1568 * i_85258;
                double defunc_2_reduce_res_83960;
                double redout_85250 = 0.0;
                
                for (int32_t i_87435 = 0; i_87435 < 1568; i_87435++) {
                    int64_t i_85251 = sext_i32_i64(i_87435);
                    int64_t binop_x_91256 = i_85251 + binop_x_91255;
                    int64_t new_index_91257 = squot64(binop_x_91256,
                                                      (int64_t) 1568);
                    int64_t binop_y_91263 = (int64_t) 1568 * new_index_91257;
                    int64_t binop_x_91264 = binop_x_91256 - binop_y_91263;
                    int64_t new_index_91265 = squot64(binop_x_91264,
                                                      (int64_t) 784);
                    int64_t binop_y_91281 = (int64_t) 784 * new_index_91265;
                    int64_t binop_x_91282 = binop_x_91264 - binop_y_91281;
                    int64_t new_index_91283 = squot64(binop_x_91282,
                                                      (int64_t) 28);
                    int64_t binop_y_91319 = (int64_t) 28 * new_index_91283;
                    int64_t new_index_91320 = binop_x_91282 - binop_y_91319;
                    double x_58460 = ((double *) mem_100851)[new_index_91257 *
                                                             (int64_t) 1568 +
                                                             new_index_91265 *
                                                             (int64_t) 784 +
                                                             new_index_91283 *
                                                             (int64_t) 28 +
                                                             new_index_91320];
                    double defunc_1_op_res_58459 = x_58460 + redout_85250;
                    double redout_tmp_114081 = defunc_1_op_res_58459;
                    
                    redout_85250 = redout_tmp_114081;
                }
                defunc_2_reduce_res_83960 = redout_85250;
                
                double calc_mean_flat_res_58461 = defunc_2_reduce_res_83960 /
                       1568.0;
                double defunc_2_reduce_res_83961;
                double redout_85252 = 0.0;
                
                for (int32_t i_87436 = 0; i_87436 < 1568; i_87436++) {
                    int64_t i_85253 = sext_i32_i64(i_87436);
                    int64_t binop_x_91190 = i_85253 + binop_x_91255;
                    int64_t new_index_91191 = squot64(binop_x_91190,
                                                      (int64_t) 1568);
                    int64_t binop_y_91197 = (int64_t) 1568 * new_index_91191;
                    int64_t binop_x_91198 = binop_x_91190 - binop_y_91197;
                    int64_t new_index_91199 = squot64(binop_x_91198,
                                                      (int64_t) 784);
                    int64_t binop_y_91215 = (int64_t) 784 * new_index_91199;
                    int64_t binop_x_91216 = binop_x_91198 - binop_y_91215;
                    int64_t new_index_91217 = squot64(binop_x_91216,
                                                      (int64_t) 28);
                    int64_t binop_y_91253 = (int64_t) 28 * new_index_91217;
                    int64_t new_index_91254 = binop_x_91216 - binop_y_91253;
                    double x_58468 = ((double *) mem_100851)[new_index_91191 *
                                                             (int64_t) 1568 +
                                                             new_index_91199 *
                                                             (int64_t) 784 +
                                                             new_index_91217 *
                                                             (int64_t) 28 +
                                                             new_index_91254];
                    double x_58465 = x_58468 - calc_mean_flat_res_58461;
                    double x_58466 = fpow64(x_58465, 2.0);
                    double defunc_1_op_res_58467 = x_58466 + redout_85252;
                    double redout_tmp_114082 = defunc_1_op_res_58467;
                    
                    redout_85252 = redout_tmp_114082;
                }
                defunc_2_reduce_res_83961 = redout_85252;
                
                double defunc_0_f_res_58469 = defunc_2_reduce_res_83961 /
                       1568.0;
                
                ((double *) mem_100881)[i_85258] = calc_mean_flat_res_58461;
                ((double *) mem_100883)[i_85258] = defunc_0_f_res_58469;
            }
            for (int32_t i_86806 = 0; i_86806 < 64; i_86806++) {
                int64_t i_85293 = sext_i32_i64(i_86806);
                double x_74572 = ((double *) mem_param_97108.mem)[i_85293];
                bool x_74573 = sle64((int64_t) 0, i_85293);
                bool y_74574 = slt64(i_85293, (int64_t) 64);
                bool bounds_check_74575 = x_74573 && y_74574;
                int64_t i_74576 = sdiv64(i_85293, (int64_t) 2);
                bool x_74577 = sle64((int64_t) 0, i_74576);
                bool y_74578 = slt64(i_74576, (int64_t) 32);
                bool bounds_check_74579 = x_74577 && y_74578;
                bool index_certs_74580;
                
                if (!bounds_check_74579) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Index [", (long long) i_74576,
                                        "] out of bounds for array of shape [",
                                        (long long) (int64_t) 32, "].",
                                        "-> #0  ../layers/groupnorm.fut:17:57-77\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  /prelude/functional.fut:39:59-65\n   #7  /prelude/soacs.fut:59:3-10\n   #8  /prelude/array.fut:216:3-39\n   #9  ../layers/groupnorm.fut:17:13-119\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                double y_74581 = ((double *) mem_100881)[i_74576];
                double x_74582 = ((double *) mem_100883)[i_74576];
                double sqrt_arg_74583 = 1.0e-5 + x_74582;
                double sqrt_res_74584 = futrts_sqrt64(sqrt_arg_74583);
                double defunc_2_reduce_res_83965;
                double redout_85261 = 0.0;
                
                for (int32_t i_87414 = 0; i_87414 < 256; i_87414++) {
                    int64_t i_85262 = sext_i32_i64(i_87414);
                    bool index_concat_cmp_87428 = sle64((int64_t) 128, i_85262);
                    double index_concat_branch_87432;
                    
                    if (index_concat_cmp_87428 == 1) {
                        int64_t index_concat_i_87429 = sub64(i_85262,
                                                             (int64_t) 128);
                        double index_concat_87430 =
                               ((double *) mem_97692)[index_concat_i_87429];
                        
                        index_concat_branch_87432 = index_concat_87430;
                    } else {
                        double index_concat_87431 =
                               ((double *) mem_97690)[i_85262];
                        
                        index_concat_branch_87432 = index_concat_87431;
                    }
                    
                    double x_78689 = ((double *) mem_param_97103.mem)[i_85293 *
                                                                      (int64_t) 256 +
                                                                      i_85262];
                    double defunc_1_f_res_78690 = x_78689 *
                           index_concat_branch_87432;
                    double defunc_1_op_res_74609 = defunc_1_f_res_78690 +
                           redout_85261;
                    double redout_tmp_114087 = defunc_1_op_res_74609;
                    
                    redout_85261 = redout_tmp_114087;
                }
                defunc_2_reduce_res_83965 = redout_85261;
                
                double defunc_1_f_res_74611 = x_74572 +
                       defunc_2_reduce_res_83965;
                double max_res_74613 = fmax64(0.0, defunc_1_f_res_74611);
                
                for (int32_t i_87415 = 0; i_87415 < 28; i_87415++) {
                    int64_t i_85274 = sext_i32_i64(i_87415);
                    bool x_78694 = sle64((int64_t) 0, i_85274);
                    bool y_78695 = slt64(i_85274, (int64_t) 28);
                    bool bounds_check_78696 = x_78694 && y_78695;
                    
                    for (int32_t i_87422 = 0; i_87422 < 28; i_87422++) {
                        int64_t i_85267 = sext_i32_i64(i_87422);
                        bool x_78714 = sle64((int64_t) 0, i_85267);
                        bool y_78715 = slt64(i_85267, (int64_t) 28);
                        bool bounds_check_78716 = x_78714 && y_78715;
                        bool y_78717 = bounds_check_74575 && bounds_check_78716;
                        bool index_ok_78718 = bounds_check_78696 && y_78717;
                        bool index_certs_78719;
                        
                        if (!index_ok_78718) {
                            set_error(ctx,
                                      msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                "Index [", (long long) i_85293,
                                                ", ", (long long) i_85274, ", ",
                                                (long long) i_85267,
                                                "] out of bounds for array of shape [",
                                                (long long) (int64_t) 64, "][",
                                                (long long) (int64_t) 28, "][",
                                                (long long) (int64_t) 28, "].",
                                                "-> #0  ../layers/groupnorm.fut:17:44-53\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  /prelude/functional.fut:39:59-65\n   #7  /prelude/soacs.fut:59:3-10\n   #8  /prelude/array.fut:216:3-39\n   #9  ../layers/groupnorm.fut:17:13-119\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        double x_78720 = ((double *) mem_100767)[i_85293 *
                                                                 (int64_t) 784 +
                                                                 i_85274 *
                                                                 (int64_t) 28 +
                                                                 i_85267];
                        double x_78721 = x_78720 - y_74581;
                        double defunc_0_f_res_78722 = x_78721 / sqrt_res_74584;
                        double defunc_0_f_res_78724 = max_res_74613 +
                               defunc_0_f_res_78722;
                        
                        ((double *) mem_100907)[i_85293 * (int64_t) 784 +
                                                i_85274 * (int64_t) 28 +
                                                i_85267] = defunc_0_f_res_78724;
                        ((double *) mem_100911)[i_85293 * (int64_t) 784 +
                                                i_85274 * (int64_t) 28 +
                                                i_85267] = defunc_0_f_res_78722;
                    }
                }
                for (int32_t i_87416 = 0; i_87416 < 30; i_87416++) {
                    int64_t i_85283 = sext_i32_i64(i_87416);
                    bool cond_74623 = slt64(i_85283, (int64_t) 1);
                    bool cond_f_res_74624 = sle64((int64_t) 29, i_85283);
                    bool x_74625 = !cond_74623;
                    bool y_74626 = cond_f_res_74624 && x_74625;
                    bool cond_74627 = cond_74623 || y_74626;
                    bool x_74628 = !cond_74627;
                    
                    for (int32_t i_87417 = 0; i_87417 < 30; i_87417++) {
                        int64_t i_85279 = sext_i32_i64(i_87417);
                        bool cond_f_res_74631 = slt64(i_85279, (int64_t) 1);
                        bool y_74632 = x_74628 && cond_f_res_74631;
                        bool cond_74633 = cond_74627 || y_74632;
                        bool cond_f_res_74634 = sle64((int64_t) 29, i_85279);
                        bool x_74635 = !cond_74633;
                        bool y_74636 = cond_f_res_74634 && x_74635;
                        bool cond_74637 = cond_74633 || y_74636;
                        double defunc_0_f_res_74638;
                        
                        if (cond_74637 == 1) {
                            defunc_0_f_res_74638 = 0.0;
                        } else {
                            int64_t i_74639 = sub64(i_85283, (int64_t) 1);
                            bool x_74640 = sle64((int64_t) 0, i_74639);
                            bool y_74641 = slt64(i_74639, (int64_t) 28);
                            bool bounds_check_74642 = x_74640 && y_74641;
                            int64_t i_74643 = sub64(i_85279, (int64_t) 1);
                            bool x_74644 = sle64((int64_t) 0, i_74643);
                            bool y_74645 = slt64(i_74643, (int64_t) 28);
                            bool bounds_check_74646 = x_74644 && y_74645;
                            bool index_ok_74647 = bounds_check_74642 &&
                                 bounds_check_74646;
                            bool index_certs_74648;
                            
                            if (!index_ok_74647) {
                                set_error(ctx,
                                          msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                    "Index [",
                                                    (long long) i_74639, ", ",
                                                    (long long) i_74643,
                                                    "] out of bounds for array of shape [",
                                                    (long long) (int64_t) 28,
                                                    "][",
                                                    (long long) (int64_t) 28,
                                                    "].",
                                                    "-> #0  ../layers/conv2d.fut:7:91-116\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  ../layers/conv2d.fut:6:22-7:117\n   #7  ../layers/conv2d.fut:6:6-7:123\n   #8  ../layers/conv2d.fut:22:7-30\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            double defunc_0_f_res_f_res_74649 =
                                   ((double *) mem_100907)[i_85293 *
                                                           (int64_t) 784 +
                                                           i_74639 *
                                                           (int64_t) 28 +
                                                           i_74643];
                            
                            defunc_0_f_res_74638 = defunc_0_f_res_f_res_74649;
                        }
                        ((double *) mem_100905)[i_85293 * (int64_t) 900 +
                                                i_85283 * (int64_t) 30 +
                                                i_85279] = defunc_0_f_res_74638;
                    }
                }
                ((double *) mem_100909)[i_85293] = defunc_1_f_res_74611;
            }
            for (int32_t i_86807 = 0; i_86807 < 28; i_86807++) {
                int64_t i_85304 = sext_i32_i64(i_86807);
                int64_t j_58585 = add64((int64_t) 3, i_85304);
                int64_t i_p_m_t_s_58586 = add64((int64_t) 2, i_85304);
                bool zzero_leq_i_p_m_t_s_58587 = sle64((int64_t) 0,
                                                       i_p_m_t_s_58586);
                bool i_p_m_t_s_leq_w_58588 = slt64(i_p_m_t_s_58586,
                                                   (int64_t) 30);
                bool zzero_lte_i_58589 = sle64((int64_t) 0, i_85304);
                bool i_lte_j_58590 = sle64(i_85304, j_58585);
                bool y_58591 = i_p_m_t_s_leq_w_58588 && zzero_lte_i_58589;
                bool y_58592 = zzero_leq_i_p_m_t_s_58587 && y_58591;
                bool y_58593 = i_lte_j_58590 && y_58592;
                bool forwards_ok_58594 = zzero_lte_i_58589 && y_58593;
                
                for (int32_t i_87409 = 0; i_87409 < 28; i_87409++) {
                    int64_t i_85300 = sext_i32_i64(i_87409);
                    int64_t j_58598 = add64((int64_t) 3, i_85300);
                    int64_t i_p_m_t_s_58599 = add64((int64_t) 2, i_85300);
                    bool zzero_leq_i_p_m_t_s_58600 = sle64((int64_t) 0,
                                                           i_p_m_t_s_58599);
                    bool i_p_m_t_s_leq_w_58601 = slt64(i_p_m_t_s_58599,
                                                       (int64_t) 30);
                    bool zzero_lte_i_58602 = sle64((int64_t) 0, i_85300);
                    bool i_lte_j_58603 = sle64(i_85300, j_58598);
                    bool y_58604 = i_p_m_t_s_leq_w_58601 && zzero_lte_i_58602;
                    bool y_58605 = zzero_leq_i_p_m_t_s_58600 && y_58604;
                    bool y_58606 = i_lte_j_58603 && y_58605;
                    bool forwards_ok_58607 = zzero_lte_i_58602 && y_58606;
                    bool index_ok_58609 = forwards_ok_58594 &&
                         forwards_ok_58607;
                    bool index_certs_58610;
                    
                    if (!index_ok_58609) {
                        set_error(ctx,
                                  msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                            "Index [", (long long) i_85304, ":",
                                            (long long) j_58585, ", ",
                                            (long long) i_85300, ":",
                                            (long long) j_58598,
                                            "] out of bounds for array of shape [",
                                            (long long) (int64_t) 30, "][",
                                            (long long) (int64_t) 30, "].",
                                            "-> #0  ../layers/conv2d.fut:13:90-124\n   #1  ../layers/conv2d.fut:13:69-146\n   #2  /prelude/soacs.fut:59:3-10\n   #3  /prelude/array.fut:200:3-17\n   #4  /prelude/functional.fut:39:59-65\n   #5  /prelude/soacs.fut:59:3-10\n   #6  /prelude/array.fut:208:3-34\n   #7  ../layers/conv2d.fut:13:26-162\n   #8  ../layers/conv2d.fut:26:17-54\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    for (int64_t i_114096 = 0; i_114096 < (int64_t) 576;
                         i_114096++) {
                        double tmp_114097 =
                               ((double *) mem_100905)[(int64_t) 30 * i_85304 +
                                                       i_85300 +
                                                       (squot64(i_114096,
                                                                (int64_t) 9) *
                                                        (int64_t) 900 +
                                                        squot64(i_114096 -
                                                                squot64(i_114096,
                                                                        (int64_t) 9) *
                                                                (int64_t) 9,
                                                                (int64_t) 3) *
                                                        (int64_t) 30 +
                                                        (i_114096 -
                                                         squot64(i_114096,
                                                                 (int64_t) 9) *
                                                         (int64_t) 9 -
                                                         squot64(i_114096 -
                                                                 squot64(i_114096,
                                                                         (int64_t) 9) *
                                                                 (int64_t) 9,
                                                                 (int64_t) 3) *
                                                         (int64_t) 3))];
                        
                        ((double *) mem_101169)[i_85304 * (int64_t) 16128 +
                                                i_85300 * (int64_t) 576 +
                                                i_114096] = tmp_114097;
                    }
                }
            }
            for (int32_t i_86808 = 0; i_86808 < 64; i_86808++) {
                int64_t i_85314 = sext_i32_i64(i_86808);
                double x_74423 = ((double *) mem_param_97127.mem)[i_85314];
                int64_t binop_x_91095 = (int64_t) 576 * i_85314;
                
                for (int32_t i_87407 = 0; i_87407 < 784; i_87407++) {
                    int64_t i_85310 = sext_i32_i64(i_87407);
                    int64_t binop_x_91161 = (int64_t) 576 * i_85310;
                    double defunc_2_reduce_res_83970;
                    double redout_85306 = 0.0;
                    
                    for (int32_t i_87408 = 0; i_87408 < 576; i_87408++) {
                        int64_t i_85307 = sext_i32_i64(i_87408);
                        int64_t binop_x_91096 = i_85307 + binop_x_91095;
                        int64_t new_index_91097 = squot64(binop_x_91096,
                                                          (int64_t) 576);
                        int64_t binop_y_91103 = (int64_t) 576 * new_index_91097;
                        int64_t binop_x_91104 = binop_x_91096 - binop_y_91103;
                        int64_t new_index_91105 = squot64(binop_x_91104,
                                                          (int64_t) 9);
                        int64_t binop_y_91121 = (int64_t) 9 * new_index_91105;
                        int64_t binop_x_91122 = binop_x_91104 - binop_y_91121;
                        int64_t new_index_91123 = squot64(binop_x_91122,
                                                          (int64_t) 3);
                        int64_t binop_y_91159 = (int64_t) 3 * new_index_91123;
                        int64_t new_index_91160 = binop_x_91122 - binop_y_91159;
                        double x_78750 =
                               ((double *) mem_param_97122.mem)[new_index_91097 *
                                                                (int64_t) 576 +
                                                                new_index_91105 *
                                                                (int64_t) 9 +
                                                                new_index_91123 *
                                                                (int64_t) 3 +
                                                                new_index_91160];
                        int64_t binop_x_91162 = i_85307 + binop_x_91161;
                        int64_t new_index_91163 = squot64(binop_x_91162,
                                                          (int64_t) 16128);
                        int64_t binop_y_91169 = (int64_t) 16128 *
                                new_index_91163;
                        int64_t binop_x_91170 = binop_x_91162 - binop_y_91169;
                        int64_t new_index_91171 = squot64(binop_x_91170,
                                                          (int64_t) 576);
                        int64_t binop_y_91187 = (int64_t) 576 * new_index_91171;
                        int64_t new_index_91188 = binop_x_91170 - binop_y_91187;
                        double x_78751 =
                               ((double *) mem_101169)[new_index_91163 *
                                                       (int64_t) 16128 +
                                                       new_index_91171 *
                                                       (int64_t) 576 +
                                                       new_index_91188];
                        double defunc_1_f_res_78752 = x_78750 * x_78751;
                        double defunc_1_op_res_78745 = defunc_1_f_res_78752 +
                               redout_85306;
                        double redout_tmp_114100 = defunc_1_op_res_78745;
                        
                        redout_85306 = redout_tmp_114100;
                    }
                    defunc_2_reduce_res_83970 = redout_85306;
                    
                    double defunc_0_f_res_78748 = x_74423 +
                           defunc_2_reduce_res_83970;
                    
                    ((double *) mem_101221)[i_85314 * (int64_t) 784 + i_85310] =
                        defunc_0_f_res_78748;
                }
            }
            for (int32_t i_86809 = 0; i_86809 < 64; i_86809++) {
                int64_t i_85326 = sext_i32_i64(i_86809);
                int64_t binop_x_91079 = (int64_t) 784 * i_85326;
                
                for (int32_t i_87405 = 0; i_87405 < 28; i_87405++) {
                    int64_t i_85322 = sext_i32_i64(i_87405);
                    int64_t binop_y_91080 = (int64_t) 28 * i_85322;
                    int64_t binop_x_91081 = binop_x_91079 + binop_y_91080;
                    
                    for (int32_t i_87406 = 0; i_87406 < 28; i_87406++) {
                        int64_t i_85318 = sext_i32_i64(i_87406);
                        int64_t binop_x_91082 = i_85318 + binop_x_91081;
                        int64_t new_index_91083 = squot64(binop_x_91082,
                                                          (int64_t) 784);
                        int64_t binop_y_91093 = (int64_t) 784 * new_index_91083;
                        int64_t new_index_91094 = binop_x_91082 - binop_y_91093;
                        double x_58653 =
                               ((double *) mem_101221)[new_index_91083 *
                                                       (int64_t) 784 +
                                                       new_index_91094];
                        double max_res_58654 = fmax64(0.0, x_58653);
                        
                        ((double *) mem_101261)[i_85326 * (int64_t) 784 +
                                                i_85322 * (int64_t) 28 +
                                                i_85318] = max_res_58654;
                    }
                }
            }
            for (int32_t i_86810 = 0; i_86810 < 32; i_86810++) {
                int64_t i_85330 = sext_i32_i64(i_86810);
                int64_t i_58657 = mul64((int64_t) 2, i_85330);
                int64_t x_58658 = add64((int64_t) 1, i_85330);
                int64_t j_58659 = mul64((int64_t) 2, x_58658);
                int64_t j_m_i_58660 = sub64(j_58659, i_58657);
                bool empty_slice_58661 = j_m_i_58660 == (int64_t) 0;
                int64_t m_58662 = sub64(j_m_i_58660, (int64_t) 1);
                int64_t i_p_m_t_s_58663 = add64(i_58657, m_58662);
                bool zzero_leq_i_p_m_t_s_58664 = sle64((int64_t) 0,
                                                       i_p_m_t_s_58663);
                bool i_p_m_t_s_leq_w_58665 = slt64(i_p_m_t_s_58663,
                                                   (int64_t) 64);
                bool zzero_lte_i_58666 = sle64((int64_t) 0, i_58657);
                bool i_lte_j_58667 = sle64(i_58657, j_58659);
                bool y_58668 = i_p_m_t_s_leq_w_58665 && zzero_lte_i_58666;
                bool y_58669 = zzero_leq_i_p_m_t_s_58664 && y_58668;
                bool y_58670 = i_lte_j_58667 && y_58669;
                bool forwards_ok_58671 = zzero_lte_i_58666 && y_58670;
                bool ok_or_empty_58672 = empty_slice_58661 || forwards_ok_58671;
                bool index_certs_58673;
                
                if (!ok_or_empty_58672) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Index [", (long long) i_58657, ":",
                                        (long long) j_58659,
                                        "] out of bounds for array of shape [",
                                        (long long) (int64_t) 64, "].",
                                        "-> #0  ../layers/groupnorm.fut:2:31-70\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  ../layers/groupnorm.fut:2:3-97\n   #4  ../layers/groupnorm.fut:15:19-54\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool dim_match_58674 = (int64_t) 2 == j_m_i_58660;
                bool empty_or_match_cert_58675;
                
                if (!dim_match_58674) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Value of (core language) shape (",
                                        (long long) j_m_i_58660, ", ",
                                        (long long) (int64_t) 28, ", ",
                                        (long long) (int64_t) 28,
                                        ") cannot match shape of type `[",
                                        (long long) (int64_t) 2, "][",
                                        (long long) (int64_t) 28, "][",
                                        (long long) (int64_t) 28, "]f64`.",
                                        "-> #0  ../layers/groupnorm.fut:2:31-96\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  ../layers/groupnorm.fut:2:3-97\n   #4  ../layers/groupnorm.fut:15:19-54\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if ((int64_t) 12544 > 0)
                    memmove(mem_101345 + i_85330 * (int64_t) 1568 * (int64_t) 8,
                            mem_101261 + (int64_t) 784 * i_58657 * (int64_t) 8,
                            (int64_t) 12544);
            }
            for (int32_t i_86811 = 0; i_86811 < 32; i_86811++) {
                int64_t i_85340 = sext_i32_i64(i_86811);
                int64_t binop_x_91013 = (int64_t) 1568 * i_85340;
                double defunc_2_reduce_res_83974;
                double redout_85332 = 0.0;
                
                for (int32_t i_87401 = 0; i_87401 < 1568; i_87401++) {
                    int64_t i_85333 = sext_i32_i64(i_87401);
                    int64_t binop_x_91014 = i_85333 + binop_x_91013;
                    int64_t new_index_91015 = squot64(binop_x_91014,
                                                      (int64_t) 1568);
                    int64_t binop_y_91021 = (int64_t) 1568 * new_index_91015;
                    int64_t binop_x_91022 = binop_x_91014 - binop_y_91021;
                    int64_t new_index_91023 = squot64(binop_x_91022,
                                                      (int64_t) 784);
                    int64_t binop_y_91039 = (int64_t) 784 * new_index_91023;
                    int64_t binop_x_91040 = binop_x_91022 - binop_y_91039;
                    int64_t new_index_91041 = squot64(binop_x_91040,
                                                      (int64_t) 28);
                    int64_t binop_y_91077 = (int64_t) 28 * new_index_91041;
                    int64_t new_index_91078 = binop_x_91040 - binop_y_91077;
                    double x_58685 = ((double *) mem_101345)[new_index_91015 *
                                                             (int64_t) 1568 +
                                                             new_index_91023 *
                                                             (int64_t) 784 +
                                                             new_index_91041 *
                                                             (int64_t) 28 +
                                                             new_index_91078];
                    double defunc_1_op_res_58684 = x_58685 + redout_85332;
                    double redout_tmp_114107 = defunc_1_op_res_58684;
                    
                    redout_85332 = redout_tmp_114107;
                }
                defunc_2_reduce_res_83974 = redout_85332;
                
                double calc_mean_flat_res_58686 = defunc_2_reduce_res_83974 /
                       1568.0;
                double defunc_2_reduce_res_83975;
                double redout_85334 = 0.0;
                
                for (int32_t i_87402 = 0; i_87402 < 1568; i_87402++) {
                    int64_t i_85335 = sext_i32_i64(i_87402);
                    int64_t binop_x_90948 = i_85335 + binop_x_91013;
                    int64_t new_index_90949 = squot64(binop_x_90948,
                                                      (int64_t) 1568);
                    int64_t binop_y_90955 = (int64_t) 1568 * new_index_90949;
                    int64_t binop_x_90956 = binop_x_90948 - binop_y_90955;
                    int64_t new_index_90957 = squot64(binop_x_90956,
                                                      (int64_t) 784);
                    int64_t binop_y_90973 = (int64_t) 784 * new_index_90957;
                    int64_t binop_x_90974 = binop_x_90956 - binop_y_90973;
                    int64_t new_index_90975 = squot64(binop_x_90974,
                                                      (int64_t) 28);
                    int64_t binop_y_91011 = (int64_t) 28 * new_index_90975;
                    int64_t new_index_91012 = binop_x_90974 - binop_y_91011;
                    double x_58693 = ((double *) mem_101345)[new_index_90949 *
                                                             (int64_t) 1568 +
                                                             new_index_90957 *
                                                             (int64_t) 784 +
                                                             new_index_90975 *
                                                             (int64_t) 28 +
                                                             new_index_91012];
                    double x_58690 = x_58693 - calc_mean_flat_res_58686;
                    double x_58691 = fpow64(x_58690, 2.0);
                    double defunc_1_op_res_58692 = x_58691 + redout_85334;
                    double redout_tmp_114108 = defunc_1_op_res_58692;
                    
                    redout_85334 = redout_tmp_114108;
                }
                defunc_2_reduce_res_83975 = redout_85334;
                
                double defunc_0_f_res_58694 = defunc_2_reduce_res_83975 /
                       1568.0;
                
                ((double *) mem_101375)[i_85340] = calc_mean_flat_res_58686;
                ((double *) mem_101377)[i_85340] = defunc_0_f_res_58694;
            }
            for (int32_t i_86812 = 0; i_86812 < 64; i_86812++) {
                int64_t i_85353 = sext_i32_i64(i_86812);
                bool x_58697 = sle64((int64_t) 0, i_85353);
                bool y_58698 = slt64(i_85353, (int64_t) 64);
                bool bounds_check_58699 = x_58697 && y_58698;
                int64_t i_58700 = sdiv64(i_85353, (int64_t) 2);
                bool x_58701 = sle64((int64_t) 0, i_58700);
                bool y_58702 = slt64(i_58700, (int64_t) 32);
                bool bounds_check_58703 = x_58701 && y_58702;
                bool index_certs_58704;
                
                if (!bounds_check_58703) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Index [", (long long) i_58700,
                                        "] out of bounds for array of shape [",
                                        (long long) (int64_t) 32, "].",
                                        "-> #0  ../layers/groupnorm.fut:17:57-77\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  /prelude/functional.fut:39:59-65\n   #7  /prelude/soacs.fut:59:3-10\n   #8  /prelude/array.fut:216:3-39\n   #9  ../layers/groupnorm.fut:17:13-119\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                double y_58705 = ((double *) mem_101375)[i_58700];
                double x_58706 = ((double *) mem_101377)[i_58700];
                double sqrt_arg_58707 = 1.0e-5 + x_58706;
                double sqrt_res_58708 = futrts_sqrt64(sqrt_arg_58707);
                
                for (int32_t i_87393 = 0; i_87393 < 28; i_87393++) {
                    int64_t i_85349 = sext_i32_i64(i_87393);
                    bool x_58711 = sle64((int64_t) 0, i_85349);
                    bool y_58712 = slt64(i_85349, (int64_t) 28);
                    bool bounds_check_58713 = x_58711 && y_58712;
                    
                    for (int32_t i_87394 = 0; i_87394 < 28; i_87394++) {
                        int64_t i_85345 = sext_i32_i64(i_87394);
                        bool x_58716 = sle64((int64_t) 0, i_85345);
                        bool y_58717 = slt64(i_85345, (int64_t) 28);
                        bool bounds_check_58718 = x_58716 && y_58717;
                        bool y_58719 = bounds_check_58699 && bounds_check_58718;
                        bool index_ok_58720 = bounds_check_58713 && y_58719;
                        bool index_certs_58721;
                        
                        if (!index_ok_58720) {
                            set_error(ctx,
                                      msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                "Index [", (long long) i_85353,
                                                ", ", (long long) i_85349, ", ",
                                                (long long) i_85345,
                                                "] out of bounds for array of shape [",
                                                (long long) (int64_t) 64, "][",
                                                (long long) (int64_t) 28, "][",
                                                (long long) (int64_t) 28, "].",
                                                "-> #0  ../layers/groupnorm.fut:17:44-53\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  /prelude/functional.fut:39:59-65\n   #7  /prelude/soacs.fut:59:3-10\n   #8  /prelude/array.fut:216:3-39\n   #9  ../layers/groupnorm.fut:17:13-119\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        double x_58722 = ((double *) mem_101261)[i_85353 *
                                                                 (int64_t) 784 +
                                                                 i_85349 *
                                                                 (int64_t) 28 +
                                                                 i_85345];
                        double x_58723 = x_58722 - y_58705;
                        double defunc_0_f_res_58724 = x_58723 / sqrt_res_58708;
                        
                        ((double *) mem_101399)[i_85353 * (int64_t) 784 +
                                                i_85349 * (int64_t) 28 +
                                                i_85345] = defunc_0_f_res_58724;
                    }
                }
            }
            for (int32_t i_86813 = 0; i_86813 < 28; i_86813++) {
                int64_t i_85361 = sext_i32_i64(i_86813);
                int64_t j_56047 = add64((int64_t) 1, i_85361);
                bool zzero_leq_i_p_m_t_s_56049 = sle64((int64_t) 0, i_85361);
                bool i_p_m_t_s_leq_w_56050 = slt64(i_85361, (int64_t) 28);
                bool i_lte_j_56052 = sle64(i_85361, j_56047);
                bool y_56053 = zzero_leq_i_p_m_t_s_56049 &&
                     i_p_m_t_s_leq_w_56050;
                bool y_56054 = zzero_leq_i_p_m_t_s_56049 && y_56053;
                bool y_56055 = i_lte_j_56052 && y_56054;
                bool forwards_ok_56056 = zzero_leq_i_p_m_t_s_56049 && y_56055;
                
                for (int32_t i_87388 = 0; i_87388 < 28; i_87388++) {
                    int64_t i_85357 = sext_i32_i64(i_87388);
                    int64_t j_56060 = add64((int64_t) 1, i_85357);
                    bool zzero_leq_i_p_m_t_s_56062 = sle64((int64_t) 0,
                                                           i_85357);
                    bool i_p_m_t_s_leq_w_56063 = slt64(i_85357, (int64_t) 28);
                    bool i_lte_j_56065 = sle64(i_85357, j_56060);
                    bool y_56066 = zzero_leq_i_p_m_t_s_56062 &&
                         i_p_m_t_s_leq_w_56063;
                    bool y_56067 = zzero_leq_i_p_m_t_s_56062 && y_56066;
                    bool y_56068 = i_lte_j_56065 && y_56067;
                    bool forwards_ok_56069 = zzero_leq_i_p_m_t_s_56062 &&
                         y_56068;
                    bool index_ok_56071 = forwards_ok_56056 &&
                         forwards_ok_56069;
                    bool index_certs_56072;
                    
                    if (!index_ok_56071) {
                        set_error(ctx,
                                  msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                            "Index [", (long long) i_85361, ":",
                                            (long long) j_56047, ", ",
                                            (long long) i_85357, ":",
                                            (long long) j_56060,
                                            "] out of bounds for array of shape [",
                                            (long long) (int64_t) 28, "][",
                                            (long long) (int64_t) 28, "].",
                                            "-> #0  ../layers/conv2d.fut:13:90-124\n   #1  ../layers/conv2d.fut:13:69-146\n   #2  /prelude/soacs.fut:59:3-10\n   #3  /prelude/array.fut:200:3-17\n   #4  /prelude/functional.fut:39:59-65\n   #5  /prelude/soacs.fut:59:3-10\n   #6  /prelude/array.fut:208:3-34\n   #7  ../layers/conv2d.fut:13:26-162\n   #8  ../layers/conv2d.fut:26:17-54\n   #9  test_diffusion.fut:57:1-59:11\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    for (int64_t i_114114 = 0; i_114114 < (int64_t) 64;
                         i_114114++) {
                        double tmp_114115 =
                               ((double *) mem_101399)[(int64_t) 28 * i_85361 +
                                                       i_85357 + (i_114114 *
                                                                  (int64_t) 784 +
                                                                  (i_114114 -
                                                                   i_114114) *
                                                                  (int64_t) 28 +
                                                                  (i_114114 -
                                                                   i_114114 -
                                                                   (i_114114 -
                                                                    i_114114)))];
                        
                        ((double *) mem_101483)[i_85361 * (int64_t) 1792 +
                                                i_85357 * (int64_t) 64 +
                                                i_114114] = tmp_114115;
                    }
                }
            }
            
            double x_56114 = ((double *) mem_param_97146.mem)[(int64_t) 0];
            
            for (int32_t i_86814 = 0; i_86814 < 784; i_86814++) {
                int64_t i_85367 = sext_i32_i64(i_86814);
                int64_t binop_x_90919 = (int64_t) 64 * i_85367;
                double defunc_2_reduce_res_83979;
                double redout_85363 = 0.0;
                
                for (int32_t i_87387 = 0; i_87387 < 64; i_87387++) {
                    int64_t i_85364 = sext_i32_i64(i_87387);
                    int64_t new_index_90893 = squot64(i_85364, (int64_t) 64);
                    int64_t binop_y_90895 = (int64_t) 64 * new_index_90893;
                    int64_t new_index_90896 = i_85364 - binop_y_90895;
                    int64_t new_index_90903 = new_index_90896 - new_index_90896;
                    int64_t new_index_90918 = new_index_90903 - new_index_90903;
                    double x_78765 =
                           ((double *) mem_param_97141.mem)[new_index_90893 *
                                                            (int64_t) 64 +
                                                            new_index_90896 +
                                                            new_index_90903 +
                                                            new_index_90918];
                    int64_t binop_x_90920 = i_85364 + binop_x_90919;
                    int64_t new_index_90921 = squot64(binop_x_90920,
                                                      (int64_t) 1792);
                    int64_t binop_y_90927 = (int64_t) 1792 * new_index_90921;
                    int64_t binop_x_90928 = binop_x_90920 - binop_y_90927;
                    int64_t new_index_90929 = squot64(binop_x_90928,
                                                      (int64_t) 64);
                    int64_t binop_y_90945 = (int64_t) 64 * new_index_90929;
                    int64_t new_index_90946 = binop_x_90928 - binop_y_90945;
                    double x_78766 = ((double *) mem_101483)[new_index_90921 *
                                                             (int64_t) 1792 +
                                                             new_index_90929 *
                                                             (int64_t) 64 +
                                                             new_index_90946];
                    double defunc_1_f_res_78767 = x_78765 * x_78766;
                    double defunc_1_op_res_74417 = defunc_1_f_res_78767 +
                           redout_85363;
                    double redout_tmp_114117 = defunc_1_op_res_74417;
                    
                    redout_85363 = redout_tmp_114117;
                }
                defunc_2_reduce_res_83979 = redout_85363;
                
                double defunc_0_f_res_74420 = x_56114 +
                       defunc_2_reduce_res_83979;
                
                ((double *) mem_101535)[i_85367] = defunc_0_f_res_74420;
            }
            
            double defunc_2_reduce_res_84336;
            double redout_85375 = 0.0;
            
            for (int64_t i_85377 = 0; i_85377 < m_49205; i_85377++) {
                int64_t binop_x_90881 = n_49206 * i_85377;
                int64_t binop_x_90886 = (int64_t) 28 * i_85377;
                double defunc_2_reduce_res_83980;
                double redout_85370 = 0.0;
                
                for (int64_t i_85372 = 0; i_85372 < n_49206; i_85372++) {
                    int64_t new_index_90882 = i_85372 + binop_x_90881;
                    double x_78777 = ((double *) mem_97633)[new_index_90882];
                    int64_t binop_x_90887 = i_85372 + binop_x_90886;
                    int64_t binop_x_90890 = squot64(binop_x_90887,
                                                    (int64_t) 784);
                    int64_t binop_y_90891 = (int64_t) 784 * binop_x_90890;
                    int64_t new_index_90892 = binop_x_90887 - binop_y_90891;
                    double x_78778 = ((double *) mem_101535)[new_index_90892];
                    double x_78781 = x_78777 - x_78778;
                    double defunc_1_f_res_78782 = fpow64(x_78781, 2.0);
                    double y_78784 = x_78778 - x_78777;
                    double x_78785 = 2.0 * y_78784;
                    double defunc_1_f_res_78786 = x_78785 / i64_res_54204;
                    double defunc_1_op_res_75536 = defunc_1_f_res_78782 +
                           redout_85370;
                    
                    ((double *) mem_101560)[i_85372] = defunc_1_f_res_78786;
                    
                    double redout_tmp_114120 = defunc_1_op_res_75536;
                    
                    redout_85370 = redout_tmp_114120;
                }
                defunc_2_reduce_res_83980 = redout_85370;
                
                double mse_res_75538 = defunc_2_reduce_res_83980 /
                       i64_res_54201;
                double defunc_1_op_res_54679 = mse_res_75538 + redout_85375;
                
                if (n_49206 * (int64_t) 8 > 0)
                    memmove(mem_101549 + i_85377 * n_49206 * (int64_t) 8,
                            mem_101560 + (int64_t) 0, n_49206 * (int64_t) 8);
                
                double redout_tmp_114118 = defunc_1_op_res_54679;
                
                redout_85375 = redout_tmp_114118;
            }
            defunc_2_reduce_res_84336 = redout_85375;
            
            double mse_loss_img_res_54681 = defunc_2_reduce_res_84336 /
                   i64_res_54202;
            
            for (int64_t i_114122 = 0; i_114122 < (int64_t) 1; i_114122++) {
                if (m_49205 * n_49206 * (int64_t) 8 > 0)
                    memmove(mem_101582 + i_114122 * (n_49206 * m_49205) *
                            (int64_t) 8, mem_101549 + (int64_t) 0, m_49205 *
                            n_49206 * (int64_t) 8);
            }
            
            int64_t x_54777 = add64(x_54378, i_54464);
            int64_t adam_unet_arg_54778 = add64((int64_t) 1, x_54777);
            double i64_res_56525 = sitofp_i64_f64(adam_unet_arg_54778);
            double y_56530 = fpow64(0.999, i64_res_56525);
            double y_56531 = 1.0 - y_56530;
            double y_56526 = fpow64(0.9, i64_res_56525);
            double y_56527 = 1.0 - y_56526;
            
            for (int64_t i_85385 = 0; i_85385 < new_n_59697; i_85385++) {
                int64_t j_59793 = add64((int64_t) 28, i_85385);
                int64_t i_p_m_t_s_59794 = add64((int64_t) 27, i_85385);
                bool zzero_leq_i_p_m_t_s_59795 = sle64((int64_t) 0,
                                                       i_p_m_t_s_59794);
                bool i_p_m_t_s_leq_w_59796 = slt64(i_p_m_t_s_59794, x_55816);
                bool i_lte_j_59798 = sle64(i_85385, j_59793);
                bool y_59800 = zzero_leq_i_p_m_t_s_59795 &&
                     i_p_m_t_s_leq_w_59796;
                bool y_59801 = i_lte_j_59798 && y_59800;
                
                for (int64_t i_85381 = 0; i_85381 < new_m_59700; i_85381++) {
                    int64_t j_59806 = add64((int64_t) 28, i_85381);
                    int64_t i_p_m_t_s_59807 = add64((int64_t) 27, i_85381);
                    bool zzero_leq_i_p_m_t_s_59808 = sle64((int64_t) 0,
                                                           i_p_m_t_s_59807);
                    bool i_p_m_t_s_leq_w_59809 = slt64(i_p_m_t_s_59807,
                                                       x_55820);
                    bool i_lte_j_59811 = sle64(i_85381, j_59806);
                    bool y_59813 = zzero_leq_i_p_m_t_s_59808 &&
                         i_p_m_t_s_leq_w_59809;
                    bool y_59814 = i_lte_j_59811 && y_59813;
                    bool index_ok_59817 = y_59801 && y_59814;
                    bool index_certs_59818;
                    
                    if (!index_ok_59817) {
                        set_error(ctx,
                                  msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                            "Index [", (long long) i_85385, ":",
                                            (long long) j_59793, ", ",
                                            (long long) i_85381, ":",
                                            (long long) j_59806,
                                            "] out of bounds for array of shape [",
                                            (long long) x_55816, "][",
                                            (long long) x_55820, "].",
                                            "-> #0  ../layers/conv2d.fut:13:90-124\n   #1  ../layers/conv2d.fut:13:69-146\n   #2  /prelude/soacs.fut:59:3-10\n   #3  /prelude/array.fut:200:3-17\n   #4  /prelude/functional.fut:39:59-65\n   #5  /prelude/soacs.fut:59:3-10\n   #6  /prelude/array.fut:208:3-34\n   #7  ../layers/conv2d.fut:13:26-162\n   #8  /prelude/soacs.fut:59:3-10\n   #9  /prelude/array.fut:208:3-34\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    for (int64_t i_114125 = 0; i_114125 < (int64_t) 784;
                         i_114125++) {
                        double tmp_114126 = ((double *) mem_97716)[x_55820 *
                                                                   i_85385 +
                                                                   i_85381 +
                                                                   (squot64(i_114125,
                                                                            (int64_t) 28) *
                                                                    x_55820 +
                                                                    (i_114125 -
                                                                     squot64(i_114125,
                                                                             (int64_t) 28) *
                                                                     (int64_t) 28))];
                        
                        ((double *) mem_101616)[i_114125] = tmp_114126;
                    }
                    if ((int64_t) 6272 > 0)
                        memmove(mem_101587 + (i_85385 * binop_y_87989 +
                                              i_85381 * (int64_t) 784) *
                                (int64_t) 8, mem_101616 + (int64_t) 0,
                                (int64_t) 6272);
                }
            }
            for (int64_t i_85393 = 0; i_85393 < m_49205; i_85393++) {
                int64_t j_58980 = add64((int64_t) 1, i_85393);
                bool i_lte_j_58985 = sle64(i_85393, j_58980);
                
                for (int64_t i_85389 = 0; i_85389 < n_49206; i_85389++) {
                    int64_t j_58993 = add64((int64_t) 1, i_85389);
                    bool i_lte_j_58998 = sle64(i_85389, j_58993);
                    bool index_ok_59004 = i_lte_j_58985 && i_lte_j_58998;
                    bool index_certs_59005;
                    
                    if (!index_ok_59004) {
                        set_error(ctx,
                                  msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                            "Index [", (long long) i_85393, ":",
                                            (long long) j_58980, ", ",
                                            (long long) i_85389, ":",
                                            (long long) j_58993,
                                            "] out of bounds for array of shape [",
                                            (long long) m_49205, "][",
                                            (long long) n_49206, "].",
                                            "-> #0  ../layers/conv2d.fut:13:90-124\n   #1  ../layers/conv2d.fut:13:69-146\n   #2  /prelude/soacs.fut:59:3-10\n   #3  /prelude/array.fut:200:3-17\n   #4  /prelude/functional.fut:39:59-65\n   #5  /prelude/soacs.fut:59:3-10\n   #6  /prelude/array.fut:208:3-34\n   #7  ../layers/conv2d.fut:13:26-162\n   #8  ../layers/conv2d.fut:26:17-54\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    if ((int64_t) 8 > 0)
                        memmove(mem_101650 + (i_85393 * n_49206 + i_85389) *
                                (int64_t) 8, mem_101582 + (n_49206 * i_85393 +
                                                           i_85389) *
                                (int64_t) 8, (int64_t) 8);
                }
            }
            for (int32_t i_86815 = 0; i_86815 < 64; i_86815++) {
                int64_t i_85401 = sext_i32_i64(i_86815);
                int64_t new_index_90857 = i_85401 - i_85401;
                int64_t new_index_90860 = new_index_90857 - new_index_90857;
                int64_t new_index_90867 = new_index_90860 - new_index_90860;
                int64_t slice_90879 = (int64_t) -1 * new_index_90860;
                int64_t slice_90880 = (int64_t) -1 * new_index_90867;
                double defunc_5_map_res_transformed_row_65634 =
                       ((double *) mem_param_97141.mem)[new_index_90857 *
                                                        (int64_t) 64 + i_85401 +
                                                        slice_90879 +
                                                        slice_90880];
                
                for (int64_t i_85397 = 0; i_85397 < i64_arg_54203; i_85397++) {
                    int64_t new_index_90868 = squot64(i_85397, n_49206);
                    int64_t binop_y_90870 = n_49206 * new_index_90868;
                    int64_t new_index_90871 = i_85397 - binop_y_90870;
                    int64_t new_index_90878 = new_index_90871 - new_index_90871;
                    double flatten_res_transformed_row_65636 =
                           ((double *) mem_101650)[new_index_90868 * n_49206 +
                                                   new_index_90871 +
                                                   new_index_90878];
                    double defunc_1_f_res_59020 =
                           defunc_5_map_res_transformed_row_65634 *
                           flatten_res_transformed_row_65636;
                    
                    ((double *) mem_101707)[i_85401 * i64_arg_54203 + i_85397] =
                        defunc_1_f_res_59020;
                }
            }
            for (int32_t i_86816 = 0; i_86816 < 32; i_86816++) {
                int64_t i_85407 = sext_i32_i64(i_86816);
                int64_t i_77102 = mul64((int64_t) 2, i_85407);
                int64_t x_77103 = add64((int64_t) 1, i_85407);
                int64_t j_77104 = mul64((int64_t) 2, x_77103);
                int64_t j_m_i_77105 = sub64(j_77104, i_77102);
                bool empty_slice_77106 = j_m_i_77105 == (int64_t) 0;
                int64_t m_77107 = sub64(j_m_i_77105, (int64_t) 1);
                int64_t i_p_m_t_s_77108 = add64(i_77102, m_77107);
                bool zzero_leq_i_p_m_t_s_77109 = sle64((int64_t) 0,
                                                       i_p_m_t_s_77108);
                bool i_p_m_t_s_leq_w_77110 = slt64(i_p_m_t_s_77108,
                                                   (int64_t) 64);
                bool zzero_lte_i_77111 = sle64((int64_t) 0, i_77102);
                bool i_lte_j_77112 = sle64(i_77102, j_77104);
                bool y_77113 = i_p_m_t_s_leq_w_77110 && zzero_lte_i_77111;
                bool y_77114 = zzero_leq_i_p_m_t_s_77109 && y_77113;
                bool y_77115 = i_lte_j_77112 && y_77114;
                bool forwards_ok_77116 = zzero_lte_i_77111 && y_77115;
                bool ok_or_empty_77117 = empty_slice_77106 || forwards_ok_77116;
                bool index_certs_77118;
                
                if (!ok_or_empty_77117) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Index [", (long long) i_77102, ":",
                                        (long long) j_77104,
                                        "] out of bounds for array of shape [",
                                        (long long) (int64_t) 64, "].",
                                        "-> #0  ../layers/groupnorm.fut:2:31-70\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  ../layers/groupnorm.fut:2:3-97\n   #4  test_diffusion.fut:57:1-59:11\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool dim_match_77119 = (int64_t) 2 == j_m_i_77105;
                bool empty_or_match_cert_77120;
                
                if (!dim_match_77119) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Value of (core language) shape (",
                                        (long long) j_m_i_77105, ", ",
                                        (long long) (int64_t) 28, ", ",
                                        (long long) (int64_t) 28,
                                        ") cannot match shape of type `[",
                                        (long long) (int64_t) 2, "][",
                                        (long long) (int64_t) 28, "][",
                                        (long long) (int64_t) 28, "]f64`.",
                                        "-> #0  ../layers/groupnorm.fut:2:31-96\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  ../layers/groupnorm.fut:2:3-97\n   #4  test_diffusion.fut:57:1-59:11\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                for (int64_t i_114133 = 0; i_114133 < (int64_t) 2; i_114133++) {
                    for (int64_t i_114134 = 0; i_114134 < (int64_t) 28;
                         i_114134++) {
                        for (int64_t i_114135 = 0; i_114135 < (int64_t) 28;
                             i_114135++) {
                            double tmp_114136 =
                                   ((double *) mem_101707)[n_49206 * m_49205 *
                                                           i_77102 + (i_114133 *
                                                                      (n_49206 *
                                                                       m_49205) +
                                                                      i_114134 *
                                                                      n_49206 +
                                                                      i_114135)];
                            
                            ((double *) mem_101750)[i_85407 * (int64_t) 1568 +
                                                    (i_114133 * (int64_t) 784 +
                                                     i_114134 * (int64_t) 28 +
                                                     i_114135)] = tmp_114136;
                        }
                    }
                }
                if ((int64_t) 12544 > 0)
                    memmove(mem_101752 + i_85407 * (int64_t) 1568 * (int64_t) 8,
                            mem_101399 + (int64_t) 784 * i_77102 * (int64_t) 8,
                            (int64_t) 12544);
            }
            for (int32_t i_86817 = 0; i_86817 < 32; i_86817++) {
                int64_t i_85417 = sext_i32_i64(i_86817);
                int64_t binop_x_90725 = (int64_t) 1568 * i_85417;
                double defunc_2_reduce_res_83985;
                double defunc_2_reduce_res_83986;
                double redout_85410;
                double redout_85411;
                
                redout_85410 = 0.0;
                redout_85411 = 0.0;
                for (int32_t i_87376 = 0; i_87376 < 1568; i_87376++) {
                    int64_t i_85412 = sext_i32_i64(i_87376);
                    int64_t binop_x_90726 = i_85412 + binop_x_90725;
                    int64_t new_index_90727 = squot64(binop_x_90726,
                                                      (int64_t) 1568);
                    int64_t binop_y_90733 = (int64_t) 1568 * new_index_90727;
                    int64_t binop_x_90734 = binop_x_90726 - binop_y_90733;
                    int64_t new_index_90735 = squot64(binop_x_90734,
                                                      (int64_t) 784);
                    int64_t binop_y_90751 = (int64_t) 784 * new_index_90735;
                    int64_t binop_x_90752 = binop_x_90734 - binop_y_90751;
                    int64_t new_index_90753 = squot64(binop_x_90752,
                                                      (int64_t) 28);
                    int64_t binop_y_90789 = (int64_t) 28 * new_index_90753;
                    int64_t new_index_90790 = binop_x_90752 - binop_y_90789;
                    double x_79511 = ((double *) mem_101750)[new_index_90727 *
                                                             (int64_t) 1568 +
                                                             new_index_90735 *
                                                             (int64_t) 784 +
                                                             new_index_90753 *
                                                             (int64_t) 28 +
                                                             new_index_90790];
                    double x_79512 = ((double *) mem_101752)[new_index_90727 *
                                                             (int64_t) 1568 +
                                                             new_index_90735 *
                                                             (int64_t) 784 +
                                                             new_index_90753 *
                                                             (int64_t) 28 +
                                                             new_index_90790];
                    double defunc_1_f_res_79514 = x_79511 * x_79512;
                    double defunc_1_op_res_56212 = x_79511 + redout_85410;
                    double defunc_1_op_res_56221 = defunc_1_f_res_79514 +
                           redout_85411;
                    double redout_tmp_114139 = defunc_1_op_res_56212;
                    double redout_tmp_114140 = defunc_1_op_res_56221;
                    
                    redout_85410 = redout_tmp_114139;
                    redout_85411 = redout_tmp_114140;
                }
                defunc_2_reduce_res_83985 = redout_85410;
                defunc_2_reduce_res_83986 = redout_85411;
                ((double *) mem_101810)[i_85417] = defunc_2_reduce_res_83985;
                ((double *) mem_101812)[i_85417] = defunc_2_reduce_res_83986;
            }
            for (int32_t i_86818 = 0; i_86818 < 32; i_86818++) {
                int64_t i_85434 = sext_i32_i64(i_86818);
                bool x_56242 = sle64((int64_t) 0, i_85434);
                bool y_56243 = slt64(i_85434, (int64_t) 32);
                bool bounds_check_56244 = x_56242 && y_56243;
                bool index_certs_56245;
                
                if (!bounds_check_56244) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Index [", (long long) i_85434,
                                        "] out of bounds for array of shape [",
                                        (long long) (int64_t) 32, "].",
                                        "-> #0  ../layers/groupnorm.fut:36:43-66\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  test_diffusion.fut:57:1-59:11\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                double defunc_0_f_res_56246 = ((double *) mem_101810)[i_85434];
                double defunc_0_f_res_56247 = ((double *) mem_101812)[i_85434];
                bool index_certs_56250;
                
                if (!bounds_check_56244) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Index [", (long long) i_85434,
                                        "] out of bounds for array of shape [",
                                        (long long) (int64_t) 32, "].",
                                        "-> #0  ../layers/groupnorm.fut:40:18-23\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  /prelude/functional.fut:39:59-65\n   #7  /prelude/soacs.fut:59:3-10\n   #8  /prelude/array.fut:216:3-39\n   #9  ../layers/groupnorm.fut:37:10-40:31\n   #10 /prelude/soacs.fut:59:3-10\n   #11 /prelude/array.fut:200:3-17\n   #12 test_diffusion.fut:57:1-59:11\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                double x_56251 = ((double *) mem_101377)[i_85434];
                double sqrt_arg_56252 = 1.0e-5 + x_56251;
                double sqrt_res_56253 = futrts_sqrt64(sqrt_arg_56252);
                
                for (int32_t i_87365 = 0; i_87365 < 2; i_87365++) {
                    int64_t i_85430 = sext_i32_i64(i_87365);
                    bool x_56256 = sle64((int64_t) 0, i_85430);
                    bool y_56257 = slt64(i_85430, (int64_t) 2);
                    bool bounds_check_56258 = x_56256 && y_56257;
                    
                    for (int32_t i_87366 = 0; i_87366 < 28; i_87366++) {
                        int64_t i_85426 = sext_i32_i64(i_87366);
                        bool x_56261 = sle64((int64_t) 0, i_85426);
                        bool y_56262 = slt64(i_85426, (int64_t) 28);
                        bool bounds_check_56263 = x_56261 && y_56262;
                        
                        for (int32_t i_87367 = 0; i_87367 < 28; i_87367++) {
                            int64_t i_85422 = sext_i32_i64(i_87367);
                            bool x_56268 = sle64((int64_t) 0, i_85422);
                            bool y_56269 = slt64(i_85422, (int64_t) 28);
                            bool bounds_check_56270 = x_56268 && y_56269;
                            bool y_56271 = bounds_check_56244 &&
                                 bounds_check_56270;
                            bool y_56272 = bounds_check_56263 && y_56271;
                            bool index_ok_56273 = bounds_check_56258 && y_56272;
                            bool index_certs_56274;
                            
                            if (!index_ok_56273) {
                                set_error(ctx,
                                          msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                    "Index [",
                                                    (long long) i_85434, ", ",
                                                    (long long) i_85430, ", ",
                                                    (long long) i_85426, ", ",
                                                    (long long) i_85422,
                                                    "] out of bounds for array of shape [",
                                                    (long long) (int64_t) 32,
                                                    "][",
                                                    (long long) (int64_t) 2,
                                                    "][",
                                                    (long long) (int64_t) 28,
                                                    "][",
                                                    (long long) (int64_t) 28,
                                                    "].",
                                                    "-> #0  ../layers/groupnorm.fut:39:30-48\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  /prelude/functional.fut:39:59-65\n   #7  /prelude/soacs.fut:59:3-10\n   #8  /prelude/array.fut:216:3-39\n   #9  ../layers/groupnorm.fut:37:10-40:31\n   #10 /prelude/soacs.fut:59:3-10\n   #11 /prelude/array.fut:200:3-17\n   #12 test_diffusion.fut:57:1-59:11\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            double y_56275 = ((double *) mem_101750)[i_85434 *
                                                                     (int64_t) 1568 +
                                                                     i_85430 *
                                                                     (int64_t) 784 +
                                                                     i_85426 *
                                                                     (int64_t) 28 +
                                                                     i_85422];
                            double x_56276 = 1568.0 * y_56275;
                            double x_56277 = x_56276 - defunc_0_f_res_56246;
                            double x_56284 = ((double *) mem_101752)[i_85434 *
                                                                     (int64_t) 1568 +
                                                                     i_85430 *
                                                                     (int64_t) 784 +
                                                                     i_85426 *
                                                                     (int64_t) 28 +
                                                                     i_85422];
                            double y_56285 = defunc_0_f_res_56247 * x_56284;
                            double y_56286 = x_56277 - y_56285;
                            double x_56287 = 6.377551020408163e-4 * y_56286;
                            double defunc_0_f_res_56288 = x_56287 /
                                   sqrt_res_56253;
                            
                            ((double *) mem_101834)[i_85434 * (int64_t) 1568 +
                                                    i_85430 * (int64_t) 784 +
                                                    i_85426 * (int64_t) 28 +
                                                    i_85422] =
                                defunc_0_f_res_56288;
                        }
                    }
                }
            }
            for (int32_t i_86819 = 0; i_86819 < 64; i_86819++) {
                int64_t i_85456 = sext_i32_i64(i_86819);
                int64_t binop_x_90613 = (int64_t) 784 * i_85456;
                
                for (int32_t i_87357 = 0; i_87357 < 28; i_87357++) {
                    int64_t i_85442 = sext_i32_i64(i_87357);
                    int64_t binop_y_90614 = (int64_t) 28 * i_85442;
                    int64_t binop_x_90615 = binop_x_90613 + binop_y_90614;
                    
                    for (int32_t i_87364 = 0; i_87364 < 28; i_87364++) {
                        int64_t i_85438 = sext_i32_i64(i_87364);
                        int64_t binop_x_90616 = i_85438 + binop_x_90615;
                        int64_t new_index_90617 = squot64(binop_x_90616,
                                                          (int64_t) 1568);
                        int64_t binop_y_90627 = (int64_t) 1568 *
                                new_index_90617;
                        int64_t binop_x_90628 = binop_x_90616 - binop_y_90627;
                        int64_t new_index_90629 = squot64(binop_x_90628,
                                                          (int64_t) 784);
                        int64_t binop_y_90653 = (int64_t) 784 * new_index_90629;
                        int64_t binop_x_90654 = binop_x_90628 - binop_y_90653;
                        int64_t new_index_90655 = squot64(binop_x_90654,
                                                          (int64_t) 28);
                        int64_t binop_y_90707 = (int64_t) 28 * new_index_90655;
                        int64_t new_index_90708 = binop_x_90654 - binop_y_90707;
                        double x_74359 =
                               ((double *) mem_101834)[new_index_90617 *
                                                       (int64_t) 1568 +
                                                       new_index_90629 *
                                                       (int64_t) 784 +
                                                       new_index_90655 *
                                                       (int64_t) 28 +
                                                       new_index_90708];
                        int64_t new_index_90713 = squot64(binop_x_90616,
                                                          (int64_t) 784);
                        int64_t binop_y_90723 = (int64_t) 784 * new_index_90713;
                        int64_t new_index_90724 = binop_x_90616 - binop_y_90723;
                        double x_74360 =
                               ((double *) mem_101221)[new_index_90713 *
                                                       (int64_t) 784 +
                                                       new_index_90724];
                        bool cond_74361 = 0.0 < x_74360;
                        double defunc_1_f_res_74362;
                        
                        if (cond_74361 == 1) {
                            defunc_1_f_res_74362 = x_74359;
                        } else {
                            defunc_1_f_res_74362 = 0.0;
                        }
                        ((double *) mem_101980)[i_85456 * (int64_t) 784 +
                                                i_85442 * (int64_t) 28 +
                                                i_85438] = defunc_1_f_res_74362;
                    }
                }
                for (int32_t i_87358 = 0; i_87358 < 30; i_87358++) {
                    int64_t i_85450 = sext_i32_i64(i_87358);
                    bool cond_74366 = slt64(i_85450, (int64_t) 1);
                    bool cond_f_res_74367 = sle64((int64_t) 29, i_85450);
                    bool x_74368 = !cond_74366;
                    bool y_74369 = cond_f_res_74367 && x_74368;
                    bool cond_74370 = cond_74366 || y_74369;
                    bool x_74371 = !cond_74370;
                    
                    for (int32_t i_87359 = 0; i_87359 < 30; i_87359++) {
                        int64_t i_85446 = sext_i32_i64(i_87359);
                        bool cond_f_res_74374 = slt64(i_85446, (int64_t) 1);
                        bool y_74375 = x_74371 && cond_f_res_74374;
                        bool cond_74376 = cond_74370 || y_74375;
                        bool cond_f_res_74377 = sle64((int64_t) 29, i_85446);
                        bool x_74378 = !cond_74376;
                        bool y_74379 = cond_f_res_74377 && x_74378;
                        bool cond_74380 = cond_74376 || y_74379;
                        double defunc_0_f_res_74381;
                        
                        if (cond_74380 == 1) {
                            defunc_0_f_res_74381 = 0.0;
                        } else {
                            int64_t i_74382 = sub64(i_85450, (int64_t) 1);
                            bool x_74383 = sle64((int64_t) 0, i_74382);
                            bool y_74384 = slt64(i_74382, (int64_t) 28);
                            bool bounds_check_74385 = x_74383 && y_74384;
                            int64_t i_74386 = sub64(i_85446, (int64_t) 1);
                            bool x_74387 = sle64((int64_t) 0, i_74386);
                            bool y_74388 = slt64(i_74386, (int64_t) 28);
                            bool bounds_check_74389 = x_74387 && y_74388;
                            bool index_ok_74390 = bounds_check_74385 &&
                                 bounds_check_74389;
                            bool index_certs_74391;
                            
                            if (!index_ok_74390) {
                                set_error(ctx,
                                          msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                    "Index [",
                                                    (long long) i_74382, ", ",
                                                    (long long) i_74386,
                                                    "] out of bounds for array of shape [",
                                                    (long long) (int64_t) 28,
                                                    "][",
                                                    (long long) (int64_t) 28,
                                                    "].",
                                                    "-> #0  ../layers/conv2d.fut:7:91-116\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  ../layers/conv2d.fut:6:22-7:117\n   #7  ../layers/conv2d.fut:6:6-7:123\n   #8  ../layers/conv2d.fut:22:7-30\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            double defunc_0_f_res_f_res_74392 =
                                   ((double *) mem_101980)[i_85456 *
                                                           (int64_t) 784 +
                                                           i_74382 *
                                                           (int64_t) 28 +
                                                           i_74386];
                            
                            defunc_0_f_res_74381 = defunc_0_f_res_f_res_74392;
                        }
                        ((double *) mem_101978)[i_85456 * (int64_t) 900 +
                                                i_85450 * (int64_t) 30 +
                                                i_85446] = defunc_0_f_res_74381;
                    }
                }
            }
            for (int32_t i_86820 = 0; i_86820 < 28; i_86820++) {
                int64_t i_85465 = sext_i32_i64(i_86820);
                int64_t j_59298 = add64((int64_t) 3, i_85465);
                int64_t i_p_m_t_s_59299 = add64((int64_t) 2, i_85465);
                bool zzero_leq_i_p_m_t_s_59300 = sle64((int64_t) 0,
                                                       i_p_m_t_s_59299);
                bool i_p_m_t_s_leq_w_59301 = slt64(i_p_m_t_s_59299,
                                                   (int64_t) 30);
                bool zzero_lte_i_59302 = sle64((int64_t) 0, i_85465);
                bool i_lte_j_59303 = sle64(i_85465, j_59298);
                bool y_59304 = i_p_m_t_s_leq_w_59301 && zzero_lte_i_59302;
                bool y_59305 = zzero_leq_i_p_m_t_s_59300 && y_59304;
                bool y_59306 = i_lte_j_59303 && y_59305;
                bool forwards_ok_59307 = zzero_lte_i_59302 && y_59306;
                
                for (int32_t i_87352 = 0; i_87352 < 28; i_87352++) {
                    int64_t i_85461 = sext_i32_i64(i_87352);
                    int64_t j_59311 = add64((int64_t) 3, i_85461);
                    int64_t i_p_m_t_s_59312 = add64((int64_t) 2, i_85461);
                    bool zzero_leq_i_p_m_t_s_59313 = sle64((int64_t) 0,
                                                           i_p_m_t_s_59312);
                    bool i_p_m_t_s_leq_w_59314 = slt64(i_p_m_t_s_59312,
                                                       (int64_t) 30);
                    bool zzero_lte_i_59315 = sle64((int64_t) 0, i_85461);
                    bool i_lte_j_59316 = sle64(i_85461, j_59311);
                    bool y_59317 = i_p_m_t_s_leq_w_59314 && zzero_lte_i_59315;
                    bool y_59318 = zzero_leq_i_p_m_t_s_59313 && y_59317;
                    bool y_59319 = i_lte_j_59316 && y_59318;
                    bool forwards_ok_59320 = zzero_lte_i_59315 && y_59319;
                    bool index_ok_59322 = forwards_ok_59307 &&
                         forwards_ok_59320;
                    bool index_certs_59323;
                    
                    if (!index_ok_59322) {
                        set_error(ctx,
                                  msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                            "Index [", (long long) i_85465, ":",
                                            (long long) j_59298, ", ",
                                            (long long) i_85461, ":",
                                            (long long) j_59311,
                                            "] out of bounds for array of shape [",
                                            (long long) (int64_t) 30, "][",
                                            (long long) (int64_t) 30, "].",
                                            "-> #0  ../layers/conv2d.fut:13:90-124\n   #1  ../layers/conv2d.fut:13:69-146\n   #2  /prelude/soacs.fut:59:3-10\n   #3  /prelude/array.fut:200:3-17\n   #4  /prelude/functional.fut:39:59-65\n   #5  /prelude/soacs.fut:59:3-10\n   #6  /prelude/array.fut:208:3-34\n   #7  ../layers/conv2d.fut:13:26-162\n   #8  ../layers/conv2d.fut:26:17-54\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    for (int64_t i_114153 = 0; i_114153 < (int64_t) 576;
                         i_114153++) {
                        double tmp_114154 =
                               ((double *) mem_101978)[(int64_t) 30 * i_85465 +
                                                       i_85461 +
                                                       (squot64(i_114153,
                                                                (int64_t) 9) *
                                                        (int64_t) 900 +
                                                        squot64(i_114153 -
                                                                squot64(i_114153,
                                                                        (int64_t) 9) *
                                                                (int64_t) 9,
                                                                (int64_t) 3) *
                                                        (int64_t) 30 +
                                                        (i_114153 -
                                                         squot64(i_114153,
                                                                 (int64_t) 9) *
                                                         (int64_t) 9 -
                                                         squot64(i_114153 -
                                                                 squot64(i_114153,
                                                                         (int64_t) 9) *
                                                                 (int64_t) 9,
                                                                 (int64_t) 3) *
                                                         (int64_t) 3))];
                        
                        ((double *) mem_102146)[i_85465 * (int64_t) 16128 +
                                                i_85461 * (int64_t) 576 +
                                                i_114153] = tmp_114154;
                    }
                }
            }
            for (int32_t i_86821 = 0; i_86821 < 64; i_86821++) {
                int64_t i_85475 = sext_i32_i64(i_86821);
                int64_t binop_x_90515 = (int64_t) 576 * i_85475;
                
                for (int32_t i_87350 = 0; i_87350 < 784; i_87350++) {
                    int64_t i_85471 = sext_i32_i64(i_87350);
                    int64_t binop_x_90581 = (int64_t) 576 * i_85471;
                    double defunc_2_reduce_res_83995;
                    double redout_85467 = 0.0;
                    
                    for (int32_t i_87351 = 0; i_87351 < 576; i_87351++) {
                        int64_t i_85468 = sext_i32_i64(i_87351);
                        int64_t binop_x_90516 = i_85468 + binop_x_90515;
                        int64_t new_index_90517 = squot64(binop_x_90516,
                                                          (int64_t) 576);
                        int64_t binop_y_90523 = (int64_t) 576 * new_index_90517;
                        int64_t binop_x_90524 = binop_x_90516 - binop_y_90523;
                        int64_t new_index_90525 = squot64(binop_x_90524,
                                                          (int64_t) 9);
                        int64_t binop_y_90541 = (int64_t) 9 * new_index_90525;
                        int64_t binop_x_90542 = binop_x_90524 - binop_y_90541;
                        int64_t new_index_90543 = squot64(binop_x_90542,
                                                          (int64_t) 3);
                        int64_t binop_y_90579 = (int64_t) 3 * new_index_90543;
                        int64_t new_index_90580 = binop_x_90542 - binop_y_90579;
                        int64_t binop_y_90609 = (int64_t) -1 * new_index_90543;
                        int64_t slice_90610 = (int64_t) 2 + binop_y_90609;
                        int64_t binop_y_90611 = (int64_t) -1 * new_index_90580;
                        int64_t slice_90612 = (int64_t) 2 + binop_y_90611;
                        double x_79526 =
                               ((double *) mem_param_97122.mem)[new_index_90525 *
                                                                (int64_t) 576 +
                                                                new_index_90517 *
                                                                (int64_t) 9 +
                                                                slice_90610 *
                                                                (int64_t) 3 +
                                                                slice_90612];
                        int64_t binop_x_90582 = i_85468 + binop_x_90581;
                        int64_t new_index_90583 = squot64(binop_x_90582,
                                                          (int64_t) 16128);
                        int64_t binop_y_90589 = (int64_t) 16128 *
                                new_index_90583;
                        int64_t binop_x_90590 = binop_x_90582 - binop_y_90589;
                        int64_t new_index_90591 = squot64(binop_x_90590,
                                                          (int64_t) 576);
                        int64_t binop_y_90607 = (int64_t) 576 * new_index_90591;
                        int64_t new_index_90608 = binop_x_90590 - binop_y_90607;
                        double x_79527 =
                               ((double *) mem_102146)[new_index_90583 *
                                                       (int64_t) 16128 +
                                                       new_index_90591 *
                                                       (int64_t) 576 +
                                                       new_index_90608];
                        double defunc_1_f_res_79528 = x_79526 * x_79527;
                        double defunc_1_op_res_59342 = defunc_1_f_res_79528 +
                               redout_85467;
                        double redout_tmp_114157 = defunc_1_op_res_59342;
                        
                        redout_85467 = redout_tmp_114157;
                    }
                    defunc_2_reduce_res_83995 = redout_85467;
                    ((double *) mem_102198)[i_85475 * (int64_t) 784 + i_85471] =
                        defunc_2_reduce_res_83995;
                }
            }
            for (int32_t i_86822 = 0; i_86822 < 32; i_86822++) {
                int64_t i_85481 = sext_i32_i64(i_86822);
                int64_t i_77058 = mul64((int64_t) 2, i_85481);
                int64_t x_77059 = add64((int64_t) 1, i_85481);
                int64_t j_77060 = mul64((int64_t) 2, x_77059);
                int64_t j_m_i_77061 = sub64(j_77060, i_77058);
                bool empty_slice_77062 = j_m_i_77061 == (int64_t) 0;
                int64_t m_77063 = sub64(j_m_i_77061, (int64_t) 1);
                int64_t i_p_m_t_s_77064 = add64(i_77058, m_77063);
                bool zzero_leq_i_p_m_t_s_77065 = sle64((int64_t) 0,
                                                       i_p_m_t_s_77064);
                bool i_p_m_t_s_leq_w_77066 = slt64(i_p_m_t_s_77064,
                                                   (int64_t) 64);
                bool zzero_lte_i_77067 = sle64((int64_t) 0, i_77058);
                bool i_lte_j_77068 = sle64(i_77058, j_77060);
                bool y_77069 = i_p_m_t_s_leq_w_77066 && zzero_lte_i_77067;
                bool y_77070 = zzero_leq_i_p_m_t_s_77065 && y_77069;
                bool y_77071 = i_lte_j_77068 && y_77070;
                bool forwards_ok_77072 = zzero_lte_i_77067 && y_77071;
                bool ok_or_empty_77073 = empty_slice_77062 || forwards_ok_77072;
                bool index_certs_77074;
                
                if (!ok_or_empty_77073) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Index [", (long long) i_77058, ":",
                                        (long long) j_77060,
                                        "] out of bounds for array of shape [",
                                        (long long) (int64_t) 64, "].",
                                        "-> #0  ../layers/groupnorm.fut:2:31-70\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  ../layers/groupnorm.fut:2:3-97\n   #4  test_diffusion.fut:57:1-59:11\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool dim_match_77075 = (int64_t) 2 == j_m_i_77061;
                bool empty_or_match_cert_77076;
                
                if (!dim_match_77075) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Value of (core language) shape (",
                                        (long long) j_m_i_77061, ", ",
                                        (long long) (int64_t) 28, ", ",
                                        (long long) (int64_t) 28,
                                        ") cannot match shape of type `[",
                                        (long long) (int64_t) 2, "][",
                                        (long long) (int64_t) 28, "][",
                                        (long long) (int64_t) 28, "]f64`.",
                                        "-> #0  ../layers/groupnorm.fut:2:31-96\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  ../layers/groupnorm.fut:2:3-97\n   #4  test_diffusion.fut:57:1-59:11\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if ((int64_t) 12544 > 0)
                    memmove(mem_102238 + i_85481 * (int64_t) 1568 * (int64_t) 8,
                            mem_102198 + (int64_t) 784 * i_77058 * (int64_t) 8,
                            (int64_t) 12544);
                if ((int64_t) 12544 > 0)
                    memmove(mem_102240 + i_85481 * (int64_t) 1568 * (int64_t) 8,
                            mem_100911 + (int64_t) 784 * i_77058 * (int64_t) 8,
                            (int64_t) 12544);
            }
            for (int32_t i_86823 = 0; i_86823 < 32; i_86823++) {
                int64_t i_85491 = sext_i32_i64(i_86823);
                int64_t binop_x_90383 = (int64_t) 1568 * i_85491;
                double defunc_2_reduce_res_83997;
                double defunc_2_reduce_res_83998;
                double redout_85484;
                double redout_85485;
                
                redout_85484 = 0.0;
                redout_85485 = 0.0;
                for (int32_t i_87347 = 0; i_87347 < 1568; i_87347++) {
                    int64_t i_85486 = sext_i32_i64(i_87347);
                    int64_t binop_x_90384 = i_85486 + binop_x_90383;
                    int64_t new_index_90385 = squot64(binop_x_90384,
                                                      (int64_t) 1568);
                    int64_t binop_y_90391 = (int64_t) 1568 * new_index_90385;
                    int64_t binop_x_90392 = binop_x_90384 - binop_y_90391;
                    int64_t new_index_90393 = squot64(binop_x_90392,
                                                      (int64_t) 784);
                    int64_t binop_y_90409 = (int64_t) 784 * new_index_90393;
                    int64_t binop_x_90410 = binop_x_90392 - binop_y_90409;
                    int64_t new_index_90411 = squot64(binop_x_90410,
                                                      (int64_t) 28);
                    int64_t binop_y_90447 = (int64_t) 28 * new_index_90411;
                    int64_t new_index_90448 = binop_x_90410 - binop_y_90447;
                    double x_79541 = ((double *) mem_102238)[new_index_90385 *
                                                             (int64_t) 1568 +
                                                             new_index_90393 *
                                                             (int64_t) 784 +
                                                             new_index_90411 *
                                                             (int64_t) 28 +
                                                             new_index_90448];
                    double x_79542 = ((double *) mem_102240)[new_index_90385 *
                                                             (int64_t) 1568 +
                                                             new_index_90393 *
                                                             (int64_t) 784 +
                                                             new_index_90411 *
                                                             (int64_t) 28 +
                                                             new_index_90448];
                    double defunc_1_f_res_79544 = x_79541 * x_79542;
                    double defunc_1_op_res_56382 = x_79541 + redout_85484;
                    double defunc_1_op_res_56391 = defunc_1_f_res_79544 +
                           redout_85485;
                    double redout_tmp_114162 = defunc_1_op_res_56382;
                    double redout_tmp_114163 = defunc_1_op_res_56391;
                    
                    redout_85484 = redout_tmp_114162;
                    redout_85485 = redout_tmp_114163;
                }
                defunc_2_reduce_res_83997 = redout_85484;
                defunc_2_reduce_res_83998 = redout_85485;
                ((double *) mem_102298)[i_85491] = defunc_2_reduce_res_83997;
                ((double *) mem_102300)[i_85491] = defunc_2_reduce_res_83998;
            }
            for (int32_t i_86824 = 0; i_86824 < 32; i_86824++) {
                int64_t i_85508 = sext_i32_i64(i_86824);
                bool x_56412 = sle64((int64_t) 0, i_85508);
                bool y_56413 = slt64(i_85508, (int64_t) 32);
                bool bounds_check_56414 = x_56412 && y_56413;
                bool index_certs_56415;
                
                if (!bounds_check_56414) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Index [", (long long) i_85508,
                                        "] out of bounds for array of shape [",
                                        (long long) (int64_t) 32, "].",
                                        "-> #0  ../layers/groupnorm.fut:36:43-66\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  test_diffusion.fut:57:1-59:11\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                double defunc_0_f_res_56416 = ((double *) mem_102298)[i_85508];
                double defunc_0_f_res_56417 = ((double *) mem_102300)[i_85508];
                bool index_certs_56420;
                
                if (!bounds_check_56414) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Index [", (long long) i_85508,
                                        "] out of bounds for array of shape [",
                                        (long long) (int64_t) 32, "].",
                                        "-> #0  ../layers/groupnorm.fut:40:18-23\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  /prelude/functional.fut:39:59-65\n   #7  /prelude/soacs.fut:59:3-10\n   #8  /prelude/array.fut:216:3-39\n   #9  ../layers/groupnorm.fut:37:10-40:31\n   #10 /prelude/soacs.fut:59:3-10\n   #11 /prelude/array.fut:200:3-17\n   #12 test_diffusion.fut:57:1-59:11\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                double x_56421 = ((double *) mem_100883)[i_85508];
                double sqrt_arg_56422 = 1.0e-5 + x_56421;
                double sqrt_res_56423 = futrts_sqrt64(sqrt_arg_56422);
                
                for (int32_t i_87336 = 0; i_87336 < 2; i_87336++) {
                    int64_t i_85504 = sext_i32_i64(i_87336);
                    bool x_56426 = sle64((int64_t) 0, i_85504);
                    bool y_56427 = slt64(i_85504, (int64_t) 2);
                    bool bounds_check_56428 = x_56426 && y_56427;
                    
                    for (int32_t i_87337 = 0; i_87337 < 28; i_87337++) {
                        int64_t i_85500 = sext_i32_i64(i_87337);
                        bool x_56431 = sle64((int64_t) 0, i_85500);
                        bool y_56432 = slt64(i_85500, (int64_t) 28);
                        bool bounds_check_56433 = x_56431 && y_56432;
                        
                        for (int32_t i_87338 = 0; i_87338 < 28; i_87338++) {
                            int64_t i_85496 = sext_i32_i64(i_87338);
                            bool x_56438 = sle64((int64_t) 0, i_85496);
                            bool y_56439 = slt64(i_85496, (int64_t) 28);
                            bool bounds_check_56440 = x_56438 && y_56439;
                            bool y_56441 = bounds_check_56414 &&
                                 bounds_check_56440;
                            bool y_56442 = bounds_check_56433 && y_56441;
                            bool index_ok_56443 = bounds_check_56428 && y_56442;
                            bool index_certs_56444;
                            
                            if (!index_ok_56443) {
                                set_error(ctx,
                                          msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                    "Index [",
                                                    (long long) i_85508, ", ",
                                                    (long long) i_85504, ", ",
                                                    (long long) i_85500, ", ",
                                                    (long long) i_85496,
                                                    "] out of bounds for array of shape [",
                                                    (long long) (int64_t) 32,
                                                    "][",
                                                    (long long) (int64_t) 2,
                                                    "][",
                                                    (long long) (int64_t) 28,
                                                    "][",
                                                    (long long) (int64_t) 28,
                                                    "].",
                                                    "-> #0  ../layers/groupnorm.fut:39:30-48\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  /prelude/functional.fut:39:59-65\n   #7  /prelude/soacs.fut:59:3-10\n   #8  /prelude/array.fut:216:3-39\n   #9  ../layers/groupnorm.fut:37:10-40:31\n   #10 /prelude/soacs.fut:59:3-10\n   #11 /prelude/array.fut:200:3-17\n   #12 test_diffusion.fut:57:1-59:11\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            double y_56445 = ((double *) mem_102238)[i_85508 *
                                                                     (int64_t) 1568 +
                                                                     i_85504 *
                                                                     (int64_t) 784 +
                                                                     i_85500 *
                                                                     (int64_t) 28 +
                                                                     i_85496];
                            double x_56446 = 1568.0 * y_56445;
                            double x_56447 = x_56446 - defunc_0_f_res_56416;
                            double x_56454 = ((double *) mem_102240)[i_85508 *
                                                                     (int64_t) 1568 +
                                                                     i_85504 *
                                                                     (int64_t) 784 +
                                                                     i_85500 *
                                                                     (int64_t) 28 +
                                                                     i_85496];
                            double y_56455 = defunc_0_f_res_56417 * x_56454;
                            double y_56456 = x_56447 - y_56455;
                            double x_56457 = 6.377551020408163e-4 * y_56456;
                            double defunc_0_f_res_56458 = x_56457 /
                                   sqrt_res_56423;
                            
                            ((double *) mem_102322)[i_85508 * (int64_t) 1568 +
                                                    i_85504 * (int64_t) 784 +
                                                    i_85500 * (int64_t) 28 +
                                                    i_85496] =
                                defunc_0_f_res_56458;
                        }
                    }
                }
            }
            for (int32_t i_86825 = 0; i_86825 < 64; i_86825++) {
                int64_t i_85530 = sext_i32_i64(i_86825);
                int64_t binop_x_90271 = (int64_t) 784 * i_85530;
                
                for (int32_t i_87328 = 0; i_87328 < 28; i_87328++) {
                    int64_t i_85516 = sext_i32_i64(i_87328);
                    int64_t binop_y_90272 = (int64_t) 28 * i_85516;
                    int64_t binop_x_90273 = binop_x_90271 + binop_y_90272;
                    
                    for (int32_t i_87335 = 0; i_87335 < 28; i_87335++) {
                        int64_t i_85512 = sext_i32_i64(i_87335);
                        int64_t binop_x_90274 = i_85512 + binop_x_90273;
                        int64_t new_index_90275 = squot64(binop_x_90274,
                                                          (int64_t) 1568);
                        int64_t binop_y_90285 = (int64_t) 1568 *
                                new_index_90275;
                        int64_t binop_x_90286 = binop_x_90274 - binop_y_90285;
                        int64_t new_index_90287 = squot64(binop_x_90286,
                                                          (int64_t) 784);
                        int64_t binop_y_90311 = (int64_t) 784 * new_index_90287;
                        int64_t binop_x_90312 = binop_x_90286 - binop_y_90311;
                        int64_t new_index_90313 = squot64(binop_x_90312,
                                                          (int64_t) 28);
                        int64_t binop_y_90365 = (int64_t) 28 * new_index_90313;
                        int64_t new_index_90366 = binop_x_90312 - binop_y_90365;
                        double x_74168 =
                               ((double *) mem_102322)[new_index_90275 *
                                                       (int64_t) 1568 +
                                                       new_index_90287 *
                                                       (int64_t) 784 +
                                                       new_index_90313 *
                                                       (int64_t) 28 +
                                                       new_index_90366];
                        int64_t new_index_90371 = squot64(binop_x_90274,
                                                          (int64_t) 784);
                        int64_t binop_y_90381 = (int64_t) 784 * new_index_90371;
                        int64_t new_index_90382 = binop_x_90274 - binop_y_90381;
                        double x_74169 =
                               ((double *) mem_100727)[new_index_90371 *
                                                       (int64_t) 784 +
                                                       new_index_90382];
                        bool cond_74170 = 0.0 < x_74169;
                        double defunc_1_f_res_74171;
                        
                        if (cond_74170 == 1) {
                            defunc_1_f_res_74171 = x_74168;
                        } else {
                            defunc_1_f_res_74171 = 0.0;
                        }
                        ((double *) mem_102468)[i_85530 * (int64_t) 784 +
                                                i_85516 * (int64_t) 28 +
                                                i_85512] = defunc_1_f_res_74171;
                    }
                }
                for (int32_t i_87329 = 0; i_87329 < 30; i_87329++) {
                    int64_t i_85524 = sext_i32_i64(i_87329);
                    bool cond_74175 = slt64(i_85524, (int64_t) 1);
                    bool cond_f_res_74176 = sle64((int64_t) 29, i_85524);
                    bool x_74177 = !cond_74175;
                    bool y_74178 = cond_f_res_74176 && x_74177;
                    bool cond_74179 = cond_74175 || y_74178;
                    bool x_74180 = !cond_74179;
                    
                    for (int32_t i_87330 = 0; i_87330 < 30; i_87330++) {
                        int64_t i_85520 = sext_i32_i64(i_87330);
                        bool cond_f_res_74183 = slt64(i_85520, (int64_t) 1);
                        bool y_74184 = x_74180 && cond_f_res_74183;
                        bool cond_74185 = cond_74179 || y_74184;
                        bool cond_f_res_74186 = sle64((int64_t) 29, i_85520);
                        bool x_74187 = !cond_74185;
                        bool y_74188 = cond_f_res_74186 && x_74187;
                        bool cond_74189 = cond_74185 || y_74188;
                        double defunc_0_f_res_74190;
                        
                        if (cond_74189 == 1) {
                            defunc_0_f_res_74190 = 0.0;
                        } else {
                            int64_t i_74191 = sub64(i_85524, (int64_t) 1);
                            bool x_74192 = sle64((int64_t) 0, i_74191);
                            bool y_74193 = slt64(i_74191, (int64_t) 28);
                            bool bounds_check_74194 = x_74192 && y_74193;
                            int64_t i_74195 = sub64(i_85520, (int64_t) 1);
                            bool x_74196 = sle64((int64_t) 0, i_74195);
                            bool y_74197 = slt64(i_74195, (int64_t) 28);
                            bool bounds_check_74198 = x_74196 && y_74197;
                            bool index_ok_74199 = bounds_check_74194 &&
                                 bounds_check_74198;
                            bool index_certs_74200;
                            
                            if (!index_ok_74199) {
                                set_error(ctx,
                                          msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                    "Index [",
                                                    (long long) i_74191, ", ",
                                                    (long long) i_74195,
                                                    "] out of bounds for array of shape [",
                                                    (long long) (int64_t) 28,
                                                    "][",
                                                    (long long) (int64_t) 28,
                                                    "].",
                                                    "-> #0  ../layers/conv2d.fut:7:91-116\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  ../layers/conv2d.fut:6:22-7:117\n   #7  ../layers/conv2d.fut:6:6-7:123\n   #8  ../layers/conv2d.fut:22:7-30\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            double defunc_0_f_res_f_res_74201 =
                                   ((double *) mem_102468)[i_85530 *
                                                           (int64_t) 784 +
                                                           i_74191 *
                                                           (int64_t) 28 +
                                                           i_74195];
                            
                            defunc_0_f_res_74190 = defunc_0_f_res_f_res_74201;
                        }
                        ((double *) mem_102466)[i_85530 * (int64_t) 900 +
                                                i_85524 * (int64_t) 30 +
                                                i_85520] = defunc_0_f_res_74190;
                    }
                }
            }
            for (int32_t i_86826 = 0; i_86826 < 28; i_86826++) {
                int64_t i_85539 = sext_i32_i64(i_86826);
                int64_t j_59616 = add64((int64_t) 3, i_85539);
                int64_t i_p_m_t_s_59617 = add64((int64_t) 2, i_85539);
                bool zzero_leq_i_p_m_t_s_59618 = sle64((int64_t) 0,
                                                       i_p_m_t_s_59617);
                bool i_p_m_t_s_leq_w_59619 = slt64(i_p_m_t_s_59617,
                                                   (int64_t) 30);
                bool zzero_lte_i_59620 = sle64((int64_t) 0, i_85539);
                bool i_lte_j_59621 = sle64(i_85539, j_59616);
                bool y_59622 = i_p_m_t_s_leq_w_59619 && zzero_lte_i_59620;
                bool y_59623 = zzero_leq_i_p_m_t_s_59618 && y_59622;
                bool y_59624 = i_lte_j_59621 && y_59623;
                bool forwards_ok_59625 = zzero_lte_i_59620 && y_59624;
                
                for (int32_t i_87323 = 0; i_87323 < 28; i_87323++) {
                    int64_t i_85535 = sext_i32_i64(i_87323);
                    int64_t j_59629 = add64((int64_t) 3, i_85535);
                    int64_t i_p_m_t_s_59630 = add64((int64_t) 2, i_85535);
                    bool zzero_leq_i_p_m_t_s_59631 = sle64((int64_t) 0,
                                                           i_p_m_t_s_59630);
                    bool i_p_m_t_s_leq_w_59632 = slt64(i_p_m_t_s_59630,
                                                       (int64_t) 30);
                    bool zzero_lte_i_59633 = sle64((int64_t) 0, i_85535);
                    bool i_lte_j_59634 = sle64(i_85535, j_59629);
                    bool y_59635 = i_p_m_t_s_leq_w_59632 && zzero_lte_i_59633;
                    bool y_59636 = zzero_leq_i_p_m_t_s_59631 && y_59635;
                    bool y_59637 = i_lte_j_59634 && y_59636;
                    bool forwards_ok_59638 = zzero_lte_i_59633 && y_59637;
                    bool index_ok_59640 = forwards_ok_59625 &&
                         forwards_ok_59638;
                    bool index_certs_59641;
                    
                    if (!index_ok_59640) {
                        set_error(ctx,
                                  msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                            "Index [", (long long) i_85539, ":",
                                            (long long) j_59616, ", ",
                                            (long long) i_85535, ":",
                                            (long long) j_59629,
                                            "] out of bounds for array of shape [",
                                            (long long) (int64_t) 30, "][",
                                            (long long) (int64_t) 30, "].",
                                            "-> #0  ../layers/conv2d.fut:13:90-124\n   #1  ../layers/conv2d.fut:13:69-146\n   #2  /prelude/soacs.fut:59:3-10\n   #3  /prelude/array.fut:200:3-17\n   #4  /prelude/functional.fut:39:59-65\n   #5  /prelude/soacs.fut:59:3-10\n   #6  /prelude/array.fut:208:3-34\n   #7  ../layers/conv2d.fut:13:26-162\n   #8  ../layers/conv2d.fut:26:17-54\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    for (int64_t i_114176 = 0; i_114176 < (int64_t) 576;
                         i_114176++) {
                        double tmp_114177 =
                               ((double *) mem_102466)[(int64_t) 30 * i_85539 +
                                                       i_85535 +
                                                       (squot64(i_114176,
                                                                (int64_t) 9) *
                                                        (int64_t) 900 +
                                                        squot64(i_114176 -
                                                                squot64(i_114176,
                                                                        (int64_t) 9) *
                                                                (int64_t) 9,
                                                                (int64_t) 3) *
                                                        (int64_t) 30 +
                                                        (i_114176 -
                                                         squot64(i_114176,
                                                                 (int64_t) 9) *
                                                         (int64_t) 9 -
                                                         squot64(i_114176 -
                                                                 squot64(i_114176,
                                                                         (int64_t) 9) *
                                                                 (int64_t) 9,
                                                                 (int64_t) 3) *
                                                         (int64_t) 3))];
                        
                        ((double *) mem_102634)[i_85539 * (int64_t) 16128 +
                                                i_85535 * (int64_t) 576 +
                                                i_114176] = tmp_114177;
                    }
                }
            }
            for (int32_t i_86827 = 0; i_86827 < 256; i_86827++) {
                int64_t i_85549 = sext_i32_i64(i_86827);
                int64_t binop_x_90173 = (int64_t) 576 * i_85549;
                
                for (int32_t i_87321 = 0; i_87321 < 784; i_87321++) {
                    int64_t i_85545 = sext_i32_i64(i_87321);
                    int64_t binop_x_90239 = (int64_t) 576 * i_85545;
                    double defunc_2_reduce_res_84007;
                    double redout_85541 = 0.0;
                    
                    for (int32_t i_87322 = 0; i_87322 < 576; i_87322++) {
                        int64_t i_85542 = sext_i32_i64(i_87322);
                        int64_t binop_x_90174 = i_85542 + binop_x_90173;
                        int64_t new_index_90175 = squot64(binop_x_90174,
                                                          (int64_t) 576);
                        int64_t binop_y_90181 = (int64_t) 576 * new_index_90175;
                        int64_t binop_x_90182 = binop_x_90174 - binop_y_90181;
                        int64_t new_index_90183 = squot64(binop_x_90182,
                                                          (int64_t) 9);
                        int64_t binop_y_90199 = (int64_t) 9 * new_index_90183;
                        int64_t binop_x_90200 = binop_x_90182 - binop_y_90199;
                        int64_t new_index_90201 = squot64(binop_x_90200,
                                                          (int64_t) 3);
                        int64_t binop_y_90237 = (int64_t) 3 * new_index_90201;
                        int64_t new_index_90238 = binop_x_90200 - binop_y_90237;
                        int64_t binop_y_90267 = (int64_t) -1 * new_index_90201;
                        int64_t slice_90268 = (int64_t) 2 + binop_y_90267;
                        int64_t binop_y_90269 = (int64_t) -1 * new_index_90238;
                        int64_t slice_90270 = (int64_t) 2 + binop_y_90269;
                        double x_79591 =
                               ((double *) mem_param_97090.mem)[new_index_90183 *
                                                                (int64_t) 2304 +
                                                                new_index_90175 *
                                                                (int64_t) 9 +
                                                                slice_90268 *
                                                                (int64_t) 3 +
                                                                slice_90270];
                        int64_t binop_x_90240 = i_85542 + binop_x_90239;
                        int64_t new_index_90241 = squot64(binop_x_90240,
                                                          (int64_t) 16128);
                        int64_t binop_y_90247 = (int64_t) 16128 *
                                new_index_90241;
                        int64_t binop_x_90248 = binop_x_90240 - binop_y_90247;
                        int64_t new_index_90249 = squot64(binop_x_90248,
                                                          (int64_t) 576);
                        int64_t binop_y_90265 = (int64_t) 576 * new_index_90249;
                        int64_t new_index_90266 = binop_x_90248 - binop_y_90265;
                        double x_79592 =
                               ((double *) mem_102634)[new_index_90241 *
                                                       (int64_t) 16128 +
                                                       new_index_90249 *
                                                       (int64_t) 576 +
                                                       new_index_90266];
                        double defunc_1_f_res_79593 = x_79591 * x_79592;
                        double defunc_1_op_res_59660 = defunc_1_f_res_79593 +
                               redout_85541;
                        double redout_tmp_114180 = defunc_1_op_res_59660;
                        
                        redout_85541 = redout_tmp_114180;
                    }
                    defunc_2_reduce_res_84007 = redout_85541;
                    ((double *) mem_102686)[i_85549 * (int64_t) 784 + i_85545] =
                        defunc_2_reduce_res_84007;
                }
            }
            for (int32_t i_86828 = 0; i_86828 < 32; i_86828++) {
                int64_t i_85555 = sext_i32_i64(i_86828);
                int64_t i_77014 = mul64((int64_t) 4, i_85555);
                int64_t x_77015 = add64((int64_t) 1, i_85555);
                int64_t j_77016 = mul64((int64_t) 4, x_77015);
                int64_t j_m_i_77017 = sub64(j_77016, i_77014);
                bool empty_slice_77018 = j_m_i_77017 == (int64_t) 0;
                int64_t m_77019 = sub64(j_m_i_77017, (int64_t) 1);
                int64_t i_p_m_t_s_77020 = add64(i_77014, m_77019);
                bool zzero_leq_i_p_m_t_s_77021 = sle64((int64_t) 0,
                                                       i_p_m_t_s_77020);
                bool i_p_m_t_s_leq_w_77022 = slt64(i_p_m_t_s_77020,
                                                   (int64_t) 128);
                bool zzero_lte_i_77023 = sle64((int64_t) 0, i_77014);
                bool i_lte_j_77024 = sle64(i_77014, j_77016);
                bool y_77025 = i_p_m_t_s_leq_w_77022 && zzero_lte_i_77023;
                bool y_77026 = zzero_leq_i_p_m_t_s_77021 && y_77025;
                bool y_77027 = i_lte_j_77024 && y_77026;
                bool forwards_ok_77028 = zzero_lte_i_77023 && y_77027;
                bool ok_or_empty_77029 = empty_slice_77018 || forwards_ok_77028;
                bool index_certs_77030;
                
                if (!ok_or_empty_77029) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Index [", (long long) i_77014, ":",
                                        (long long) j_77016,
                                        "] out of bounds for array of shape [",
                                        (long long) (int64_t) 128, "].",
                                        "-> #0  ../layers/groupnorm.fut:2:31-70\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  ../layers/groupnorm.fut:2:3-97\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool dim_match_77031 = (int64_t) 4 == j_m_i_77017;
                bool empty_or_match_cert_77032;
                
                if (!dim_match_77031) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Value of (core language) shape (",
                                        (long long) j_m_i_77017, ", ",
                                        (long long) (int64_t) 28, ", ",
                                        (long long) (int64_t) 28,
                                        ") cannot match shape of type `[",
                                        (long long) (int64_t) 4, "][",
                                        (long long) (int64_t) 28, "][",
                                        (long long) (int64_t) 28, "]f64`.",
                                        "-> #0  ../layers/groupnorm.fut:2:31-96\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  ../layers/groupnorm.fut:2:3-97\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if ((int64_t) 25088 > 0)
                    memmove(mem_102726 + i_85555 * (int64_t) 3136 * (int64_t) 8,
                            mem_102686 + (int64_t) 784 * i_77014 * (int64_t) 8,
                            (int64_t) 25088);
                if ((int64_t) 25088 > 0)
                    memmove(mem_102728 + i_85555 * (int64_t) 3136 * (int64_t) 8,
                            mem_100507 + (int64_t) 784 * i_77014 * (int64_t) 8,
                            (int64_t) 25088);
            }
            for (int32_t i_86829 = 0; i_86829 < 32; i_86829++) {
                int64_t i_85565 = sext_i32_i64(i_86829);
                int64_t binop_x_90041 = (int64_t) 3136 * i_85565;
                double defunc_2_reduce_res_84009;
                double defunc_2_reduce_res_84010;
                double redout_85558;
                double redout_85559;
                
                redout_85558 = 0.0;
                redout_85559 = 0.0;
                for (int32_t i_87318 = 0; i_87318 < 3136; i_87318++) {
                    int64_t i_85560 = sext_i32_i64(i_87318);
                    int64_t binop_x_90042 = i_85560 + binop_x_90041;
                    int64_t new_index_90043 = squot64(binop_x_90042,
                                                      (int64_t) 3136);
                    int64_t binop_y_90049 = (int64_t) 3136 * new_index_90043;
                    int64_t binop_x_90050 = binop_x_90042 - binop_y_90049;
                    int64_t new_index_90051 = squot64(binop_x_90050,
                                                      (int64_t) 784);
                    int64_t binop_y_90067 = (int64_t) 784 * new_index_90051;
                    int64_t binop_x_90068 = binop_x_90050 - binop_y_90067;
                    int64_t new_index_90069 = squot64(binop_x_90068,
                                                      (int64_t) 28);
                    int64_t binop_y_90105 = (int64_t) 28 * new_index_90069;
                    int64_t new_index_90106 = binop_x_90068 - binop_y_90105;
                    double x_79606 = ((double *) mem_102726)[new_index_90043 *
                                                             (int64_t) 3136 +
                                                             new_index_90051 *
                                                             (int64_t) 784 +
                                                             new_index_90069 *
                                                             (int64_t) 28 +
                                                             new_index_90106];
                    double x_79607 = ((double *) mem_102728)[new_index_90043 *
                                                             (int64_t) 3136 +
                                                             new_index_90051 *
                                                             (int64_t) 784 +
                                                             new_index_90069 *
                                                             (int64_t) 28 +
                                                             new_index_90106];
                    double defunc_1_f_res_79609 = x_79606 * x_79607;
                    double defunc_1_op_res_61224 = x_79606 + redout_85558;
                    double defunc_1_op_res_61233 = defunc_1_f_res_79609 +
                           redout_85559;
                    double redout_tmp_114185 = defunc_1_op_res_61224;
                    double redout_tmp_114186 = defunc_1_op_res_61233;
                    
                    redout_85558 = redout_tmp_114185;
                    redout_85559 = redout_tmp_114186;
                }
                defunc_2_reduce_res_84009 = redout_85558;
                defunc_2_reduce_res_84010 = redout_85559;
                ((double *) mem_102786)[i_85565] = defunc_2_reduce_res_84009;
                ((double *) mem_102788)[i_85565] = defunc_2_reduce_res_84010;
            }
            for (int32_t i_86830 = 0; i_86830 < 32; i_86830++) {
                int64_t i_85582 = sext_i32_i64(i_86830);
                bool x_61241 = sle64((int64_t) 0, i_85582);
                bool y_61242 = slt64(i_85582, (int64_t) 32);
                bool bounds_check_61243 = x_61241 && y_61242;
                bool index_certs_61244;
                
                if (!bounds_check_61243) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Index [", (long long) i_85582,
                                        "] out of bounds for array of shape [",
                                        (long long) (int64_t) 32, "].",
                                        "-> #0  ../layers/groupnorm.fut:36:43-66\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                double defunc_0_f_res_61245 = ((double *) mem_102786)[i_85582];
                double defunc_0_f_res_61246 = ((double *) mem_102788)[i_85582];
                bool index_certs_61249;
                
                if (!bounds_check_61243) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Index [", (long long) i_85582,
                                        "] out of bounds for array of shape [",
                                        (long long) (int64_t) 32, "].",
                                        "-> #0  ../layers/groupnorm.fut:40:18-23\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  /prelude/functional.fut:39:59-65\n   #7  /prelude/soacs.fut:59:3-10\n   #8  /prelude/array.fut:216:3-39\n   #9  ../layers/groupnorm.fut:37:10-40:31\n   #10 /prelude/soacs.fut:59:3-10\n   #11 /prelude/array.fut:200:3-17\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                double x_61250 = ((double *) mem_100485)[i_85582];
                double sqrt_arg_61251 = 1.0e-5 + x_61250;
                double sqrt_res_61252 = futrts_sqrt64(sqrt_arg_61251);
                
                for (int32_t i_87307 = 0; i_87307 < 4; i_87307++) {
                    int64_t i_85578 = sext_i32_i64(i_87307);
                    bool x_61255 = sle64((int64_t) 0, i_85578);
                    bool y_61256 = slt64(i_85578, (int64_t) 4);
                    bool bounds_check_61257 = x_61255 && y_61256;
                    
                    for (int32_t i_87308 = 0; i_87308 < 28; i_87308++) {
                        int64_t i_85574 = sext_i32_i64(i_87308);
                        bool x_61260 = sle64((int64_t) 0, i_85574);
                        bool y_61261 = slt64(i_85574, (int64_t) 28);
                        bool bounds_check_61262 = x_61260 && y_61261;
                        
                        for (int32_t i_87309 = 0; i_87309 < 28; i_87309++) {
                            int64_t i_85570 = sext_i32_i64(i_87309);
                            bool x_61267 = sle64((int64_t) 0, i_85570);
                            bool y_61268 = slt64(i_85570, (int64_t) 28);
                            bool bounds_check_61269 = x_61267 && y_61268;
                            bool y_61270 = bounds_check_61243 &&
                                 bounds_check_61269;
                            bool y_61271 = bounds_check_61262 && y_61270;
                            bool index_ok_61272 = bounds_check_61257 && y_61271;
                            bool index_certs_61273;
                            
                            if (!index_ok_61272) {
                                set_error(ctx,
                                          msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                    "Index [",
                                                    (long long) i_85582, ", ",
                                                    (long long) i_85578, ", ",
                                                    (long long) i_85574, ", ",
                                                    (long long) i_85570,
                                                    "] out of bounds for array of shape [",
                                                    (long long) (int64_t) 32,
                                                    "][",
                                                    (long long) (int64_t) 4,
                                                    "][",
                                                    (long long) (int64_t) 28,
                                                    "][",
                                                    (long long) (int64_t) 28,
                                                    "].",
                                                    "-> #0  ../layers/groupnorm.fut:39:30-48\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  /prelude/functional.fut:39:59-65\n   #7  /prelude/soacs.fut:59:3-10\n   #8  /prelude/array.fut:216:3-39\n   #9  ../layers/groupnorm.fut:37:10-40:31\n   #10 /prelude/soacs.fut:59:3-10\n   #11 /prelude/array.fut:200:3-17\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            double y_61274 = ((double *) mem_102726)[i_85582 *
                                                                     (int64_t) 3136 +
                                                                     i_85578 *
                                                                     (int64_t) 784 +
                                                                     i_85574 *
                                                                     (int64_t) 28 +
                                                                     i_85570];
                            double x_61275 = 3136.0 * y_61274;
                            double x_61276 = x_61275 - defunc_0_f_res_61245;
                            double x_61283 = ((double *) mem_102728)[i_85582 *
                                                                     (int64_t) 3136 +
                                                                     i_85578 *
                                                                     (int64_t) 784 +
                                                                     i_85574 *
                                                                     (int64_t) 28 +
                                                                     i_85570];
                            double y_61284 = defunc_0_f_res_61246 * x_61283;
                            double y_61285 = x_61276 - y_61284;
                            double x_61286 = 3.1887755102040814e-4 * y_61285;
                            double defunc_0_f_res_61287 = x_61286 /
                                   sqrt_res_61252;
                            
                            ((double *) mem_102810)[i_85582 * (int64_t) 3136 +
                                                    i_85578 * (int64_t) 784 +
                                                    i_85574 * (int64_t) 28 +
                                                    i_85570] =
                                defunc_0_f_res_61287;
                        }
                    }
                }
            }
            for (int32_t i_86831 = 0; i_86831 < 128; i_86831++) {
                int64_t i_85604 = sext_i32_i64(i_86831);
                int64_t binop_x_89929 = (int64_t) 784 * i_85604;
                
                for (int32_t i_87299 = 0; i_87299 < 28; i_87299++) {
                    int64_t i_85590 = sext_i32_i64(i_87299);
                    int64_t binop_y_89930 = (int64_t) 28 * i_85590;
                    int64_t binop_x_89931 = binop_x_89929 + binop_y_89930;
                    
                    for (int32_t i_87306 = 0; i_87306 < 28; i_87306++) {
                        int64_t i_85586 = sext_i32_i64(i_87306);
                        int64_t binop_x_89932 = i_85586 + binop_x_89931;
                        int64_t new_index_89933 = squot64(binop_x_89932,
                                                          (int64_t) 3136);
                        int64_t binop_y_89943 = (int64_t) 3136 *
                                new_index_89933;
                        int64_t binop_x_89944 = binop_x_89932 - binop_y_89943;
                        int64_t new_index_89945 = squot64(binop_x_89944,
                                                          (int64_t) 784);
                        int64_t binop_y_89969 = (int64_t) 784 * new_index_89945;
                        int64_t binop_x_89970 = binop_x_89944 - binop_y_89969;
                        int64_t new_index_89971 = squot64(binop_x_89970,
                                                          (int64_t) 28);
                        int64_t binop_y_90023 = (int64_t) 28 * new_index_89971;
                        int64_t new_index_90024 = binop_x_89970 - binop_y_90023;
                        double x_73720 =
                               ((double *) mem_102810)[new_index_89933 *
                                                       (int64_t) 3136 +
                                                       new_index_89945 *
                                                       (int64_t) 784 +
                                                       new_index_89971 *
                                                       (int64_t) 28 +
                                                       new_index_90024];
                        int64_t new_index_90029 = squot64(binop_x_89932,
                                                          (int64_t) 784);
                        int64_t binop_y_90039 = (int64_t) 784 * new_index_90029;
                        int64_t new_index_90040 = binop_x_89932 - binop_y_90039;
                        double x_73721 =
                               ((double *) mem_100329)[new_index_90029 *
                                                       (int64_t) 784 +
                                                       new_index_90040];
                        bool cond_73722 = 0.0 < x_73721;
                        double defunc_1_f_res_73723;
                        
                        if (cond_73722 == 1) {
                            defunc_1_f_res_73723 = x_73720;
                        } else {
                            defunc_1_f_res_73723 = 0.0;
                        }
                        ((double *) mem_102956)[i_85604 * (int64_t) 784 +
                                                i_85590 * (int64_t) 28 +
                                                i_85586] = defunc_1_f_res_73723;
                    }
                }
                for (int32_t i_87300 = 0; i_87300 < 30; i_87300++) {
                    int64_t i_85598 = sext_i32_i64(i_87300);
                    bool cond_73727 = slt64(i_85598, (int64_t) 1);
                    bool cond_f_res_73728 = sle64((int64_t) 29, i_85598);
                    bool x_73729 = !cond_73727;
                    bool y_73730 = cond_f_res_73728 && x_73729;
                    bool cond_73731 = cond_73727 || y_73730;
                    bool x_73732 = !cond_73731;
                    
                    for (int32_t i_87301 = 0; i_87301 < 30; i_87301++) {
                        int64_t i_85594 = sext_i32_i64(i_87301);
                        bool cond_f_res_73735 = slt64(i_85594, (int64_t) 1);
                        bool y_73736 = x_73732 && cond_f_res_73735;
                        bool cond_73737 = cond_73731 || y_73736;
                        bool cond_f_res_73738 = sle64((int64_t) 29, i_85594);
                        bool x_73739 = !cond_73737;
                        bool y_73740 = cond_f_res_73738 && x_73739;
                        bool cond_73741 = cond_73737 || y_73740;
                        double defunc_0_f_res_73742;
                        
                        if (cond_73741 == 1) {
                            defunc_0_f_res_73742 = 0.0;
                        } else {
                            int64_t i_73743 = sub64(i_85598, (int64_t) 1);
                            bool x_73744 = sle64((int64_t) 0, i_73743);
                            bool y_73745 = slt64(i_73743, (int64_t) 28);
                            bool bounds_check_73746 = x_73744 && y_73745;
                            int64_t i_73747 = sub64(i_85594, (int64_t) 1);
                            bool x_73748 = sle64((int64_t) 0, i_73747);
                            bool y_73749 = slt64(i_73747, (int64_t) 28);
                            bool bounds_check_73750 = x_73748 && y_73749;
                            bool index_ok_73751 = bounds_check_73746 &&
                                 bounds_check_73750;
                            bool index_certs_73752;
                            
                            if (!index_ok_73751) {
                                set_error(ctx,
                                          msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                    "Index [",
                                                    (long long) i_73743, ", ",
                                                    (long long) i_73747,
                                                    "] out of bounds for array of shape [",
                                                    (long long) (int64_t) 28,
                                                    "][",
                                                    (long long) (int64_t) 28,
                                                    "].",
                                                    "-> #0  ../layers/conv2d.fut:7:91-116\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  ../layers/conv2d.fut:6:22-7:117\n   #7  ../layers/conv2d.fut:6:6-7:123\n   #8  ../layers/conv2d.fut:22:7-30\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            double defunc_0_f_res_f_res_73753 =
                                   ((double *) mem_102956)[i_85604 *
                                                           (int64_t) 784 +
                                                           i_73743 *
                                                           (int64_t) 28 +
                                                           i_73747];
                            
                            defunc_0_f_res_73742 = defunc_0_f_res_f_res_73753;
                        }
                        ((double *) mem_102954)[i_85604 * (int64_t) 900 +
                                                i_85598 * (int64_t) 30 +
                                                i_85594] = defunc_0_f_res_73742;
                    }
                }
            }
            for (int32_t i_86832 = 0; i_86832 < 28; i_86832++) {
                int64_t i_85613 = sext_i32_i64(i_86832);
                int64_t j_61545 = add64((int64_t) 3, i_85613);
                int64_t i_p_m_t_s_61546 = add64((int64_t) 2, i_85613);
                bool zzero_leq_i_p_m_t_s_61547 = sle64((int64_t) 0,
                                                       i_p_m_t_s_61546);
                bool i_p_m_t_s_leq_w_61548 = slt64(i_p_m_t_s_61546,
                                                   (int64_t) 30);
                bool zzero_lte_i_61549 = sle64((int64_t) 0, i_85613);
                bool i_lte_j_61550 = sle64(i_85613, j_61545);
                bool y_61551 = i_p_m_t_s_leq_w_61548 && zzero_lte_i_61549;
                bool y_61552 = zzero_leq_i_p_m_t_s_61547 && y_61551;
                bool y_61553 = i_lte_j_61550 && y_61552;
                bool forwards_ok_61554 = zzero_lte_i_61549 && y_61553;
                
                for (int32_t i_87294 = 0; i_87294 < 28; i_87294++) {
                    int64_t i_85609 = sext_i32_i64(i_87294);
                    int64_t j_61558 = add64((int64_t) 3, i_85609);
                    int64_t i_p_m_t_s_61559 = add64((int64_t) 2, i_85609);
                    bool zzero_leq_i_p_m_t_s_61560 = sle64((int64_t) 0,
                                                           i_p_m_t_s_61559);
                    bool i_p_m_t_s_leq_w_61561 = slt64(i_p_m_t_s_61559,
                                                       (int64_t) 30);
                    bool zzero_lte_i_61562 = sle64((int64_t) 0, i_85609);
                    bool i_lte_j_61563 = sle64(i_85609, j_61558);
                    bool y_61564 = i_p_m_t_s_leq_w_61561 && zzero_lte_i_61562;
                    bool y_61565 = zzero_leq_i_p_m_t_s_61560 && y_61564;
                    bool y_61566 = i_lte_j_61563 && y_61565;
                    bool forwards_ok_61567 = zzero_lte_i_61562 && y_61566;
                    bool index_ok_61569 = forwards_ok_61554 &&
                         forwards_ok_61567;
                    bool index_certs_61570;
                    
                    if (!index_ok_61569) {
                        set_error(ctx,
                                  msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                            "Index [", (long long) i_85613, ":",
                                            (long long) j_61545, ", ",
                                            (long long) i_85609, ":",
                                            (long long) j_61558,
                                            "] out of bounds for array of shape [",
                                            (long long) (int64_t) 30, "][",
                                            (long long) (int64_t) 30, "].",
                                            "-> #0  ../layers/conv2d.fut:13:90-124\n   #1  ../layers/conv2d.fut:13:69-146\n   #2  /prelude/soacs.fut:59:3-10\n   #3  /prelude/array.fut:200:3-17\n   #4  /prelude/functional.fut:39:59-65\n   #5  /prelude/soacs.fut:59:3-10\n   #6  /prelude/array.fut:208:3-34\n   #7  ../layers/conv2d.fut:13:26-162\n   #8  ../layers/conv2d.fut:26:17-54\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    for (int64_t i_114199 = 0; i_114199 < (int64_t) 1152;
                         i_114199++) {
                        double tmp_114200 =
                               ((double *) mem_102954)[(int64_t) 30 * i_85613 +
                                                       i_85609 +
                                                       (squot64(i_114199,
                                                                (int64_t) 9) *
                                                        (int64_t) 900 +
                                                        squot64(i_114199 -
                                                                squot64(i_114199,
                                                                        (int64_t) 9) *
                                                                (int64_t) 9,
                                                                (int64_t) 3) *
                                                        (int64_t) 30 +
                                                        (i_114199 -
                                                         squot64(i_114199,
                                                                 (int64_t) 9) *
                                                         (int64_t) 9 -
                                                         squot64(i_114199 -
                                                                 squot64(i_114199,
                                                                         (int64_t) 9) *
                                                                 (int64_t) 9,
                                                                 (int64_t) 3) *
                                                         (int64_t) 3))];
                        
                        ((double *) mem_103122)[i_85613 * (int64_t) 32256 +
                                                i_85609 * (int64_t) 1152 +
                                                i_114199] = tmp_114200;
                    }
                }
            }
            for (int32_t i_86833 = 0; i_86833 < 128; i_86833++) {
                int64_t i_85623 = sext_i32_i64(i_86833);
                int64_t binop_x_89831 = (int64_t) 1152 * i_85623;
                
                for (int32_t i_87292 = 0; i_87292 < 784; i_87292++) {
                    int64_t i_85619 = sext_i32_i64(i_87292);
                    int64_t binop_x_89897 = (int64_t) 1152 * i_85619;
                    double defunc_2_reduce_res_84019;
                    double redout_85615 = 0.0;
                    
                    for (int32_t i_87293 = 0; i_87293 < 1152; i_87293++) {
                        int64_t i_85616 = sext_i32_i64(i_87293);
                        int64_t binop_x_89832 = i_85616 + binop_x_89831;
                        int64_t new_index_89833 = squot64(binop_x_89832,
                                                          (int64_t) 1152);
                        int64_t binop_y_89839 = (int64_t) 1152 *
                                new_index_89833;
                        int64_t binop_x_89840 = binop_x_89832 - binop_y_89839;
                        int64_t new_index_89841 = squot64(binop_x_89840,
                                                          (int64_t) 9);
                        int64_t binop_y_89857 = (int64_t) 9 * new_index_89841;
                        int64_t binop_x_89858 = binop_x_89840 - binop_y_89857;
                        int64_t new_index_89859 = squot64(binop_x_89858,
                                                          (int64_t) 3);
                        int64_t binop_y_89895 = (int64_t) 3 * new_index_89859;
                        int64_t new_index_89896 = binop_x_89858 - binop_y_89895;
                        int64_t binop_y_89925 = (int64_t) -1 * new_index_89859;
                        int64_t slice_89926 = (int64_t) 2 + binop_y_89925;
                        int64_t binop_y_89927 = (int64_t) -1 * new_index_89896;
                        int64_t slice_89928 = (int64_t) 2 + binop_y_89927;
                        double x_81556 =
                               ((double *) mem_param_97071.mem)[new_index_89841 *
                                                                (int64_t) 1152 +
                                                                new_index_89833 *
                                                                (int64_t) 9 +
                                                                slice_89926 *
                                                                (int64_t) 3 +
                                                                slice_89928];
                        int64_t binop_x_89898 = i_85616 + binop_x_89897;
                        int64_t new_index_89899 = squot64(binop_x_89898,
                                                          (int64_t) 32256);
                        int64_t binop_y_89905 = (int64_t) 32256 *
                                new_index_89899;
                        int64_t binop_x_89906 = binop_x_89898 - binop_y_89905;
                        int64_t new_index_89907 = squot64(binop_x_89906,
                                                          (int64_t) 1152);
                        int64_t binop_y_89923 = (int64_t) 1152 *
                                new_index_89907;
                        int64_t new_index_89924 = binop_x_89906 - binop_y_89923;
                        double x_81557 =
                               ((double *) mem_103122)[new_index_89899 *
                                                       (int64_t) 32256 +
                                                       new_index_89907 *
                                                       (int64_t) 1152 +
                                                       new_index_89924];
                        double defunc_1_f_res_81558 = x_81556 * x_81557;
                        double defunc_1_op_res_61589 = defunc_1_f_res_81558 +
                               redout_85615;
                        double redout_tmp_114203 = defunc_1_op_res_61589;
                        
                        redout_85615 = redout_tmp_114203;
                    }
                    defunc_2_reduce_res_84019 = redout_85615;
                    ((double *) mem_103174)[i_85623 * (int64_t) 784 + i_85619] =
                        defunc_2_reduce_res_84019;
                }
            }
            for (int32_t i_86834 = 0; i_86834 < 32; i_86834++) {
                int64_t i_85629 = sext_i32_i64(i_86834);
                int64_t i_76970 = mul64((int64_t) 4, i_85629);
                int64_t x_76971 = add64((int64_t) 1, i_85629);
                int64_t j_76972 = mul64((int64_t) 4, x_76971);
                int64_t j_m_i_76973 = sub64(j_76972, i_76970);
                bool empty_slice_76974 = j_m_i_76973 == (int64_t) 0;
                int64_t m_76975 = sub64(j_m_i_76973, (int64_t) 1);
                int64_t i_p_m_t_s_76976 = add64(i_76970, m_76975);
                bool zzero_leq_i_p_m_t_s_76977 = sle64((int64_t) 0,
                                                       i_p_m_t_s_76976);
                bool i_p_m_t_s_leq_w_76978 = slt64(i_p_m_t_s_76976,
                                                   (int64_t) 128);
                bool zzero_lte_i_76979 = sle64((int64_t) 0, i_76970);
                bool i_lte_j_76980 = sle64(i_76970, j_76972);
                bool y_76981 = i_p_m_t_s_leq_w_76978 && zzero_lte_i_76979;
                bool y_76982 = zzero_leq_i_p_m_t_s_76977 && y_76981;
                bool y_76983 = i_lte_j_76980 && y_76982;
                bool forwards_ok_76984 = zzero_lte_i_76979 && y_76983;
                bool ok_or_empty_76985 = empty_slice_76974 || forwards_ok_76984;
                bool index_certs_76986;
                
                if (!ok_or_empty_76985) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Index [", (long long) i_76970, ":",
                                        (long long) j_76972,
                                        "] out of bounds for array of shape [",
                                        (long long) (int64_t) 128, "].",
                                        "-> #0  ../layers/groupnorm.fut:2:31-70\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  ../layers/groupnorm.fut:2:3-97\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool dim_match_76987 = (int64_t) 4 == j_m_i_76973;
                bool empty_or_match_cert_76988;
                
                if (!dim_match_76987) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Value of (core language) shape (",
                                        (long long) j_m_i_76973, ", ",
                                        (long long) (int64_t) 28, ", ",
                                        (long long) (int64_t) 28,
                                        ") cannot match shape of type `[",
                                        (long long) (int64_t) 4, "][",
                                        (long long) (int64_t) 28, "][",
                                        (long long) (int64_t) 28, "]f64`.",
                                        "-> #0  ../layers/groupnorm.fut:2:31-96\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  ../layers/groupnorm.fut:2:3-97\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if ((int64_t) 25088 > 0)
                    memmove(mem_103214 + i_85629 * (int64_t) 3136 * (int64_t) 8,
                            mem_103174 + (int64_t) 784 * i_76970 * (int64_t) 8,
                            (int64_t) 25088);
                if ((int64_t) 25088 > 0)
                    memmove(mem_103216 + i_85629 * (int64_t) 3136 * (int64_t) 8,
                            mem_100019 + (int64_t) 784 * i_76970 * (int64_t) 8,
                            (int64_t) 25088);
            }
            for (int32_t i_86835 = 0; i_86835 < 32; i_86835++) {
                int64_t i_85639 = sext_i32_i64(i_86835);
                int64_t binop_x_89699 = (int64_t) 3136 * i_85639;
                double defunc_2_reduce_res_84021;
                double defunc_2_reduce_res_84022;
                double redout_85632;
                double redout_85633;
                
                redout_85632 = 0.0;
                redout_85633 = 0.0;
                for (int32_t i_87289 = 0; i_87289 < 3136; i_87289++) {
                    int64_t i_85634 = sext_i32_i64(i_87289);
                    int64_t binop_x_89700 = i_85634 + binop_x_89699;
                    int64_t new_index_89701 = squot64(binop_x_89700,
                                                      (int64_t) 3136);
                    int64_t binop_y_89707 = (int64_t) 3136 * new_index_89701;
                    int64_t binop_x_89708 = binop_x_89700 - binop_y_89707;
                    int64_t new_index_89709 = squot64(binop_x_89708,
                                                      (int64_t) 784);
                    int64_t binop_y_89725 = (int64_t) 784 * new_index_89709;
                    int64_t binop_x_89726 = binop_x_89708 - binop_y_89725;
                    int64_t new_index_89727 = squot64(binop_x_89726,
                                                      (int64_t) 28);
                    int64_t binop_y_89763 = (int64_t) 28 * new_index_89727;
                    int64_t new_index_89764 = binop_x_89726 - binop_y_89763;
                    double x_81571 = ((double *) mem_103214)[new_index_89701 *
                                                             (int64_t) 3136 +
                                                             new_index_89709 *
                                                             (int64_t) 784 +
                                                             new_index_89727 *
                                                             (int64_t) 28 +
                                                             new_index_89764];
                    double x_81572 = ((double *) mem_103216)[new_index_89701 *
                                                             (int64_t) 3136 +
                                                             new_index_89709 *
                                                             (int64_t) 784 +
                                                             new_index_89727 *
                                                             (int64_t) 28 +
                                                             new_index_89764];
                    double defunc_1_f_res_81574 = x_81571 * x_81572;
                    double defunc_1_op_res_61670 = x_81571 + redout_85632;
                    double defunc_1_op_res_61679 = defunc_1_f_res_81574 +
                           redout_85633;
                    double redout_tmp_114208 = defunc_1_op_res_61670;
                    double redout_tmp_114209 = defunc_1_op_res_61679;
                    
                    redout_85632 = redout_tmp_114208;
                    redout_85633 = redout_tmp_114209;
                }
                defunc_2_reduce_res_84021 = redout_85632;
                defunc_2_reduce_res_84022 = redout_85633;
                ((double *) mem_103274)[i_85639] = defunc_2_reduce_res_84021;
                ((double *) mem_103276)[i_85639] = defunc_2_reduce_res_84022;
            }
            for (int32_t i_86836 = 0; i_86836 < 32; i_86836++) {
                int64_t i_85656 = sext_i32_i64(i_86836);
                bool x_61687 = sle64((int64_t) 0, i_85656);
                bool y_61688 = slt64(i_85656, (int64_t) 32);
                bool bounds_check_61689 = x_61687 && y_61688;
                bool index_certs_61690;
                
                if (!bounds_check_61689) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Index [", (long long) i_85656,
                                        "] out of bounds for array of shape [",
                                        (long long) (int64_t) 32, "].",
                                        "-> #0  ../layers/groupnorm.fut:36:43-66\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                double defunc_0_f_res_61691 = ((double *) mem_103274)[i_85656];
                double defunc_0_f_res_61692 = ((double *) mem_103276)[i_85656];
                bool index_certs_61695;
                
                if (!bounds_check_61689) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Index [", (long long) i_85656,
                                        "] out of bounds for array of shape [",
                                        (long long) (int64_t) 32, "].",
                                        "-> #0  ../layers/groupnorm.fut:40:18-23\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  /prelude/functional.fut:39:59-65\n   #7  /prelude/soacs.fut:59:3-10\n   #8  /prelude/array.fut:216:3-39\n   #9  ../layers/groupnorm.fut:37:10-40:31\n   #10 /prelude/soacs.fut:59:3-10\n   #11 /prelude/array.fut:200:3-17\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                double x_61696 = ((double *) mem_99991)[i_85656];
                double sqrt_arg_61697 = 1.0e-5 + x_61696;
                double sqrt_res_61698 = futrts_sqrt64(sqrt_arg_61697);
                
                for (int32_t i_87278 = 0; i_87278 < 4; i_87278++) {
                    int64_t i_85652 = sext_i32_i64(i_87278);
                    bool x_61701 = sle64((int64_t) 0, i_85652);
                    bool y_61702 = slt64(i_85652, (int64_t) 4);
                    bool bounds_check_61703 = x_61701 && y_61702;
                    
                    for (int32_t i_87279 = 0; i_87279 < 28; i_87279++) {
                        int64_t i_85648 = sext_i32_i64(i_87279);
                        bool x_61706 = sle64((int64_t) 0, i_85648);
                        bool y_61707 = slt64(i_85648, (int64_t) 28);
                        bool bounds_check_61708 = x_61706 && y_61707;
                        
                        for (int32_t i_87280 = 0; i_87280 < 28; i_87280++) {
                            int64_t i_85644 = sext_i32_i64(i_87280);
                            bool x_61713 = sle64((int64_t) 0, i_85644);
                            bool y_61714 = slt64(i_85644, (int64_t) 28);
                            bool bounds_check_61715 = x_61713 && y_61714;
                            bool y_61716 = bounds_check_61689 &&
                                 bounds_check_61715;
                            bool y_61717 = bounds_check_61708 && y_61716;
                            bool index_ok_61718 = bounds_check_61703 && y_61717;
                            bool index_certs_61719;
                            
                            if (!index_ok_61718) {
                                set_error(ctx,
                                          msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                    "Index [",
                                                    (long long) i_85656, ", ",
                                                    (long long) i_85652, ", ",
                                                    (long long) i_85648, ", ",
                                                    (long long) i_85644,
                                                    "] out of bounds for array of shape [",
                                                    (long long) (int64_t) 32,
                                                    "][",
                                                    (long long) (int64_t) 4,
                                                    "][",
                                                    (long long) (int64_t) 28,
                                                    "][",
                                                    (long long) (int64_t) 28,
                                                    "].",
                                                    "-> #0  ../layers/groupnorm.fut:39:30-48\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  /prelude/functional.fut:39:59-65\n   #7  /prelude/soacs.fut:59:3-10\n   #8  /prelude/array.fut:216:3-39\n   #9  ../layers/groupnorm.fut:37:10-40:31\n   #10 /prelude/soacs.fut:59:3-10\n   #11 /prelude/array.fut:200:3-17\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            double y_61720 = ((double *) mem_103214)[i_85656 *
                                                                     (int64_t) 3136 +
                                                                     i_85652 *
                                                                     (int64_t) 784 +
                                                                     i_85648 *
                                                                     (int64_t) 28 +
                                                                     i_85644];
                            double x_61721 = 3136.0 * y_61720;
                            double x_61722 = x_61721 - defunc_0_f_res_61691;
                            double x_61729 = ((double *) mem_103216)[i_85656 *
                                                                     (int64_t) 3136 +
                                                                     i_85652 *
                                                                     (int64_t) 784 +
                                                                     i_85648 *
                                                                     (int64_t) 28 +
                                                                     i_85644];
                            double y_61730 = defunc_0_f_res_61692 * x_61729;
                            double y_61731 = x_61722 - y_61730;
                            double x_61732 = 3.1887755102040814e-4 * y_61731;
                            double defunc_0_f_res_61733 = x_61732 /
                                   sqrt_res_61698;
                            
                            ((double *) mem_103298)[i_85656 * (int64_t) 3136 +
                                                    i_85652 * (int64_t) 784 +
                                                    i_85648 * (int64_t) 28 +
                                                    i_85644] =
                                defunc_0_f_res_61733;
                        }
                    }
                }
            }
            for (int32_t i_86837 = 0; i_86837 < 128; i_86837++) {
                int64_t i_85678 = sext_i32_i64(i_86837);
                int64_t binop_x_89587 = (int64_t) 784 * i_85678;
                
                for (int32_t i_87270 = 0; i_87270 < 28; i_87270++) {
                    int64_t i_85664 = sext_i32_i64(i_87270);
                    int64_t binop_y_89588 = (int64_t) 28 * i_85664;
                    int64_t binop_x_89589 = binop_x_89587 + binop_y_89588;
                    
                    for (int32_t i_87277 = 0; i_87277 < 28; i_87277++) {
                        int64_t i_85660 = sext_i32_i64(i_87277);
                        int64_t binop_x_89590 = i_85660 + binop_x_89589;
                        int64_t new_index_89591 = squot64(binop_x_89590,
                                                          (int64_t) 3136);
                        int64_t binop_y_89601 = (int64_t) 3136 *
                                new_index_89591;
                        int64_t binop_x_89602 = binop_x_89590 - binop_y_89601;
                        int64_t new_index_89603 = squot64(binop_x_89602,
                                                          (int64_t) 784);
                        int64_t binop_y_89627 = (int64_t) 784 * new_index_89603;
                        int64_t binop_x_89628 = binop_x_89602 - binop_y_89627;
                        int64_t new_index_89629 = squot64(binop_x_89628,
                                                          (int64_t) 28);
                        int64_t binop_y_89681 = (int64_t) 28 * new_index_89629;
                        int64_t new_index_89682 = binop_x_89628 - binop_y_89681;
                        double x_73529 =
                               ((double *) mem_103298)[new_index_89591 *
                                                       (int64_t) 3136 +
                                                       new_index_89603 *
                                                       (int64_t) 784 +
                                                       new_index_89629 *
                                                       (int64_t) 28 +
                                                       new_index_89682];
                        int64_t new_index_89687 = squot64(binop_x_89590,
                                                          (int64_t) 784);
                        int64_t binop_y_89697 = (int64_t) 784 * new_index_89687;
                        int64_t new_index_89698 = binop_x_89590 - binop_y_89697;
                        double x_73530 =
                               ((double *) mem_99835)[new_index_89687 *
                                                      (int64_t) 784 +
                                                      new_index_89698];
                        bool cond_73531 = 0.0 < x_73530;
                        double defunc_1_f_res_73532;
                        
                        if (cond_73531 == 1) {
                            defunc_1_f_res_73532 = x_73529;
                        } else {
                            defunc_1_f_res_73532 = 0.0;
                        }
                        ((double *) mem_103444)[i_85678 * (int64_t) 784 +
                                                i_85664 * (int64_t) 28 +
                                                i_85660] = defunc_1_f_res_73532;
                    }
                }
                for (int32_t i_87271 = 0; i_87271 < 30; i_87271++) {
                    int64_t i_85672 = sext_i32_i64(i_87271);
                    bool cond_73536 = slt64(i_85672, (int64_t) 1);
                    bool cond_f_res_73537 = sle64((int64_t) 29, i_85672);
                    bool x_73538 = !cond_73536;
                    bool y_73539 = cond_f_res_73537 && x_73538;
                    bool cond_73540 = cond_73536 || y_73539;
                    bool x_73541 = !cond_73540;
                    
                    for (int32_t i_87272 = 0; i_87272 < 30; i_87272++) {
                        int64_t i_85668 = sext_i32_i64(i_87272);
                        bool cond_f_res_73544 = slt64(i_85668, (int64_t) 1);
                        bool y_73545 = x_73541 && cond_f_res_73544;
                        bool cond_73546 = cond_73540 || y_73545;
                        bool cond_f_res_73547 = sle64((int64_t) 29, i_85668);
                        bool x_73548 = !cond_73546;
                        bool y_73549 = cond_f_res_73547 && x_73548;
                        bool cond_73550 = cond_73546 || y_73549;
                        double defunc_0_f_res_73551;
                        
                        if (cond_73550 == 1) {
                            defunc_0_f_res_73551 = 0.0;
                        } else {
                            int64_t i_73552 = sub64(i_85672, (int64_t) 1);
                            bool x_73553 = sle64((int64_t) 0, i_73552);
                            bool y_73554 = slt64(i_73552, (int64_t) 28);
                            bool bounds_check_73555 = x_73553 && y_73554;
                            int64_t i_73556 = sub64(i_85668, (int64_t) 1);
                            bool x_73557 = sle64((int64_t) 0, i_73556);
                            bool y_73558 = slt64(i_73556, (int64_t) 28);
                            bool bounds_check_73559 = x_73557 && y_73558;
                            bool index_ok_73560 = bounds_check_73555 &&
                                 bounds_check_73559;
                            bool index_certs_73561;
                            
                            if (!index_ok_73560) {
                                set_error(ctx,
                                          msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                    "Index [",
                                                    (long long) i_73552, ", ",
                                                    (long long) i_73556,
                                                    "] out of bounds for array of shape [",
                                                    (long long) (int64_t) 28,
                                                    "][",
                                                    (long long) (int64_t) 28,
                                                    "].",
                                                    "-> #0  ../layers/conv2d.fut:7:91-116\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  ../layers/conv2d.fut:6:22-7:117\n   #7  ../layers/conv2d.fut:6:6-7:123\n   #8  ../layers/conv2d.fut:22:7-30\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            double defunc_0_f_res_f_res_73562 =
                                   ((double *) mem_103444)[i_85678 *
                                                           (int64_t) 784 +
                                                           i_73552 *
                                                           (int64_t) 28 +
                                                           i_73556];
                            
                            defunc_0_f_res_73551 = defunc_0_f_res_f_res_73562;
                        }
                        ((double *) mem_103442)[i_85678 * (int64_t) 900 +
                                                i_85672 * (int64_t) 30 +
                                                i_85668] = defunc_0_f_res_73551;
                    }
                }
            }
            for (int32_t i_86838 = 0; i_86838 < 28; i_86838++) {
                int64_t i_85687 = sext_i32_i64(i_86838);
                int64_t j_62017 = add64((int64_t) 3, i_85687);
                int64_t i_p_m_t_s_62018 = add64((int64_t) 2, i_85687);
                bool zzero_leq_i_p_m_t_s_62019 = sle64((int64_t) 0,
                                                       i_p_m_t_s_62018);
                bool i_p_m_t_s_leq_w_62020 = slt64(i_p_m_t_s_62018,
                                                   (int64_t) 30);
                bool zzero_lte_i_62021 = sle64((int64_t) 0, i_85687);
                bool i_lte_j_62022 = sle64(i_85687, j_62017);
                bool y_62023 = i_p_m_t_s_leq_w_62020 && zzero_lte_i_62021;
                bool y_62024 = zzero_leq_i_p_m_t_s_62019 && y_62023;
                bool y_62025 = i_lte_j_62022 && y_62024;
                bool forwards_ok_62026 = zzero_lte_i_62021 && y_62025;
                
                for (int32_t i_87265 = 0; i_87265 < 28; i_87265++) {
                    int64_t i_85683 = sext_i32_i64(i_87265);
                    int64_t j_62030 = add64((int64_t) 3, i_85683);
                    int64_t i_p_m_t_s_62031 = add64((int64_t) 2, i_85683);
                    bool zzero_leq_i_p_m_t_s_62032 = sle64((int64_t) 0,
                                                           i_p_m_t_s_62031);
                    bool i_p_m_t_s_leq_w_62033 = slt64(i_p_m_t_s_62031,
                                                       (int64_t) 30);
                    bool zzero_lte_i_62034 = sle64((int64_t) 0, i_85683);
                    bool i_lte_j_62035 = sle64(i_85683, j_62030);
                    bool y_62036 = i_p_m_t_s_leq_w_62033 && zzero_lte_i_62034;
                    bool y_62037 = zzero_leq_i_p_m_t_s_62032 && y_62036;
                    bool y_62038 = i_lte_j_62035 && y_62037;
                    bool forwards_ok_62039 = zzero_lte_i_62034 && y_62038;
                    bool index_ok_62041 = forwards_ok_62026 &&
                         forwards_ok_62039;
                    bool index_certs_62042;
                    
                    if (!index_ok_62041) {
                        set_error(ctx,
                                  msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                            "Index [", (long long) i_85687, ":",
                                            (long long) j_62017, ", ",
                                            (long long) i_85683, ":",
                                            (long long) j_62030,
                                            "] out of bounds for array of shape [",
                                            (long long) (int64_t) 30, "][",
                                            (long long) (int64_t) 30, "].",
                                            "-> #0  ../layers/conv2d.fut:13:90-124\n   #1  ../layers/conv2d.fut:13:69-146\n   #2  /prelude/soacs.fut:59:3-10\n   #3  /prelude/array.fut:200:3-17\n   #4  /prelude/functional.fut:39:59-65\n   #5  /prelude/soacs.fut:59:3-10\n   #6  /prelude/array.fut:208:3-34\n   #7  ../layers/conv2d.fut:13:26-162\n   #8  ../layers/conv2d.fut:26:17-54\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    for (int64_t i_114222 = 0; i_114222 < (int64_t) 1152;
                         i_114222++) {
                        double tmp_114223 =
                               ((double *) mem_103442)[(int64_t) 30 * i_85687 +
                                                       i_85683 +
                                                       (squot64(i_114222,
                                                                (int64_t) 9) *
                                                        (int64_t) 900 +
                                                        squot64(i_114222 -
                                                                squot64(i_114222,
                                                                        (int64_t) 9) *
                                                                (int64_t) 9,
                                                                (int64_t) 3) *
                                                        (int64_t) 30 +
                                                        (i_114222 -
                                                         squot64(i_114222,
                                                                 (int64_t) 9) *
                                                         (int64_t) 9 -
                                                         squot64(i_114222 -
                                                                 squot64(i_114222,
                                                                         (int64_t) 9) *
                                                                 (int64_t) 9,
                                                                 (int64_t) 3) *
                                                         (int64_t) 3))];
                        
                        ((double *) mem_103610)[i_85687 * (int64_t) 32256 +
                                                i_85683 * (int64_t) 1152 +
                                                i_114222] = tmp_114223;
                    }
                }
            }
            for (int32_t i_86839 = 0; i_86839 < 512; i_86839++) {
                int64_t i_85697 = sext_i32_i64(i_86839);
                int64_t binop_x_89489 = (int64_t) 1152 * i_85697;
                
                for (int32_t i_87263 = 0; i_87263 < 784; i_87263++) {
                    int64_t i_85693 = sext_i32_i64(i_87263);
                    int64_t binop_x_89555 = (int64_t) 1152 * i_85693;
                    double defunc_2_reduce_res_84031;
                    double redout_85689 = 0.0;
                    
                    for (int32_t i_87264 = 0; i_87264 < 1152; i_87264++) {
                        int64_t i_85690 = sext_i32_i64(i_87264);
                        int64_t binop_x_89490 = i_85690 + binop_x_89489;
                        int64_t new_index_89491 = squot64(binop_x_89490,
                                                          (int64_t) 1152);
                        int64_t binop_y_89497 = (int64_t) 1152 *
                                new_index_89491;
                        int64_t binop_x_89498 = binop_x_89490 - binop_y_89497;
                        int64_t new_index_89499 = squot64(binop_x_89498,
                                                          (int64_t) 9);
                        int64_t binop_y_89515 = (int64_t) 9 * new_index_89499;
                        int64_t binop_x_89516 = binop_x_89498 - binop_y_89515;
                        int64_t new_index_89517 = squot64(binop_x_89516,
                                                          (int64_t) 3);
                        int64_t binop_y_89553 = (int64_t) 3 * new_index_89517;
                        int64_t new_index_89554 = binop_x_89516 - binop_y_89553;
                        int64_t binop_y_89583 = (int64_t) -1 * new_index_89517;
                        int64_t slice_89584 = (int64_t) 2 + binop_y_89583;
                        int64_t binop_y_89585 = (int64_t) -1 * new_index_89554;
                        int64_t slice_89586 = (int64_t) 2 + binop_y_89585;
                        double x_81621 =
                               ((double *) mem_param_97039.mem)[new_index_89499 *
                                                                (int64_t) 4608 +
                                                                new_index_89491 *
                                                                (int64_t) 9 +
                                                                slice_89584 *
                                                                (int64_t) 3 +
                                                                slice_89586];
                        int64_t binop_x_89556 = i_85690 + binop_x_89555;
                        int64_t new_index_89557 = squot64(binop_x_89556,
                                                          (int64_t) 32256);
                        int64_t binop_y_89563 = (int64_t) 32256 *
                                new_index_89557;
                        int64_t binop_x_89564 = binop_x_89556 - binop_y_89563;
                        int64_t new_index_89565 = squot64(binop_x_89564,
                                                          (int64_t) 1152);
                        int64_t binop_y_89581 = (int64_t) 1152 *
                                new_index_89565;
                        int64_t new_index_89582 = binop_x_89564 - binop_y_89581;
                        double x_81622 =
                               ((double *) mem_103610)[new_index_89557 *
                                                       (int64_t) 32256 +
                                                       new_index_89565 *
                                                       (int64_t) 1152 +
                                                       new_index_89582];
                        double defunc_1_f_res_81623 = x_81621 * x_81622;
                        double defunc_1_op_res_62061 = defunc_1_f_res_81623 +
                               redout_85689;
                        double redout_tmp_114226 = defunc_1_op_res_62061;
                        
                        redout_85689 = redout_tmp_114226;
                    }
                    defunc_2_reduce_res_84031 = redout_85689;
                    ((double *) mem_103662)[i_85697 * (int64_t) 784 + i_85693] =
                        defunc_2_reduce_res_84031;
                }
            }
            for (int32_t i_86840 = 0; i_86840 < 256; i_86840++) {
                int64_t i_85709 = sext_i32_i64(i_86840);
                int64_t slice_87262 = (int64_t) 256 + i_85709;
                int64_t binop_x_89457 = (int64_t) 784 * i_85709;
                int64_t binop_x_89473 = (int64_t) 784 * slice_87262;
                
                for (int32_t i_87260 = 0; i_87260 < 28; i_87260++) {
                    int64_t i_85705 = sext_i32_i64(i_87260);
                    int64_t binop_y_89458 = (int64_t) 28 * i_85705;
                    int64_t binop_x_89459 = binop_x_89457 + binop_y_89458;
                    int64_t binop_x_89475 = binop_y_89458 + binop_x_89473;
                    
                    for (int32_t i_87261 = 0; i_87261 < 28; i_87261++) {
                        int64_t i_85701 = sext_i32_i64(i_87261);
                        int64_t binop_x_89460 = i_85701 + binop_x_89459;
                        int64_t new_index_89461 = squot64(binop_x_89460,
                                                          (int64_t) 784);
                        int64_t binop_y_89471 = (int64_t) 784 * new_index_89461;
                        int64_t new_index_89472 = binop_x_89460 - binop_y_89471;
                        double x_54747 =
                               ((double *) mem_103662)[new_index_89461 *
                                                       (int64_t) 784 +
                                                       new_index_89472];
                        int64_t binop_x_89476 = i_85701 + binop_x_89475;
                        int64_t new_index_89477 = squot64(binop_x_89476,
                                                          (int64_t) 784);
                        int64_t binop_y_89487 = (int64_t) 784 * new_index_89477;
                        int64_t new_index_89488 = binop_x_89476 - binop_y_89487;
                        double x_54748 =
                               ((double *) mem_103662)[new_index_89477 *
                                                       (int64_t) 784 +
                                                       new_index_89488];
                        double defunc_1_f_res_54749 = x_54747 + x_54748;
                        
                        ((double *) mem_103702)[i_85709 * (int64_t) 784 +
                                                i_85705 * (int64_t) 28 +
                                                i_85701] = defunc_1_f_res_54749;
                    }
                }
            }
            for (int32_t i_86841 = 0; i_86841 < 32; i_86841++) {
                int64_t i_85715 = sext_i32_i64(i_86841);
                int64_t i_76926 = mul64((int64_t) 8, i_85715);
                int64_t x_76927 = add64((int64_t) 1, i_85715);
                int64_t j_76928 = mul64((int64_t) 8, x_76927);
                int64_t j_m_i_76929 = sub64(j_76928, i_76926);
                bool empty_slice_76930 = j_m_i_76929 == (int64_t) 0;
                int64_t m_76931 = sub64(j_m_i_76929, (int64_t) 1);
                int64_t i_p_m_t_s_76932 = add64(i_76926, m_76931);
                bool zzero_leq_i_p_m_t_s_76933 = sle64((int64_t) 0,
                                                       i_p_m_t_s_76932);
                bool i_p_m_t_s_leq_w_76934 = slt64(i_p_m_t_s_76932,
                                                   (int64_t) 256);
                bool zzero_lte_i_76935 = sle64((int64_t) 0, i_76926);
                bool i_lte_j_76936 = sle64(i_76926, j_76928);
                bool y_76937 = i_p_m_t_s_leq_w_76934 && zzero_lte_i_76935;
                bool y_76938 = zzero_leq_i_p_m_t_s_76933 && y_76937;
                bool y_76939 = i_lte_j_76936 && y_76938;
                bool forwards_ok_76940 = zzero_lte_i_76935 && y_76939;
                bool ok_or_empty_76941 = empty_slice_76930 || forwards_ok_76940;
                bool index_certs_76942;
                
                if (!ok_or_empty_76941) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Index [", (long long) i_76926, ":",
                                        (long long) j_76928,
                                        "] out of bounds for array of shape [",
                                        (long long) (int64_t) 256, "].",
                                        "-> #0  ../layers/groupnorm.fut:2:31-70\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  ../layers/groupnorm.fut:2:3-97\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool dim_match_76943 = (int64_t) 8 == j_m_i_76929;
                bool empty_or_match_cert_76944;
                
                if (!dim_match_76943) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Value of (core language) shape (",
                                        (long long) j_m_i_76929, ", ",
                                        (long long) (int64_t) 28, ", ",
                                        (long long) (int64_t) 28,
                                        ") cannot match shape of type `[",
                                        (long long) (int64_t) 8, "][",
                                        (long long) (int64_t) 28, "][",
                                        (long long) (int64_t) 28, "]f64`.",
                                        "-> #0  ../layers/groupnorm.fut:2:31-96\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  ../layers/groupnorm.fut:2:3-97\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if ((int64_t) 50176 > 0)
                    memmove(mem_103786 + i_85715 * (int64_t) 6272 * (int64_t) 8,
                            mem_103702 + (int64_t) 784 * i_76926 * (int64_t) 8,
                            (int64_t) 50176);
                if ((int64_t) 50176 > 0)
                    memmove(mem_103788 + i_85715 * (int64_t) 6272 * (int64_t) 8,
                            mem_99615 + (int64_t) 784 * i_76926 * (int64_t) 8,
                            (int64_t) 50176);
            }
            for (int32_t i_86842 = 0; i_86842 < 32; i_86842++) {
                int64_t i_85725 = sext_i32_i64(i_86842);
                int64_t binop_x_89325 = (int64_t) 6272 * i_85725;
                double defunc_2_reduce_res_84035;
                double defunc_2_reduce_res_84036;
                double redout_85718;
                double redout_85719;
                
                redout_85718 = 0.0;
                redout_85719 = 0.0;
                for (int32_t i_87257 = 0; i_87257 < 6272; i_87257++) {
                    int64_t i_85720 = sext_i32_i64(i_87257);
                    int64_t binop_x_89326 = i_85720 + binop_x_89325;
                    int64_t new_index_89327 = squot64(binop_x_89326,
                                                      (int64_t) 6272);
                    int64_t binop_y_89333 = (int64_t) 6272 * new_index_89327;
                    int64_t binop_x_89334 = binop_x_89326 - binop_y_89333;
                    int64_t new_index_89335 = squot64(binop_x_89334,
                                                      (int64_t) 784);
                    int64_t binop_y_89351 = (int64_t) 784 * new_index_89335;
                    int64_t binop_x_89352 = binop_x_89334 - binop_y_89351;
                    int64_t new_index_89353 = squot64(binop_x_89352,
                                                      (int64_t) 28);
                    int64_t binop_y_89389 = (int64_t) 28 * new_index_89353;
                    int64_t new_index_89390 = binop_x_89352 - binop_y_89389;
                    double x_81638 = ((double *) mem_103786)[new_index_89327 *
                                                             (int64_t) 6272 +
                                                             new_index_89335 *
                                                             (int64_t) 784 +
                                                             new_index_89353 *
                                                             (int64_t) 28 +
                                                             new_index_89390];
                    double x_81639 = ((double *) mem_103788)[new_index_89327 *
                                                             (int64_t) 6272 +
                                                             new_index_89335 *
                                                             (int64_t) 784 +
                                                             new_index_89353 *
                                                             (int64_t) 28 +
                                                             new_index_89390];
                    double defunc_1_f_res_81641 = x_81638 * x_81639;
                    double defunc_1_op_res_62191 = x_81638 + redout_85718;
                    double defunc_1_op_res_62200 = defunc_1_f_res_81641 +
                           redout_85719;
                    double redout_tmp_114234 = defunc_1_op_res_62191;
                    double redout_tmp_114235 = defunc_1_op_res_62200;
                    
                    redout_85718 = redout_tmp_114234;
                    redout_85719 = redout_tmp_114235;
                }
                defunc_2_reduce_res_84035 = redout_85718;
                defunc_2_reduce_res_84036 = redout_85719;
                ((double *) mem_103846)[i_85725] = defunc_2_reduce_res_84035;
                ((double *) mem_103848)[i_85725] = defunc_2_reduce_res_84036;
            }
            for (int32_t i_86843 = 0; i_86843 < 32; i_86843++) {
                int64_t i_85742 = sext_i32_i64(i_86843);
                bool x_62208 = sle64((int64_t) 0, i_85742);
                bool y_62209 = slt64(i_85742, (int64_t) 32);
                bool bounds_check_62210 = x_62208 && y_62209;
                bool index_certs_62211;
                
                if (!bounds_check_62210) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Index [", (long long) i_85742,
                                        "] out of bounds for array of shape [",
                                        (long long) (int64_t) 32, "].",
                                        "-> #0  ../layers/groupnorm.fut:36:43-66\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                double defunc_0_f_res_62212 = ((double *) mem_103846)[i_85742];
                double defunc_0_f_res_62213 = ((double *) mem_103848)[i_85742];
                bool index_certs_62216;
                
                if (!bounds_check_62210) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Index [", (long long) i_85742,
                                        "] out of bounds for array of shape [",
                                        (long long) (int64_t) 32, "].",
                                        "-> #0  ../layers/groupnorm.fut:40:18-23\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  /prelude/functional.fut:39:59-65\n   #7  /prelude/soacs.fut:59:3-10\n   #8  /prelude/array.fut:216:3-39\n   #9  ../layers/groupnorm.fut:37:10-40:31\n   #10 /prelude/soacs.fut:59:3-10\n   #11 /prelude/array.fut:200:3-17\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                double x_62217 = ((double *) mem_99593)[i_85742];
                double sqrt_arg_62218 = 1.0e-5 + x_62217;
                double sqrt_res_62219 = futrts_sqrt64(sqrt_arg_62218);
                
                for (int32_t i_87246 = 0; i_87246 < 8; i_87246++) {
                    int64_t i_85738 = sext_i32_i64(i_87246);
                    bool x_62222 = sle64((int64_t) 0, i_85738);
                    bool y_62223 = slt64(i_85738, (int64_t) 8);
                    bool bounds_check_62224 = x_62222 && y_62223;
                    
                    for (int32_t i_87247 = 0; i_87247 < 28; i_87247++) {
                        int64_t i_85734 = sext_i32_i64(i_87247);
                        bool x_62227 = sle64((int64_t) 0, i_85734);
                        bool y_62228 = slt64(i_85734, (int64_t) 28);
                        bool bounds_check_62229 = x_62227 && y_62228;
                        
                        for (int32_t i_87248 = 0; i_87248 < 28; i_87248++) {
                            int64_t i_85730 = sext_i32_i64(i_87248);
                            bool x_62234 = sle64((int64_t) 0, i_85730);
                            bool y_62235 = slt64(i_85730, (int64_t) 28);
                            bool bounds_check_62236 = x_62234 && y_62235;
                            bool y_62237 = bounds_check_62210 &&
                                 bounds_check_62236;
                            bool y_62238 = bounds_check_62229 && y_62237;
                            bool index_ok_62239 = bounds_check_62224 && y_62238;
                            bool index_certs_62240;
                            
                            if (!index_ok_62239) {
                                set_error(ctx,
                                          msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                    "Index [",
                                                    (long long) i_85742, ", ",
                                                    (long long) i_85738, ", ",
                                                    (long long) i_85734, ", ",
                                                    (long long) i_85730,
                                                    "] out of bounds for array of shape [",
                                                    (long long) (int64_t) 32,
                                                    "][",
                                                    (long long) (int64_t) 8,
                                                    "][",
                                                    (long long) (int64_t) 28,
                                                    "][",
                                                    (long long) (int64_t) 28,
                                                    "].",
                                                    "-> #0  ../layers/groupnorm.fut:39:30-48\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  /prelude/functional.fut:39:59-65\n   #7  /prelude/soacs.fut:59:3-10\n   #8  /prelude/array.fut:216:3-39\n   #9  ../layers/groupnorm.fut:37:10-40:31\n   #10 /prelude/soacs.fut:59:3-10\n   #11 /prelude/array.fut:200:3-17\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            double y_62241 = ((double *) mem_103786)[i_85742 *
                                                                     (int64_t) 6272 +
                                                                     i_85738 *
                                                                     (int64_t) 784 +
                                                                     i_85734 *
                                                                     (int64_t) 28 +
                                                                     i_85730];
                            double x_62242 = 6272.0 * y_62241;
                            double x_62243 = x_62242 - defunc_0_f_res_62212;
                            double x_62250 = ((double *) mem_103788)[i_85742 *
                                                                     (int64_t) 6272 +
                                                                     i_85738 *
                                                                     (int64_t) 784 +
                                                                     i_85734 *
                                                                     (int64_t) 28 +
                                                                     i_85730];
                            double y_62251 = defunc_0_f_res_62213 * x_62250;
                            double y_62252 = x_62243 - y_62251;
                            double x_62253 = 1.5943877551020407e-4 * y_62252;
                            double defunc_0_f_res_62254 = x_62253 /
                                   sqrt_res_62219;
                            
                            ((double *) mem_103870)[i_85742 * (int64_t) 6272 +
                                                    i_85738 * (int64_t) 784 +
                                                    i_85734 * (int64_t) 28 +
                                                    i_85730] =
                                defunc_0_f_res_62254;
                        }
                    }
                }
            }
            for (int32_t i_86844 = 0; i_86844 < 256; i_86844++) {
                int64_t i_85764 = sext_i32_i64(i_86844);
                int64_t binop_x_89213 = (int64_t) 784 * i_85764;
                
                for (int32_t i_87238 = 0; i_87238 < 28; i_87238++) {
                    int64_t i_85750 = sext_i32_i64(i_87238);
                    int64_t binop_y_89214 = (int64_t) 28 * i_85750;
                    int64_t binop_x_89215 = binop_x_89213 + binop_y_89214;
                    
                    for (int32_t i_87245 = 0; i_87245 < 28; i_87245++) {
                        int64_t i_85746 = sext_i32_i64(i_87245);
                        int64_t binop_x_89216 = i_85746 + binop_x_89215;
                        int64_t new_index_89217 = squot64(binop_x_89216,
                                                          (int64_t) 6272);
                        int64_t binop_y_89227 = (int64_t) 6272 *
                                new_index_89217;
                        int64_t binop_x_89228 = binop_x_89216 - binop_y_89227;
                        int64_t new_index_89229 = squot64(binop_x_89228,
                                                          (int64_t) 784);
                        int64_t binop_y_89253 = (int64_t) 784 * new_index_89229;
                        int64_t binop_x_89254 = binop_x_89228 - binop_y_89253;
                        int64_t new_index_89255 = squot64(binop_x_89254,
                                                          (int64_t) 28);
                        int64_t binop_y_89307 = (int64_t) 28 * new_index_89255;
                        int64_t new_index_89308 = binop_x_89254 - binop_y_89307;
                        double x_73081 =
                               ((double *) mem_103870)[new_index_89217 *
                                                       (int64_t) 6272 +
                                                       new_index_89229 *
                                                       (int64_t) 784 +
                                                       new_index_89255 *
                                                       (int64_t) 28 +
                                                       new_index_89308];
                        int64_t new_index_89313 = squot64(binop_x_89216,
                                                          (int64_t) 784);
                        int64_t binop_y_89323 = (int64_t) 784 * new_index_89313;
                        int64_t new_index_89324 = binop_x_89216 - binop_y_89323;
                        double x_73082 =
                               ((double *) mem_99437)[new_index_89313 *
                                                      (int64_t) 784 +
                                                      new_index_89324];
                        bool cond_73083 = 0.0 < x_73082;
                        double defunc_1_f_res_73084;
                        
                        if (cond_73083 == 1) {
                            defunc_1_f_res_73084 = x_73081;
                        } else {
                            defunc_1_f_res_73084 = 0.0;
                        }
                        ((double *) mem_104016)[i_85764 * (int64_t) 784 +
                                                i_85750 * (int64_t) 28 +
                                                i_85746] = defunc_1_f_res_73084;
                    }
                }
                for (int32_t i_87239 = 0; i_87239 < 30; i_87239++) {
                    int64_t i_85758 = sext_i32_i64(i_87239);
                    bool cond_73088 = slt64(i_85758, (int64_t) 1);
                    bool cond_f_res_73089 = sle64((int64_t) 29, i_85758);
                    bool x_73090 = !cond_73088;
                    bool y_73091 = cond_f_res_73089 && x_73090;
                    bool cond_73092 = cond_73088 || y_73091;
                    bool x_73093 = !cond_73092;
                    
                    for (int32_t i_87240 = 0; i_87240 < 30; i_87240++) {
                        int64_t i_85754 = sext_i32_i64(i_87240);
                        bool cond_f_res_73096 = slt64(i_85754, (int64_t) 1);
                        bool y_73097 = x_73093 && cond_f_res_73096;
                        bool cond_73098 = cond_73092 || y_73097;
                        bool cond_f_res_73099 = sle64((int64_t) 29, i_85754);
                        bool x_73100 = !cond_73098;
                        bool y_73101 = cond_f_res_73099 && x_73100;
                        bool cond_73102 = cond_73098 || y_73101;
                        double defunc_0_f_res_73103;
                        
                        if (cond_73102 == 1) {
                            defunc_0_f_res_73103 = 0.0;
                        } else {
                            int64_t i_73104 = sub64(i_85758, (int64_t) 1);
                            bool x_73105 = sle64((int64_t) 0, i_73104);
                            bool y_73106 = slt64(i_73104, (int64_t) 28);
                            bool bounds_check_73107 = x_73105 && y_73106;
                            int64_t i_73108 = sub64(i_85754, (int64_t) 1);
                            bool x_73109 = sle64((int64_t) 0, i_73108);
                            bool y_73110 = slt64(i_73108, (int64_t) 28);
                            bool bounds_check_73111 = x_73109 && y_73110;
                            bool index_ok_73112 = bounds_check_73107 &&
                                 bounds_check_73111;
                            bool index_certs_73113;
                            
                            if (!index_ok_73112) {
                                set_error(ctx,
                                          msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                    "Index [",
                                                    (long long) i_73104, ", ",
                                                    (long long) i_73108,
                                                    "] out of bounds for array of shape [",
                                                    (long long) (int64_t) 28,
                                                    "][",
                                                    (long long) (int64_t) 28,
                                                    "].",
                                                    "-> #0  ../layers/conv2d.fut:7:91-116\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  ../layers/conv2d.fut:6:22-7:117\n   #7  ../layers/conv2d.fut:6:6-7:123\n   #8  ../layers/conv2d.fut:22:7-30\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            double defunc_0_f_res_f_res_73114 =
                                   ((double *) mem_104016)[i_85764 *
                                                           (int64_t) 784 +
                                                           i_73104 *
                                                           (int64_t) 28 +
                                                           i_73108];
                            
                            defunc_0_f_res_73103 = defunc_0_f_res_f_res_73114;
                        }
                        ((double *) mem_104014)[i_85764 * (int64_t) 900 +
                                                i_85758 * (int64_t) 30 +
                                                i_85754] = defunc_0_f_res_73103;
                    }
                }
            }
            for (int32_t i_86845 = 0; i_86845 < 28; i_86845++) {
                int64_t i_85773 = sext_i32_i64(i_86845);
                int64_t j_62512 = add64((int64_t) 3, i_85773);
                int64_t i_p_m_t_s_62513 = add64((int64_t) 2, i_85773);
                bool zzero_leq_i_p_m_t_s_62514 = sle64((int64_t) 0,
                                                       i_p_m_t_s_62513);
                bool i_p_m_t_s_leq_w_62515 = slt64(i_p_m_t_s_62513,
                                                   (int64_t) 30);
                bool zzero_lte_i_62516 = sle64((int64_t) 0, i_85773);
                bool i_lte_j_62517 = sle64(i_85773, j_62512);
                bool y_62518 = i_p_m_t_s_leq_w_62515 && zzero_lte_i_62516;
                bool y_62519 = zzero_leq_i_p_m_t_s_62514 && y_62518;
                bool y_62520 = i_lte_j_62517 && y_62519;
                bool forwards_ok_62521 = zzero_lte_i_62516 && y_62520;
                
                for (int32_t i_87233 = 0; i_87233 < 28; i_87233++) {
                    int64_t i_85769 = sext_i32_i64(i_87233);
                    int64_t j_62525 = add64((int64_t) 3, i_85769);
                    int64_t i_p_m_t_s_62526 = add64((int64_t) 2, i_85769);
                    bool zzero_leq_i_p_m_t_s_62527 = sle64((int64_t) 0,
                                                           i_p_m_t_s_62526);
                    bool i_p_m_t_s_leq_w_62528 = slt64(i_p_m_t_s_62526,
                                                       (int64_t) 30);
                    bool zzero_lte_i_62529 = sle64((int64_t) 0, i_85769);
                    bool i_lte_j_62530 = sle64(i_85769, j_62525);
                    bool y_62531 = i_p_m_t_s_leq_w_62528 && zzero_lte_i_62529;
                    bool y_62532 = zzero_leq_i_p_m_t_s_62527 && y_62531;
                    bool y_62533 = i_lte_j_62530 && y_62532;
                    bool forwards_ok_62534 = zzero_lte_i_62529 && y_62533;
                    bool index_ok_62536 = forwards_ok_62521 &&
                         forwards_ok_62534;
                    bool index_certs_62537;
                    
                    if (!index_ok_62536) {
                        set_error(ctx,
                                  msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                            "Index [", (long long) i_85773, ":",
                                            (long long) j_62512, ", ",
                                            (long long) i_85769, ":",
                                            (long long) j_62525,
                                            "] out of bounds for array of shape [",
                                            (long long) (int64_t) 30, "][",
                                            (long long) (int64_t) 30, "].",
                                            "-> #0  ../layers/conv2d.fut:13:90-124\n   #1  ../layers/conv2d.fut:13:69-146\n   #2  /prelude/soacs.fut:59:3-10\n   #3  /prelude/array.fut:200:3-17\n   #4  /prelude/functional.fut:39:59-65\n   #5  /prelude/soacs.fut:59:3-10\n   #6  /prelude/array.fut:208:3-34\n   #7  ../layers/conv2d.fut:13:26-162\n   #8  ../layers/conv2d.fut:26:17-54\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    for (int64_t i_114248 = 0; i_114248 < (int64_t) 2304;
                         i_114248++) {
                        double tmp_114249 =
                               ((double *) mem_104014)[(int64_t) 30 * i_85773 +
                                                       i_85769 +
                                                       (squot64(i_114248,
                                                                (int64_t) 9) *
                                                        (int64_t) 900 +
                                                        squot64(i_114248 -
                                                                squot64(i_114248,
                                                                        (int64_t) 9) *
                                                                (int64_t) 9,
                                                                (int64_t) 3) *
                                                        (int64_t) 30 +
                                                        (i_114248 -
                                                         squot64(i_114248,
                                                                 (int64_t) 9) *
                                                         (int64_t) 9 -
                                                         squot64(i_114248 -
                                                                 squot64(i_114248,
                                                                         (int64_t) 9) *
                                                                 (int64_t) 9,
                                                                 (int64_t) 3) *
                                                         (int64_t) 3))];
                        
                        ((double *) mem_104182)[i_85773 * (int64_t) 64512 +
                                                i_85769 * (int64_t) 2304 +
                                                i_114248] = tmp_114249;
                    }
                }
            }
            for (int32_t i_86846 = 0; i_86846 < 256; i_86846++) {
                int64_t i_85783 = sext_i32_i64(i_86846);
                int64_t binop_x_89115 = (int64_t) 2304 * i_85783;
                
                for (int32_t i_87231 = 0; i_87231 < 784; i_87231++) {
                    int64_t i_85779 = sext_i32_i64(i_87231);
                    int64_t binop_x_89181 = (int64_t) 2304 * i_85779;
                    double defunc_2_reduce_res_84045;
                    double redout_85775 = 0.0;
                    
                    for (int32_t i_87232 = 0; i_87232 < 2304; i_87232++) {
                        int64_t i_85776 = sext_i32_i64(i_87232);
                        int64_t binop_x_89116 = i_85776 + binop_x_89115;
                        int64_t new_index_89117 = squot64(binop_x_89116,
                                                          (int64_t) 2304);
                        int64_t binop_y_89123 = (int64_t) 2304 *
                                new_index_89117;
                        int64_t binop_x_89124 = binop_x_89116 - binop_y_89123;
                        int64_t new_index_89125 = squot64(binop_x_89124,
                                                          (int64_t) 9);
                        int64_t binop_y_89141 = (int64_t) 9 * new_index_89125;
                        int64_t binop_x_89142 = binop_x_89124 - binop_y_89141;
                        int64_t new_index_89143 = squot64(binop_x_89142,
                                                          (int64_t) 3);
                        int64_t binop_y_89179 = (int64_t) 3 * new_index_89143;
                        int64_t new_index_89180 = binop_x_89142 - binop_y_89179;
                        int64_t binop_y_89209 = (int64_t) -1 * new_index_89143;
                        int64_t slice_89210 = (int64_t) 2 + binop_y_89209;
                        int64_t binop_y_89211 = (int64_t) -1 * new_index_89180;
                        int64_t slice_89212 = (int64_t) 2 + binop_y_89211;
                        double x_82329 =
                               ((double *) mem_param_97020.mem)[new_index_89125 *
                                                                (int64_t) 2304 +
                                                                new_index_89117 *
                                                                (int64_t) 9 +
                                                                slice_89210 *
                                                                (int64_t) 3 +
                                                                slice_89212];
                        int64_t binop_x_89182 = i_85776 + binop_x_89181;
                        int64_t new_index_89183 = squot64(binop_x_89182,
                                                          (int64_t) 64512);
                        int64_t binop_y_89189 = (int64_t) 64512 *
                                new_index_89183;
                        int64_t binop_x_89190 = binop_x_89182 - binop_y_89189;
                        int64_t new_index_89191 = squot64(binop_x_89190,
                                                          (int64_t) 2304);
                        int64_t binop_y_89207 = (int64_t) 2304 *
                                new_index_89191;
                        int64_t new_index_89208 = binop_x_89190 - binop_y_89207;
                        double x_82330 =
                               ((double *) mem_104182)[new_index_89183 *
                                                       (int64_t) 64512 +
                                                       new_index_89191 *
                                                       (int64_t) 2304 +
                                                       new_index_89208];
                        double defunc_1_f_res_82331 = x_82329 * x_82330;
                        double defunc_1_op_res_62556 = defunc_1_f_res_82331 +
                               redout_85775;
                        double redout_tmp_114252 = defunc_1_op_res_62556;
                        
                        redout_85775 = redout_tmp_114252;
                    }
                    defunc_2_reduce_res_84045 = redout_85775;
                    ((double *) mem_104234)[i_85783 * (int64_t) 784 + i_85779] =
                        defunc_2_reduce_res_84045;
                }
            }
            for (int32_t i_86847 = 0; i_86847 < 32; i_86847++) {
                int64_t i_85789 = sext_i32_i64(i_86847);
                int64_t i_76882 = mul64((int64_t) 8, i_85789);
                int64_t x_76883 = add64((int64_t) 1, i_85789);
                int64_t j_76884 = mul64((int64_t) 8, x_76883);
                int64_t j_m_i_76885 = sub64(j_76884, i_76882);
                bool empty_slice_76886 = j_m_i_76885 == (int64_t) 0;
                int64_t m_76887 = sub64(j_m_i_76885, (int64_t) 1);
                int64_t i_p_m_t_s_76888 = add64(i_76882, m_76887);
                bool zzero_leq_i_p_m_t_s_76889 = sle64((int64_t) 0,
                                                       i_p_m_t_s_76888);
                bool i_p_m_t_s_leq_w_76890 = slt64(i_p_m_t_s_76888,
                                                   (int64_t) 256);
                bool zzero_lte_i_76891 = sle64((int64_t) 0, i_76882);
                bool i_lte_j_76892 = sle64(i_76882, j_76884);
                bool y_76893 = i_p_m_t_s_leq_w_76890 && zzero_lte_i_76891;
                bool y_76894 = zzero_leq_i_p_m_t_s_76889 && y_76893;
                bool y_76895 = i_lte_j_76892 && y_76894;
                bool forwards_ok_76896 = zzero_lte_i_76891 && y_76895;
                bool ok_or_empty_76897 = empty_slice_76886 || forwards_ok_76896;
                bool index_certs_76898;
                
                if (!ok_or_empty_76897) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Index [", (long long) i_76882, ":",
                                        (long long) j_76884,
                                        "] out of bounds for array of shape [",
                                        (long long) (int64_t) 256, "].",
                                        "-> #0  ../layers/groupnorm.fut:2:31-70\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  ../layers/groupnorm.fut:2:3-97\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool dim_match_76899 = (int64_t) 8 == j_m_i_76885;
                bool empty_or_match_cert_76900;
                
                if (!dim_match_76899) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Value of (core language) shape (",
                                        (long long) j_m_i_76885, ", ",
                                        (long long) (int64_t) 28, ", ",
                                        (long long) (int64_t) 28,
                                        ") cannot match shape of type `[",
                                        (long long) (int64_t) 8, "][",
                                        (long long) (int64_t) 28, "][",
                                        (long long) (int64_t) 28, "]f64`.",
                                        "-> #0  ../layers/groupnorm.fut:2:31-96\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  ../layers/groupnorm.fut:2:3-97\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if ((int64_t) 50176 > 0)
                    memmove(mem_104274 + i_85789 * (int64_t) 6272 * (int64_t) 8,
                            mem_104234 + (int64_t) 784 * i_76882 * (int64_t) 8,
                            (int64_t) 50176);
                if ((int64_t) 50176 > 0)
                    memmove(mem_104276 + i_85789 * (int64_t) 6272 * (int64_t) 8,
                            mem_99127 + (int64_t) 784 * i_76882 * (int64_t) 8,
                            (int64_t) 50176);
            }
            for (int32_t i_86848 = 0; i_86848 < 32; i_86848++) {
                int64_t i_85799 = sext_i32_i64(i_86848);
                int64_t binop_x_88983 = (int64_t) 6272 * i_85799;
                double defunc_2_reduce_res_84047;
                double defunc_2_reduce_res_84048;
                double redout_85792;
                double redout_85793;
                
                redout_85792 = 0.0;
                redout_85793 = 0.0;
                for (int32_t i_87228 = 0; i_87228 < 6272; i_87228++) {
                    int64_t i_85794 = sext_i32_i64(i_87228);
                    int64_t binop_x_88984 = i_85794 + binop_x_88983;
                    int64_t new_index_88985 = squot64(binop_x_88984,
                                                      (int64_t) 6272);
                    int64_t binop_y_88991 = (int64_t) 6272 * new_index_88985;
                    int64_t binop_x_88992 = binop_x_88984 - binop_y_88991;
                    int64_t new_index_88993 = squot64(binop_x_88992,
                                                      (int64_t) 784);
                    int64_t binop_y_89009 = (int64_t) 784 * new_index_88993;
                    int64_t binop_x_89010 = binop_x_88992 - binop_y_89009;
                    int64_t new_index_89011 = squot64(binop_x_89010,
                                                      (int64_t) 28);
                    int64_t binop_y_89047 = (int64_t) 28 * new_index_89011;
                    int64_t new_index_89048 = binop_x_89010 - binop_y_89047;
                    double x_82344 = ((double *) mem_104274)[new_index_88985 *
                                                             (int64_t) 6272 +
                                                             new_index_88993 *
                                                             (int64_t) 784 +
                                                             new_index_89011 *
                                                             (int64_t) 28 +
                                                             new_index_89048];
                    double x_82345 = ((double *) mem_104276)[new_index_88985 *
                                                             (int64_t) 6272 +
                                                             new_index_88993 *
                                                             (int64_t) 784 +
                                                             new_index_89011 *
                                                             (int64_t) 28 +
                                                             new_index_89048];
                    double defunc_1_f_res_82347 = x_82344 * x_82345;
                    double defunc_1_op_res_62637 = x_82344 + redout_85792;
                    double defunc_1_op_res_62646 = defunc_1_f_res_82347 +
                           redout_85793;
                    double redout_tmp_114257 = defunc_1_op_res_62637;
                    double redout_tmp_114258 = defunc_1_op_res_62646;
                    
                    redout_85792 = redout_tmp_114257;
                    redout_85793 = redout_tmp_114258;
                }
                defunc_2_reduce_res_84047 = redout_85792;
                defunc_2_reduce_res_84048 = redout_85793;
                ((double *) mem_104334)[i_85799] = defunc_2_reduce_res_84047;
                ((double *) mem_104336)[i_85799] = defunc_2_reduce_res_84048;
            }
            for (int32_t i_86849 = 0; i_86849 < 32; i_86849++) {
                int64_t i_85816 = sext_i32_i64(i_86849);
                bool x_62654 = sle64((int64_t) 0, i_85816);
                bool y_62655 = slt64(i_85816, (int64_t) 32);
                bool bounds_check_62656 = x_62654 && y_62655;
                bool index_certs_62657;
                
                if (!bounds_check_62656) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Index [", (long long) i_85816,
                                        "] out of bounds for array of shape [",
                                        (long long) (int64_t) 32, "].",
                                        "-> #0  ../layers/groupnorm.fut:36:43-66\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                double defunc_0_f_res_62658 = ((double *) mem_104334)[i_85816];
                double defunc_0_f_res_62659 = ((double *) mem_104336)[i_85816];
                bool index_certs_62662;
                
                if (!bounds_check_62656) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Index [", (long long) i_85816,
                                        "] out of bounds for array of shape [",
                                        (long long) (int64_t) 32, "].",
                                        "-> #0  ../layers/groupnorm.fut:40:18-23\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  /prelude/functional.fut:39:59-65\n   #7  /prelude/soacs.fut:59:3-10\n   #8  /prelude/array.fut:216:3-39\n   #9  ../layers/groupnorm.fut:37:10-40:31\n   #10 /prelude/soacs.fut:59:3-10\n   #11 /prelude/array.fut:200:3-17\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                double x_62663 = ((double *) mem_99099)[i_85816];
                double sqrt_arg_62664 = 1.0e-5 + x_62663;
                double sqrt_res_62665 = futrts_sqrt64(sqrt_arg_62664);
                
                for (int32_t i_87217 = 0; i_87217 < 8; i_87217++) {
                    int64_t i_85812 = sext_i32_i64(i_87217);
                    bool x_62668 = sle64((int64_t) 0, i_85812);
                    bool y_62669 = slt64(i_85812, (int64_t) 8);
                    bool bounds_check_62670 = x_62668 && y_62669;
                    
                    for (int32_t i_87218 = 0; i_87218 < 28; i_87218++) {
                        int64_t i_85808 = sext_i32_i64(i_87218);
                        bool x_62673 = sle64((int64_t) 0, i_85808);
                        bool y_62674 = slt64(i_85808, (int64_t) 28);
                        bool bounds_check_62675 = x_62673 && y_62674;
                        
                        for (int32_t i_87219 = 0; i_87219 < 28; i_87219++) {
                            int64_t i_85804 = sext_i32_i64(i_87219);
                            bool x_62680 = sle64((int64_t) 0, i_85804);
                            bool y_62681 = slt64(i_85804, (int64_t) 28);
                            bool bounds_check_62682 = x_62680 && y_62681;
                            bool y_62683 = bounds_check_62656 &&
                                 bounds_check_62682;
                            bool y_62684 = bounds_check_62675 && y_62683;
                            bool index_ok_62685 = bounds_check_62670 && y_62684;
                            bool index_certs_62686;
                            
                            if (!index_ok_62685) {
                                set_error(ctx,
                                          msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                    "Index [",
                                                    (long long) i_85816, ", ",
                                                    (long long) i_85812, ", ",
                                                    (long long) i_85808, ", ",
                                                    (long long) i_85804,
                                                    "] out of bounds for array of shape [",
                                                    (long long) (int64_t) 32,
                                                    "][",
                                                    (long long) (int64_t) 8,
                                                    "][",
                                                    (long long) (int64_t) 28,
                                                    "][",
                                                    (long long) (int64_t) 28,
                                                    "].",
                                                    "-> #0  ../layers/groupnorm.fut:39:30-48\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  /prelude/functional.fut:39:59-65\n   #7  /prelude/soacs.fut:59:3-10\n   #8  /prelude/array.fut:216:3-39\n   #9  ../layers/groupnorm.fut:37:10-40:31\n   #10 /prelude/soacs.fut:59:3-10\n   #11 /prelude/array.fut:200:3-17\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            double y_62687 = ((double *) mem_104274)[i_85816 *
                                                                     (int64_t) 6272 +
                                                                     i_85812 *
                                                                     (int64_t) 784 +
                                                                     i_85808 *
                                                                     (int64_t) 28 +
                                                                     i_85804];
                            double x_62688 = 6272.0 * y_62687;
                            double x_62689 = x_62688 - defunc_0_f_res_62658;
                            double x_62696 = ((double *) mem_104276)[i_85816 *
                                                                     (int64_t) 6272 +
                                                                     i_85812 *
                                                                     (int64_t) 784 +
                                                                     i_85808 *
                                                                     (int64_t) 28 +
                                                                     i_85804];
                            double y_62697 = defunc_0_f_res_62659 * x_62696;
                            double y_62698 = x_62689 - y_62697;
                            double x_62699 = 1.5943877551020407e-4 * y_62698;
                            double defunc_0_f_res_62700 = x_62699 /
                                   sqrt_res_62665;
                            
                            ((double *) mem_104358)[i_85816 * (int64_t) 6272 +
                                                    i_85812 * (int64_t) 784 +
                                                    i_85808 * (int64_t) 28 +
                                                    i_85804] =
                                defunc_0_f_res_62700;
                        }
                    }
                }
            }
            for (int32_t i_86850 = 0; i_86850 < 256; i_86850++) {
                int64_t i_85838 = sext_i32_i64(i_86850);
                int64_t binop_x_88871 = (int64_t) 784 * i_85838;
                
                for (int32_t i_87209 = 0; i_87209 < 28; i_87209++) {
                    int64_t i_85824 = sext_i32_i64(i_87209);
                    int64_t binop_y_88872 = (int64_t) 28 * i_85824;
                    int64_t binop_x_88873 = binop_x_88871 + binop_y_88872;
                    
                    for (int32_t i_87216 = 0; i_87216 < 28; i_87216++) {
                        int64_t i_85820 = sext_i32_i64(i_87216);
                        int64_t binop_x_88874 = i_85820 + binop_x_88873;
                        int64_t new_index_88875 = squot64(binop_x_88874,
                                                          (int64_t) 6272);
                        int64_t binop_y_88885 = (int64_t) 6272 *
                                new_index_88875;
                        int64_t binop_x_88886 = binop_x_88874 - binop_y_88885;
                        int64_t new_index_88887 = squot64(binop_x_88886,
                                                          (int64_t) 784);
                        int64_t binop_y_88911 = (int64_t) 784 * new_index_88887;
                        int64_t binop_x_88912 = binop_x_88886 - binop_y_88911;
                        int64_t new_index_88913 = squot64(binop_x_88912,
                                                          (int64_t) 28);
                        int64_t binop_y_88965 = (int64_t) 28 * new_index_88913;
                        int64_t new_index_88966 = binop_x_88912 - binop_y_88965;
                        double x_72890 =
                               ((double *) mem_104358)[new_index_88875 *
                                                       (int64_t) 6272 +
                                                       new_index_88887 *
                                                       (int64_t) 784 +
                                                       new_index_88913 *
                                                       (int64_t) 28 +
                                                       new_index_88966];
                        int64_t new_index_88971 = squot64(binop_x_88874,
                                                          (int64_t) 784);
                        int64_t binop_y_88981 = (int64_t) 784 * new_index_88971;
                        int64_t new_index_88982 = binop_x_88874 - binop_y_88981;
                        double x_72891 =
                               ((double *) mem_98943)[new_index_88971 *
                                                      (int64_t) 784 +
                                                      new_index_88982];
                        bool cond_72892 = 0.0 < x_72891;
                        double defunc_1_f_res_72893;
                        
                        if (cond_72892 == 1) {
                            defunc_1_f_res_72893 = x_72890;
                        } else {
                            defunc_1_f_res_72893 = 0.0;
                        }
                        ((double *) mem_104504)[i_85838 * (int64_t) 784 +
                                                i_85824 * (int64_t) 28 +
                                                i_85820] = defunc_1_f_res_72893;
                    }
                }
                for (int32_t i_87210 = 0; i_87210 < 30; i_87210++) {
                    int64_t i_85832 = sext_i32_i64(i_87210);
                    bool cond_72897 = slt64(i_85832, (int64_t) 1);
                    bool cond_f_res_72898 = sle64((int64_t) 29, i_85832);
                    bool x_72899 = !cond_72897;
                    bool y_72900 = cond_f_res_72898 && x_72899;
                    bool cond_72901 = cond_72897 || y_72900;
                    bool x_72902 = !cond_72901;
                    
                    for (int32_t i_87211 = 0; i_87211 < 30; i_87211++) {
                        int64_t i_85828 = sext_i32_i64(i_87211);
                        bool cond_f_res_72905 = slt64(i_85828, (int64_t) 1);
                        bool y_72906 = x_72902 && cond_f_res_72905;
                        bool cond_72907 = cond_72901 || y_72906;
                        bool cond_f_res_72908 = sle64((int64_t) 29, i_85828);
                        bool x_72909 = !cond_72907;
                        bool y_72910 = cond_f_res_72908 && x_72909;
                        bool cond_72911 = cond_72907 || y_72910;
                        double defunc_0_f_res_72912;
                        
                        if (cond_72911 == 1) {
                            defunc_0_f_res_72912 = 0.0;
                        } else {
                            int64_t i_72913 = sub64(i_85832, (int64_t) 1);
                            bool x_72914 = sle64((int64_t) 0, i_72913);
                            bool y_72915 = slt64(i_72913, (int64_t) 28);
                            bool bounds_check_72916 = x_72914 && y_72915;
                            int64_t i_72917 = sub64(i_85828, (int64_t) 1);
                            bool x_72918 = sle64((int64_t) 0, i_72917);
                            bool y_72919 = slt64(i_72917, (int64_t) 28);
                            bool bounds_check_72920 = x_72918 && y_72919;
                            bool index_ok_72921 = bounds_check_72916 &&
                                 bounds_check_72920;
                            bool index_certs_72922;
                            
                            if (!index_ok_72921) {
                                set_error(ctx,
                                          msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                    "Index [",
                                                    (long long) i_72913, ", ",
                                                    (long long) i_72917,
                                                    "] out of bounds for array of shape [",
                                                    (long long) (int64_t) 28,
                                                    "][",
                                                    (long long) (int64_t) 28,
                                                    "].",
                                                    "-> #0  ../layers/conv2d.fut:7:91-116\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  ../layers/conv2d.fut:6:22-7:117\n   #7  ../layers/conv2d.fut:6:6-7:123\n   #8  ../layers/conv2d.fut:22:7-30\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            double defunc_0_f_res_f_res_72923 =
                                   ((double *) mem_104504)[i_85838 *
                                                           (int64_t) 784 +
                                                           i_72913 *
                                                           (int64_t) 28 +
                                                           i_72917];
                            
                            defunc_0_f_res_72912 = defunc_0_f_res_f_res_72923;
                        }
                        ((double *) mem_104502)[i_85838 * (int64_t) 900 +
                                                i_85832 * (int64_t) 30 +
                                                i_85828] = defunc_0_f_res_72912;
                    }
                }
            }
            for (int32_t i_86851 = 0; i_86851 < 28; i_86851++) {
                int64_t i_85847 = sext_i32_i64(i_86851);
                int64_t j_62984 = add64((int64_t) 3, i_85847);
                int64_t i_p_m_t_s_62985 = add64((int64_t) 2, i_85847);
                bool zzero_leq_i_p_m_t_s_62986 = sle64((int64_t) 0,
                                                       i_p_m_t_s_62985);
                bool i_p_m_t_s_leq_w_62987 = slt64(i_p_m_t_s_62985,
                                                   (int64_t) 30);
                bool zzero_lte_i_62988 = sle64((int64_t) 0, i_85847);
                bool i_lte_j_62989 = sle64(i_85847, j_62984);
                bool y_62990 = i_p_m_t_s_leq_w_62987 && zzero_lte_i_62988;
                bool y_62991 = zzero_leq_i_p_m_t_s_62986 && y_62990;
                bool y_62992 = i_lte_j_62989 && y_62991;
                bool forwards_ok_62993 = zzero_lte_i_62988 && y_62992;
                
                for (int32_t i_87204 = 0; i_87204 < 28; i_87204++) {
                    int64_t i_85843 = sext_i32_i64(i_87204);
                    int64_t j_62997 = add64((int64_t) 3, i_85843);
                    int64_t i_p_m_t_s_62998 = add64((int64_t) 2, i_85843);
                    bool zzero_leq_i_p_m_t_s_62999 = sle64((int64_t) 0,
                                                           i_p_m_t_s_62998);
                    bool i_p_m_t_s_leq_w_63000 = slt64(i_p_m_t_s_62998,
                                                       (int64_t) 30);
                    bool zzero_lte_i_63001 = sle64((int64_t) 0, i_85843);
                    bool i_lte_j_63002 = sle64(i_85843, j_62997);
                    bool y_63003 = i_p_m_t_s_leq_w_63000 && zzero_lte_i_63001;
                    bool y_63004 = zzero_leq_i_p_m_t_s_62999 && y_63003;
                    bool y_63005 = i_lte_j_63002 && y_63004;
                    bool forwards_ok_63006 = zzero_lte_i_63001 && y_63005;
                    bool index_ok_63008 = forwards_ok_62993 &&
                         forwards_ok_63006;
                    bool index_certs_63009;
                    
                    if (!index_ok_63008) {
                        set_error(ctx,
                                  msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                            "Index [", (long long) i_85847, ":",
                                            (long long) j_62984, ", ",
                                            (long long) i_85843, ":",
                                            (long long) j_62997,
                                            "] out of bounds for array of shape [",
                                            (long long) (int64_t) 30, "][",
                                            (long long) (int64_t) 30, "].",
                                            "-> #0  ../layers/conv2d.fut:13:90-124\n   #1  ../layers/conv2d.fut:13:69-146\n   #2  /prelude/soacs.fut:59:3-10\n   #3  /prelude/array.fut:200:3-17\n   #4  /prelude/functional.fut:39:59-65\n   #5  /prelude/soacs.fut:59:3-10\n   #6  /prelude/array.fut:208:3-34\n   #7  ../layers/conv2d.fut:13:26-162\n   #8  ../layers/conv2d.fut:26:17-54\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    for (int64_t i_114271 = 0; i_114271 < (int64_t) 2304;
                         i_114271++) {
                        double tmp_114272 =
                               ((double *) mem_104502)[(int64_t) 30 * i_85847 +
                                                       i_85843 +
                                                       (squot64(i_114271,
                                                                (int64_t) 9) *
                                                        (int64_t) 900 +
                                                        squot64(i_114271 -
                                                                squot64(i_114271,
                                                                        (int64_t) 9) *
                                                                (int64_t) 9,
                                                                (int64_t) 3) *
                                                        (int64_t) 30 +
                                                        (i_114271 -
                                                         squot64(i_114271,
                                                                 (int64_t) 9) *
                                                         (int64_t) 9 -
                                                         squot64(i_114271 -
                                                                 squot64(i_114271,
                                                                         (int64_t) 9) *
                                                                 (int64_t) 9,
                                                                 (int64_t) 3) *
                                                         (int64_t) 3))];
                        
                        ((double *) mem_104670)[i_85847 * (int64_t) 64512 +
                                                i_85843 * (int64_t) 2304 +
                                                i_114271] = tmp_114272;
                    }
                }
            }
            for (int32_t i_86852 = 0; i_86852 < 128; i_86852++) {
                int64_t i_85857 = sext_i32_i64(i_86852);
                int64_t binop_x_88773 = (int64_t) 2304 * i_85857;
                
                for (int32_t i_87202 = 0; i_87202 < 784; i_87202++) {
                    int64_t i_85853 = sext_i32_i64(i_87202);
                    int64_t binop_x_88839 = (int64_t) 2304 * i_85853;
                    double defunc_2_reduce_res_84057;
                    double redout_85849 = 0.0;
                    
                    for (int32_t i_87203 = 0; i_87203 < 2304; i_87203++) {
                        int64_t i_85850 = sext_i32_i64(i_87203);
                        int64_t binop_x_88774 = i_85850 + binop_x_88773;
                        int64_t new_index_88775 = squot64(binop_x_88774,
                                                          (int64_t) 2304);
                        int64_t binop_y_88781 = (int64_t) 2304 *
                                new_index_88775;
                        int64_t binop_x_88782 = binop_x_88774 - binop_y_88781;
                        int64_t new_index_88783 = squot64(binop_x_88782,
                                                          (int64_t) 9);
                        int64_t binop_y_88799 = (int64_t) 9 * new_index_88783;
                        int64_t binop_x_88800 = binop_x_88782 - binop_y_88799;
                        int64_t new_index_88801 = squot64(binop_x_88800,
                                                          (int64_t) 3);
                        int64_t binop_y_88837 = (int64_t) 3 * new_index_88801;
                        int64_t new_index_88838 = binop_x_88800 - binop_y_88837;
                        int64_t binop_y_88867 = (int64_t) -1 * new_index_88801;
                        int64_t slice_88868 = (int64_t) 2 + binop_y_88867;
                        int64_t binop_y_88869 = (int64_t) -1 * new_index_88838;
                        int64_t slice_88870 = (int64_t) 2 + binop_y_88869;
                        double x_82394 =
                               ((double *) mem_param_96988.mem)[new_index_88783 *
                                                                (int64_t) 1152 +
                                                                new_index_88775 *
                                                                (int64_t) 9 +
                                                                slice_88868 *
                                                                (int64_t) 3 +
                                                                slice_88870];
                        int64_t binop_x_88840 = i_85850 + binop_x_88839;
                        int64_t new_index_88841 = squot64(binop_x_88840,
                                                          (int64_t) 64512);
                        int64_t binop_y_88847 = (int64_t) 64512 *
                                new_index_88841;
                        int64_t binop_x_88848 = binop_x_88840 - binop_y_88847;
                        int64_t new_index_88849 = squot64(binop_x_88848,
                                                          (int64_t) 2304);
                        int64_t binop_y_88865 = (int64_t) 2304 *
                                new_index_88849;
                        int64_t new_index_88866 = binop_x_88848 - binop_y_88865;
                        double x_82395 =
                               ((double *) mem_104670)[new_index_88841 *
                                                       (int64_t) 64512 +
                                                       new_index_88849 *
                                                       (int64_t) 2304 +
                                                       new_index_88866];
                        double defunc_1_f_res_82396 = x_82394 * x_82395;
                        double defunc_1_op_res_63028 = defunc_1_f_res_82396 +
                               redout_85849;
                        double redout_tmp_114275 = defunc_1_op_res_63028;
                        
                        redout_85849 = redout_tmp_114275;
                    }
                    defunc_2_reduce_res_84057 = redout_85849;
                    ((double *) mem_104722)[i_85857 * (int64_t) 784 + i_85853] =
                        defunc_2_reduce_res_84057;
                }
            }
            for (int32_t i_86853 = 0; i_86853 < 128; i_86853++) {
                int64_t i_85869 = sext_i32_i64(i_86853);
                int64_t slice_87201 = (int64_t) 128 + i_85869;
                int64_t binop_x_88741 = (int64_t) 784 * i_85869;
                int64_t binop_x_88757 = (int64_t) 784 * slice_87201;
                
                for (int32_t i_87199 = 0; i_87199 < 28; i_87199++) {
                    int64_t i_85865 = sext_i32_i64(i_87199);
                    int64_t binop_y_88742 = (int64_t) 28 * i_85865;
                    int64_t binop_x_88743 = binop_x_88741 + binop_y_88742;
                    int64_t binop_x_88759 = binop_y_88742 + binop_x_88757;
                    
                    for (int32_t i_87200 = 0; i_87200 < 28; i_87200++) {
                        int64_t i_85861 = sext_i32_i64(i_87200);
                        int64_t binop_x_88744 = i_85861 + binop_x_88743;
                        int64_t new_index_88745 = squot64(binop_x_88744,
                                                          (int64_t) 784);
                        int64_t binop_y_88755 = (int64_t) 784 * new_index_88745;
                        int64_t new_index_88756 = binop_x_88744 - binop_y_88755;
                        double x_54764 =
                               ((double *) mem_104722)[new_index_88745 *
                                                       (int64_t) 784 +
                                                       new_index_88756];
                        int64_t binop_x_88760 = i_85861 + binop_x_88759;
                        int64_t new_index_88761 = squot64(binop_x_88760,
                                                          (int64_t) 784);
                        int64_t binop_y_88771 = (int64_t) 784 * new_index_88761;
                        int64_t new_index_88772 = binop_x_88760 - binop_y_88771;
                        double x_54765 =
                               ((double *) mem_102686)[new_index_88761 *
                                                       (int64_t) 784 +
                                                       new_index_88772];
                        double defunc_1_f_res_54766 = x_54764 + x_54765;
                        
                        ((double *) mem_104762)[i_85869 * (int64_t) 784 +
                                                i_85865 * (int64_t) 28 +
                                                i_85861] = defunc_1_f_res_54766;
                    }
                }
            }
            for (int32_t i_86854 = 0; i_86854 < 32; i_86854++) {
                int64_t i_85875 = sext_i32_i64(i_86854);
                int64_t i_76838 = mul64((int64_t) 4, i_85875);
                int64_t x_76839 = add64((int64_t) 1, i_85875);
                int64_t j_76840 = mul64((int64_t) 4, x_76839);
                int64_t j_m_i_76841 = sub64(j_76840, i_76838);
                bool empty_slice_76842 = j_m_i_76841 == (int64_t) 0;
                int64_t m_76843 = sub64(j_m_i_76841, (int64_t) 1);
                int64_t i_p_m_t_s_76844 = add64(i_76838, m_76843);
                bool zzero_leq_i_p_m_t_s_76845 = sle64((int64_t) 0,
                                                       i_p_m_t_s_76844);
                bool i_p_m_t_s_leq_w_76846 = slt64(i_p_m_t_s_76844,
                                                   (int64_t) 128);
                bool zzero_lte_i_76847 = sle64((int64_t) 0, i_76838);
                bool i_lte_j_76848 = sle64(i_76838, j_76840);
                bool y_76849 = i_p_m_t_s_leq_w_76846 && zzero_lte_i_76847;
                bool y_76850 = zzero_leq_i_p_m_t_s_76845 && y_76849;
                bool y_76851 = i_lte_j_76848 && y_76850;
                bool forwards_ok_76852 = zzero_lte_i_76847 && y_76851;
                bool ok_or_empty_76853 = empty_slice_76842 || forwards_ok_76852;
                bool index_certs_76854;
                
                if (!ok_or_empty_76853) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Index [", (long long) i_76838, ":",
                                        (long long) j_76840,
                                        "] out of bounds for array of shape [",
                                        (long long) (int64_t) 128, "].",
                                        "-> #0  ../layers/groupnorm.fut:2:31-70\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  ../layers/groupnorm.fut:2:3-97\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool dim_match_76855 = (int64_t) 4 == j_m_i_76841;
                bool empty_or_match_cert_76856;
                
                if (!dim_match_76855) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Value of (core language) shape (",
                                        (long long) j_m_i_76841, ", ",
                                        (long long) (int64_t) 28, ", ",
                                        (long long) (int64_t) 28,
                                        ") cannot match shape of type `[",
                                        (long long) (int64_t) 4, "][",
                                        (long long) (int64_t) 28, "][",
                                        (long long) (int64_t) 28, "]f64`.",
                                        "-> #0  ../layers/groupnorm.fut:2:31-96\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  ../layers/groupnorm.fut:2:3-97\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if ((int64_t) 25088 > 0)
                    memmove(mem_104846 + i_85875 * (int64_t) 3136 * (int64_t) 8,
                            mem_104762 + (int64_t) 784 * i_76838 * (int64_t) 8,
                            (int64_t) 25088);
                if ((int64_t) 25088 > 0)
                    memmove(mem_104848 + i_85875 * (int64_t) 3136 * (int64_t) 8,
                            mem_98725 + (int64_t) 784 * i_76838 * (int64_t) 8,
                            (int64_t) 25088);
            }
            for (int32_t i_86855 = 0; i_86855 < 32; i_86855++) {
                int64_t i_85885 = sext_i32_i64(i_86855);
                int64_t binop_x_88609 = (int64_t) 3136 * i_85885;
                double defunc_2_reduce_res_84061;
                double defunc_2_reduce_res_84062;
                double redout_85878;
                double redout_85879;
                
                redout_85878 = 0.0;
                redout_85879 = 0.0;
                for (int32_t i_87196 = 0; i_87196 < 3136; i_87196++) {
                    int64_t i_85880 = sext_i32_i64(i_87196);
                    int64_t binop_x_88610 = i_85880 + binop_x_88609;
                    int64_t new_index_88611 = squot64(binop_x_88610,
                                                      (int64_t) 3136);
                    int64_t binop_y_88617 = (int64_t) 3136 * new_index_88611;
                    int64_t binop_x_88618 = binop_x_88610 - binop_y_88617;
                    int64_t new_index_88619 = squot64(binop_x_88618,
                                                      (int64_t) 784);
                    int64_t binop_y_88635 = (int64_t) 784 * new_index_88619;
                    int64_t binop_x_88636 = binop_x_88618 - binop_y_88635;
                    int64_t new_index_88637 = squot64(binop_x_88636,
                                                      (int64_t) 28);
                    int64_t binop_y_88673 = (int64_t) 28 * new_index_88637;
                    int64_t new_index_88674 = binop_x_88636 - binop_y_88673;
                    double x_82411 = ((double *) mem_104846)[new_index_88611 *
                                                             (int64_t) 3136 +
                                                             new_index_88619 *
                                                             (int64_t) 784 +
                                                             new_index_88637 *
                                                             (int64_t) 28 +
                                                             new_index_88674];
                    double x_82412 = ((double *) mem_104848)[new_index_88611 *
                                                             (int64_t) 3136 +
                                                             new_index_88619 *
                                                             (int64_t) 784 +
                                                             new_index_88637 *
                                                             (int64_t) 28 +
                                                             new_index_88674];
                    double defunc_1_f_res_82414 = x_82411 * x_82412;
                    double defunc_1_op_res_63158 = x_82411 + redout_85878;
                    double defunc_1_op_res_63167 = defunc_1_f_res_82414 +
                           redout_85879;
                    double redout_tmp_114283 = defunc_1_op_res_63158;
                    double redout_tmp_114284 = defunc_1_op_res_63167;
                    
                    redout_85878 = redout_tmp_114283;
                    redout_85879 = redout_tmp_114284;
                }
                defunc_2_reduce_res_84061 = redout_85878;
                defunc_2_reduce_res_84062 = redout_85879;
                ((double *) mem_104906)[i_85885] = defunc_2_reduce_res_84061;
                ((double *) mem_104908)[i_85885] = defunc_2_reduce_res_84062;
            }
            for (int32_t i_86856 = 0; i_86856 < 32; i_86856++) {
                int64_t i_85902 = sext_i32_i64(i_86856);
                bool x_63175 = sle64((int64_t) 0, i_85902);
                bool y_63176 = slt64(i_85902, (int64_t) 32);
                bool bounds_check_63177 = x_63175 && y_63176;
                bool index_certs_63178;
                
                if (!bounds_check_63177) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Index [", (long long) i_85902,
                                        "] out of bounds for array of shape [",
                                        (long long) (int64_t) 32, "].",
                                        "-> #0  ../layers/groupnorm.fut:36:43-66\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                double defunc_0_f_res_63179 = ((double *) mem_104906)[i_85902];
                double defunc_0_f_res_63180 = ((double *) mem_104908)[i_85902];
                bool index_certs_63183;
                
                if (!bounds_check_63177) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Index [", (long long) i_85902,
                                        "] out of bounds for array of shape [",
                                        (long long) (int64_t) 32, "].",
                                        "-> #0  ../layers/groupnorm.fut:40:18-23\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  /prelude/functional.fut:39:59-65\n   #7  /prelude/soacs.fut:59:3-10\n   #8  /prelude/array.fut:216:3-39\n   #9  ../layers/groupnorm.fut:37:10-40:31\n   #10 /prelude/soacs.fut:59:3-10\n   #11 /prelude/array.fut:200:3-17\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                double x_63184 = ((double *) mem_98701)[i_85902];
                double sqrt_arg_63185 = 1.0e-5 + x_63184;
                double sqrt_res_63186 = futrts_sqrt64(sqrt_arg_63185);
                
                for (int32_t i_87185 = 0; i_87185 < 4; i_87185++) {
                    int64_t i_85898 = sext_i32_i64(i_87185);
                    bool x_63189 = sle64((int64_t) 0, i_85898);
                    bool y_63190 = slt64(i_85898, (int64_t) 4);
                    bool bounds_check_63191 = x_63189 && y_63190;
                    
                    for (int32_t i_87186 = 0; i_87186 < 28; i_87186++) {
                        int64_t i_85894 = sext_i32_i64(i_87186);
                        bool x_63194 = sle64((int64_t) 0, i_85894);
                        bool y_63195 = slt64(i_85894, (int64_t) 28);
                        bool bounds_check_63196 = x_63194 && y_63195;
                        
                        for (int32_t i_87187 = 0; i_87187 < 28; i_87187++) {
                            int64_t i_85890 = sext_i32_i64(i_87187);
                            bool x_63201 = sle64((int64_t) 0, i_85890);
                            bool y_63202 = slt64(i_85890, (int64_t) 28);
                            bool bounds_check_63203 = x_63201 && y_63202;
                            bool y_63204 = bounds_check_63177 &&
                                 bounds_check_63203;
                            bool y_63205 = bounds_check_63196 && y_63204;
                            bool index_ok_63206 = bounds_check_63191 && y_63205;
                            bool index_certs_63207;
                            
                            if (!index_ok_63206) {
                                set_error(ctx,
                                          msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                    "Index [",
                                                    (long long) i_85902, ", ",
                                                    (long long) i_85898, ", ",
                                                    (long long) i_85894, ", ",
                                                    (long long) i_85890,
                                                    "] out of bounds for array of shape [",
                                                    (long long) (int64_t) 32,
                                                    "][",
                                                    (long long) (int64_t) 4,
                                                    "][",
                                                    (long long) (int64_t) 28,
                                                    "][",
                                                    (long long) (int64_t) 28,
                                                    "].",
                                                    "-> #0  ../layers/groupnorm.fut:39:30-48\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  /prelude/functional.fut:39:59-65\n   #7  /prelude/soacs.fut:59:3-10\n   #8  /prelude/array.fut:216:3-39\n   #9  ../layers/groupnorm.fut:37:10-40:31\n   #10 /prelude/soacs.fut:59:3-10\n   #11 /prelude/array.fut:200:3-17\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            double y_63208 = ((double *) mem_104846)[i_85902 *
                                                                     (int64_t) 3136 +
                                                                     i_85898 *
                                                                     (int64_t) 784 +
                                                                     i_85894 *
                                                                     (int64_t) 28 +
                                                                     i_85890];
                            double x_63209 = 3136.0 * y_63208;
                            double x_63210 = x_63209 - defunc_0_f_res_63179;
                            double x_63217 = ((double *) mem_104848)[i_85902 *
                                                                     (int64_t) 3136 +
                                                                     i_85898 *
                                                                     (int64_t) 784 +
                                                                     i_85894 *
                                                                     (int64_t) 28 +
                                                                     i_85890];
                            double y_63218 = defunc_0_f_res_63180 * x_63217;
                            double y_63219 = x_63210 - y_63218;
                            double x_63220 = 3.1887755102040814e-4 * y_63219;
                            double defunc_0_f_res_63221 = x_63220 /
                                   sqrt_res_63186;
                            
                            ((double *) mem_104930)[i_85902 * (int64_t) 3136 +
                                                    i_85898 * (int64_t) 784 +
                                                    i_85894 * (int64_t) 28 +
                                                    i_85890] =
                                defunc_0_f_res_63221;
                        }
                    }
                }
            }
            for (int32_t i_86857 = 0; i_86857 < 128; i_86857++) {
                int64_t i_85924 = sext_i32_i64(i_86857);
                int64_t binop_x_88497 = (int64_t) 784 * i_85924;
                
                for (int32_t i_87177 = 0; i_87177 < 28; i_87177++) {
                    int64_t i_85910 = sext_i32_i64(i_87177);
                    int64_t binop_y_88498 = (int64_t) 28 * i_85910;
                    int64_t binop_x_88499 = binop_x_88497 + binop_y_88498;
                    
                    for (int32_t i_87184 = 0; i_87184 < 28; i_87184++) {
                        int64_t i_85906 = sext_i32_i64(i_87184);
                        int64_t binop_x_88500 = i_85906 + binop_x_88499;
                        int64_t new_index_88501 = squot64(binop_x_88500,
                                                          (int64_t) 3136);
                        int64_t binop_y_88511 = (int64_t) 3136 *
                                new_index_88501;
                        int64_t binop_x_88512 = binop_x_88500 - binop_y_88511;
                        int64_t new_index_88513 = squot64(binop_x_88512,
                                                          (int64_t) 784);
                        int64_t binop_y_88537 = (int64_t) 784 * new_index_88513;
                        int64_t binop_x_88538 = binop_x_88512 - binop_y_88537;
                        int64_t new_index_88539 = squot64(binop_x_88538,
                                                          (int64_t) 28);
                        int64_t binop_y_88591 = (int64_t) 28 * new_index_88539;
                        int64_t new_index_88592 = binop_x_88538 - binop_y_88591;
                        double x_72447 =
                               ((double *) mem_104930)[new_index_88501 *
                                                       (int64_t) 3136 +
                                                       new_index_88513 *
                                                       (int64_t) 784 +
                                                       new_index_88539 *
                                                       (int64_t) 28 +
                                                       new_index_88592];
                        int64_t new_index_88597 = squot64(binop_x_88500,
                                                          (int64_t) 784);
                        int64_t binop_y_88607 = (int64_t) 784 * new_index_88597;
                        int64_t new_index_88608 = binop_x_88500 - binop_y_88607;
                        double x_72448 =
                               ((double *) mem_98545)[new_index_88597 *
                                                      (int64_t) 784 +
                                                      new_index_88608];
                        bool cond_72449 = 0.0 < x_72448;
                        double defunc_1_f_res_72450;
                        
                        if (cond_72449 == 1) {
                            defunc_1_f_res_72450 = x_72447;
                        } else {
                            defunc_1_f_res_72450 = 0.0;
                        }
                        ((double *) mem_105076)[i_85924 * (int64_t) 784 +
                                                i_85910 * (int64_t) 28 +
                                                i_85906] = defunc_1_f_res_72450;
                    }
                }
                for (int32_t i_87178 = 0; i_87178 < 30; i_87178++) {
                    int64_t i_85918 = sext_i32_i64(i_87178);
                    bool cond_72454 = slt64(i_85918, (int64_t) 1);
                    bool cond_f_res_72455 = sle64((int64_t) 29, i_85918);
                    bool x_72456 = !cond_72454;
                    bool y_72457 = cond_f_res_72455 && x_72456;
                    bool cond_72458 = cond_72454 || y_72457;
                    bool x_72459 = !cond_72458;
                    
                    for (int32_t i_87179 = 0; i_87179 < 30; i_87179++) {
                        int64_t i_85914 = sext_i32_i64(i_87179);
                        bool cond_f_res_72462 = slt64(i_85914, (int64_t) 1);
                        bool y_72463 = x_72459 && cond_f_res_72462;
                        bool cond_72464 = cond_72458 || y_72463;
                        bool cond_f_res_72465 = sle64((int64_t) 29, i_85914);
                        bool x_72466 = !cond_72464;
                        bool y_72467 = cond_f_res_72465 && x_72466;
                        bool cond_72468 = cond_72464 || y_72467;
                        double defunc_0_f_res_72469;
                        
                        if (cond_72468 == 1) {
                            defunc_0_f_res_72469 = 0.0;
                        } else {
                            int64_t i_72470 = sub64(i_85918, (int64_t) 1);
                            bool x_72471 = sle64((int64_t) 0, i_72470);
                            bool y_72472 = slt64(i_72470, (int64_t) 28);
                            bool bounds_check_72473 = x_72471 && y_72472;
                            int64_t i_72474 = sub64(i_85914, (int64_t) 1);
                            bool x_72475 = sle64((int64_t) 0, i_72474);
                            bool y_72476 = slt64(i_72474, (int64_t) 28);
                            bool bounds_check_72477 = x_72475 && y_72476;
                            bool index_ok_72478 = bounds_check_72473 &&
                                 bounds_check_72477;
                            bool index_certs_72479;
                            
                            if (!index_ok_72478) {
                                set_error(ctx,
                                          msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                    "Index [",
                                                    (long long) i_72470, ", ",
                                                    (long long) i_72474,
                                                    "] out of bounds for array of shape [",
                                                    (long long) (int64_t) 28,
                                                    "][",
                                                    (long long) (int64_t) 28,
                                                    "].",
                                                    "-> #0  ../layers/conv2d.fut:7:91-116\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  ../layers/conv2d.fut:6:22-7:117\n   #7  ../layers/conv2d.fut:6:6-7:123\n   #8  ../layers/conv2d.fut:22:7-30\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            double defunc_0_f_res_f_res_72480 =
                                   ((double *) mem_105076)[i_85924 *
                                                           (int64_t) 784 +
                                                           i_72470 *
                                                           (int64_t) 28 +
                                                           i_72474];
                            
                            defunc_0_f_res_72469 = defunc_0_f_res_f_res_72480;
                        }
                        ((double *) mem_105074)[i_85924 * (int64_t) 900 +
                                                i_85918 * (int64_t) 30 +
                                                i_85914] = defunc_0_f_res_72469;
                    }
                }
            }
            for (int32_t i_86858 = 0; i_86858 < 28; i_86858++) {
                int64_t i_85933 = sext_i32_i64(i_86858);
                int64_t j_63479 = add64((int64_t) 3, i_85933);
                int64_t i_p_m_t_s_63480 = add64((int64_t) 2, i_85933);
                bool zzero_leq_i_p_m_t_s_63481 = sle64((int64_t) 0,
                                                       i_p_m_t_s_63480);
                bool i_p_m_t_s_leq_w_63482 = slt64(i_p_m_t_s_63480,
                                                   (int64_t) 30);
                bool zzero_lte_i_63483 = sle64((int64_t) 0, i_85933);
                bool i_lte_j_63484 = sle64(i_85933, j_63479);
                bool y_63485 = i_p_m_t_s_leq_w_63482 && zzero_lte_i_63483;
                bool y_63486 = zzero_leq_i_p_m_t_s_63481 && y_63485;
                bool y_63487 = i_lte_j_63484 && y_63486;
                bool forwards_ok_63488 = zzero_lte_i_63483 && y_63487;
                
                for (int32_t i_87172 = 0; i_87172 < 28; i_87172++) {
                    int64_t i_85929 = sext_i32_i64(i_87172);
                    int64_t j_63492 = add64((int64_t) 3, i_85929);
                    int64_t i_p_m_t_s_63493 = add64((int64_t) 2, i_85929);
                    bool zzero_leq_i_p_m_t_s_63494 = sle64((int64_t) 0,
                                                           i_p_m_t_s_63493);
                    bool i_p_m_t_s_leq_w_63495 = slt64(i_p_m_t_s_63493,
                                                       (int64_t) 30);
                    bool zzero_lte_i_63496 = sle64((int64_t) 0, i_85929);
                    bool i_lte_j_63497 = sle64(i_85929, j_63492);
                    bool y_63498 = i_p_m_t_s_leq_w_63495 && zzero_lte_i_63496;
                    bool y_63499 = zzero_leq_i_p_m_t_s_63494 && y_63498;
                    bool y_63500 = i_lte_j_63497 && y_63499;
                    bool forwards_ok_63501 = zzero_lte_i_63496 && y_63500;
                    bool index_ok_63503 = forwards_ok_63488 &&
                         forwards_ok_63501;
                    bool index_certs_63504;
                    
                    if (!index_ok_63503) {
                        set_error(ctx,
                                  msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                            "Index [", (long long) i_85933, ":",
                                            (long long) j_63479, ", ",
                                            (long long) i_85929, ":",
                                            (long long) j_63492,
                                            "] out of bounds for array of shape [",
                                            (long long) (int64_t) 30, "][",
                                            (long long) (int64_t) 30, "].",
                                            "-> #0  ../layers/conv2d.fut:13:90-124\n   #1  ../layers/conv2d.fut:13:69-146\n   #2  /prelude/soacs.fut:59:3-10\n   #3  /prelude/array.fut:200:3-17\n   #4  /prelude/functional.fut:39:59-65\n   #5  /prelude/soacs.fut:59:3-10\n   #6  /prelude/array.fut:208:3-34\n   #7  ../layers/conv2d.fut:13:26-162\n   #8  ../layers/conv2d.fut:26:17-54\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    for (int64_t i_114297 = 0; i_114297 < (int64_t) 1152;
                         i_114297++) {
                        double tmp_114298 =
                               ((double *) mem_105074)[(int64_t) 30 * i_85933 +
                                                       i_85929 +
                                                       (squot64(i_114297,
                                                                (int64_t) 9) *
                                                        (int64_t) 900 +
                                                        squot64(i_114297 -
                                                                squot64(i_114297,
                                                                        (int64_t) 9) *
                                                                (int64_t) 9,
                                                                (int64_t) 3) *
                                                        (int64_t) 30 +
                                                        (i_114297 -
                                                         squot64(i_114297,
                                                                 (int64_t) 9) *
                                                         (int64_t) 9 -
                                                         squot64(i_114297 -
                                                                 squot64(i_114297,
                                                                         (int64_t) 9) *
                                                                 (int64_t) 9,
                                                                 (int64_t) 3) *
                                                         (int64_t) 3))];
                        
                        ((double *) mem_105242)[i_85933 * (int64_t) 32256 +
                                                i_85929 * (int64_t) 1152 +
                                                i_114297] = tmp_114298;
                    }
                }
            }
            for (int32_t i_86859 = 0; i_86859 < 128; i_86859++) {
                int64_t i_85943 = sext_i32_i64(i_86859);
                int64_t binop_x_88399 = (int64_t) 1152 * i_85943;
                
                for (int32_t i_87170 = 0; i_87170 < 784; i_87170++) {
                    int64_t i_85939 = sext_i32_i64(i_87170);
                    int64_t binop_x_88465 = (int64_t) 1152 * i_85939;
                    double defunc_2_reduce_res_84071;
                    double redout_85935 = 0.0;
                    
                    for (int32_t i_87171 = 0; i_87171 < 1152; i_87171++) {
                        int64_t i_85936 = sext_i32_i64(i_87171);
                        int64_t binop_x_88400 = i_85936 + binop_x_88399;
                        int64_t new_index_88401 = squot64(binop_x_88400,
                                                          (int64_t) 1152);
                        int64_t binop_y_88407 = (int64_t) 1152 *
                                new_index_88401;
                        int64_t binop_x_88408 = binop_x_88400 - binop_y_88407;
                        int64_t new_index_88409 = squot64(binop_x_88408,
                                                          (int64_t) 9);
                        int64_t binop_y_88425 = (int64_t) 9 * new_index_88409;
                        int64_t binop_x_88426 = binop_x_88408 - binop_y_88425;
                        int64_t new_index_88427 = squot64(binop_x_88426,
                                                          (int64_t) 3);
                        int64_t binop_y_88463 = (int64_t) 3 * new_index_88427;
                        int64_t new_index_88464 = binop_x_88426 - binop_y_88463;
                        int64_t binop_y_88493 = (int64_t) -1 * new_index_88427;
                        int64_t slice_88494 = (int64_t) 2 + binop_y_88493;
                        int64_t binop_y_88495 = (int64_t) -1 * new_index_88464;
                        int64_t slice_88496 = (int64_t) 2 + binop_y_88495;
                        double x_82426 =
                               ((double *) mem_param_96969.mem)[new_index_88409 *
                                                                (int64_t) 1152 +
                                                                new_index_88401 *
                                                                (int64_t) 9 +
                                                                slice_88494 *
                                                                (int64_t) 3 +
                                                                slice_88496];
                        int64_t binop_x_88466 = i_85936 + binop_x_88465;
                        int64_t new_index_88467 = squot64(binop_x_88466,
                                                          (int64_t) 32256);
                        int64_t binop_y_88473 = (int64_t) 32256 *
                                new_index_88467;
                        int64_t binop_x_88474 = binop_x_88466 - binop_y_88473;
                        int64_t new_index_88475 = squot64(binop_x_88474,
                                                          (int64_t) 1152);
                        int64_t binop_y_88491 = (int64_t) 1152 *
                                new_index_88475;
                        int64_t new_index_88492 = binop_x_88474 - binop_y_88491;
                        double x_82427 =
                               ((double *) mem_105242)[new_index_88467 *
                                                       (int64_t) 32256 +
                                                       new_index_88475 *
                                                       (int64_t) 1152 +
                                                       new_index_88492];
                        double defunc_1_f_res_82428 = x_82426 * x_82427;
                        double defunc_1_op_res_63523 = defunc_1_f_res_82428 +
                               redout_85935;
                        double redout_tmp_114301 = defunc_1_op_res_63523;
                        
                        redout_85935 = redout_tmp_114301;
                    }
                    defunc_2_reduce_res_84071 = redout_85935;
                    ((double *) mem_105294)[i_85943 * (int64_t) 784 + i_85939] =
                        defunc_2_reduce_res_84071;
                }
            }
            for (int32_t i_86860 = 0; i_86860 < 32; i_86860++) {
                int64_t i_85949 = sext_i32_i64(i_86860);
                int64_t i_76794 = mul64((int64_t) 4, i_85949);
                int64_t x_76795 = add64((int64_t) 1, i_85949);
                int64_t j_76796 = mul64((int64_t) 4, x_76795);
                int64_t j_m_i_76797 = sub64(j_76796, i_76794);
                bool empty_slice_76798 = j_m_i_76797 == (int64_t) 0;
                int64_t m_76799 = sub64(j_m_i_76797, (int64_t) 1);
                int64_t i_p_m_t_s_76800 = add64(i_76794, m_76799);
                bool zzero_leq_i_p_m_t_s_76801 = sle64((int64_t) 0,
                                                       i_p_m_t_s_76800);
                bool i_p_m_t_s_leq_w_76802 = slt64(i_p_m_t_s_76800,
                                                   (int64_t) 128);
                bool zzero_lte_i_76803 = sle64((int64_t) 0, i_76794);
                bool i_lte_j_76804 = sle64(i_76794, j_76796);
                bool y_76805 = i_p_m_t_s_leq_w_76802 && zzero_lte_i_76803;
                bool y_76806 = zzero_leq_i_p_m_t_s_76801 && y_76805;
                bool y_76807 = i_lte_j_76804 && y_76806;
                bool forwards_ok_76808 = zzero_lte_i_76803 && y_76807;
                bool ok_or_empty_76809 = empty_slice_76798 || forwards_ok_76808;
                bool index_certs_76810;
                
                if (!ok_or_empty_76809) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Index [", (long long) i_76794, ":",
                                        (long long) j_76796,
                                        "] out of bounds for array of shape [",
                                        (long long) (int64_t) 128, "].",
                                        "-> #0  ../layers/groupnorm.fut:2:31-70\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  ../layers/groupnorm.fut:2:3-97\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool dim_match_76811 = (int64_t) 4 == j_m_i_76797;
                bool empty_or_match_cert_76812;
                
                if (!dim_match_76811) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Value of (core language) shape (",
                                        (long long) j_m_i_76797, ", ",
                                        (long long) (int64_t) 28, ", ",
                                        (long long) (int64_t) 28,
                                        ") cannot match shape of type `[",
                                        (long long) (int64_t) 4, "][",
                                        (long long) (int64_t) 28, "][",
                                        (long long) (int64_t) 28, "]f64`.",
                                        "-> #0  ../layers/groupnorm.fut:2:31-96\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  ../layers/groupnorm.fut:2:3-97\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if ((int64_t) 25088 > 0)
                    memmove(mem_105334 + i_85949 * (int64_t) 3136 * (int64_t) 8,
                            mem_105294 + (int64_t) 784 * i_76794 * (int64_t) 8,
                            (int64_t) 25088);
                if ((int64_t) 25088 > 0)
                    memmove(mem_105336 + i_85949 * (int64_t) 3136 * (int64_t) 8,
                            mem_98235 + (int64_t) 784 * i_76794 * (int64_t) 8,
                            (int64_t) 25088);
            }
            for (int32_t i_86861 = 0; i_86861 < 32; i_86861++) {
                int64_t i_85959 = sext_i32_i64(i_86861);
                int64_t binop_x_88267 = (int64_t) 3136 * i_85959;
                double defunc_2_reduce_res_84073;
                double defunc_2_reduce_res_84074;
                double redout_85952;
                double redout_85953;
                
                redout_85952 = 0.0;
                redout_85953 = 0.0;
                for (int32_t i_87167 = 0; i_87167 < 3136; i_87167++) {
                    int64_t i_85954 = sext_i32_i64(i_87167);
                    int64_t binop_x_88268 = i_85954 + binop_x_88267;
                    int64_t new_index_88269 = squot64(binop_x_88268,
                                                      (int64_t) 3136);
                    int64_t binop_y_88275 = (int64_t) 3136 * new_index_88269;
                    int64_t binop_x_88276 = binop_x_88268 - binop_y_88275;
                    int64_t new_index_88277 = squot64(binop_x_88276,
                                                      (int64_t) 784);
                    int64_t binop_y_88293 = (int64_t) 784 * new_index_88277;
                    int64_t binop_x_88294 = binop_x_88276 - binop_y_88293;
                    int64_t new_index_88295 = squot64(binop_x_88294,
                                                      (int64_t) 28);
                    int64_t binop_y_88331 = (int64_t) 28 * new_index_88295;
                    int64_t new_index_88332 = binop_x_88294 - binop_y_88331;
                    double x_82441 = ((double *) mem_105334)[new_index_88269 *
                                                             (int64_t) 3136 +
                                                             new_index_88277 *
                                                             (int64_t) 784 +
                                                             new_index_88295 *
                                                             (int64_t) 28 +
                                                             new_index_88332];
                    double x_82442 = ((double *) mem_105336)[new_index_88269 *
                                                             (int64_t) 3136 +
                                                             new_index_88277 *
                                                             (int64_t) 784 +
                                                             new_index_88295 *
                                                             (int64_t) 28 +
                                                             new_index_88332];
                    double defunc_1_f_res_82444 = x_82441 * x_82442;
                    double defunc_1_op_res_63604 = x_82441 + redout_85952;
                    double defunc_1_op_res_63613 = defunc_1_f_res_82444 +
                           redout_85953;
                    double redout_tmp_114306 = defunc_1_op_res_63604;
                    double redout_tmp_114307 = defunc_1_op_res_63613;
                    
                    redout_85952 = redout_tmp_114306;
                    redout_85953 = redout_tmp_114307;
                }
                defunc_2_reduce_res_84073 = redout_85952;
                defunc_2_reduce_res_84074 = redout_85953;
                ((double *) mem_105394)[i_85959] = defunc_2_reduce_res_84073;
                ((double *) mem_105396)[i_85959] = defunc_2_reduce_res_84074;
            }
            for (int32_t i_86862 = 0; i_86862 < 32; i_86862++) {
                int64_t i_85976 = sext_i32_i64(i_86862);
                bool x_63621 = sle64((int64_t) 0, i_85976);
                bool y_63622 = slt64(i_85976, (int64_t) 32);
                bool bounds_check_63623 = x_63621 && y_63622;
                bool index_certs_63624;
                
                if (!bounds_check_63623) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Index [", (long long) i_85976,
                                        "] out of bounds for array of shape [",
                                        (long long) (int64_t) 32, "].",
                                        "-> #0  ../layers/groupnorm.fut:36:43-66\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                double defunc_0_f_res_63625 = ((double *) mem_105394)[i_85976];
                double defunc_0_f_res_63626 = ((double *) mem_105396)[i_85976];
                bool index_certs_63629;
                
                if (!bounds_check_63623) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Index [", (long long) i_85976,
                                        "] out of bounds for array of shape [",
                                        (long long) (int64_t) 32, "].",
                                        "-> #0  ../layers/groupnorm.fut:40:18-23\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  /prelude/functional.fut:39:59-65\n   #7  /prelude/soacs.fut:59:3-10\n   #8  /prelude/array.fut:216:3-39\n   #9  ../layers/groupnorm.fut:37:10-40:31\n   #10 /prelude/soacs.fut:59:3-10\n   #11 /prelude/array.fut:200:3-17\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                double x_63630 = ((double *) mem_98207)[i_85976];
                double sqrt_arg_63631 = 1.0e-5 + x_63630;
                double sqrt_res_63632 = futrts_sqrt64(sqrt_arg_63631);
                
                for (int32_t i_87156 = 0; i_87156 < 4; i_87156++) {
                    int64_t i_85972 = sext_i32_i64(i_87156);
                    bool x_63635 = sle64((int64_t) 0, i_85972);
                    bool y_63636 = slt64(i_85972, (int64_t) 4);
                    bool bounds_check_63637 = x_63635 && y_63636;
                    
                    for (int32_t i_87157 = 0; i_87157 < 28; i_87157++) {
                        int64_t i_85968 = sext_i32_i64(i_87157);
                        bool x_63640 = sle64((int64_t) 0, i_85968);
                        bool y_63641 = slt64(i_85968, (int64_t) 28);
                        bool bounds_check_63642 = x_63640 && y_63641;
                        
                        for (int32_t i_87158 = 0; i_87158 < 28; i_87158++) {
                            int64_t i_85964 = sext_i32_i64(i_87158);
                            bool x_63647 = sle64((int64_t) 0, i_85964);
                            bool y_63648 = slt64(i_85964, (int64_t) 28);
                            bool bounds_check_63649 = x_63647 && y_63648;
                            bool y_63650 = bounds_check_63623 &&
                                 bounds_check_63649;
                            bool y_63651 = bounds_check_63642 && y_63650;
                            bool index_ok_63652 = bounds_check_63637 && y_63651;
                            bool index_certs_63653;
                            
                            if (!index_ok_63652) {
                                set_error(ctx,
                                          msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                    "Index [",
                                                    (long long) i_85976, ", ",
                                                    (long long) i_85972, ", ",
                                                    (long long) i_85968, ", ",
                                                    (long long) i_85964,
                                                    "] out of bounds for array of shape [",
                                                    (long long) (int64_t) 32,
                                                    "][",
                                                    (long long) (int64_t) 4,
                                                    "][",
                                                    (long long) (int64_t) 28,
                                                    "][",
                                                    (long long) (int64_t) 28,
                                                    "].",
                                                    "-> #0  ../layers/groupnorm.fut:39:30-48\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  /prelude/functional.fut:39:59-65\n   #7  /prelude/soacs.fut:59:3-10\n   #8  /prelude/array.fut:216:3-39\n   #9  ../layers/groupnorm.fut:37:10-40:31\n   #10 /prelude/soacs.fut:59:3-10\n   #11 /prelude/array.fut:200:3-17\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            double y_63654 = ((double *) mem_105334)[i_85976 *
                                                                     (int64_t) 3136 +
                                                                     i_85972 *
                                                                     (int64_t) 784 +
                                                                     i_85968 *
                                                                     (int64_t) 28 +
                                                                     i_85964];
                            double x_63655 = 3136.0 * y_63654;
                            double x_63656 = x_63655 - defunc_0_f_res_63625;
                            double x_63663 = ((double *) mem_105336)[i_85976 *
                                                                     (int64_t) 3136 +
                                                                     i_85972 *
                                                                     (int64_t) 784 +
                                                                     i_85968 *
                                                                     (int64_t) 28 +
                                                                     i_85964];
                            double y_63664 = defunc_0_f_res_63626 * x_63663;
                            double y_63665 = x_63656 - y_63664;
                            double x_63666 = 3.1887755102040814e-4 * y_63665;
                            double defunc_0_f_res_63667 = x_63666 /
                                   sqrt_res_63632;
                            
                            ((double *) mem_105418)[i_85976 * (int64_t) 3136 +
                                                    i_85972 * (int64_t) 784 +
                                                    i_85968 * (int64_t) 28 +
                                                    i_85964] =
                                defunc_0_f_res_63667;
                        }
                    }
                }
            }
            for (int32_t i_86863 = 0; i_86863 < 128; i_86863++) {
                int64_t i_85998 = sext_i32_i64(i_86863);
                int64_t binop_x_88155 = (int64_t) 784 * i_85998;
                
                for (int32_t i_87148 = 0; i_87148 < 28; i_87148++) {
                    int64_t i_85984 = sext_i32_i64(i_87148);
                    int64_t binop_y_88156 = (int64_t) 28 * i_85984;
                    int64_t binop_x_88157 = binop_x_88155 + binop_y_88156;
                    
                    for (int32_t i_87155 = 0; i_87155 < 28; i_87155++) {
                        int64_t i_85980 = sext_i32_i64(i_87155);
                        int64_t binop_x_88158 = i_85980 + binop_x_88157;
                        int64_t new_index_88159 = squot64(binop_x_88158,
                                                          (int64_t) 3136);
                        int64_t binop_y_88169 = (int64_t) 3136 *
                                new_index_88159;
                        int64_t binop_x_88170 = binop_x_88158 - binop_y_88169;
                        int64_t new_index_88171 = squot64(binop_x_88170,
                                                          (int64_t) 784);
                        int64_t binop_y_88195 = (int64_t) 784 * new_index_88171;
                        int64_t binop_x_88196 = binop_x_88170 - binop_y_88195;
                        int64_t new_index_88197 = squot64(binop_x_88196,
                                                          (int64_t) 28);
                        int64_t binop_y_88249 = (int64_t) 28 * new_index_88197;
                        int64_t new_index_88250 = binop_x_88196 - binop_y_88249;
                        double x_72256 =
                               ((double *) mem_105418)[new_index_88159 *
                                                       (int64_t) 3136 +
                                                       new_index_88171 *
                                                       (int64_t) 784 +
                                                       new_index_88197 *
                                                       (int64_t) 28 +
                                                       new_index_88250];
                        int64_t new_index_88255 = squot64(binop_x_88158,
                                                          (int64_t) 784);
                        int64_t binop_y_88265 = (int64_t) 784 * new_index_88255;
                        int64_t new_index_88266 = binop_x_88158 - binop_y_88265;
                        double x_72257 =
                               ((double *) mem_98051)[new_index_88255 *
                                                      (int64_t) 784 +
                                                      new_index_88266];
                        bool cond_72258 = 0.0 < x_72257;
                        double defunc_1_f_res_72259;
                        
                        if (cond_72258 == 1) {
                            defunc_1_f_res_72259 = x_72256;
                        } else {
                            defunc_1_f_res_72259 = 0.0;
                        }
                        ((double *) mem_105564)[i_85998 * (int64_t) 784 +
                                                i_85984 * (int64_t) 28 +
                                                i_85980] = defunc_1_f_res_72259;
                    }
                }
                for (int32_t i_87149 = 0; i_87149 < 30; i_87149++) {
                    int64_t i_85992 = sext_i32_i64(i_87149);
                    bool cond_72263 = slt64(i_85992, (int64_t) 1);
                    bool cond_f_res_72264 = sle64((int64_t) 29, i_85992);
                    bool x_72265 = !cond_72263;
                    bool y_72266 = cond_f_res_72264 && x_72265;
                    bool cond_72267 = cond_72263 || y_72266;
                    bool x_72268 = !cond_72267;
                    
                    for (int32_t i_87150 = 0; i_87150 < 30; i_87150++) {
                        int64_t i_85988 = sext_i32_i64(i_87150);
                        bool cond_f_res_72271 = slt64(i_85988, (int64_t) 1);
                        bool y_72272 = x_72268 && cond_f_res_72271;
                        bool cond_72273 = cond_72267 || y_72272;
                        bool cond_f_res_72274 = sle64((int64_t) 29, i_85988);
                        bool x_72275 = !cond_72273;
                        bool y_72276 = cond_f_res_72274 && x_72275;
                        bool cond_72277 = cond_72273 || y_72276;
                        double defunc_0_f_res_72278;
                        
                        if (cond_72277 == 1) {
                            defunc_0_f_res_72278 = 0.0;
                        } else {
                            int64_t i_72279 = sub64(i_85992, (int64_t) 1);
                            bool x_72280 = sle64((int64_t) 0, i_72279);
                            bool y_72281 = slt64(i_72279, (int64_t) 28);
                            bool bounds_check_72282 = x_72280 && y_72281;
                            int64_t i_72283 = sub64(i_85988, (int64_t) 1);
                            bool x_72284 = sle64((int64_t) 0, i_72283);
                            bool y_72285 = slt64(i_72283, (int64_t) 28);
                            bool bounds_check_72286 = x_72284 && y_72285;
                            bool index_ok_72287 = bounds_check_72282 &&
                                 bounds_check_72286;
                            bool index_certs_72288;
                            
                            if (!index_ok_72287) {
                                set_error(ctx,
                                          msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                    "Index [",
                                                    (long long) i_72279, ", ",
                                                    (long long) i_72283,
                                                    "] out of bounds for array of shape [",
                                                    (long long) (int64_t) 28,
                                                    "][",
                                                    (long long) (int64_t) 28,
                                                    "].",
                                                    "-> #0  ../layers/conv2d.fut:7:91-116\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  ../layers/conv2d.fut:6:22-7:117\n   #7  ../layers/conv2d.fut:6:6-7:123\n   #8  ../layers/conv2d.fut:22:7-30\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            double defunc_0_f_res_f_res_72289 =
                                   ((double *) mem_105564)[i_85998 *
                                                           (int64_t) 784 +
                                                           i_72279 *
                                                           (int64_t) 28 +
                                                           i_72283];
                            
                            defunc_0_f_res_72278 = defunc_0_f_res_f_res_72289;
                        }
                        ((double *) mem_105562)[i_85998 * (int64_t) 900 +
                                                i_85992 * (int64_t) 30 +
                                                i_85988] = defunc_0_f_res_72278;
                    }
                }
            }
            for (int32_t i_86864 = 0; i_86864 < 28; i_86864++) {
                int64_t i_86007 = sext_i32_i64(i_86864);
                int64_t j_63951 = add64((int64_t) 3, i_86007);
                int64_t i_p_m_t_s_63952 = add64((int64_t) 2, i_86007);
                bool zzero_leq_i_p_m_t_s_63953 = sle64((int64_t) 0,
                                                       i_p_m_t_s_63952);
                bool i_p_m_t_s_leq_w_63954 = slt64(i_p_m_t_s_63952,
                                                   (int64_t) 30);
                bool zzero_lte_i_63955 = sle64((int64_t) 0, i_86007);
                bool i_lte_j_63956 = sle64(i_86007, j_63951);
                bool y_63957 = i_p_m_t_s_leq_w_63954 && zzero_lte_i_63955;
                bool y_63958 = zzero_leq_i_p_m_t_s_63953 && y_63957;
                bool y_63959 = i_lte_j_63956 && y_63958;
                bool forwards_ok_63960 = zzero_lte_i_63955 && y_63959;
                
                for (int32_t i_87143 = 0; i_87143 < 28; i_87143++) {
                    int64_t i_86003 = sext_i32_i64(i_87143);
                    int64_t j_63964 = add64((int64_t) 3, i_86003);
                    int64_t i_p_m_t_s_63965 = add64((int64_t) 2, i_86003);
                    bool zzero_leq_i_p_m_t_s_63966 = sle64((int64_t) 0,
                                                           i_p_m_t_s_63965);
                    bool i_p_m_t_s_leq_w_63967 = slt64(i_p_m_t_s_63965,
                                                       (int64_t) 30);
                    bool zzero_lte_i_63968 = sle64((int64_t) 0, i_86003);
                    bool i_lte_j_63969 = sle64(i_86003, j_63964);
                    bool y_63970 = i_p_m_t_s_leq_w_63967 && zzero_lte_i_63968;
                    bool y_63971 = zzero_leq_i_p_m_t_s_63966 && y_63970;
                    bool y_63972 = i_lte_j_63969 && y_63971;
                    bool forwards_ok_63973 = zzero_lte_i_63968 && y_63972;
                    bool index_ok_63975 = forwards_ok_63960 &&
                         forwards_ok_63973;
                    bool index_certs_63976;
                    
                    if (!index_ok_63975) {
                        set_error(ctx,
                                  msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                            "Index [", (long long) i_86007, ":",
                                            (long long) j_63951, ", ",
                                            (long long) i_86003, ":",
                                            (long long) j_63964,
                                            "] out of bounds for array of shape [",
                                            (long long) (int64_t) 30, "][",
                                            (long long) (int64_t) 30, "].",
                                            "-> #0  ../layers/conv2d.fut:13:90-124\n   #1  ../layers/conv2d.fut:13:69-146\n   #2  /prelude/soacs.fut:59:3-10\n   #3  /prelude/array.fut:200:3-17\n   #4  /prelude/functional.fut:39:59-65\n   #5  /prelude/soacs.fut:59:3-10\n   #6  /prelude/array.fut:208:3-34\n   #7  ../layers/conv2d.fut:13:26-162\n   #8  ../layers/conv2d.fut:26:17-54\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    for (int64_t i_114320 = 0; i_114320 < (int64_t) 1152;
                         i_114320++) {
                        double tmp_114321 =
                               ((double *) mem_105562)[(int64_t) 30 * i_86007 +
                                                       i_86003 +
                                                       (squot64(i_114320,
                                                                (int64_t) 9) *
                                                        (int64_t) 900 +
                                                        squot64(i_114320 -
                                                                squot64(i_114320,
                                                                        (int64_t) 9) *
                                                                (int64_t) 9,
                                                                (int64_t) 3) *
                                                        (int64_t) 30 +
                                                        (i_114320 -
                                                         squot64(i_114320,
                                                                 (int64_t) 9) *
                                                         (int64_t) 9 -
                                                         squot64(i_114320 -
                                                                 squot64(i_114320,
                                                                         (int64_t) 9) *
                                                                 (int64_t) 9,
                                                                 (int64_t) 3) *
                                                         (int64_t) 3))];
                        
                        ((double *) mem_105730)[i_86007 * (int64_t) 32256 +
                                                i_86003 * (int64_t) 1152 +
                                                i_114320] = tmp_114321;
                    }
                }
            }
            if (memblock_alloc(ctx, &mem_105782, (int64_t) 512, "mem_105782")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_105784, (int64_t) 512, "mem_105784")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_105786, (int64_t) 512, "mem_105786")) {
                err = 1;
                goto cleanup;
            }
            for (int32_t i_86865 = 0; i_86865 < 64; i_86865++) {
                int64_t i_86024 = sext_i32_i64(i_86865);
                double x_71829 = ((double *) mem_param_97165.mem)[i_86024];
                double x_71830 = ((double *) mem_param_97184.mem)[i_86024];
                double x_71831 = ((double *) mem_param_96923.mem)[i_86024];
                int64_t binop_x_88057 = (int64_t) 1152 * i_86024;
                double defunc_2_reduce_res_84084;
                double redout_86012 = 0.0;
                
                for (int32_t i_87141 = 0; i_87141 < 784; i_87141++) {
                    int64_t i_86014 = sext_i32_i64(i_87141);
                    int64_t binop_x_88123 = (int64_t) 1152 * i_86014;
                    double defunc_2_reduce_res_84083;
                    double redout_86009 = 0.0;
                    
                    for (int32_t i_87142 = 0; i_87142 < 1152; i_87142++) {
                        int64_t i_86010 = sext_i32_i64(i_87142);
                        int64_t binop_x_88058 = i_86010 + binop_x_88057;
                        int64_t new_index_88059 = squot64(binop_x_88058,
                                                          (int64_t) 1152);
                        int64_t binop_y_88065 = (int64_t) 1152 *
                                new_index_88059;
                        int64_t binop_x_88066 = binop_x_88058 - binop_y_88065;
                        int64_t new_index_88067 = squot64(binop_x_88066,
                                                          (int64_t) 9);
                        int64_t binop_y_88083 = (int64_t) 9 * new_index_88067;
                        int64_t binop_x_88084 = binop_x_88066 - binop_y_88083;
                        int64_t new_index_88085 = squot64(binop_x_88084,
                                                          (int64_t) 3);
                        int64_t binop_y_88121 = (int64_t) 3 * new_index_88085;
                        int64_t new_index_88122 = binop_x_88084 - binop_y_88121;
                        int64_t binop_y_88151 = (int64_t) -1 * new_index_88085;
                        int64_t slice_88152 = (int64_t) 2 + binop_y_88151;
                        int64_t binop_y_88153 = (int64_t) -1 * new_index_88122;
                        int64_t slice_88154 = (int64_t) 2 + binop_y_88153;
                        double x_82503 =
                               ((double *) mem_param_96937.mem)[new_index_88067 *
                                                                (int64_t) 576 +
                                                                new_index_88059 *
                                                                (int64_t) 9 +
                                                                slice_88152 *
                                                                (int64_t) 3 +
                                                                slice_88154];
                        int64_t binop_x_88124 = i_86010 + binop_x_88123;
                        int64_t new_index_88125 = squot64(binop_x_88124,
                                                          (int64_t) 32256);
                        int64_t binop_y_88131 = (int64_t) 32256 *
                                new_index_88125;
                        int64_t binop_x_88132 = binop_x_88124 - binop_y_88131;
                        int64_t new_index_88133 = squot64(binop_x_88132,
                                                          (int64_t) 1152);
                        int64_t binop_y_88149 = (int64_t) 1152 *
                                new_index_88133;
                        int64_t new_index_88150 = binop_x_88132 - binop_y_88149;
                        double x_82504 =
                               ((double *) mem_105730)[new_index_88125 *
                                                       (int64_t) 32256 +
                                                       new_index_88133 *
                                                       (int64_t) 1152 +
                                                       new_index_88150];
                        double defunc_1_f_res_82505 = x_82503 * x_82504;
                        double defunc_1_op_res_82499 = defunc_1_f_res_82505 +
                               redout_86009;
                        double redout_tmp_114328 = defunc_1_op_res_82499;
                        
                        redout_86009 = redout_tmp_114328;
                    }
                    defunc_2_reduce_res_84083 = redout_86009;
                    
                    double defunc_1_op_res_71847 = defunc_2_reduce_res_84083 +
                           redout_86012;
                    
                    ((double *) mem_105813)[i_86014] =
                        defunc_2_reduce_res_84083;
                    
                    double redout_tmp_114326 = defunc_1_op_res_71847;
                    
                    redout_86012 = redout_tmp_114326;
                }
                defunc_2_reduce_res_84084 = redout_86012;
                
                double x_71850 = 0.9 * x_71829;
                double y_71851 = 9.999999999999998e-2 *
                       defunc_2_reduce_res_84084;
                double m_dw_71852 = x_71850 + y_71851;
                double x_71853 = 0.999 * x_71830;
                double y_71854 = fpow64(defunc_2_reduce_res_84084, 2.0);
                double y_71855 = 1.0000000000000009e-3 * y_71854;
                double v_dw_71856 = x_71853 + y_71855;
                double m_dw_corr_71857 = m_dw_71852 / y_56527;
                double v_dw_corr_71858 = v_dw_71856 / y_56531;
                double sqrt_res_71859 = futrts_sqrt64(v_dw_corr_71858);
                double y_71860 = 1.0e-8 + sqrt_res_71859;
                double y_71861 = m_dw_corr_71857 / y_71860;
                double y_71862 = 3.0e-4 * y_71861;
                double new_w_71863 = x_71831 - y_71862;
                
                ((double *) mem_105782.mem)[i_86024] = new_w_71863;
                ((double *) mem_105784.mem)[i_86024] = m_dw_71852;
                ((double *) mem_105786.mem)[i_86024] = v_dw_71856;
                if ((int64_t) 6272 > 0)
                    memmove(mem_105788 + i_86024 * (int64_t) 784 * (int64_t) 8,
                            mem_105813 + (int64_t) 0, (int64_t) 6272);
            }
            if (memblock_alloc(ctx, &mem_105850, (int64_t) 1179648,
                               "mem_105850")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_105852, (int64_t) 1179648,
                               "mem_105852")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_105854, (int64_t) 1179648,
                               "mem_105854")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_105856, (int64_t) 294912,
                               "mem_105856")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_105858, (int64_t) 294912,
                               "mem_105858")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_105860, (int64_t) 294912,
                               "mem_105860")) {
                err = 1;
                goto cleanup;
            }
            for (int32_t i_86866 = 0; i_86866 < 64; i_86866++) {
                int64_t i_86145 = sext_i32_i64(i_86866);
                bool x_77953 = sle64((int64_t) 0, i_86145);
                bool y_77954 = slt64(i_86145, (int64_t) 64);
                bool bounds_check_77955 = x_77953 && y_77954;
                bool index_certs_77956;
                
                if (!bounds_check_77955) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Index [", (long long) i_86145,
                                        "] out of bounds for array of shape [",
                                        (long long) (int64_t) 64, "].",
                                        "-> #0  ../layers/conv2d.fut:34:69-81\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                for (int64_t i_86035 = 0; i_86035 < new_n_58743; i_86035++) {
                    int64_t j_77959 = add64(m_49205, i_86035);
                    int64_t i_p_m_t_s_77960 = add64(m_58766, i_86035);
                    bool zzero_leq_i_p_m_t_s_77961 = sle64((int64_t) 0,
                                                           i_p_m_t_s_77960);
                    bool i_p_m_t_s_leq_w_77962 = slt64(i_p_m_t_s_77960,
                                                       (int64_t) 28);
                    bool i_lte_j_77964 = sle64(i_86035, j_77959);
                    bool y_77966 = zzero_leq_i_p_m_t_s_77961 &&
                         i_p_m_t_s_leq_w_77962;
                    bool y_77967 = i_lte_j_77964 && y_77966;
                    bool ok_or_empty_77969 = empty_slice_58765 || y_77967;
                    
                    for (int64_t i_86031 = 0; i_86031 < new_n_58743;
                         i_86031++) {
                        int64_t j_77972 = add64(m_49205, i_86031);
                        int64_t i_p_m_t_s_77973 = add64(m_58766, i_86031);
                        bool zzero_leq_i_p_m_t_s_77974 = sle64((int64_t) 0,
                                                               i_p_m_t_s_77973);
                        bool i_p_m_t_s_leq_w_77975 = slt64(i_p_m_t_s_77973,
                                                           (int64_t) 28);
                        bool i_lte_j_77977 = sle64(i_86031, j_77972);
                        bool y_77979 = zzero_leq_i_p_m_t_s_77974 &&
                             i_p_m_t_s_leq_w_77975;
                        bool y_77980 = i_lte_j_77977 && y_77979;
                        bool ok_or_empty_77982 = empty_slice_58765 || y_77980;
                        bool index_ok_77983 = ok_or_empty_77969 &&
                             ok_or_empty_77982;
                        bool index_certs_77984;
                        
                        if (!index_ok_77983) {
                            set_error(ctx,
                                      msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                "Index [", (long long) i_86035,
                                                ":", (long long) j_77959, ", ",
                                                (long long) i_86031, ":",
                                                (long long) j_77972,
                                                "] out of bounds for array of shape [",
                                                (long long) (int64_t) 28, "][",
                                                (long long) (int64_t) 28, "].",
                                                "-> #0  ../layers/conv2d.fut:13:90-124\n   #1  ../layers/conv2d.fut:13:69-146\n   #2  /prelude/soacs.fut:59:3-10\n   #3  /prelude/array.fut:200:3-17\n   #4  /prelude/functional.fut:39:59-65\n   #5  /prelude/soacs.fut:59:3-10\n   #6  /prelude/array.fut:208:3-34\n   #7  ../layers/conv2d.fut:13:26-162\n   #8  /prelude/soacs.fut:59:3-10\n   #9  /prelude/array.fut:208:3-34\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        for (int64_t i_114339 = 0; i_114339 < k_total_58756;
                             i_114339++) {
                            double tmp_114340 =
                                   ((double *) mem_101399)[i_86145 *
                                                           (int64_t) 784 +
                                                           (int64_t) 28 *
                                                           i_86035 + i_86031 +
                                                           (squot64(i_114339,
                                                                    m_49205) *
                                                            (int64_t) 28 +
                                                            (i_114339 -
                                                             squot64(i_114339,
                                                                     m_49205) *
                                                             m_49205))];
                            
                            ((double *) mem_106006)[i_114339] = tmp_114340;
                        }
                        if (k_total_58756 * (int64_t) 8 > 0)
                            memmove(mem_105976 + (i_86035 * binop_y_88024 +
                                                  i_86031 * i64_arg_54203) *
                                    (int64_t) 8, mem_106006 + (int64_t) 0,
                                    k_total_58756 * (int64_t) 8);
                    }
                }
                for (int64_t i_86041 = 0; i_86041 < x_58750; i_86041++) {
                    int64_t binop_x_88022 = i64_arg_54203 * i_86041;
                    double defunc_2_reduce_res_84087;
                    double redout_86037 = 0.0;
                    
                    for (int64_t i_86038 = 0; i_86038 < i64_arg_54203;
                         i_86038++) {
                        int64_t new_index_87131 = squot64(i_86038, n_49206);
                        int64_t binop_y_87133 = n_49206 * new_index_87131;
                        int64_t new_index_87134 = i_86038 - binop_y_87133;
                        double x_79016 =
                               ((double *) mem_101549)[new_index_87131 *
                                                       n_49206 +
                                                       new_index_87134];
                        int64_t binop_x_88023 = i_86038 + binop_x_88022;
                        int64_t new_index_88025 = squot64(binop_x_88023,
                                                          binop_y_88024);
                        int64_t binop_y_88033 = binop_y_88024 * new_index_88025;
                        int64_t binop_x_88034 = binop_x_88023 - binop_y_88033;
                        int64_t new_index_88035 = squot64(binop_x_88034,
                                                          i64_arg_54203);
                        int64_t binop_y_88055 = i64_arg_54203 * new_index_88035;
                        int64_t new_index_88056 = binop_x_88034 - binop_y_88055;
                        double x_79017 =
                               ((double *) mem_105976)[new_index_88025 *
                                                       binop_y_88024 +
                                                       new_index_88035 *
                                                       i64_arg_54203 +
                                                       new_index_88056];
                        double defunc_1_f_res_79018 = x_79016 * x_79017;
                        double defunc_1_op_res_77999 = defunc_1_f_res_79018 +
                               redout_86037;
                        double redout_tmp_114342 = defunc_1_op_res_77999;
                        
                        redout_86037 = redout_tmp_114342;
                    }
                    defunc_2_reduce_res_84087 = redout_86037;
                    ((double *) mem_106039)[i_86041] =
                        defunc_2_reduce_res_84087;
                }
                if (new_n_58743 * new_n_58743 * (int64_t) 8 > 0)
                    memmove(mem_106053 + (int64_t) 0, mem_106039 + (int64_t) 0,
                            new_n_58743 * new_n_58743 * (int64_t) 8);
                for (int32_t i_87074 = 0; i_87074 < 64; i_87074++) {
                    int64_t i_86079 = sext_i32_i64(i_87074);
                    bool x_78909 = sle64((int64_t) 0, i_86079);
                    bool y_78910 = slt64(i_86079, (int64_t) 64);
                    bool bounds_check_78911 = x_78909 && y_78910;
                    bool index_certs_78912;
                    
                    if (!bounds_check_78911) {
                        set_error(ctx,
                                  msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                            "Index [", (long long) i_86079,
                                            "] out of bounds for array of shape [",
                                            (long long) (int64_t) 64, "].",
                                            "-> #0  ../layers/conv2d.fut:34:69-81\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    for (int32_t i_87106 = 0; i_87106 < 30; i_87106++) {
                        int64_t i_86049 = sext_i32_i64(i_87106);
                        bool cond_78915 = slt64(i_86049, (int64_t) 1);
                        bool cond_f_res_78916 = sle64((int64_t) 29, i_86049);
                        bool x_78917 = !cond_78915;
                        bool y_78918 = cond_f_res_78916 && x_78917;
                        bool cond_78919 = cond_78915 || y_78918;
                        bool x_78920 = !cond_78919;
                        
                        for (int32_t i_87124 = 0; i_87124 < 30; i_87124++) {
                            int64_t i_86045 = sext_i32_i64(i_87124);
                            bool cond_f_res_78923 = slt64(i_86045, (int64_t) 1);
                            bool y_78924 = x_78920 && cond_f_res_78923;
                            bool cond_78925 = cond_78919 || y_78924;
                            bool cond_f_res_78926 = sle64((int64_t) 29,
                                                          i_86045);
                            bool x_78927 = !cond_78925;
                            bool y_78928 = cond_f_res_78926 && x_78927;
                            bool cond_78929 = cond_78925 || y_78928;
                            double defunc_0_f_res_78930;
                            
                            if (cond_78929 == 1) {
                                defunc_0_f_res_78930 = 0.0;
                            } else {
                                int64_t i_78931 = sub64(i_86049, (int64_t) 1);
                                bool x_78932 = sle64((int64_t) 0, i_78931);
                                bool y_78933 = slt64(i_78931, (int64_t) 28);
                                bool bounds_check_78934 = x_78932 && y_78933;
                                int64_t i_78935 = sub64(i_86045, (int64_t) 1);
                                bool x_78936 = sle64((int64_t) 0, i_78935);
                                bool y_78937 = slt64(i_78935, (int64_t) 28);
                                bool bounds_check_78938 = x_78936 && y_78937;
                                bool index_ok_78939 = bounds_check_78934 &&
                                     bounds_check_78938;
                                bool index_certs_78940;
                                
                                if (!index_ok_78939) {
                                    set_error(ctx,
                                              msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                        "Index [",
                                                        (long long) i_78931,
                                                        ", ",
                                                        (long long) i_78935,
                                                        "] out of bounds for array of shape [",
                                                        (long long) (int64_t) 28,
                                                        "][",
                                                        (long long) (int64_t) 28,
                                                        "].",
                                                        "-> #0  ../layers/conv2d.fut:7:91-116\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  ../layers/conv2d.fut:6:22-7:117\n   #7  ../layers/conv2d.fut:6:6-7:123\n   #8  /prelude/soacs.fut:59:3-10\n   #9  /prelude/array.fut:208:3-34\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                double defunc_0_f_res_f_res_78941 =
                                       ((double *) mem_100907)[i_86079 *
                                                               (int64_t) 784 +
                                                               i_78931 *
                                                               (int64_t) 28 +
                                                               i_78935];
                                
                                defunc_0_f_res_78930 =
                                    defunc_0_f_res_f_res_78941;
                            }
                            ((double *) mem_106103)[i_86049 * (int64_t) 30 +
                                                    i_86045] =
                                defunc_0_f_res_78930;
                        }
                    }
                    for (int32_t i_87107 = 0; i_87107 < 3; i_87107++) {
                        int64_t i_86069 = sext_i32_i64(i_87107);
                        int64_t j_79226 = add64((int64_t) 28, i_86069);
                        int64_t i_p_m_t_s_79227 = add64((int64_t) 27, i_86069);
                        bool zzero_leq_i_p_m_t_s_79228 = sle64((int64_t) 0,
                                                               i_p_m_t_s_79227);
                        bool i_p_m_t_s_leq_w_79229 = slt64(i_p_m_t_s_79227,
                                                           (int64_t) 30);
                        bool zzero_lte_i_79230 = sle64((int64_t) 0, i_86069);
                        bool i_lte_j_79231 = sle64(i_86069, j_79226);
                        bool y_79232 = i_p_m_t_s_leq_w_79229 &&
                             zzero_lte_i_79230;
                        bool y_79233 = zzero_leq_i_p_m_t_s_79228 && y_79232;
                        bool y_79234 = i_lte_j_79231 && y_79233;
                        bool forwards_ok_79235 = zzero_lte_i_79230 && y_79234;
                        
                        for (int32_t i_87108 = 0; i_87108 < 3; i_87108++) {
                            int64_t i_86059 = sext_i32_i64(i_87108);
                            double x_79285 =
                                   ((double *) mem_param_97568.mem)[i_86145 *
                                                                    (int64_t) 576 +
                                                                    i_86079 *
                                                                    (int64_t) 9 +
                                                                    i_86069 *
                                                                    (int64_t) 3 +
                                                                    i_86059];
                            double x_79286 =
                                   ((double *) mem_param_97587.mem)[i_86145 *
                                                                    (int64_t) 576 +
                                                                    i_86079 *
                                                                    (int64_t) 9 +
                                                                    i_86069 *
                                                                    (int64_t) 3 +
                                                                    i_86059];
                            double x_79287 =
                                   ((double *) mem_param_97122.mem)[i_86145 *
                                                                    (int64_t) 576 +
                                                                    i_86079 *
                                                                    (int64_t) 9 +
                                                                    i_86069 *
                                                                    (int64_t) 3 +
                                                                    i_86059];
                            int64_t j_79288 = add64((int64_t) 28, i_86059);
                            int64_t i_p_m_t_s_79289 = add64((int64_t) 27,
                                                            i_86059);
                            bool zzero_leq_i_p_m_t_s_79290 = sle64((int64_t) 0,
                                                                   i_p_m_t_s_79289);
                            bool i_p_m_t_s_leq_w_79291 = slt64(i_p_m_t_s_79289,
                                                               (int64_t) 30);
                            bool zzero_lte_i_79292 = sle64((int64_t) 0,
                                                           i_86059);
                            bool i_lte_j_79293 = sle64(i_86059, j_79288);
                            bool y_79294 = i_p_m_t_s_leq_w_79291 &&
                                 zzero_lte_i_79292;
                            bool y_79295 = zzero_leq_i_p_m_t_s_79290 && y_79294;
                            bool y_79296 = i_lte_j_79293 && y_79295;
                            bool forwards_ok_79297 = zzero_lte_i_79292 &&
                                 y_79296;
                            bool index_ok_79298 = forwards_ok_79235 &&
                                 forwards_ok_79297;
                            bool index_certs_79299;
                            
                            if (!index_ok_79298) {
                                set_error(ctx,
                                          msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                    "Index [",
                                                    (long long) i_86069, ":",
                                                    (long long) j_79226, ", ",
                                                    (long long) i_86059, ":",
                                                    (long long) j_79288,
                                                    "] out of bounds for array of shape [",
                                                    (long long) (int64_t) 30,
                                                    "][",
                                                    (long long) (int64_t) 30,
                                                    "].",
                                                    "-> #0  ../layers/conv2d.fut:13:90-124\n   #1  ../layers/conv2d.fut:13:69-146\n   #2  /prelude/soacs.fut:59:3-10\n   #3  /prelude/array.fut:200:3-17\n   #4  /prelude/functional.fut:39:59-65\n   #5  /prelude/soacs.fut:59:3-10\n   #6  /prelude/array.fut:208:3-34\n   #7  ../layers/conv2d.fut:13:26-162\n   #8  /prelude/soacs.fut:59:3-10\n   #9  /prelude/array.fut:208:3-34\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            double defunc_2_reduce_res_84089;
                            double redout_86051 = 0.0;
                            
                            for (int32_t i_87109 = 0; i_87109 < 784;
                                 i_87109++) {
                                int64_t i_86052 = sext_i32_i64(i_87109);
                                int64_t new_index_87110 = squot64(i_86052,
                                                                  (int64_t) 28);
                                int64_t binop_y_87112 = (int64_t) 28 *
                                        new_index_87110;
                                int64_t new_index_87113 = i_86052 -
                                        binop_y_87112;
                                double x_79308 =
                                       ((double *) mem_101980)[i_86145 *
                                                               (int64_t) 784 +
                                                               new_index_87110 *
                                                               (int64_t) 28 +
                                                               new_index_87113];
                                int64_t slice_87118 = i_86069 + new_index_87110;
                                int64_t slice_87119 = i_86059 + new_index_87113;
                                double x_79309 =
                                       ((double *) mem_106103)[slice_87118 *
                                                               (int64_t) 30 +
                                                               slice_87119];
                                double defunc_1_f_res_79310 = x_79308 * x_79309;
                                double defunc_1_op_res_79307 =
                                       defunc_1_f_res_79310 + redout_86051;
                                double redout_tmp_114354 =
                                       defunc_1_op_res_79307;
                                
                                redout_86051 = redout_tmp_114354;
                            }
                            defunc_2_reduce_res_84089 = redout_86051;
                            
                            double x_79311 = 0.9 * x_79285;
                            double y_79312 = 9.999999999999998e-2 *
                                   defunc_2_reduce_res_84089;
                            double m_dw_79313 = x_79311 + y_79312;
                            double x_79314 = 0.999 * x_79286;
                            double y_79315 = fpow64(defunc_2_reduce_res_84089,
                                                    2.0);
                            double y_79316 = 1.0000000000000009e-3 * y_79315;
                            double v_dw_79317 = x_79314 + y_79316;
                            double m_dw_corr_79318 = m_dw_79313 / y_56527;
                            double v_dw_corr_79319 = v_dw_79317 / y_56531;
                            double sqrt_res_79320 =
                                   futrts_sqrt64(v_dw_corr_79319);
                            double y_79321 = 1.0e-8 + sqrt_res_79320;
                            double y_79322 = m_dw_corr_79318 / y_79321;
                            double y_79323 = 3.0e-4 * y_79322;
                            double new_w_79324 = x_79287 - y_79323;
                            
                            ((double *) mem_105856.mem)[i_86145 *
                                                        (int64_t) 576 +
                                                        i_86079 * (int64_t) 9 +
                                                        i_86069 * (int64_t) 3 +
                                                        i_86059] = new_w_79324;
                            ((double *) mem_105858.mem)[i_86145 *
                                                        (int64_t) 576 +
                                                        i_86079 * (int64_t) 9 +
                                                        i_86069 * (int64_t) 3 +
                                                        i_86059] = m_dw_79313;
                            ((double *) mem_105860.mem)[i_86145 *
                                                        (int64_t) 576 +
                                                        i_86079 * (int64_t) 9 +
                                                        i_86069 * (int64_t) 3 +
                                                        i_86059] = v_dw_79317;
                        }
                    }
                }
                for (int32_t i_87075 = 0; i_87075 < 256; i_87075++) {
                    int64_t i_86119 = sext_i32_i64(i_87075);
                    bool x_78795 = sle64((int64_t) 0, i_86119);
                    bool y_78796 = slt64(i_86119, (int64_t) 256);
                    bool bounds_check_78797 = x_78795 && y_78796;
                    bool index_certs_78798;
                    
                    if (!bounds_check_78797) {
                        set_error(ctx,
                                  msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                            "Index [", (long long) i_86119,
                                            "] out of bounds for array of shape [",
                                            (long long) (int64_t) 256, "].",
                                            "-> #0  ../layers/conv2d.fut:34:69-81\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    for (int32_t i_87081 = 0; i_87081 < 30; i_87081++) {
                        int64_t i_86089 = sext_i32_i64(i_87081);
                        bool cond_78801 = slt64(i_86089, (int64_t) 1);
                        bool cond_f_res_78802 = sle64((int64_t) 29, i_86089);
                        bool x_78803 = !cond_78801;
                        bool y_78804 = cond_f_res_78802 && x_78803;
                        bool cond_78805 = cond_78801 || y_78804;
                        bool x_78806 = !cond_78805;
                        
                        for (int32_t i_87099 = 0; i_87099 < 30; i_87099++) {
                            int64_t i_86085 = sext_i32_i64(i_87099);
                            bool cond_f_res_78809 = slt64(i_86085, (int64_t) 1);
                            bool y_78810 = x_78806 && cond_f_res_78809;
                            bool cond_78811 = cond_78805 || y_78810;
                            bool cond_f_res_78812 = sle64((int64_t) 29,
                                                          i_86085);
                            bool x_78813 = !cond_78811;
                            bool y_78814 = cond_f_res_78812 && x_78813;
                            bool cond_78815 = cond_78811 || y_78814;
                            double defunc_0_f_res_78816;
                            
                            if (cond_78815 == 1) {
                                defunc_0_f_res_78816 = 0.0;
                            } else {
                                int64_t i_78817 = sub64(i_86089, (int64_t) 1);
                                bool x_78818 = sle64((int64_t) 0, i_78817);
                                bool y_78819 = slt64(i_78817, (int64_t) 28);
                                bool bounds_check_78820 = x_78818 && y_78819;
                                int64_t i_78821 = sub64(i_86085, (int64_t) 1);
                                bool x_78822 = sle64((int64_t) 0, i_78821);
                                bool y_78823 = slt64(i_78821, (int64_t) 28);
                                bool bounds_check_78824 = x_78822 && y_78823;
                                bool index_ok_78825 = bounds_check_78820 &&
                                     bounds_check_78824;
                                bool index_certs_78826;
                                
                                if (!index_ok_78825) {
                                    set_error(ctx,
                                              msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                        "Index [",
                                                        (long long) i_78817,
                                                        ", ",
                                                        (long long) i_78821,
                                                        "] out of bounds for array of shape [",
                                                        (long long) (int64_t) 28,
                                                        "][",
                                                        (long long) (int64_t) 28,
                                                        "].",
                                                        "-> #0  ../layers/conv2d.fut:7:91-116\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  ../layers/conv2d.fut:6:22-7:117\n   #7  ../layers/conv2d.fut:6:6-7:123\n   #8  /prelude/soacs.fut:59:3-10\n   #9  /prelude/array.fut:208:3-34\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool index_concat_cmp_78827 =
                                     sle64((int64_t) 128, i_86119);
                                double index_concat_branch_78828;
                                
                                if (index_concat_cmp_78827 == 1) {
                                    int64_t index_concat_i_84098 =
                                            sub64(i_86119, (int64_t) 128);
                                    double index_concat_84099 =
                                           ((double *) mem_98725)[index_concat_i_84098 *
                                                                  (int64_t) 784 +
                                                                  i_78817 *
                                                                  (int64_t) 28 +
                                                                  i_78821];
                                    
                                    index_concat_branch_78828 =
                                        index_concat_84099;
                                } else {
                                    double index_concat_78831 =
                                           ((double *) mem_100507)[i_86119 *
                                                                   (int64_t) 784 +
                                                                   i_78817 *
                                                                   (int64_t) 28 +
                                                                   i_78821];
                                    
                                    index_concat_branch_78828 =
                                        index_concat_78831;
                                }
                                defunc_0_f_res_78816 =
                                    index_concat_branch_78828;
                            }
                            ((double *) mem_106485)[i_86089 * (int64_t) 30 +
                                                    i_86085] =
                                defunc_0_f_res_78816;
                        }
                    }
                    for (int32_t i_87082 = 0; i_87082 < 3; i_87082++) {
                        int64_t i_86109 = sext_i32_i64(i_87082);
                        int64_t j_79347 = add64((int64_t) 28, i_86109);
                        int64_t i_p_m_t_s_79348 = add64((int64_t) 27, i_86109);
                        bool zzero_leq_i_p_m_t_s_79349 = sle64((int64_t) 0,
                                                               i_p_m_t_s_79348);
                        bool i_p_m_t_s_leq_w_79350 = slt64(i_p_m_t_s_79348,
                                                           (int64_t) 30);
                        bool zzero_lte_i_79351 = sle64((int64_t) 0, i_86109);
                        bool i_lte_j_79352 = sle64(i_86109, j_79347);
                        bool y_79353 = i_p_m_t_s_leq_w_79350 &&
                             zzero_lte_i_79351;
                        bool y_79354 = zzero_leq_i_p_m_t_s_79349 && y_79353;
                        bool y_79355 = i_lte_j_79352 && y_79354;
                        bool forwards_ok_79356 = zzero_lte_i_79351 && y_79355;
                        
                        for (int32_t i_87083 = 0; i_87083 < 3; i_87083++) {
                            int64_t i_86099 = sext_i32_i64(i_87083);
                            double x_79408 =
                                   ((double *) mem_param_97504.mem)[i_86145 *
                                                                    (int64_t) 2304 +
                                                                    i_86119 *
                                                                    (int64_t) 9 +
                                                                    i_86109 *
                                                                    (int64_t) 3 +
                                                                    i_86099];
                            double x_79409 =
                                   ((double *) mem_param_97523.mem)[i_86145 *
                                                                    (int64_t) 2304 +
                                                                    i_86119 *
                                                                    (int64_t) 9 +
                                                                    i_86109 *
                                                                    (int64_t) 3 +
                                                                    i_86099];
                            double x_79410 =
                                   ((double *) mem_param_97090.mem)[i_86145 *
                                                                    (int64_t) 2304 +
                                                                    i_86119 *
                                                                    (int64_t) 9 +
                                                                    i_86109 *
                                                                    (int64_t) 3 +
                                                                    i_86099];
                            int64_t j_79411 = add64((int64_t) 28, i_86099);
                            int64_t i_p_m_t_s_79412 = add64((int64_t) 27,
                                                            i_86099);
                            bool zzero_leq_i_p_m_t_s_79413 = sle64((int64_t) 0,
                                                                   i_p_m_t_s_79412);
                            bool i_p_m_t_s_leq_w_79414 = slt64(i_p_m_t_s_79412,
                                                               (int64_t) 30);
                            bool zzero_lte_i_79415 = sle64((int64_t) 0,
                                                           i_86099);
                            bool i_lte_j_79416 = sle64(i_86099, j_79411);
                            bool y_79417 = i_p_m_t_s_leq_w_79414 &&
                                 zzero_lte_i_79415;
                            bool y_79418 = zzero_leq_i_p_m_t_s_79413 && y_79417;
                            bool y_79419 = i_lte_j_79416 && y_79418;
                            bool forwards_ok_79420 = zzero_lte_i_79415 &&
                                 y_79419;
                            bool index_ok_79421 = forwards_ok_79356 &&
                                 forwards_ok_79420;
                            bool index_certs_79422;
                            
                            if (!index_ok_79421) {
                                set_error(ctx,
                                          msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                    "Index [",
                                                    (long long) i_86109, ":",
                                                    (long long) j_79347, ", ",
                                                    (long long) i_86099, ":",
                                                    (long long) j_79411,
                                                    "] out of bounds for array of shape [",
                                                    (long long) (int64_t) 30,
                                                    "][",
                                                    (long long) (int64_t) 30,
                                                    "].",
                                                    "-> #0  ../layers/conv2d.fut:13:90-124\n   #1  ../layers/conv2d.fut:13:69-146\n   #2  /prelude/soacs.fut:59:3-10\n   #3  /prelude/array.fut:200:3-17\n   #4  /prelude/functional.fut:39:59-65\n   #5  /prelude/soacs.fut:59:3-10\n   #6  /prelude/array.fut:208:3-34\n   #7  ../layers/conv2d.fut:13:26-162\n   #8  /prelude/soacs.fut:59:3-10\n   #9  /prelude/array.fut:208:3-34\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            double defunc_2_reduce_res_84101;
                            double redout_86091 = 0.0;
                            
                            for (int32_t i_87084 = 0; i_87084 < 784;
                                 i_87084++) {
                                int64_t i_86092 = sext_i32_i64(i_87084);
                                int64_t new_index_87085 = squot64(i_86092,
                                                                  (int64_t) 28);
                                int64_t binop_y_87087 = (int64_t) 28 *
                                        new_index_87085;
                                int64_t new_index_87088 = i_86092 -
                                        binop_y_87087;
                                double x_79431 =
                                       ((double *) mem_102468)[i_86145 *
                                                               (int64_t) 784 +
                                                               new_index_87085 *
                                                               (int64_t) 28 +
                                                               new_index_87088];
                                int64_t slice_87093 = i_86109 + new_index_87085;
                                int64_t slice_87094 = i_86099 + new_index_87088;
                                double x_79432 =
                                       ((double *) mem_106485)[slice_87093 *
                                                               (int64_t) 30 +
                                                               slice_87094];
                                double defunc_1_f_res_79433 = x_79431 * x_79432;
                                double defunc_1_op_res_79430 =
                                       defunc_1_f_res_79433 + redout_86091;
                                double redout_tmp_114366 =
                                       defunc_1_op_res_79430;
                                
                                redout_86091 = redout_tmp_114366;
                            }
                            defunc_2_reduce_res_84101 = redout_86091;
                            
                            double x_79434 = 0.9 * x_79408;
                            double y_79435 = 9.999999999999998e-2 *
                                   defunc_2_reduce_res_84101;
                            double m_dw_79436 = x_79434 + y_79435;
                            double x_79437 = 0.999 * x_79409;
                            double y_79438 = fpow64(defunc_2_reduce_res_84101,
                                                    2.0);
                            double y_79439 = 1.0000000000000009e-3 * y_79438;
                            double v_dw_79440 = x_79437 + y_79439;
                            double m_dw_corr_79441 = m_dw_79436 / y_56527;
                            double v_dw_corr_79442 = v_dw_79440 / y_56531;
                            double sqrt_res_79443 =
                                   futrts_sqrt64(v_dw_corr_79442);
                            double y_79444 = 1.0e-8 + sqrt_res_79443;
                            double y_79445 = m_dw_corr_79441 / y_79444;
                            double y_79446 = 3.0e-4 * y_79445;
                            double new_w_79447 = x_79410 - y_79446;
                            
                            ((double *) mem_105850.mem)[i_86145 *
                                                        (int64_t) 2304 +
                                                        i_86119 * (int64_t) 9 +
                                                        i_86109 * (int64_t) 3 +
                                                        i_86099] = new_w_79447;
                            ((double *) mem_105852.mem)[i_86145 *
                                                        (int64_t) 2304 +
                                                        i_86119 * (int64_t) 9 +
                                                        i_86109 * (int64_t) 3 +
                                                        i_86099] = m_dw_79436;
                            ((double *) mem_105854.mem)[i_86145 *
                                                        (int64_t) 2304 +
                                                        i_86119 * (int64_t) 9 +
                                                        i_86109 * (int64_t) 3 +
                                                        i_86099] = v_dw_79440;
                        }
                    }
                }
                
                int64_t binop_x_87971 = (int64_t) 784 * i_86145;
                
                for (int64_t i_86127 = 0; i_86127 < x_59704; i_86127++) {
                    int64_t binop_x_87987 = (int64_t) 784 * i_86127;
                    double defunc_2_reduce_res_84110;
                    double redout_86123 = 0.0;
                    
                    for (int32_t i_87076 = 0; i_87076 < 784; i_87076++) {
                        int64_t i_86124 = sext_i32_i64(i_87076);
                        int64_t new_index_87077 = squot64(i_86124,
                                                          (int64_t) 28);
                        int64_t binop_y_87079 = (int64_t) 28 * new_index_87077;
                        int64_t new_index_87080 = i_86124 - binop_y_87079;
                        int64_t binop_x_87973 = binop_y_87079 + binop_x_87971;
                        int64_t binop_x_87974 = new_index_87080 + binop_x_87973;
                        int64_t new_index_87975 = squot64(binop_x_87974,
                                                          (int64_t) 784);
                        int64_t binop_y_87985 = (int64_t) 784 * new_index_87975;
                        int64_t new_index_87986 = binop_x_87974 - binop_y_87985;
                        double x_79214 =
                               ((double *) mem_105788)[new_index_87975 *
                                                       (int64_t) 784 +
                                                       new_index_87986];
                        int64_t binop_x_87988 = i_86124 + binop_x_87987;
                        int64_t new_index_87990 = squot64(binop_x_87988,
                                                          binop_y_87989);
                        int64_t binop_y_87998 = binop_y_87989 * new_index_87990;
                        int64_t binop_x_87999 = binop_x_87988 - binop_y_87998;
                        int64_t new_index_88000 = squot64(binop_x_87999,
                                                          (int64_t) 784);
                        int64_t binop_y_88020 = (int64_t) 784 * new_index_88000;
                        int64_t new_index_88021 = binop_x_87999 - binop_y_88020;
                        double x_79215 =
                               ((double *) mem_101587)[new_index_87990 *
                                                       binop_y_87989 +
                                                       new_index_88000 *
                                                       (int64_t) 784 +
                                                       new_index_88021];
                        double defunc_1_f_res_79216 = x_79214 * x_79215;
                        double defunc_1_op_res_78276 = defunc_1_f_res_79216 +
                               redout_86123;
                        double redout_tmp_114368 = defunc_1_op_res_78276;
                        
                        redout_86123 = redout_tmp_114368;
                    }
                    defunc_2_reduce_res_84110 = redout_86123;
                    ((double *) mem_106820)[i_86127] =
                        defunc_2_reduce_res_84110;
                }
                for (int64_t i_114369 = 0; i_114369 < (int64_t) 1; i_114369++) {
                    if ((int64_t) 72 > 0)
                        memmove(mem_106832 + i_114369 * (int64_t) 9 *
                                (int64_t) 8, mem_106820 + (int64_t) 0,
                                (int64_t) 72);
                }
                if ((int64_t) 72 > 0)
                    memmove(mem_105848 + i_86145 * (int64_t) 9 * (int64_t) 8,
                            mem_106832 + (int64_t) 0, (int64_t) 72);
                for (int64_t i_114370 = 0; i_114370 < new_n_58743; i_114370++) {
                    for (int64_t i_114371 = 0; i_114371 < new_n_58743;
                         i_114371++) {
                        double tmp_114372 = ((double *) mem_106053)[i_114370 *
                                                                    new_n_58743 +
                                                                    i_114371];
                        
                        ((double *) mem_105862)[i_86145 + (i_114370 +
                                                           i_114371)] =
                            tmp_114372;
                    }
                }
            }
            
            double defunc_2_reduce_res_84467;
            double redout_86154 = 0.0;
            
            for (int64_t i_86155 = 0; i_86155 < i64_arg_54203; i_86155++) {
                int64_t binop_x_87953 = squot64(i_86155, i64_arg_54203);
                int64_t binop_y_87955 = i64_arg_54203 * binop_x_87953;
                int64_t binop_x_87956 = i_86155 - binop_y_87955;
                int64_t new_index_87957 = squot64(binop_x_87956, n_49206);
                int64_t binop_y_87969 = n_49206 * new_index_87957;
                int64_t new_index_87970 = binop_x_87956 - binop_y_87969;
                double x_59042 = ((double *) mem_101549)[new_index_87957 *
                                                         n_49206 +
                                                         new_index_87970];
                double defunc_1_op_res_59041 = x_59042 + redout_86154;
                double redout_tmp_114373 = defunc_1_op_res_59041;
                
                redout_86154 = redout_tmp_114373;
            }
            defunc_2_reduce_res_84467 = redout_86154;
            if (memblock_alloc(ctx, &mem_106943, (int64_t) 512, "mem_106943")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_106945, (int64_t) 512, "mem_106945")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_106947, (int64_t) 512, "mem_106947")) {
                err = 1;
                goto cleanup;
            }
            for (int32_t i_86867 = 0; i_86867 < 64; i_86867++) {
                int64_t i_86164 = sext_i32_i64(i_86867);
                double x_74204 = ((double *) mem_param_97573.mem)[i_86164];
                double x_74205 = ((double *) mem_param_97592.mem)[i_86164];
                double x_74206 = ((double *) mem_param_97127.mem)[i_86164];
                int64_t binop_x_87922 = (int64_t) 784 * i_86164;
                double defunc_2_reduce_res_84121;
                double redout_86156 = 0.0;
                
                for (int32_t i_87073 = 0; i_87073 < 784; i_87073++) {
                    int64_t i_86157 = sext_i32_i64(i_87073);
                    int64_t binop_x_87923 = i_86157 + binop_x_87922;
                    int64_t new_index_87924 = squot64(binop_x_87923,
                                                      (int64_t) 784);
                    int64_t binop_y_87930 = (int64_t) 784 * new_index_87924;
                    int64_t binop_x_87931 = binop_x_87923 - binop_y_87930;
                    int64_t new_index_87932 = squot64(binop_x_87931,
                                                      (int64_t) 28);
                    int64_t binop_y_87948 = (int64_t) 28 * new_index_87932;
                    int64_t new_index_87949 = binop_x_87931 - binop_y_87948;
                    double x_74211 = ((double *) mem_101980)[new_index_87924 *
                                                             (int64_t) 784 +
                                                             new_index_87932 *
                                                             (int64_t) 28 +
                                                             new_index_87949];
                    double defunc_1_op_res_74210 = x_74211 + redout_86156;
                    double redout_tmp_114377 = defunc_1_op_res_74210;
                    
                    redout_86156 = redout_tmp_114377;
                }
                defunc_2_reduce_res_84121 = redout_86156;
                
                double x_74213 = 0.9 * x_74204;
                double y_74214 = 9.999999999999998e-2 *
                       defunc_2_reduce_res_84121;
                double m_dw_74215 = x_74213 + y_74214;
                double x_74216 = 0.999 * x_74205;
                double y_74217 = fpow64(defunc_2_reduce_res_84121, 2.0);
                double y_74218 = 1.0000000000000009e-3 * y_74217;
                double v_dw_74219 = x_74216 + y_74218;
                double m_dw_corr_74220 = m_dw_74215 / y_56527;
                double v_dw_corr_74221 = v_dw_74219 / y_56531;
                double sqrt_res_74222 = futrts_sqrt64(v_dw_corr_74221);
                double y_74223 = 1.0e-8 + sqrt_res_74222;
                double y_74224 = m_dw_corr_74220 / y_74223;
                double y_74225 = 3.0e-4 * y_74224;
                double new_w_74226 = x_74206 - y_74225;
                
                ((double *) mem_106943.mem)[i_86164] = new_w_74226;
                ((double *) mem_106945.mem)[i_86164] = m_dw_74215;
                ((double *) mem_106947.mem)[i_86164] = v_dw_74219;
            }
            if (memblock_alloc(ctx, &mem_106979, (int64_t) 512, "mem_106979")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_106981, (int64_t) 512, "mem_106981")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_106983, (int64_t) 512, "mem_106983")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_106985, (int64_t) 131072,
                               "mem_106985")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_106987, (int64_t) 131072,
                               "mem_106987")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_106989, (int64_t) 131072,
                               "mem_106989")) {
                err = 1;
                goto cleanup;
            }
            for (int32_t i_86868 = 0; i_86868 < 64; i_86868++) {
                int64_t i_86194 = sext_i32_i64(i_86868);
                double x_74094 = ((double *) mem_param_97541.mem)[i_86194];
                double x_74095 = ((double *) mem_param_97554.mem)[i_86194];
                double x_74096 = ((double *) mem_param_97108.mem)[i_86194];
                double x_74097 = ((double *) mem_100909)[i_86194];
                int64_t binop_x_87906 = (int64_t) 784 * i_86194;
                double defunc_0_f_res_84123;
                double redout_86170 = 0.0;
                
                for (int32_t i_87064 = 0; i_87064 < 28; i_87064++) {
                    int64_t i_86171 = sext_i32_i64(i_87064);
                    int64_t binop_y_87907 = (int64_t) 28 * i_86171;
                    int64_t binop_x_87908 = binop_x_87906 + binop_y_87907;
                    double defunc_0_f_res_84122;
                    double redout_86168 = 0.0;
                    
                    for (int32_t i_87072 = 0; i_87072 < 28; i_87072++) {
                        int64_t i_86169 = sext_i32_i64(i_87072);
                        int64_t binop_x_87909 = i_86169 + binop_x_87908;
                        int64_t new_index_87910 = squot64(binop_x_87909,
                                                          (int64_t) 784);
                        int64_t binop_y_87920 = (int64_t) 784 * new_index_87910;
                        int64_t new_index_87921 = binop_x_87909 - binop_y_87920;
                        double x_79582 =
                               ((double *) mem_102198)[new_index_87910 *
                                                       (int64_t) 784 +
                                                       new_index_87921];
                        double defunc_1_op_res_79581 = x_79582 + redout_86168;
                        double redout_tmp_114385 = defunc_1_op_res_79581;
                        
                        redout_86168 = redout_tmp_114385;
                    }
                    defunc_0_f_res_84122 = redout_86168;
                    
                    double defunc_1_op_res_74112 = defunc_0_f_res_84122 +
                           redout_86170;
                    double redout_tmp_114384 = defunc_1_op_res_74112;
                    
                    redout_86170 = redout_tmp_114384;
                }
                defunc_0_f_res_84123 = redout_86170;
                
                bool cond_74115 = 0.0 < x_74097;
                double defunc_1_f_res_74116;
                
                if (cond_74115 == 1) {
                    defunc_1_f_res_74116 = defunc_0_f_res_84123;
                } else {
                    defunc_1_f_res_74116 = 0.0;
                }
                for (int32_t i_87065 = 0; i_87065 < 256; i_87065++) {
                    int64_t i_86178 = sext_i32_i64(i_87065);
                    bool index_concat_cmp_87067 = sle64((int64_t) 128, i_86178);
                    double index_concat_branch_87071;
                    
                    if (index_concat_cmp_87067 == 1) {
                        int64_t index_concat_i_87068 = sub64(i_86178,
                                                             (int64_t) 128);
                        double index_concat_87069 =
                               ((double *) mem_97692)[index_concat_i_87068];
                        
                        index_concat_branch_87071 = index_concat_87069;
                    } else {
                        double index_concat_87070 =
                               ((double *) mem_97690)[i_86178];
                        
                        index_concat_branch_87071 = index_concat_87070;
                    }
                    
                    double x_79557 = ((double *) mem_param_97536.mem)[i_86194 *
                                                                      (int64_t) 256 +
                                                                      i_86178];
                    double x_79558 = ((double *) mem_param_97549.mem)[i_86194 *
                                                                      (int64_t) 256 +
                                                                      i_86178];
                    double x_79559 = ((double *) mem_param_97103.mem)[i_86194 *
                                                                      (int64_t) 256 +
                                                                      i_86178];
                    double defunc_0_f_res_79560 = defunc_1_f_res_74116 *
                           index_concat_branch_87071;
                    double x_79562 = 0.9 * x_79557;
                    double y_79563 = 9.999999999999998e-2 *
                           defunc_0_f_res_79560;
                    double m_dw_79564 = x_79562 + y_79563;
                    double x_79565 = 0.999 * x_79558;
                    double y_79566 = fpow64(defunc_0_f_res_79560, 2.0);
                    double y_79567 = 1.0000000000000009e-3 * y_79566;
                    double v_dw_79568 = x_79565 + y_79567;
                    double m_dw_corr_79569 = m_dw_79564 / y_56527;
                    double v_dw_corr_79570 = v_dw_79568 / y_56531;
                    double sqrt_res_79571 = futrts_sqrt64(v_dw_corr_79570);
                    double y_79572 = 1.0e-8 + sqrt_res_79571;
                    double y_79573 = m_dw_corr_79569 / y_79572;
                    double y_79574 = 3.0e-4 * y_79573;
                    double new_w_79575 = x_79559 - y_79574;
                    
                    ((double *) mem_106985.mem)[i_86194 * (int64_t) 256 +
                                                i_86178] = new_w_79575;
                    ((double *) mem_106987.mem)[i_86194 * (int64_t) 256 +
                                                i_86178] = m_dw_79564;
                    ((double *) mem_106989.mem)[i_86194 * (int64_t) 256 +
                                                i_86178] = v_dw_79568;
                }
                
                double x_74147 = 0.9 * x_74094;
                double y_74148 = 9.999999999999998e-2 * defunc_1_f_res_74116;
                double m_dw_74149 = x_74147 + y_74148;
                double x_74150 = 0.999 * x_74095;
                double y_74151 = fpow64(defunc_1_f_res_74116, 2.0);
                double y_74152 = 1.0000000000000009e-3 * y_74151;
                double v_dw_74153 = x_74150 + y_74152;
                double m_dw_corr_74154 = m_dw_74149 / y_56527;
                double v_dw_corr_74155 = v_dw_74153 / y_56531;
                double sqrt_res_74156 = futrts_sqrt64(v_dw_corr_74155);
                double y_74157 = 1.0e-8 + sqrt_res_74156;
                double y_74158 = m_dw_corr_74154 / y_74157;
                double y_74159 = 3.0e-4 * y_74158;
                double new_w_74160 = x_74096 - y_74159;
                
                ((double *) mem_106979.mem)[i_86194] = new_w_74160;
                ((double *) mem_106981.mem)[i_86194] = m_dw_74149;
                ((double *) mem_106983.mem)[i_86194] = v_dw_74153;
            }
            if (memblock_alloc(ctx, &mem_107135, (int64_t) 512, "mem_107135")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_107137, (int64_t) 512, "mem_107137")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_107139, (int64_t) 512, "mem_107139")) {
                err = 1;
                goto cleanup;
            }
            for (int32_t i_86869 = 0; i_86869 < 64; i_86869++) {
                int64_t i_86209 = sext_i32_i64(i_86869);
                double x_73756 = ((double *) mem_param_97509.mem)[i_86209];
                double x_73757 = ((double *) mem_param_97528.mem)[i_86209];
                double x_73758 = ((double *) mem_param_97095.mem)[i_86209];
                int64_t binop_x_87878 = (int64_t) 784 * i_86209;
                double defunc_2_reduce_res_84127;
                double redout_86201 = 0.0;
                
                for (int32_t i_87063 = 0; i_87063 < 784; i_87063++) {
                    int64_t i_86202 = sext_i32_i64(i_87063);
                    int64_t binop_x_87879 = i_86202 + binop_x_87878;
                    int64_t new_index_87880 = squot64(binop_x_87879,
                                                      (int64_t) 784);
                    int64_t binop_y_87886 = (int64_t) 784 * new_index_87880;
                    int64_t binop_x_87887 = binop_x_87879 - binop_y_87886;
                    int64_t new_index_87888 = squot64(binop_x_87887,
                                                      (int64_t) 28);
                    int64_t binop_y_87904 = (int64_t) 28 * new_index_87888;
                    int64_t new_index_87905 = binop_x_87887 - binop_y_87904;
                    double x_73763 = ((double *) mem_102468)[new_index_87880 *
                                                             (int64_t) 784 +
                                                             new_index_87888 *
                                                             (int64_t) 28 +
                                                             new_index_87905];
                    double defunc_1_op_res_73762 = x_73763 + redout_86201;
                    double redout_tmp_114392 = defunc_1_op_res_73762;
                    
                    redout_86201 = redout_tmp_114392;
                }
                defunc_2_reduce_res_84127 = redout_86201;
                
                double x_73765 = 0.9 * x_73756;
                double y_73766 = 9.999999999999998e-2 *
                       defunc_2_reduce_res_84127;
                double m_dw_73767 = x_73765 + y_73766;
                double x_73768 = 0.999 * x_73757;
                double y_73769 = fpow64(defunc_2_reduce_res_84127, 2.0);
                double y_73770 = 1.0000000000000009e-3 * y_73769;
                double v_dw_73771 = x_73768 + y_73770;
                double m_dw_corr_73772 = m_dw_73767 / y_56527;
                double v_dw_corr_73773 = v_dw_73771 / y_56531;
                double sqrt_res_73774 = futrts_sqrt64(v_dw_corr_73773);
                double y_73775 = 1.0e-8 + sqrt_res_73774;
                double y_73776 = m_dw_corr_73772 / y_73775;
                double y_73777 = 3.0e-4 * y_73776;
                double new_w_73778 = x_73758 - y_73777;
                
                ((double *) mem_107135.mem)[i_86209] = new_w_73778;
                ((double *) mem_107137.mem)[i_86209] = m_dw_73767;
                ((double *) mem_107139.mem)[i_86209] = v_dw_73771;
            }
            if (memblock_alloc(ctx, &mem_107171, (int64_t) 589824,
                               "mem_107171")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_107173, (int64_t) 589824,
                               "mem_107173")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_107175, (int64_t) 589824,
                               "mem_107175")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_107177, (int64_t) 1179648,
                               "mem_107177")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_107179, (int64_t) 1179648,
                               "mem_107179")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_107181, (int64_t) 1179648,
                               "mem_107181")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_107183, (int64_t) 4718592,
                               "mem_107183")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_107185, (int64_t) 4718592,
                               "mem_107185")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_107187, (int64_t) 4718592,
                               "mem_107187")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_107189, (int64_t) 1179648,
                               "mem_107189")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_107191, (int64_t) 1179648,
                               "mem_107191")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_107193, (int64_t) 1179648,
                               "mem_107193")) {
                err = 1;
                goto cleanup;
            }
            for (int32_t i_86870 = 0; i_86870 < 128; i_86870++) {
                int64_t i_86392 = sext_i32_i64(i_86870);
                bool x_76222 = sle64((int64_t) 0, i_86392);
                bool y_76223 = slt64(i_86392, (int64_t) 128);
                bool bounds_check_76224 = x_76222 && y_76223;
                bool index_certs_76225;
                
                if (!bounds_check_76224) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Index [", (long long) i_86392,
                                        "] out of bounds for array of shape [",
                                        (long long) (int64_t) 128, "].",
                                        "-> #0  ../layers/conv2d.fut:34:86-96\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                for (int32_t i_86972 = 0; i_86972 < 128; i_86972++) {
                    int64_t i_86281 = sext_i32_i64(i_86972);
                    bool x_80084 = sle64((int64_t) 0, i_86281);
                    bool y_80085 = slt64(i_86281, (int64_t) 128);
                    bool bounds_check_80086 = x_80084 && y_80085;
                    bool index_certs_80087;
                    
                    if (!bounds_check_80086) {
                        set_error(ctx,
                                  msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                            "Index [", (long long) i_86281,
                                            "] out of bounds for array of shape [",
                                            (long long) (int64_t) 128, "].",
                                            "-> #0  ../layers/conv2d.fut:34:69-81\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    for (int32_t i_87025 = 0; i_87025 < 30; i_87025++) {
                        int64_t i_86224 = sext_i32_i64(i_87025);
                        bool cond_80380 = slt64(i_86224, (int64_t) 1);
                        bool cond_f_res_80381 = sle64((int64_t) 29, i_86224);
                        bool x_80382 = !cond_80380;
                        bool y_80383 = cond_f_res_80381 && x_80382;
                        bool cond_80384 = cond_80380 || y_80383;
                        bool x_80385 = !cond_80384;
                        
                        for (int32_t i_87054 = 0; i_87054 < 30; i_87054++) {
                            int64_t i_86217 = sext_i32_i64(i_87054);
                            bool cond_f_res_80496 = slt64(i_86217, (int64_t) 1);
                            bool y_80497 = x_80385 && cond_f_res_80496;
                            bool cond_80498 = cond_80384 || y_80497;
                            bool cond_f_res_80499 = sle64((int64_t) 29,
                                                          i_86217);
                            bool x_80500 = !cond_80498;
                            bool y_80501 = cond_f_res_80499 && x_80500;
                            bool cond_80502 = cond_80498 || y_80501;
                            double defunc_0_f_res_80503;
                            
                            if (cond_80502 == 1) {
                                defunc_0_f_res_80503 = 0.0;
                            } else {
                                int64_t i_80504 = sub64(i_86224, (int64_t) 1);
                                bool x_80505 = sle64((int64_t) 0, i_80504);
                                bool y_80506 = slt64(i_80504, (int64_t) 28);
                                bool bounds_check_80507 = x_80505 && y_80506;
                                int64_t i_80508 = sub64(i_86217, (int64_t) 1);
                                bool x_80509 = sle64((int64_t) 0, i_80508);
                                bool y_80510 = slt64(i_80508, (int64_t) 28);
                                bool bounds_check_80511 = x_80509 && y_80510;
                                bool index_ok_80512 = bounds_check_80507 &&
                                     bounds_check_80511;
                                bool index_certs_80513;
                                
                                if (!index_ok_80512) {
                                    set_error(ctx,
                                              msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                        "Index [",
                                                        (long long) i_80504,
                                                        ", ",
                                                        (long long) i_80508,
                                                        "] out of bounds for array of shape [",
                                                        (long long) (int64_t) 28,
                                                        "][",
                                                        (long long) (int64_t) 28,
                                                        "].",
                                                        "-> #0  ../layers/conv2d.fut:7:91-116\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  ../layers/conv2d.fut:6:22-7:117\n   #7  ../layers/conv2d.fut:6:6-7:123\n   #8  /prelude/soacs.fut:59:3-10\n   #9  /prelude/array.fut:208:3-34\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                double defunc_0_f_res_f_res_80514 =
                                       ((double *) mem_100015)[i_86281 *
                                                               (int64_t) 784 +
                                                               i_80504 *
                                                               (int64_t) 28 +
                                                               i_80508];
                                
                                defunc_0_f_res_80503 =
                                    defunc_0_f_res_f_res_80514;
                            }
                            
                            double defunc_0_f_res_80523;
                            
                            if (cond_80502 == 1) {
                                defunc_0_f_res_80523 = 0.0;
                            } else {
                                int64_t i_80524 = sub64(i_86224, (int64_t) 1);
                                bool x_80525 = sle64((int64_t) 0, i_80524);
                                bool y_80526 = slt64(i_80524, (int64_t) 28);
                                bool bounds_check_80527 = x_80525 && y_80526;
                                int64_t i_80528 = sub64(i_86217, (int64_t) 1);
                                bool x_80529 = sle64((int64_t) 0, i_80528);
                                bool y_80530 = slt64(i_80528, (int64_t) 28);
                                bool bounds_check_80531 = x_80529 && y_80530;
                                bool index_ok_80532 = bounds_check_80527 &&
                                     bounds_check_80531;
                                bool index_certs_80533;
                                
                                if (!index_ok_80532) {
                                    set_error(ctx,
                                              msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                        "Index [",
                                                        (long long) i_80524,
                                                        ", ",
                                                        (long long) i_80528,
                                                        "] out of bounds for array of shape [",
                                                        (long long) (int64_t) 28,
                                                        "][",
                                                        (long long) (int64_t) 28,
                                                        "].",
                                                        "-> #0  ../layers/conv2d.fut:7:91-116\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  ../layers/conv2d.fut:6:22-7:117\n   #7  ../layers/conv2d.fut:6:6-7:123\n   #8  /prelude/soacs.fut:59:3-10\n   #9  /prelude/array.fut:208:3-34\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                double defunc_0_f_res_f_res_80534 =
                                       ((double *) mem_98231)[i_86281 *
                                                              (int64_t) 784 +
                                                              i_80524 *
                                                              (int64_t) 28 +
                                                              i_80528];
                                
                                defunc_0_f_res_80523 =
                                    defunc_0_f_res_f_res_80534;
                            }
                            ((double *) mem_107459)[i_86224 * (int64_t) 30 +
                                                    i_86217] =
                                defunc_0_f_res_80523;
                            ((double *) mem_107461)[i_86224 * (int64_t) 30 +
                                                    i_86217] =
                                defunc_0_f_res_80503;
                        }
                    }
                    for (int32_t i_87026 = 0; i_87026 < 3; i_87026++) {
                        int64_t i_86262 = sext_i32_i64(i_87026);
                        int64_t j_80960 = add64((int64_t) 28, i_86262);
                        int64_t i_p_m_t_s_80961 = add64((int64_t) 27, i_86262);
                        bool zzero_leq_i_p_m_t_s_80962 = sle64((int64_t) 0,
                                                               i_p_m_t_s_80961);
                        bool i_p_m_t_s_leq_w_80963 = slt64(i_p_m_t_s_80961,
                                                           (int64_t) 30);
                        bool zzero_lte_i_80964 = sle64((int64_t) 0, i_86262);
                        bool i_lte_j_80965 = sle64(i_86262, j_80960);
                        bool y_80966 = i_p_m_t_s_leq_w_80963 &&
                             zzero_lte_i_80964;
                        bool y_80967 = zzero_leq_i_p_m_t_s_80962 && y_80966;
                        bool y_80968 = i_lte_j_80965 && y_80967;
                        bool forwards_ok_80969 = zzero_lte_i_80964 && y_80968;
                        
                        for (int32_t i_87027 = 0; i_87027 < 3; i_87027++) {
                            int64_t i_86243 = sext_i32_i64(i_87027);
                            double x_81136 =
                                   ((double *) mem_param_97466.mem)[i_86392 *
                                                                    (int64_t) 1152 +
                                                                    i_86281 *
                                                                    (int64_t) 9 +
                                                                    i_86262 *
                                                                    (int64_t) 3 +
                                                                    i_86243];
                            double x_81137 =
                                   ((double *) mem_param_97485.mem)[i_86392 *
                                                                    (int64_t) 1152 +
                                                                    i_86281 *
                                                                    (int64_t) 9 +
                                                                    i_86262 *
                                                                    (int64_t) 3 +
                                                                    i_86243];
                            double x_81138 =
                                   ((double *) mem_param_97071.mem)[i_86392 *
                                                                    (int64_t) 1152 +
                                                                    i_86281 *
                                                                    (int64_t) 9 +
                                                                    i_86262 *
                                                                    (int64_t) 3 +
                                                                    i_86243];
                            double x_81140 =
                                   ((double *) mem_param_97262.mem)[i_86392 *
                                                                    (int64_t) 1152 +
                                                                    i_86281 *
                                                                    (int64_t) 9 +
                                                                    i_86262 *
                                                                    (int64_t) 3 +
                                                                    i_86243];
                            double x_81141 =
                                   ((double *) mem_param_97281.mem)[i_86392 *
                                                                    (int64_t) 1152 +
                                                                    i_86281 *
                                                                    (int64_t) 9 +
                                                                    i_86262 *
                                                                    (int64_t) 3 +
                                                                    i_86243];
                            double x_81142 =
                                   ((double *) mem_param_96969.mem)[i_86392 *
                                                                    (int64_t) 1152 +
                                                                    i_86281 *
                                                                    (int64_t) 9 +
                                                                    i_86262 *
                                                                    (int64_t) 3 +
                                                                    i_86243];
                            int64_t j_81143 = add64((int64_t) 28, i_86243);
                            int64_t i_p_m_t_s_81144 = add64((int64_t) 27,
                                                            i_86243);
                            bool zzero_leq_i_p_m_t_s_81145 = sle64((int64_t) 0,
                                                                   i_p_m_t_s_81144);
                            bool i_p_m_t_s_leq_w_81146 = slt64(i_p_m_t_s_81144,
                                                               (int64_t) 30);
                            bool zzero_lte_i_81147 = sle64((int64_t) 0,
                                                           i_86243);
                            bool i_lte_j_81148 = sle64(i_86243, j_81143);
                            bool y_81149 = i_p_m_t_s_leq_w_81146 &&
                                 zzero_lte_i_81147;
                            bool y_81150 = zzero_leq_i_p_m_t_s_81145 && y_81149;
                            bool y_81151 = i_lte_j_81148 && y_81150;
                            bool forwards_ok_81152 = zzero_lte_i_81147 &&
                                 y_81151;
                            bool index_ok_81153 = forwards_ok_80969 &&
                                 forwards_ok_81152;
                            bool index_certs_81154;
                            
                            if (!index_ok_81153) {
                                set_error(ctx,
                                          msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                    "Index [",
                                                    (long long) i_86262, ":",
                                                    (long long) j_80960, ", ",
                                                    (long long) i_86243, ":",
                                                    (long long) j_81143,
                                                    "] out of bounds for array of shape [",
                                                    (long long) (int64_t) 30,
                                                    "][",
                                                    (long long) (int64_t) 30,
                                                    "].",
                                                    "-> #0  ../layers/conv2d.fut:13:90-124\n   #1  ../layers/conv2d.fut:13:69-146\n   #2  /prelude/soacs.fut:59:3-10\n   #3  /prelude/array.fut:200:3-17\n   #4  /prelude/functional.fut:39:59-65\n   #5  /prelude/soacs.fut:59:3-10\n   #6  /prelude/array.fut:208:3-34\n   #7  ../layers/conv2d.fut:13:26-162\n   #8  /prelude/soacs.fut:59:3-10\n   #9  /prelude/array.fut:208:3-34\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            double defunc_2_reduce_res_84130;
                            double redout_86227 = 0.0;
                            
                            for (int32_t i_87028 = 0; i_87028 < 784;
                                 i_87028++) {
                                int64_t i_86228 = sext_i32_i64(i_87028);
                                int64_t new_index_87040 = squot64(i_86228,
                                                                  (int64_t) 28);
                                int64_t binop_y_87042 = (int64_t) 28 *
                                        new_index_87040;
                                int64_t new_index_87043 = i_86228 -
                                        binop_y_87042;
                                double x_81204 =
                                       ((double *) mem_102956)[i_86392 *
                                                               (int64_t) 784 +
                                                               new_index_87040 *
                                                               (int64_t) 28 +
                                                               new_index_87043];
                                int64_t slice_87048 = i_86262 + new_index_87040;
                                int64_t slice_87049 = i_86243 + new_index_87043;
                                double x_81205 =
                                       ((double *) mem_107461)[slice_87048 *
                                                               (int64_t) 30 +
                                                               slice_87049];
                                double defunc_1_f_res_81206 = x_81204 * x_81205;
                                double defunc_1_op_res_81203 =
                                       defunc_1_f_res_81206 + redout_86227;
                                double redout_tmp_114427 =
                                       defunc_1_op_res_81203;
                                
                                redout_86227 = redout_tmp_114427;
                            }
                            defunc_2_reduce_res_84130 = redout_86227;
                            
                            double defunc_2_reduce_res_84132;
                            double redout_86229 = 0.0;
                            
                            for (int32_t i_87029 = 0; i_87029 < 784;
                                 i_87029++) {
                                int64_t i_86230 = sext_i32_i64(i_87029);
                                int64_t new_index_87030 = squot64(i_86230,
                                                                  (int64_t) 28);
                                int64_t binop_y_87032 = (int64_t) 28 *
                                        new_index_87030;
                                int64_t new_index_87033 = i_86230 -
                                        binop_y_87032;
                                double x_81179 =
                                       ((double *) mem_105076)[i_86392 *
                                                               (int64_t) 784 +
                                                               new_index_87030 *
                                                               (int64_t) 28 +
                                                               new_index_87033];
                                int64_t slice_87038 = i_86262 + new_index_87030;
                                int64_t slice_87039 = i_86243 + new_index_87033;
                                double x_81180 =
                                       ((double *) mem_107459)[slice_87038 *
                                                               (int64_t) 30 +
                                                               slice_87039];
                                double defunc_1_f_res_81181 = x_81179 * x_81180;
                                double defunc_1_op_res_81178 =
                                       defunc_1_f_res_81181 + redout_86229;
                                double redout_tmp_114428 =
                                       defunc_1_op_res_81178;
                                
                                redout_86229 = redout_tmp_114428;
                            }
                            defunc_2_reduce_res_84132 = redout_86229;
                            
                            double x_81182 = 0.9 * x_81140;
                            double y_81183 = 9.999999999999998e-2 *
                                   defunc_2_reduce_res_84132;
                            double m_dw_81184 = x_81182 + y_81183;
                            double x_81185 = 0.999 * x_81141;
                            double y_81186 = fpow64(defunc_2_reduce_res_84132,
                                                    2.0);
                            double y_81187 = 1.0000000000000009e-3 * y_81186;
                            double v_dw_81188 = x_81185 + y_81187;
                            double m_dw_corr_81189 = m_dw_81184 / y_56527;
                            double v_dw_corr_81190 = v_dw_81188 / y_56531;
                            double sqrt_res_81191 =
                                   futrts_sqrt64(v_dw_corr_81190);
                            double y_81192 = 1.0e-8 + sqrt_res_81191;
                            double y_81193 = m_dw_corr_81189 / y_81192;
                            double y_81194 = 3.0e-4 * y_81193;
                            double new_w_81195 = x_81142 - y_81194;
                            double x_81207 = 0.9 * x_81136;
                            double y_81208 = 9.999999999999998e-2 *
                                   defunc_2_reduce_res_84130;
                            double m_dw_81209 = x_81207 + y_81208;
                            double x_81210 = 0.999 * x_81137;
                            double y_81211 = fpow64(defunc_2_reduce_res_84130,
                                                    2.0);
                            double y_81212 = 1.0000000000000009e-3 * y_81211;
                            double v_dw_81213 = x_81210 + y_81212;
                            double m_dw_corr_81214 = m_dw_81209 / y_56527;
                            double v_dw_corr_81215 = v_dw_81213 / y_56531;
                            double sqrt_res_81216 =
                                   futrts_sqrt64(v_dw_corr_81215);
                            double y_81217 = 1.0e-8 + sqrt_res_81216;
                            double y_81218 = m_dw_corr_81214 / y_81217;
                            double y_81219 = 3.0e-4 * y_81218;
                            double new_w_81220 = x_81138 - y_81219;
                            
                            ((double *) mem_107189.mem)[i_86392 *
                                                        (int64_t) 1152 +
                                                        i_86281 * (int64_t) 9 +
                                                        i_86262 * (int64_t) 3 +
                                                        i_86243] = new_w_81220;
                            ((double *) mem_107191.mem)[i_86392 *
                                                        (int64_t) 1152 +
                                                        i_86281 * (int64_t) 9 +
                                                        i_86262 * (int64_t) 3 +
                                                        i_86243] = m_dw_81209;
                            ((double *) mem_107193.mem)[i_86392 *
                                                        (int64_t) 1152 +
                                                        i_86281 * (int64_t) 9 +
                                                        i_86262 * (int64_t) 3 +
                                                        i_86243] = v_dw_81213;
                            ((double *) mem_107177.mem)[i_86392 *
                                                        (int64_t) 1152 +
                                                        i_86281 * (int64_t) 9 +
                                                        i_86262 * (int64_t) 3 +
                                                        i_86243] = new_w_81195;
                            ((double *) mem_107179.mem)[i_86392 *
                                                        (int64_t) 1152 +
                                                        i_86281 * (int64_t) 9 +
                                                        i_86262 * (int64_t) 3 +
                                                        i_86243] = m_dw_81184;
                            ((double *) mem_107181.mem)[i_86392 *
                                                        (int64_t) 1152 +
                                                        i_86281 * (int64_t) 9 +
                                                        i_86262 * (int64_t) 3 +
                                                        i_86243] = v_dw_81188;
                        }
                    }
                }
                for (int32_t i_86973 = 0; i_86973 < 512; i_86973++) {
                    int64_t i_86324 = sext_i32_i64(i_86973);
                    bool x_79854 = sle64((int64_t) 0, i_86324);
                    bool y_79855 = slt64(i_86324, (int64_t) 512);
                    bool bounds_check_79856 = x_79854 && y_79855;
                    bool index_certs_79857;
                    
                    if (!bounds_check_79856) {
                        set_error(ctx,
                                  msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                            "Index [", (long long) i_86324,
                                            "] out of bounds for array of shape [",
                                            (long long) (int64_t) 512, "].",
                                            "-> #0  ../layers/conv2d.fut:34:69-81\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    for (int32_t i_87000 = 0; i_87000 < 30; i_87000++) {
                        int64_t i_86294 = sext_i32_i64(i_87000);
                        bool cond_79860 = slt64(i_86294, (int64_t) 1);
                        bool cond_f_res_79861 = sle64((int64_t) 29, i_86294);
                        bool x_79862 = !cond_79860;
                        bool y_79863 = cond_f_res_79861 && x_79862;
                        bool cond_79864 = cond_79860 || y_79863;
                        bool x_79865 = !cond_79864;
                        
                        for (int32_t i_87018 = 0; i_87018 < 30; i_87018++) {
                            int64_t i_86290 = sext_i32_i64(i_87018);
                            bool cond_f_res_79868 = slt64(i_86290, (int64_t) 1);
                            bool y_79869 = x_79865 && cond_f_res_79868;
                            bool cond_79870 = cond_79864 || y_79869;
                            bool cond_f_res_79871 = sle64((int64_t) 29,
                                                          i_86290);
                            bool x_79872 = !cond_79870;
                            bool y_79873 = cond_f_res_79871 && x_79872;
                            bool cond_79874 = cond_79870 || y_79873;
                            double defunc_0_f_res_79875;
                            
                            if (cond_79874 == 1) {
                                defunc_0_f_res_79875 = 0.0;
                            } else {
                                int64_t i_79876 = sub64(i_86294, (int64_t) 1);
                                bool x_79877 = sle64((int64_t) 0, i_79876);
                                bool y_79878 = slt64(i_79876, (int64_t) 28);
                                bool bounds_check_79879 = x_79877 && y_79878;
                                int64_t i_79880 = sub64(i_86290, (int64_t) 1);
                                bool x_79881 = sle64((int64_t) 0, i_79880);
                                bool y_79882 = slt64(i_79880, (int64_t) 28);
                                bool bounds_check_79883 = x_79881 && y_79882;
                                bool index_ok_79884 = bounds_check_79879 &&
                                     bounds_check_79883;
                                bool index_certs_79885;
                                
                                if (!index_ok_79884) {
                                    set_error(ctx,
                                              msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                        "Index [",
                                                        (long long) i_79876,
                                                        ", ",
                                                        (long long) i_79880,
                                                        "] out of bounds for array of shape [",
                                                        (long long) (int64_t) 28,
                                                        "][",
                                                        (long long) (int64_t) 28,
                                                        "].",
                                                        "-> #0  ../layers/conv2d.fut:7:91-116\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  ../layers/conv2d.fut:6:22-7:117\n   #7  ../layers/conv2d.fut:6:6-7:123\n   #8  /prelude/soacs.fut:59:3-10\n   #9  /prelude/array.fut:208:3-34\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool index_concat_cmp_79886 =
                                     sle64((int64_t) 256, i_86324);
                                double index_concat_branch_79887;
                                
                                if (index_concat_cmp_79886 == 1) {
                                    int64_t index_concat_i_84148 =
                                            sub64(i_86324, (int64_t) 256);
                                    double index_concat_84149 =
                                           ((double *) mem_99615)[index_concat_i_84148 *
                                                                  (int64_t) 784 +
                                                                  i_79876 *
                                                                  (int64_t) 28 +
                                                                  i_79880];
                                    
                                    index_concat_branch_79887 =
                                        index_concat_84149;
                                } else {
                                    double index_concat_79890 =
                                           ((double *) mem_99615)[i_86324 *
                                                                  (int64_t) 784 +
                                                                  i_79876 *
                                                                  (int64_t) 28 +
                                                                  i_79880];
                                    
                                    index_concat_branch_79887 =
                                        index_concat_79890;
                                }
                                defunc_0_f_res_79875 =
                                    index_concat_branch_79887;
                            }
                            ((double *) mem_108175)[i_86294 * (int64_t) 30 +
                                                    i_86290] =
                                defunc_0_f_res_79875;
                        }
                    }
                    for (int32_t i_87001 = 0; i_87001 < 3; i_87001++) {
                        int64_t i_86314 = sext_i32_i64(i_87001);
                        int64_t j_81260 = add64((int64_t) 28, i_86314);
                        int64_t i_p_m_t_s_81261 = add64((int64_t) 27, i_86314);
                        bool zzero_leq_i_p_m_t_s_81262 = sle64((int64_t) 0,
                                                               i_p_m_t_s_81261);
                        bool i_p_m_t_s_leq_w_81263 = slt64(i_p_m_t_s_81261,
                                                           (int64_t) 30);
                        bool zzero_lte_i_81264 = sle64((int64_t) 0, i_86314);
                        bool i_lte_j_81265 = sle64(i_86314, j_81260);
                        bool y_81266 = i_p_m_t_s_leq_w_81263 &&
                             zzero_lte_i_81264;
                        bool y_81267 = zzero_leq_i_p_m_t_s_81262 && y_81266;
                        bool y_81268 = i_lte_j_81265 && y_81267;
                        bool forwards_ok_81269 = zzero_lte_i_81264 && y_81268;
                        
                        for (int32_t i_87002 = 0; i_87002 < 3; i_87002++) {
                            int64_t i_86304 = sext_i32_i64(i_87002);
                            double x_81321 =
                                   ((double *) mem_param_97402.mem)[i_86392 *
                                                                    (int64_t) 4608 +
                                                                    i_86324 *
                                                                    (int64_t) 9 +
                                                                    i_86314 *
                                                                    (int64_t) 3 +
                                                                    i_86304];
                            double x_81322 =
                                   ((double *) mem_param_97421.mem)[i_86392 *
                                                                    (int64_t) 4608 +
                                                                    i_86324 *
                                                                    (int64_t) 9 +
                                                                    i_86314 *
                                                                    (int64_t) 3 +
                                                                    i_86304];
                            double x_81323 =
                                   ((double *) mem_param_97039.mem)[i_86392 *
                                                                    (int64_t) 4608 +
                                                                    i_86324 *
                                                                    (int64_t) 9 +
                                                                    i_86314 *
                                                                    (int64_t) 3 +
                                                                    i_86304];
                            int64_t j_81324 = add64((int64_t) 28, i_86304);
                            int64_t i_p_m_t_s_81325 = add64((int64_t) 27,
                                                            i_86304);
                            bool zzero_leq_i_p_m_t_s_81326 = sle64((int64_t) 0,
                                                                   i_p_m_t_s_81325);
                            bool i_p_m_t_s_leq_w_81327 = slt64(i_p_m_t_s_81325,
                                                               (int64_t) 30);
                            bool zzero_lte_i_81328 = sle64((int64_t) 0,
                                                           i_86304);
                            bool i_lte_j_81329 = sle64(i_86304, j_81324);
                            bool y_81330 = i_p_m_t_s_leq_w_81327 &&
                                 zzero_lte_i_81328;
                            bool y_81331 = zzero_leq_i_p_m_t_s_81326 && y_81330;
                            bool y_81332 = i_lte_j_81329 && y_81331;
                            bool forwards_ok_81333 = zzero_lte_i_81328 &&
                                 y_81332;
                            bool index_ok_81334 = forwards_ok_81269 &&
                                 forwards_ok_81333;
                            bool index_certs_81335;
                            
                            if (!index_ok_81334) {
                                set_error(ctx,
                                          msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                    "Index [",
                                                    (long long) i_86314, ":",
                                                    (long long) j_81260, ", ",
                                                    (long long) i_86304, ":",
                                                    (long long) j_81324,
                                                    "] out of bounds for array of shape [",
                                                    (long long) (int64_t) 30,
                                                    "][",
                                                    (long long) (int64_t) 30,
                                                    "].",
                                                    "-> #0  ../layers/conv2d.fut:13:90-124\n   #1  ../layers/conv2d.fut:13:69-146\n   #2  /prelude/soacs.fut:59:3-10\n   #3  /prelude/array.fut:200:3-17\n   #4  /prelude/functional.fut:39:59-65\n   #5  /prelude/soacs.fut:59:3-10\n   #6  /prelude/array.fut:208:3-34\n   #7  ../layers/conv2d.fut:13:26-162\n   #8  /prelude/soacs.fut:59:3-10\n   #9  /prelude/array.fut:208:3-34\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            double defunc_2_reduce_res_84151;
                            double redout_86296 = 0.0;
                            
                            for (int32_t i_87003 = 0; i_87003 < 784;
                                 i_87003++) {
                                int64_t i_86297 = sext_i32_i64(i_87003);
                                int64_t new_index_87004 = squot64(i_86297,
                                                                  (int64_t) 28);
                                int64_t binop_y_87006 = (int64_t) 28 *
                                        new_index_87004;
                                int64_t new_index_87007 = i_86297 -
                                        binop_y_87006;
                                double x_81344 =
                                       ((double *) mem_103444)[i_86392 *
                                                               (int64_t) 784 +
                                                               new_index_87004 *
                                                               (int64_t) 28 +
                                                               new_index_87007];
                                int64_t slice_87012 = i_86314 + new_index_87004;
                                int64_t slice_87013 = i_86304 + new_index_87007;
                                double x_81345 =
                                       ((double *) mem_108175)[slice_87012 *
                                                               (int64_t) 30 +
                                                               slice_87013];
                                double defunc_1_f_res_81346 = x_81344 * x_81345;
                                double defunc_1_op_res_81343 =
                                       defunc_1_f_res_81346 + redout_86296;
                                double redout_tmp_114440 =
                                       defunc_1_op_res_81343;
                                
                                redout_86296 = redout_tmp_114440;
                            }
                            defunc_2_reduce_res_84151 = redout_86296;
                            
                            double x_81347 = 0.9 * x_81321;
                            double y_81348 = 9.999999999999998e-2 *
                                   defunc_2_reduce_res_84151;
                            double m_dw_81349 = x_81347 + y_81348;
                            double x_81350 = 0.999 * x_81322;
                            double y_81351 = fpow64(defunc_2_reduce_res_84151,
                                                    2.0);
                            double y_81352 = 1.0000000000000009e-3 * y_81351;
                            double v_dw_81353 = x_81350 + y_81352;
                            double m_dw_corr_81354 = m_dw_81349 / y_56527;
                            double v_dw_corr_81355 = v_dw_81353 / y_56531;
                            double sqrt_res_81356 =
                                   futrts_sqrt64(v_dw_corr_81355);
                            double y_81357 = 1.0e-8 + sqrt_res_81356;
                            double y_81358 = m_dw_corr_81354 / y_81357;
                            double y_81359 = 3.0e-4 * y_81358;
                            double new_w_81360 = x_81323 - y_81359;
                            
                            ((double *) mem_107183.mem)[i_86392 *
                                                        (int64_t) 4608 +
                                                        i_86324 * (int64_t) 9 +
                                                        i_86314 * (int64_t) 3 +
                                                        i_86304] = new_w_81360;
                            ((double *) mem_107185.mem)[i_86392 *
                                                        (int64_t) 4608 +
                                                        i_86324 * (int64_t) 9 +
                                                        i_86314 * (int64_t) 3 +
                                                        i_86304] = m_dw_81349;
                            ((double *) mem_107187.mem)[i_86392 *
                                                        (int64_t) 4608 +
                                                        i_86324 * (int64_t) 9 +
                                                        i_86314 * (int64_t) 3 +
                                                        i_86304] = v_dw_81353;
                        }
                    }
                }
                for (int32_t i_86974 = 0; i_86974 < 64; i_86974++) {
                    int64_t i_86364 = sext_i32_i64(i_86974);
                    bool x_79625 = sle64((int64_t) 0, i_86364);
                    bool y_79626 = slt64(i_86364, (int64_t) 64);
                    bool bounds_check_79627 = x_79625 && y_79626;
                    bool index_certs_79628;
                    
                    if (!bounds_check_79627) {
                        set_error(ctx,
                                  msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                            "Index [", (long long) i_86364,
                                            "] out of bounds for array of shape [",
                                            (long long) (int64_t) 64, "].",
                                            "-> #0  ../layers/conv2d.fut:34:69-81\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    for (int32_t i_86975 = 0; i_86975 < 30; i_86975++) {
                        int64_t i_86334 = sext_i32_i64(i_86975);
                        bool cond_79631 = slt64(i_86334, (int64_t) 1);
                        bool cond_f_res_79632 = sle64((int64_t) 29, i_86334);
                        bool x_79633 = !cond_79631;
                        bool y_79634 = cond_f_res_79632 && x_79633;
                        bool cond_79635 = cond_79631 || y_79634;
                        bool x_79636 = !cond_79635;
                        
                        for (int32_t i_86993 = 0; i_86993 < 30; i_86993++) {
                            int64_t i_86330 = sext_i32_i64(i_86993);
                            bool cond_f_res_79639 = slt64(i_86330, (int64_t) 1);
                            bool y_79640 = x_79636 && cond_f_res_79639;
                            bool cond_79641 = cond_79635 || y_79640;
                            bool cond_f_res_79642 = sle64((int64_t) 29,
                                                          i_86330);
                            bool x_79643 = !cond_79641;
                            bool y_79644 = cond_f_res_79642 && x_79643;
                            bool cond_79645 = cond_79641 || y_79644;
                            double defunc_0_f_res_79646;
                            
                            if (cond_79645 == 1) {
                                defunc_0_f_res_79646 = 0.0;
                            } else {
                                int64_t i_79647 = sub64(i_86334, (int64_t) 1);
                                bool x_79648 = sle64((int64_t) 0, i_79647);
                                bool y_79649 = slt64(i_79647, (int64_t) 28);
                                bool bounds_check_79650 = x_79648 && y_79649;
                                int64_t i_79651 = sub64(i_86330, (int64_t) 1);
                                bool x_79652 = sle64((int64_t) 0, i_79651);
                                bool y_79653 = slt64(i_79651, (int64_t) 28);
                                bool bounds_check_79654 = x_79652 && y_79653;
                                bool index_ok_79655 = bounds_check_79650 &&
                                     bounds_check_79654;
                                bool index_certs_79656;
                                
                                if (!index_ok_79655) {
                                    set_error(ctx,
                                              msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                        "Index [",
                                                        (long long) i_79647,
                                                        ", ",
                                                        (long long) i_79651,
                                                        "] out of bounds for array of shape [",
                                                        (long long) (int64_t) 28,
                                                        "][",
                                                        (long long) (int64_t) 28,
                                                        "].",
                                                        "-> #0  ../layers/conv2d.fut:7:91-116\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  ../layers/conv2d.fut:6:22-7:117\n   #7  ../layers/conv2d.fut:6:6-7:123\n   #8  /prelude/soacs.fut:59:3-10\n   #9  /prelude/array.fut:208:3-34\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t binop_x_79658 = flat_dim_55927 *
                                        i_86364;
                                int64_t binop_y_79659 = new_m_55822 * i_79647;
                                int64_t binop_x_79660 = binop_x_79658 +
                                        binop_y_79659;
                                int64_t binop_x_79661 = i_79651 + binop_x_79660;
                                int64_t new_index_79662 = squot64(binop_x_79661,
                                                                  flat_dim_55927);
                                int64_t binop_y_79663 = flat_dim_55927 *
                                        new_index_79662;
                                int64_t new_index_79664 = binop_x_79661 -
                                        binop_y_79663;
                                double defunc_0_f_res_f_res_79665 =
                                       ((double *) mem_97872)[new_index_79662 *
                                                              flat_dim_55927 +
                                                              new_index_79664];
                                
                                defunc_0_f_res_79646 =
                                    defunc_0_f_res_f_res_79665;
                            }
                            ((double *) mem_108557)[i_86334 * (int64_t) 30 +
                                                    i_86330] =
                                defunc_0_f_res_79646;
                        }
                    }
                    for (int32_t i_86976 = 0; i_86976 < 3; i_86976++) {
                        int64_t i_86354 = sext_i32_i64(i_86976);
                        int64_t j_81385 = add64((int64_t) 28, i_86354);
                        int64_t i_p_m_t_s_81386 = add64((int64_t) 27, i_86354);
                        bool zzero_leq_i_p_m_t_s_81387 = sle64((int64_t) 0,
                                                               i_p_m_t_s_81386);
                        bool i_p_m_t_s_leq_w_81388 = slt64(i_p_m_t_s_81386,
                                                           (int64_t) 30);
                        bool zzero_lte_i_81389 = sle64((int64_t) 0, i_86354);
                        bool i_lte_j_81390 = sle64(i_86354, j_81385);
                        bool y_81391 = i_p_m_t_s_leq_w_81388 &&
                             zzero_lte_i_81389;
                        bool y_81392 = zzero_leq_i_p_m_t_s_81387 && y_81391;
                        bool y_81393 = i_lte_j_81390 && y_81392;
                        bool forwards_ok_81394 = zzero_lte_i_81389 && y_81393;
                        
                        for (int32_t i_86977 = 0; i_86977 < 3; i_86977++) {
                            int64_t i_86344 = sext_i32_i64(i_86977);
                            double x_81444 =
                                   ((double *) mem_param_97198.mem)[i_86392 *
                                                                    (int64_t) 576 +
                                                                    i_86364 *
                                                                    (int64_t) 9 +
                                                                    i_86354 *
                                                                    (int64_t) 3 +
                                                                    i_86344];
                            double x_81445 =
                                   ((double *) mem_param_97217.mem)[i_86392 *
                                                                    (int64_t) 576 +
                                                                    i_86364 *
                                                                    (int64_t) 9 +
                                                                    i_86354 *
                                                                    (int64_t) 3 +
                                                                    i_86344];
                            double x_81446 =
                                   ((double *) mem_param_96937.mem)[i_86392 *
                                                                    (int64_t) 576 +
                                                                    i_86364 *
                                                                    (int64_t) 9 +
                                                                    i_86354 *
                                                                    (int64_t) 3 +
                                                                    i_86344];
                            int64_t j_81447 = add64((int64_t) 28, i_86344);
                            int64_t i_p_m_t_s_81448 = add64((int64_t) 27,
                                                            i_86344);
                            bool zzero_leq_i_p_m_t_s_81449 = sle64((int64_t) 0,
                                                                   i_p_m_t_s_81448);
                            bool i_p_m_t_s_leq_w_81450 = slt64(i_p_m_t_s_81448,
                                                               (int64_t) 30);
                            bool zzero_lte_i_81451 = sle64((int64_t) 0,
                                                           i_86344);
                            bool i_lte_j_81452 = sle64(i_86344, j_81447);
                            bool y_81453 = i_p_m_t_s_leq_w_81450 &&
                                 zzero_lte_i_81451;
                            bool y_81454 = zzero_leq_i_p_m_t_s_81449 && y_81453;
                            bool y_81455 = i_lte_j_81452 && y_81454;
                            bool forwards_ok_81456 = zzero_lte_i_81451 &&
                                 y_81455;
                            bool index_ok_81457 = forwards_ok_81394 &&
                                 forwards_ok_81456;
                            bool index_certs_81458;
                            
                            if (!index_ok_81457) {
                                set_error(ctx,
                                          msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                    "Index [",
                                                    (long long) i_86354, ":",
                                                    (long long) j_81385, ", ",
                                                    (long long) i_86344, ":",
                                                    (long long) j_81447,
                                                    "] out of bounds for array of shape [",
                                                    (long long) (int64_t) 30,
                                                    "][",
                                                    (long long) (int64_t) 30,
                                                    "].",
                                                    "-> #0  ../layers/conv2d.fut:13:90-124\n   #1  ../layers/conv2d.fut:13:69-146\n   #2  /prelude/soacs.fut:59:3-10\n   #3  /prelude/array.fut:200:3-17\n   #4  /prelude/functional.fut:39:59-65\n   #5  /prelude/soacs.fut:59:3-10\n   #6  /prelude/array.fut:208:3-34\n   #7  ../layers/conv2d.fut:13:26-162\n   #8  /prelude/soacs.fut:59:3-10\n   #9  /prelude/array.fut:208:3-34\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            double defunc_2_reduce_res_84161;
                            double redout_86336 = 0.0;
                            
                            for (int32_t i_86978 = 0; i_86978 < 784;
                                 i_86978++) {
                                int64_t i_86337 = sext_i32_i64(i_86978);
                                int64_t new_index_86979 = squot64(i_86337,
                                                                  (int64_t) 28);
                                int64_t binop_y_86981 = (int64_t) 28 *
                                        new_index_86979;
                                int64_t new_index_86982 = i_86337 -
                                        binop_y_86981;
                                double x_81467 =
                                       ((double *) mem_105564)[i_86392 *
                                                               (int64_t) 784 +
                                                               new_index_86979 *
                                                               (int64_t) 28 +
                                                               new_index_86982];
                                int64_t slice_86987 = i_86354 + new_index_86979;
                                int64_t slice_86988 = i_86344 + new_index_86982;
                                double x_81468 =
                                       ((double *) mem_108557)[slice_86987 *
                                                               (int64_t) 30 +
                                                               slice_86988];
                                double defunc_1_f_res_81469 = x_81467 * x_81468;
                                double defunc_1_op_res_81466 =
                                       defunc_1_f_res_81469 + redout_86336;
                                double redout_tmp_114452 =
                                       defunc_1_op_res_81466;
                                
                                redout_86336 = redout_tmp_114452;
                            }
                            defunc_2_reduce_res_84161 = redout_86336;
                            
                            double x_81470 = 0.9 * x_81444;
                            double y_81471 = 9.999999999999998e-2 *
                                   defunc_2_reduce_res_84161;
                            double m_dw_81472 = x_81470 + y_81471;
                            double x_81473 = 0.999 * x_81445;
                            double y_81474 = fpow64(defunc_2_reduce_res_84161,
                                                    2.0);
                            double y_81475 = 1.0000000000000009e-3 * y_81474;
                            double v_dw_81476 = x_81473 + y_81475;
                            double m_dw_corr_81477 = m_dw_81472 / y_56527;
                            double v_dw_corr_81478 = v_dw_81476 / y_56531;
                            double sqrt_res_81479 =
                                   futrts_sqrt64(v_dw_corr_81478);
                            double y_81480 = 1.0e-8 + sqrt_res_81479;
                            double y_81481 = m_dw_corr_81477 / y_81480;
                            double y_81482 = 3.0e-4 * y_81481;
                            double new_w_81483 = x_81446 - y_81482;
                            
                            ((double *) mem_107171.mem)[i_86392 *
                                                        (int64_t) 576 +
                                                        i_86364 * (int64_t) 9 +
                                                        i_86354 * (int64_t) 3 +
                                                        i_86344] = new_w_81483;
                            ((double *) mem_107173.mem)[i_86392 *
                                                        (int64_t) 576 +
                                                        i_86364 * (int64_t) 9 +
                                                        i_86354 * (int64_t) 3 +
                                                        i_86344] = m_dw_81472;
                            ((double *) mem_107175.mem)[i_86392 *
                                                        (int64_t) 576 +
                                                        i_86364 * (int64_t) 9 +
                                                        i_86354 * (int64_t) 3 +
                                                        i_86344] = v_dw_81476;
                        }
                    }
                }
            }
            if (memblock_alloc(ctx, &mem_109059, (int64_t) 1024,
                               "mem_109059")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_109061, (int64_t) 1024,
                               "mem_109061")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_109063, (int64_t) 1024,
                               "mem_109063")) {
                err = 1;
                goto cleanup;
            }
            for (int32_t i_86871 = 0; i_86871 < 128; i_86871++) {
                int64_t i_86413 = sext_i32_i64(i_86871);
                double x_73564 = ((double *) mem_param_97471.mem)[i_86413];
                double x_73565 = ((double *) mem_param_97490.mem)[i_86413];
                double x_73566 = ((double *) mem_param_97076.mem)[i_86413];
                int64_t binop_x_87850 = (int64_t) 784 * i_86413;
                double defunc_2_reduce_res_84182;
                double redout_86405 = 0.0;
                
                for (int32_t i_86971 = 0; i_86971 < 784; i_86971++) {
                    int64_t i_86406 = sext_i32_i64(i_86971);
                    int64_t binop_x_87851 = i_86406 + binop_x_87850;
                    int64_t new_index_87852 = squot64(binop_x_87851,
                                                      (int64_t) 784);
                    int64_t binop_y_87858 = (int64_t) 784 * new_index_87852;
                    int64_t binop_x_87859 = binop_x_87851 - binop_y_87858;
                    int64_t new_index_87860 = squot64(binop_x_87859,
                                                      (int64_t) 28);
                    int64_t binop_y_87876 = (int64_t) 28 * new_index_87860;
                    int64_t new_index_87877 = binop_x_87859 - binop_y_87876;
                    double x_73572 = ((double *) mem_102956)[new_index_87852 *
                                                             (int64_t) 784 +
                                                             new_index_87860 *
                                                             (int64_t) 28 +
                                                             new_index_87877];
                    double defunc_1_op_res_73571 = x_73572 + redout_86405;
                    double redout_tmp_114456 = defunc_1_op_res_73571;
                    
                    redout_86405 = redout_tmp_114456;
                }
                defunc_2_reduce_res_84182 = redout_86405;
                
                double x_73574 = 0.9 * x_73564;
                double y_73575 = 9.999999999999998e-2 *
                       defunc_2_reduce_res_84182;
                double m_dw_73576 = x_73574 + y_73575;
                double x_73577 = 0.999 * x_73565;
                double y_73578 = fpow64(defunc_2_reduce_res_84182, 2.0);
                double y_73579 = 1.0000000000000009e-3 * y_73578;
                double v_dw_73580 = x_73577 + y_73579;
                double m_dw_corr_73581 = m_dw_73576 / y_56527;
                double v_dw_corr_73582 = v_dw_73580 / y_56531;
                double sqrt_res_73583 = futrts_sqrt64(v_dw_corr_73582);
                double y_73584 = 1.0e-8 + sqrt_res_73583;
                double y_73585 = m_dw_corr_73581 / y_73584;
                double y_73586 = 3.0e-4 * y_73585;
                double new_w_73587 = x_73566 - y_73586;
                
                ((double *) mem_109059.mem)[i_86413] = new_w_73587;
                ((double *) mem_109061.mem)[i_86413] = m_dw_73576;
                ((double *) mem_109063.mem)[i_86413] = v_dw_73580;
            }
            if (memblock_alloc(ctx, &mem_109095, (int64_t) 1024,
                               "mem_109095")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_109097, (int64_t) 1024,
                               "mem_109097")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_109099, (int64_t) 1024,
                               "mem_109099")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_109101, (int64_t) 262144,
                               "mem_109101")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_109103, (int64_t) 262144,
                               "mem_109103")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_109105, (int64_t) 262144,
                               "mem_109105")) {
                err = 1;
                goto cleanup;
            }
            for (int32_t i_86872 = 0; i_86872 < 128; i_86872++) {
                int64_t i_86443 = sext_i32_i64(i_86872);
                double x_73455 = ((double *) mem_param_97439.mem)[i_86443];
                double x_73456 = ((double *) mem_param_97452.mem)[i_86443];
                double x_73457 = ((double *) mem_param_97057.mem)[i_86443];
                double x_73458 = ((double *) mem_100017)[i_86443];
                int64_t binop_x_87834 = (int64_t) 784 * i_86443;
                double defunc_0_f_res_84184;
                double redout_86419 = 0.0;
                
                for (int32_t i_86962 = 0; i_86962 < 28; i_86962++) {
                    int64_t i_86420 = sext_i32_i64(i_86962);
                    int64_t binop_y_87835 = (int64_t) 28 * i_86420;
                    int64_t binop_x_87836 = binop_x_87834 + binop_y_87835;
                    double defunc_0_f_res_84183;
                    double redout_86417 = 0.0;
                    
                    for (int32_t i_86970 = 0; i_86970 < 28; i_86970++) {
                        int64_t i_86418 = sext_i32_i64(i_86970);
                        int64_t binop_x_87837 = i_86418 + binop_x_87836;
                        int64_t new_index_87838 = squot64(binop_x_87837,
                                                          (int64_t) 784);
                        int64_t binop_y_87848 = (int64_t) 784 * new_index_87838;
                        int64_t new_index_87849 = binop_x_87837 - binop_y_87848;
                        double x_81612 =
                               ((double *) mem_103174)[new_index_87838 *
                                                       (int64_t) 784 +
                                                       new_index_87849];
                        double defunc_1_op_res_81611 = x_81612 + redout_86417;
                        double redout_tmp_114464 = defunc_1_op_res_81611;
                        
                        redout_86417 = redout_tmp_114464;
                    }
                    defunc_0_f_res_84183 = redout_86417;
                    
                    double defunc_1_op_res_73473 = defunc_0_f_res_84183 +
                           redout_86419;
                    double redout_tmp_114463 = defunc_1_op_res_73473;
                    
                    redout_86419 = redout_tmp_114463;
                }
                defunc_0_f_res_84184 = redout_86419;
                
                bool cond_73476 = 0.0 < x_73458;
                double defunc_1_f_res_73477;
                
                if (cond_73476 == 1) {
                    defunc_1_f_res_73477 = defunc_0_f_res_84184;
                } else {
                    defunc_1_f_res_73477 = 0.0;
                }
                for (int32_t i_86963 = 0; i_86963 < 256; i_86963++) {
                    int64_t i_86427 = sext_i32_i64(i_86963);
                    bool index_concat_cmp_86965 = sle64((int64_t) 128, i_86427);
                    double index_concat_branch_86969;
                    
                    if (index_concat_cmp_86965 == 1) {
                        int64_t index_concat_i_86966 = sub64(i_86427,
                                                             (int64_t) 128);
                        double index_concat_86967 =
                               ((double *) mem_97692)[index_concat_i_86966];
                        
                        index_concat_branch_86969 = index_concat_86967;
                    } else {
                        double index_concat_86968 =
                               ((double *) mem_97690)[i_86427];
                        
                        index_concat_branch_86969 = index_concat_86968;
                    }
                    
                    double x_81587 = ((double *) mem_param_97434.mem)[i_86443 *
                                                                      (int64_t) 256 +
                                                                      i_86427];
                    double x_81588 = ((double *) mem_param_97447.mem)[i_86443 *
                                                                      (int64_t) 256 +
                                                                      i_86427];
                    double x_81589 = ((double *) mem_param_97052.mem)[i_86443 *
                                                                      (int64_t) 256 +
                                                                      i_86427];
                    double defunc_0_f_res_81590 = defunc_1_f_res_73477 *
                           index_concat_branch_86969;
                    double x_81592 = 0.9 * x_81587;
                    double y_81593 = 9.999999999999998e-2 *
                           defunc_0_f_res_81590;
                    double m_dw_81594 = x_81592 + y_81593;
                    double x_81595 = 0.999 * x_81588;
                    double y_81596 = fpow64(defunc_0_f_res_81590, 2.0);
                    double y_81597 = 1.0000000000000009e-3 * y_81596;
                    double v_dw_81598 = x_81595 + y_81597;
                    double m_dw_corr_81599 = m_dw_81594 / y_56527;
                    double v_dw_corr_81600 = v_dw_81598 / y_56531;
                    double sqrt_res_81601 = futrts_sqrt64(v_dw_corr_81600);
                    double y_81602 = 1.0e-8 + sqrt_res_81601;
                    double y_81603 = m_dw_corr_81599 / y_81602;
                    double y_81604 = 3.0e-4 * y_81603;
                    double new_w_81605 = x_81589 - y_81604;
                    
                    ((double *) mem_109101.mem)[i_86443 * (int64_t) 256 +
                                                i_86427] = new_w_81605;
                    ((double *) mem_109103.mem)[i_86443 * (int64_t) 256 +
                                                i_86427] = m_dw_81594;
                    ((double *) mem_109105.mem)[i_86443 * (int64_t) 256 +
                                                i_86427] = v_dw_81598;
                }
                
                double x_73508 = 0.9 * x_73455;
                double y_73509 = 9.999999999999998e-2 * defunc_1_f_res_73477;
                double m_dw_73510 = x_73508 + y_73509;
                double x_73511 = 0.999 * x_73456;
                double y_73512 = fpow64(defunc_1_f_res_73477, 2.0);
                double y_73513 = 1.0000000000000009e-3 * y_73512;
                double v_dw_73514 = x_73511 + y_73513;
                double m_dw_corr_73515 = m_dw_73510 / y_56527;
                double v_dw_corr_73516 = v_dw_73514 / y_56531;
                double sqrt_res_73517 = futrts_sqrt64(v_dw_corr_73516);
                double y_73518 = 1.0e-8 + sqrt_res_73517;
                double y_73519 = m_dw_corr_73515 / y_73518;
                double y_73520 = 3.0e-4 * y_73519;
                double new_w_73521 = x_73457 - y_73520;
                
                ((double *) mem_109095.mem)[i_86443] = new_w_73521;
                ((double *) mem_109097.mem)[i_86443] = m_dw_73510;
                ((double *) mem_109099.mem)[i_86443] = v_dw_73514;
            }
            if (memblock_alloc(ctx, &mem_109251, (int64_t) 1024,
                               "mem_109251")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_109253, (int64_t) 1024,
                               "mem_109253")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_109255, (int64_t) 1024,
                               "mem_109255")) {
                err = 1;
                goto cleanup;
            }
            for (int32_t i_86873 = 0; i_86873 < 128; i_86873++) {
                int64_t i_86458 = sext_i32_i64(i_86873);
                double x_73116 = ((double *) mem_param_97407.mem)[i_86458];
                double x_73117 = ((double *) mem_param_97426.mem)[i_86458];
                double x_73118 = ((double *) mem_param_97044.mem)[i_86458];
                int64_t binop_x_87806 = (int64_t) 784 * i_86458;
                double defunc_2_reduce_res_84188;
                double redout_86450 = 0.0;
                
                for (int32_t i_86961 = 0; i_86961 < 784; i_86961++) {
                    int64_t i_86451 = sext_i32_i64(i_86961);
                    int64_t binop_x_87807 = i_86451 + binop_x_87806;
                    int64_t new_index_87808 = squot64(binop_x_87807,
                                                      (int64_t) 784);
                    int64_t binop_y_87814 = (int64_t) 784 * new_index_87808;
                    int64_t binop_x_87815 = binop_x_87807 - binop_y_87814;
                    int64_t new_index_87816 = squot64(binop_x_87815,
                                                      (int64_t) 28);
                    int64_t binop_y_87832 = (int64_t) 28 * new_index_87816;
                    int64_t new_index_87833 = binop_x_87815 - binop_y_87832;
                    double x_73124 = ((double *) mem_103444)[new_index_87808 *
                                                             (int64_t) 784 +
                                                             new_index_87816 *
                                                             (int64_t) 28 +
                                                             new_index_87833];
                    double defunc_1_op_res_73123 = x_73124 + redout_86450;
                    double redout_tmp_114471 = defunc_1_op_res_73123;
                    
                    redout_86450 = redout_tmp_114471;
                }
                defunc_2_reduce_res_84188 = redout_86450;
                
                double x_73126 = 0.9 * x_73116;
                double y_73127 = 9.999999999999998e-2 *
                       defunc_2_reduce_res_84188;
                double m_dw_73128 = x_73126 + y_73127;
                double x_73129 = 0.999 * x_73117;
                double y_73130 = fpow64(defunc_2_reduce_res_84188, 2.0);
                double y_73131 = 1.0000000000000009e-3 * y_73130;
                double v_dw_73132 = x_73129 + y_73131;
                double m_dw_corr_73133 = m_dw_73128 / y_56527;
                double v_dw_corr_73134 = v_dw_73132 / y_56531;
                double sqrt_res_73135 = futrts_sqrt64(v_dw_corr_73134);
                double y_73136 = 1.0e-8 + sqrt_res_73135;
                double y_73137 = m_dw_corr_73133 / y_73136;
                double y_73138 = 3.0e-4 * y_73137;
                double new_w_73139 = x_73118 - y_73138;
                
                ((double *) mem_109251.mem)[i_86458] = new_w_73139;
                ((double *) mem_109253.mem)[i_86458] = m_dw_73128;
                ((double *) mem_109255.mem)[i_86458] = v_dw_73132;
            }
            if (memblock_alloc(ctx, &mem_109287, (int64_t) 2359296,
                               "mem_109287")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_109289, (int64_t) 2359296,
                               "mem_109289")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_109291, (int64_t) 2359296,
                               "mem_109291")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_109293, (int64_t) 4718592,
                               "mem_109293")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_109295, (int64_t) 4718592,
                               "mem_109295")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_109297, (int64_t) 4718592,
                               "mem_109297")) {
                err = 1;
                goto cleanup;
            }
            for (int32_t i_86874 = 0; i_86874 < 256; i_86874++) {
                int64_t i_86554 = sext_i32_i64(i_86874);
                bool x_77154 = sle64((int64_t) 0, i_86554);
                bool y_77155 = slt64(i_86554, (int64_t) 256);
                bool bounds_check_77156 = x_77154 && y_77155;
                bool index_certs_77157;
                
                if (!bounds_check_77156) {
                    set_error(ctx,
                              msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                        "Index [", (long long) i_86554,
                                        "] out of bounds for array of shape [",
                                        (long long) (int64_t) 256, "].",
                                        "-> #0  ../layers/conv2d.fut:34:86-96\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                for (int32_t i_86907 = 0; i_86907 < 256; i_86907++) {
                    int64_t i_86498 = sext_i32_i64(i_86907);
                    bool x_81767 = sle64((int64_t) 0, i_86498);
                    bool y_81768 = slt64(i_86498, (int64_t) 256);
                    bool bounds_check_81769 = x_81767 && y_81768;
                    bool index_certs_81770;
                    
                    if (!bounds_check_81769) {
                        set_error(ctx,
                                  msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                            "Index [", (long long) i_86498,
                                            "] out of bounds for array of shape [",
                                            (long long) (int64_t) 256, "].",
                                            "-> #0  ../layers/conv2d.fut:34:69-81\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    for (int32_t i_86934 = 0; i_86934 < 30; i_86934++) {
                        int64_t i_86468 = sext_i32_i64(i_86934);
                        bool cond_81773 = slt64(i_86468, (int64_t) 1);
                        bool cond_f_res_81774 = sle64((int64_t) 29, i_86468);
                        bool x_81775 = !cond_81773;
                        bool y_81776 = cond_f_res_81774 && x_81775;
                        bool cond_81777 = cond_81773 || y_81776;
                        bool x_81778 = !cond_81777;
                        
                        for (int32_t i_86952 = 0; i_86952 < 30; i_86952++) {
                            int64_t i_86464 = sext_i32_i64(i_86952);
                            bool cond_f_res_81781 = slt64(i_86464, (int64_t) 1);
                            bool y_81782 = x_81778 && cond_f_res_81781;
                            bool cond_81783 = cond_81777 || y_81782;
                            bool cond_f_res_81784 = sle64((int64_t) 29,
                                                          i_86464);
                            bool x_81785 = !cond_81783;
                            bool y_81786 = cond_f_res_81784 && x_81785;
                            bool cond_81787 = cond_81783 || y_81786;
                            double defunc_0_f_res_81788;
                            
                            if (cond_81787 == 1) {
                                defunc_0_f_res_81788 = 0.0;
                            } else {
                                int64_t i_81789 = sub64(i_86468, (int64_t) 1);
                                bool x_81790 = sle64((int64_t) 0, i_81789);
                                bool y_81791 = slt64(i_81789, (int64_t) 28);
                                bool bounds_check_81792 = x_81790 && y_81791;
                                int64_t i_81793 = sub64(i_86464, (int64_t) 1);
                                bool x_81794 = sle64((int64_t) 0, i_81793);
                                bool y_81795 = slt64(i_81793, (int64_t) 28);
                                bool bounds_check_81796 = x_81794 && y_81795;
                                bool index_ok_81797 = bounds_check_81792 &&
                                     bounds_check_81796;
                                bool index_certs_81798;
                                
                                if (!index_ok_81797) {
                                    set_error(ctx,
                                              msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                        "Index [",
                                                        (long long) i_81789,
                                                        ", ",
                                                        (long long) i_81793,
                                                        "] out of bounds for array of shape [",
                                                        (long long) (int64_t) 28,
                                                        "][",
                                                        (long long) (int64_t) 28,
                                                        "].",
                                                        "-> #0  ../layers/conv2d.fut:7:91-116\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  ../layers/conv2d.fut:6:22-7:117\n   #7  ../layers/conv2d.fut:6:6-7:123\n   #8  /prelude/soacs.fut:59:3-10\n   #9  /prelude/array.fut:208:3-34\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                double defunc_0_f_res_f_res_81799 =
                                       ((double *) mem_99123)[i_86498 *
                                                              (int64_t) 784 +
                                                              i_81789 *
                                                              (int64_t) 28 +
                                                              i_81793];
                                
                                defunc_0_f_res_81788 =
                                    defunc_0_f_res_f_res_81799;
                            }
                            ((double *) mem_109431)[i_86468 * (int64_t) 30 +
                                                    i_86464] =
                                defunc_0_f_res_81788;
                        }
                    }
                    for (int32_t i_86935 = 0; i_86935 < 3; i_86935++) {
                        int64_t i_86488 = sext_i32_i64(i_86935);
                        int64_t j_82065 = add64((int64_t) 28, i_86488);
                        int64_t i_p_m_t_s_82066 = add64((int64_t) 27, i_86488);
                        bool zzero_leq_i_p_m_t_s_82067 = sle64((int64_t) 0,
                                                               i_p_m_t_s_82066);
                        bool i_p_m_t_s_leq_w_82068 = slt64(i_p_m_t_s_82066,
                                                           (int64_t) 30);
                        bool zzero_lte_i_82069 = sle64((int64_t) 0, i_86488);
                        bool i_lte_j_82070 = sle64(i_86488, j_82065);
                        bool y_82071 = i_p_m_t_s_leq_w_82068 &&
                             zzero_lte_i_82069;
                        bool y_82072 = zzero_leq_i_p_m_t_s_82067 && y_82071;
                        bool y_82073 = i_lte_j_82070 && y_82072;
                        bool forwards_ok_82074 = zzero_lte_i_82069 && y_82073;
                        
                        for (int32_t i_86936 = 0; i_86936 < 3; i_86936++) {
                            int64_t i_86478 = sext_i32_i64(i_86936);
                            double x_82124 =
                                   ((double *) mem_param_97364.mem)[i_86554 *
                                                                    (int64_t) 2304 +
                                                                    i_86498 *
                                                                    (int64_t) 9 +
                                                                    i_86488 *
                                                                    (int64_t) 3 +
                                                                    i_86478];
                            double x_82125 =
                                   ((double *) mem_param_97383.mem)[i_86554 *
                                                                    (int64_t) 2304 +
                                                                    i_86498 *
                                                                    (int64_t) 9 +
                                                                    i_86488 *
                                                                    (int64_t) 3 +
                                                                    i_86478];
                            double x_82126 =
                                   ((double *) mem_param_97020.mem)[i_86554 *
                                                                    (int64_t) 2304 +
                                                                    i_86498 *
                                                                    (int64_t) 9 +
                                                                    i_86488 *
                                                                    (int64_t) 3 +
                                                                    i_86478];
                            int64_t j_82127 = add64((int64_t) 28, i_86478);
                            int64_t i_p_m_t_s_82128 = add64((int64_t) 27,
                                                            i_86478);
                            bool zzero_leq_i_p_m_t_s_82129 = sle64((int64_t) 0,
                                                                   i_p_m_t_s_82128);
                            bool i_p_m_t_s_leq_w_82130 = slt64(i_p_m_t_s_82128,
                                                               (int64_t) 30);
                            bool zzero_lte_i_82131 = sle64((int64_t) 0,
                                                           i_86478);
                            bool i_lte_j_82132 = sle64(i_86478, j_82127);
                            bool y_82133 = i_p_m_t_s_leq_w_82130 &&
                                 zzero_lte_i_82131;
                            bool y_82134 = zzero_leq_i_p_m_t_s_82129 && y_82133;
                            bool y_82135 = i_lte_j_82132 && y_82134;
                            bool forwards_ok_82136 = zzero_lte_i_82131 &&
                                 y_82135;
                            bool index_ok_82137 = forwards_ok_82074 &&
                                 forwards_ok_82136;
                            bool index_certs_82138;
                            
                            if (!index_ok_82137) {
                                set_error(ctx,
                                          msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                    "Index [",
                                                    (long long) i_86488, ":",
                                                    (long long) j_82065, ", ",
                                                    (long long) i_86478, ":",
                                                    (long long) j_82127,
                                                    "] out of bounds for array of shape [",
                                                    (long long) (int64_t) 30,
                                                    "][",
                                                    (long long) (int64_t) 30,
                                                    "].",
                                                    "-> #0  ../layers/conv2d.fut:13:90-124\n   #1  ../layers/conv2d.fut:13:69-146\n   #2  /prelude/soacs.fut:59:3-10\n   #3  /prelude/array.fut:200:3-17\n   #4  /prelude/functional.fut:39:59-65\n   #5  /prelude/soacs.fut:59:3-10\n   #6  /prelude/array.fut:208:3-34\n   #7  ../layers/conv2d.fut:13:26-162\n   #8  /prelude/soacs.fut:59:3-10\n   #9  /prelude/array.fut:208:3-34\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            double defunc_2_reduce_res_84190;
                            double redout_86470 = 0.0;
                            
                            for (int32_t i_86937 = 0; i_86937 < 784;
                                 i_86937++) {
                                int64_t i_86471 = sext_i32_i64(i_86937);
                                int64_t new_index_86938 = squot64(i_86471,
                                                                  (int64_t) 28);
                                int64_t binop_y_86940 = (int64_t) 28 *
                                        new_index_86938;
                                int64_t new_index_86941 = i_86471 -
                                        binop_y_86940;
                                double x_82147 =
                                       ((double *) mem_104016)[i_86554 *
                                                               (int64_t) 784 +
                                                               new_index_86938 *
                                                               (int64_t) 28 +
                                                               new_index_86941];
                                int64_t slice_86946 = i_86488 + new_index_86938;
                                int64_t slice_86947 = i_86478 + new_index_86941;
                                double x_82148 =
                                       ((double *) mem_109431)[slice_86946 *
                                                               (int64_t) 30 +
                                                               slice_86947];
                                double defunc_1_f_res_82149 = x_82147 * x_82148;
                                double defunc_1_op_res_82146 =
                                       defunc_1_f_res_82149 + redout_86470;
                                double redout_tmp_114489 =
                                       defunc_1_op_res_82146;
                                
                                redout_86470 = redout_tmp_114489;
                            }
                            defunc_2_reduce_res_84190 = redout_86470;
                            
                            double x_82150 = 0.9 * x_82124;
                            double y_82151 = 9.999999999999998e-2 *
                                   defunc_2_reduce_res_84190;
                            double m_dw_82152 = x_82150 + y_82151;
                            double x_82153 = 0.999 * x_82125;
                            double y_82154 = fpow64(defunc_2_reduce_res_84190,
                                                    2.0);
                            double y_82155 = 1.0000000000000009e-3 * y_82154;
                            double v_dw_82156 = x_82153 + y_82155;
                            double m_dw_corr_82157 = m_dw_82152 / y_56527;
                            double v_dw_corr_82158 = v_dw_82156 / y_56531;
                            double sqrt_res_82159 =
                                   futrts_sqrt64(v_dw_corr_82158);
                            double y_82160 = 1.0e-8 + sqrt_res_82159;
                            double y_82161 = m_dw_corr_82157 / y_82160;
                            double y_82162 = 3.0e-4 * y_82161;
                            double new_w_82163 = x_82126 - y_82162;
                            
                            ((double *) mem_109293.mem)[i_86554 *
                                                        (int64_t) 2304 +
                                                        i_86498 * (int64_t) 9 +
                                                        i_86488 * (int64_t) 3 +
                                                        i_86478] = new_w_82163;
                            ((double *) mem_109295.mem)[i_86554 *
                                                        (int64_t) 2304 +
                                                        i_86498 * (int64_t) 9 +
                                                        i_86488 * (int64_t) 3 +
                                                        i_86478] = m_dw_82152;
                            ((double *) mem_109297.mem)[i_86554 *
                                                        (int64_t) 2304 +
                                                        i_86498 * (int64_t) 9 +
                                                        i_86488 * (int64_t) 3 +
                                                        i_86478] = v_dw_82156;
                        }
                    }
                }
                for (int32_t i_86908 = 0; i_86908 < 128; i_86908++) {
                    int64_t i_86538 = sext_i32_i64(i_86908);
                    bool x_81657 = sle64((int64_t) 0, i_86538);
                    bool y_81658 = slt64(i_86538, (int64_t) 128);
                    bool bounds_check_81659 = x_81657 && y_81658;
                    bool index_certs_81660;
                    
                    if (!bounds_check_81659) {
                        set_error(ctx,
                                  msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                            "Index [", (long long) i_86538,
                                            "] out of bounds for array of shape [",
                                            (long long) (int64_t) 128, "].",
                                            "-> #0  ../layers/conv2d.fut:34:69-81\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    for (int32_t i_86909 = 0; i_86909 < 30; i_86909++) {
                        int64_t i_86508 = sext_i32_i64(i_86909);
                        bool cond_81663 = slt64(i_86508, (int64_t) 1);
                        bool cond_f_res_81664 = sle64((int64_t) 29, i_86508);
                        bool x_81665 = !cond_81663;
                        bool y_81666 = cond_f_res_81664 && x_81665;
                        bool cond_81667 = cond_81663 || y_81666;
                        bool x_81668 = !cond_81667;
                        
                        for (int32_t i_86927 = 0; i_86927 < 30; i_86927++) {
                            int64_t i_86504 = sext_i32_i64(i_86927);
                            bool cond_f_res_81671 = slt64(i_86504, (int64_t) 1);
                            bool y_81672 = x_81668 && cond_f_res_81671;
                            bool cond_81673 = cond_81667 || y_81672;
                            bool cond_f_res_81674 = sle64((int64_t) 29,
                                                          i_86504);
                            bool x_81675 = !cond_81673;
                            bool y_81676 = cond_f_res_81674 && x_81675;
                            bool cond_81677 = cond_81673 || y_81676;
                            double defunc_0_f_res_81678;
                            
                            if (cond_81677 == 1) {
                                defunc_0_f_res_81678 = 0.0;
                            } else {
                                int64_t i_81679 = sub64(i_86508, (int64_t) 1);
                                bool x_81680 = sle64((int64_t) 0, i_81679);
                                bool y_81681 = slt64(i_81679, (int64_t) 28);
                                bool bounds_check_81682 = x_81680 && y_81681;
                                int64_t i_81683 = sub64(i_86504, (int64_t) 1);
                                bool x_81684 = sle64((int64_t) 0, i_81683);
                                bool y_81685 = slt64(i_81683, (int64_t) 28);
                                bool bounds_check_81686 = x_81684 && y_81685;
                                bool index_ok_81687 = bounds_check_81682 &&
                                     bounds_check_81686;
                                bool index_certs_81688;
                                
                                if (!index_ok_81687) {
                                    set_error(ctx,
                                              msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                        "Index [",
                                                        (long long) i_81679,
                                                        ", ",
                                                        (long long) i_81683,
                                                        "] out of bounds for array of shape [",
                                                        (long long) (int64_t) 28,
                                                        "][",
                                                        (long long) (int64_t) 28,
                                                        "].",
                                                        "-> #0  ../layers/conv2d.fut:7:91-116\n   #1  /prelude/soacs.fut:59:3-10\n   #2  /prelude/array.fut:200:3-17\n   #3  /prelude/functional.fut:39:59-65\n   #4  /prelude/soacs.fut:59:3-10\n   #5  /prelude/array.fut:208:3-34\n   #6  ../layers/conv2d.fut:6:22-7:117\n   #7  ../layers/conv2d.fut:6:6-7:123\n   #8  /prelude/soacs.fut:59:3-10\n   #9  /prelude/array.fut:208:3-34\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                double defunc_0_f_res_f_res_81689 =
                                       ((double *) mem_98725)[i_86538 *
                                                              (int64_t) 784 +
                                                              i_81679 *
                                                              (int64_t) 28 +
                                                              i_81683];
                                
                                defunc_0_f_res_81678 =
                                    defunc_0_f_res_f_res_81689;
                            }
                            ((double *) mem_109813)[i_86508 * (int64_t) 30 +
                                                    i_86504] =
                                defunc_0_f_res_81678;
                        }
                    }
                    for (int32_t i_86910 = 0; i_86910 < 3; i_86910++) {
                        int64_t i_86528 = sext_i32_i64(i_86910);
                        int64_t j_82186 = add64((int64_t) 28, i_86528);
                        int64_t i_p_m_t_s_82187 = add64((int64_t) 27, i_86528);
                        bool zzero_leq_i_p_m_t_s_82188 = sle64((int64_t) 0,
                                                               i_p_m_t_s_82187);
                        bool i_p_m_t_s_leq_w_82189 = slt64(i_p_m_t_s_82187,
                                                           (int64_t) 30);
                        bool zzero_lte_i_82190 = sle64((int64_t) 0, i_86528);
                        bool i_lte_j_82191 = sle64(i_86528, j_82186);
                        bool y_82192 = i_p_m_t_s_leq_w_82189 &&
                             zzero_lte_i_82190;
                        bool y_82193 = zzero_leq_i_p_m_t_s_82188 && y_82192;
                        bool y_82194 = i_lte_j_82191 && y_82193;
                        bool forwards_ok_82195 = zzero_lte_i_82190 && y_82194;
                        
                        for (int32_t i_86911 = 0; i_86911 < 3; i_86911++) {
                            int64_t i_86518 = sext_i32_i64(i_86911);
                            double x_82245 =
                                   ((double *) mem_param_97300.mem)[i_86554 *
                                                                    (int64_t) 1152 +
                                                                    i_86538 *
                                                                    (int64_t) 9 +
                                                                    i_86528 *
                                                                    (int64_t) 3 +
                                                                    i_86518];
                            double x_82246 =
                                   ((double *) mem_param_97319.mem)[i_86554 *
                                                                    (int64_t) 1152 +
                                                                    i_86538 *
                                                                    (int64_t) 9 +
                                                                    i_86528 *
                                                                    (int64_t) 3 +
                                                                    i_86518];
                            double x_82247 =
                                   ((double *) mem_param_96988.mem)[i_86554 *
                                                                    (int64_t) 1152 +
                                                                    i_86538 *
                                                                    (int64_t) 9 +
                                                                    i_86528 *
                                                                    (int64_t) 3 +
                                                                    i_86518];
                            int64_t j_82248 = add64((int64_t) 28, i_86518);
                            int64_t i_p_m_t_s_82249 = add64((int64_t) 27,
                                                            i_86518);
                            bool zzero_leq_i_p_m_t_s_82250 = sle64((int64_t) 0,
                                                                   i_p_m_t_s_82249);
                            bool i_p_m_t_s_leq_w_82251 = slt64(i_p_m_t_s_82249,
                                                               (int64_t) 30);
                            bool zzero_lte_i_82252 = sle64((int64_t) 0,
                                                           i_86518);
                            bool i_lte_j_82253 = sle64(i_86518, j_82248);
                            bool y_82254 = i_p_m_t_s_leq_w_82251 &&
                                 zzero_lte_i_82252;
                            bool y_82255 = zzero_leq_i_p_m_t_s_82250 && y_82254;
                            bool y_82256 = i_lte_j_82253 && y_82255;
                            bool forwards_ok_82257 = zzero_lte_i_82252 &&
                                 y_82256;
                            bool index_ok_82258 = forwards_ok_82195 &&
                                 forwards_ok_82257;
                            bool index_certs_82259;
                            
                            if (!index_ok_82258) {
                                set_error(ctx,
                                          msgprintf("Error: %s%lld%s%lld%s%lld%s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                                                    "Index [",
                                                    (long long) i_86528, ":",
                                                    (long long) j_82186, ", ",
                                                    (long long) i_86518, ":",
                                                    (long long) j_82248,
                                                    "] out of bounds for array of shape [",
                                                    (long long) (int64_t) 30,
                                                    "][",
                                                    (long long) (int64_t) 30,
                                                    "].",
                                                    "-> #0  ../layers/conv2d.fut:13:90-124\n   #1  ../layers/conv2d.fut:13:69-146\n   #2  /prelude/soacs.fut:59:3-10\n   #3  /prelude/array.fut:200:3-17\n   #4  /prelude/functional.fut:39:59-65\n   #5  /prelude/soacs.fut:59:3-10\n   #6  /prelude/array.fut:208:3-34\n   #7  ../layers/conv2d.fut:13:26-162\n   #8  /prelude/soacs.fut:59:3-10\n   #9  /prelude/array.fut:208:3-34\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            double defunc_2_reduce_res_84200;
                            double redout_86510 = 0.0;
                            
                            for (int32_t i_86912 = 0; i_86912 < 784;
                                 i_86912++) {
                                int64_t i_86511 = sext_i32_i64(i_86912);
                                int64_t new_index_86913 = squot64(i_86511,
                                                                  (int64_t) 28);
                                int64_t binop_y_86915 = (int64_t) 28 *
                                        new_index_86913;
                                int64_t new_index_86916 = i_86511 -
                                        binop_y_86915;
                                double x_82268 =
                                       ((double *) mem_104504)[i_86554 *
                                                               (int64_t) 784 +
                                                               new_index_86913 *
                                                               (int64_t) 28 +
                                                               new_index_86916];
                                int64_t slice_86921 = i_86528 + new_index_86913;
                                int64_t slice_86922 = i_86518 + new_index_86916;
                                double x_82269 =
                                       ((double *) mem_109813)[slice_86921 *
                                                               (int64_t) 30 +
                                                               slice_86922];
                                double defunc_1_f_res_82270 = x_82268 * x_82269;
                                double defunc_1_op_res_82267 =
                                       defunc_1_f_res_82270 + redout_86510;
                                double redout_tmp_114501 =
                                       defunc_1_op_res_82267;
                                
                                redout_86510 = redout_tmp_114501;
                            }
                            defunc_2_reduce_res_84200 = redout_86510;
                            
                            double x_82271 = 0.9 * x_82245;
                            double y_82272 = 9.999999999999998e-2 *
                                   defunc_2_reduce_res_84200;
                            double m_dw_82273 = x_82271 + y_82272;
                            double x_82274 = 0.999 * x_82246;
                            double y_82275 = fpow64(defunc_2_reduce_res_84200,
                                                    2.0);
                            double y_82276 = 1.0000000000000009e-3 * y_82275;
                            double v_dw_82277 = x_82274 + y_82276;
                            double m_dw_corr_82278 = m_dw_82273 / y_56527;
                            double v_dw_corr_82279 = v_dw_82277 / y_56531;
                            double sqrt_res_82280 =
                                   futrts_sqrt64(v_dw_corr_82279);
                            double y_82281 = 1.0e-8 + sqrt_res_82280;
                            double y_82282 = m_dw_corr_82278 / y_82281;
                            double y_82283 = 3.0e-4 * y_82282;
                            double new_w_82284 = x_82247 - y_82283;
                            
                            ((double *) mem_109287.mem)[i_86554 *
                                                        (int64_t) 1152 +
                                                        i_86538 * (int64_t) 9 +
                                                        i_86528 * (int64_t) 3 +
                                                        i_86518] = new_w_82284;
                            ((double *) mem_109289.mem)[i_86554 *
                                                        (int64_t) 1152 +
                                                        i_86538 * (int64_t) 9 +
                                                        i_86528 * (int64_t) 3 +
                                                        i_86518] = m_dw_82273;
                            ((double *) mem_109291.mem)[i_86554 *
                                                        (int64_t) 1152 +
                                                        i_86538 * (int64_t) 9 +
                                                        i_86528 * (int64_t) 3 +
                                                        i_86518] = v_dw_82277;
                        }
                    }
                }
            }
            if (memblock_alloc(ctx, &mem_110231, (int64_t) 2048,
                               "mem_110231")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_110233, (int64_t) 2048,
                               "mem_110233")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_110235, (int64_t) 2048,
                               "mem_110235")) {
                err = 1;
                goto cleanup;
            }
            for (int32_t i_86875 = 0; i_86875 < 256; i_86875++) {
                int64_t i_86569 = sext_i32_i64(i_86875);
                double x_72925 = ((double *) mem_param_97369.mem)[i_86569];
                double x_72926 = ((double *) mem_param_97388.mem)[i_86569];
                double x_72927 = ((double *) mem_param_97025.mem)[i_86569];
                int64_t binop_x_87778 = (int64_t) 784 * i_86569;
                double defunc_2_reduce_res_84215;
                double redout_86561 = 0.0;
                
                for (int32_t i_86906 = 0; i_86906 < 784; i_86906++) {
                    int64_t i_86562 = sext_i32_i64(i_86906);
                    int64_t binop_x_87779 = i_86562 + binop_x_87778;
                    int64_t new_index_87780 = squot64(binop_x_87779,
                                                      (int64_t) 784);
                    int64_t binop_y_87786 = (int64_t) 784 * new_index_87780;
                    int64_t binop_x_87787 = binop_x_87779 - binop_y_87786;
                    int64_t new_index_87788 = squot64(binop_x_87787,
                                                      (int64_t) 28);
                    int64_t binop_y_87804 = (int64_t) 28 * new_index_87788;
                    int64_t new_index_87805 = binop_x_87787 - binop_y_87804;
                    double x_72933 = ((double *) mem_104016)[new_index_87780 *
                                                             (int64_t) 784 +
                                                             new_index_87788 *
                                                             (int64_t) 28 +
                                                             new_index_87805];
                    double defunc_1_op_res_72932 = x_72933 + redout_86561;
                    double redout_tmp_114505 = defunc_1_op_res_72932;
                    
                    redout_86561 = redout_tmp_114505;
                }
                defunc_2_reduce_res_84215 = redout_86561;
                
                double x_72935 = 0.9 * x_72925;
                double y_72936 = 9.999999999999998e-2 *
                       defunc_2_reduce_res_84215;
                double m_dw_72937 = x_72935 + y_72936;
                double x_72938 = 0.999 * x_72926;
                double y_72939 = fpow64(defunc_2_reduce_res_84215, 2.0);
                double y_72940 = 1.0000000000000009e-3 * y_72939;
                double v_dw_72941 = x_72938 + y_72940;
                double m_dw_corr_72942 = m_dw_72937 / y_56527;
                double v_dw_corr_72943 = v_dw_72941 / y_56531;
                double sqrt_res_72944 = futrts_sqrt64(v_dw_corr_72943);
                double y_72945 = 1.0e-8 + sqrt_res_72944;
                double y_72946 = m_dw_corr_72942 / y_72945;
                double y_72947 = 3.0e-4 * y_72946;
                double new_w_72948 = x_72927 - y_72947;
                
                ((double *) mem_110231.mem)[i_86569] = new_w_72948;
                ((double *) mem_110233.mem)[i_86569] = m_dw_72937;
                ((double *) mem_110235.mem)[i_86569] = v_dw_72941;
            }
            if (memblock_alloc(ctx, &mem_110267, (int64_t) 2048,
                               "mem_110267")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_110269, (int64_t) 2048,
                               "mem_110269")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_110271, (int64_t) 2048,
                               "mem_110271")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_110273, (int64_t) 524288,
                               "mem_110273")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_110275, (int64_t) 524288,
                               "mem_110275")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_110277, (int64_t) 524288,
                               "mem_110277")) {
                err = 1;
                goto cleanup;
            }
            for (int32_t i_86876 = 0; i_86876 < 256; i_86876++) {
                int64_t i_86599 = sext_i32_i64(i_86876);
                double x_72816 = ((double *) mem_param_97337.mem)[i_86599];
                double x_72817 = ((double *) mem_param_97350.mem)[i_86599];
                double x_72818 = ((double *) mem_param_97006.mem)[i_86599];
                double x_72819 = ((double *) mem_99125)[i_86599];
                int64_t binop_x_87762 = (int64_t) 784 * i_86599;
                double defunc_0_f_res_84217;
                double redout_86575 = 0.0;
                
                for (int32_t i_86897 = 0; i_86897 < 28; i_86897++) {
                    int64_t i_86576 = sext_i32_i64(i_86897);
                    int64_t binop_y_87763 = (int64_t) 28 * i_86576;
                    int64_t binop_x_87764 = binop_x_87762 + binop_y_87763;
                    double defunc_0_f_res_84216;
                    double redout_86573 = 0.0;
                    
                    for (int32_t i_86905 = 0; i_86905 < 28; i_86905++) {
                        int64_t i_86574 = sext_i32_i64(i_86905);
                        int64_t binop_x_87765 = i_86574 + binop_x_87764;
                        int64_t new_index_87766 = squot64(binop_x_87765,
                                                          (int64_t) 784);
                        int64_t binop_y_87776 = (int64_t) 784 * new_index_87766;
                        int64_t new_index_87777 = binop_x_87765 - binop_y_87776;
                        double x_82385 =
                               ((double *) mem_104234)[new_index_87766 *
                                                       (int64_t) 784 +
                                                       new_index_87777];
                        double defunc_1_op_res_82384 = x_82385 + redout_86573;
                        double redout_tmp_114513 = defunc_1_op_res_82384;
                        
                        redout_86573 = redout_tmp_114513;
                    }
                    defunc_0_f_res_84216 = redout_86573;
                    
                    double defunc_1_op_res_72834 = defunc_0_f_res_84216 +
                           redout_86575;
                    double redout_tmp_114512 = defunc_1_op_res_72834;
                    
                    redout_86575 = redout_tmp_114512;
                }
                defunc_0_f_res_84217 = redout_86575;
                
                bool cond_72837 = 0.0 < x_72819;
                double defunc_1_f_res_72838;
                
                if (cond_72837 == 1) {
                    defunc_1_f_res_72838 = defunc_0_f_res_84217;
                } else {
                    defunc_1_f_res_72838 = 0.0;
                }
                for (int32_t i_86898 = 0; i_86898 < 256; i_86898++) {
                    int64_t i_86583 = sext_i32_i64(i_86898);
                    bool index_concat_cmp_86900 = sle64((int64_t) 128, i_86583);
                    double index_concat_branch_86904;
                    
                    if (index_concat_cmp_86900 == 1) {
                        int64_t index_concat_i_86901 = sub64(i_86583,
                                                             (int64_t) 128);
                        double index_concat_86902 =
                               ((double *) mem_97692)[index_concat_i_86901];
                        
                        index_concat_branch_86904 = index_concat_86902;
                    } else {
                        double index_concat_86903 =
                               ((double *) mem_97690)[i_86583];
                        
                        index_concat_branch_86904 = index_concat_86903;
                    }
                    
                    double x_82360 = ((double *) mem_param_97332.mem)[i_86599 *
                                                                      (int64_t) 256 +
                                                                      i_86583];
                    double x_82361 = ((double *) mem_param_97345.mem)[i_86599 *
                                                                      (int64_t) 256 +
                                                                      i_86583];
                    double x_82362 = ((double *) mem_param_97001.mem)[i_86599 *
                                                                      (int64_t) 256 +
                                                                      i_86583];
                    double defunc_0_f_res_82363 = defunc_1_f_res_72838 *
                           index_concat_branch_86904;
                    double x_82365 = 0.9 * x_82360;
                    double y_82366 = 9.999999999999998e-2 *
                           defunc_0_f_res_82363;
                    double m_dw_82367 = x_82365 + y_82366;
                    double x_82368 = 0.999 * x_82361;
                    double y_82369 = fpow64(defunc_0_f_res_82363, 2.0);
                    double y_82370 = 1.0000000000000009e-3 * y_82369;
                    double v_dw_82371 = x_82368 + y_82370;
                    double m_dw_corr_82372 = m_dw_82367 / y_56527;
                    double v_dw_corr_82373 = v_dw_82371 / y_56531;
                    double sqrt_res_82374 = futrts_sqrt64(v_dw_corr_82373);
                    double y_82375 = 1.0e-8 + sqrt_res_82374;
                    double y_82376 = m_dw_corr_82372 / y_82375;
                    double y_82377 = 3.0e-4 * y_82376;
                    double new_w_82378 = x_82362 - y_82377;
                    
                    ((double *) mem_110273.mem)[i_86599 * (int64_t) 256 +
                                                i_86583] = new_w_82378;
                    ((double *) mem_110275.mem)[i_86599 * (int64_t) 256 +
                                                i_86583] = m_dw_82367;
                    ((double *) mem_110277.mem)[i_86599 * (int64_t) 256 +
                                                i_86583] = v_dw_82371;
                }
                
                double x_72869 = 0.9 * x_72816;
                double y_72870 = 9.999999999999998e-2 * defunc_1_f_res_72838;
                double m_dw_72871 = x_72869 + y_72870;
                double x_72872 = 0.999 * x_72817;
                double y_72873 = fpow64(defunc_1_f_res_72838, 2.0);
                double y_72874 = 1.0000000000000009e-3 * y_72873;
                double v_dw_72875 = x_72872 + y_72874;
                double m_dw_corr_72876 = m_dw_72871 / y_56527;
                double v_dw_corr_72877 = v_dw_72875 / y_56531;
                double sqrt_res_72878 = futrts_sqrt64(v_dw_corr_72877);
                double y_72879 = 1.0e-8 + sqrt_res_72878;
                double y_72880 = m_dw_corr_72876 / y_72879;
                double y_72881 = 3.0e-4 * y_72880;
                double new_w_72882 = x_72818 - y_72881;
                
                ((double *) mem_110267.mem)[i_86599] = new_w_72882;
                ((double *) mem_110269.mem)[i_86599] = m_dw_72871;
                ((double *) mem_110271.mem)[i_86599] = v_dw_72875;
            }
            if (memblock_alloc(ctx, &mem_110423, (int64_t) 2048,
                               "mem_110423")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_110425, (int64_t) 2048,
                               "mem_110425")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_110427, (int64_t) 2048,
                               "mem_110427")) {
                err = 1;
                goto cleanup;
            }
            for (int32_t i_86877 = 0; i_86877 < 256; i_86877++) {
                int64_t i_86614 = sext_i32_i64(i_86877);
                double x_72482 = ((double *) mem_param_97305.mem)[i_86614];
                double x_72483 = ((double *) mem_param_97324.mem)[i_86614];
                double x_72484 = ((double *) mem_param_96993.mem)[i_86614];
                int64_t binop_x_87734 = (int64_t) 784 * i_86614;
                double defunc_2_reduce_res_84221;
                double redout_86606 = 0.0;
                
                for (int32_t i_86896 = 0; i_86896 < 784; i_86896++) {
                    int64_t i_86607 = sext_i32_i64(i_86896);
                    int64_t binop_x_87735 = i_86607 + binop_x_87734;
                    int64_t new_index_87736 = squot64(binop_x_87735,
                                                      (int64_t) 784);
                    int64_t binop_y_87742 = (int64_t) 784 * new_index_87736;
                    int64_t binop_x_87743 = binop_x_87735 - binop_y_87742;
                    int64_t new_index_87744 = squot64(binop_x_87743,
                                                      (int64_t) 28);
                    int64_t binop_y_87760 = (int64_t) 28 * new_index_87744;
                    int64_t new_index_87761 = binop_x_87743 - binop_y_87760;
                    double x_72490 = ((double *) mem_104504)[new_index_87736 *
                                                             (int64_t) 784 +
                                                             new_index_87744 *
                                                             (int64_t) 28 +
                                                             new_index_87761];
                    double defunc_1_op_res_72489 = x_72490 + redout_86606;
                    double redout_tmp_114520 = defunc_1_op_res_72489;
                    
                    redout_86606 = redout_tmp_114520;
                }
                defunc_2_reduce_res_84221 = redout_86606;
                
                double x_72492 = 0.9 * x_72482;
                double y_72493 = 9.999999999999998e-2 *
                       defunc_2_reduce_res_84221;
                double m_dw_72494 = x_72492 + y_72493;
                double x_72495 = 0.999 * x_72483;
                double y_72496 = fpow64(defunc_2_reduce_res_84221, 2.0);
                double y_72497 = 1.0000000000000009e-3 * y_72496;
                double v_dw_72498 = x_72495 + y_72497;
                double m_dw_corr_72499 = m_dw_72494 / y_56527;
                double v_dw_corr_72500 = v_dw_72498 / y_56531;
                double sqrt_res_72501 = futrts_sqrt64(v_dw_corr_72500);
                double y_72502 = 1.0e-8 + sqrt_res_72501;
                double y_72503 = m_dw_corr_72499 / y_72502;
                double y_72504 = 3.0e-4 * y_72503;
                double new_w_72505 = x_72484 - y_72504;
                
                ((double *) mem_110423.mem)[i_86614] = new_w_72505;
                ((double *) mem_110425.mem)[i_86614] = m_dw_72494;
                ((double *) mem_110427.mem)[i_86614] = v_dw_72498;
            }
            if (memblock_alloc(ctx, &mem_110459, (int64_t) 1024,
                               "mem_110459")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_110461, (int64_t) 1024,
                               "mem_110461")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_110463, (int64_t) 1024,
                               "mem_110463")) {
                err = 1;
                goto cleanup;
            }
            for (int32_t i_86878 = 0; i_86878 < 128; i_86878++) {
                int64_t i_86626 = sext_i32_i64(i_86878);
                double x_72291 = ((double *) mem_param_97267.mem)[i_86626];
                double x_72292 = ((double *) mem_param_97286.mem)[i_86626];
                double x_72293 = ((double *) mem_param_96974.mem)[i_86626];
                int64_t binop_x_87706 = (int64_t) 784 * i_86626;
                double defunc_2_reduce_res_84222;
                double redout_86618 = 0.0;
                
                for (int32_t i_86895 = 0; i_86895 < 784; i_86895++) {
                    int64_t i_86619 = sext_i32_i64(i_86895);
                    int64_t binop_x_87707 = i_86619 + binop_x_87706;
                    int64_t new_index_87708 = squot64(binop_x_87707,
                                                      (int64_t) 784);
                    int64_t binop_y_87714 = (int64_t) 784 * new_index_87708;
                    int64_t binop_x_87715 = binop_x_87707 - binop_y_87714;
                    int64_t new_index_87716 = squot64(binop_x_87715,
                                                      (int64_t) 28);
                    int64_t binop_y_87732 = (int64_t) 28 * new_index_87716;
                    int64_t new_index_87733 = binop_x_87715 - binop_y_87732;
                    double x_72299 = ((double *) mem_105076)[new_index_87708 *
                                                             (int64_t) 784 +
                                                             new_index_87716 *
                                                             (int64_t) 28 +
                                                             new_index_87733];
                    double defunc_1_op_res_72298 = x_72299 + redout_86618;
                    double redout_tmp_114524 = defunc_1_op_res_72298;
                    
                    redout_86618 = redout_tmp_114524;
                }
                defunc_2_reduce_res_84222 = redout_86618;
                
                double x_72301 = 0.9 * x_72291;
                double y_72302 = 9.999999999999998e-2 *
                       defunc_2_reduce_res_84222;
                double m_dw_72303 = x_72301 + y_72302;
                double x_72304 = 0.999 * x_72292;
                double y_72305 = fpow64(defunc_2_reduce_res_84222, 2.0);
                double y_72306 = 1.0000000000000009e-3 * y_72305;
                double v_dw_72307 = x_72304 + y_72306;
                double m_dw_corr_72308 = m_dw_72303 / y_56527;
                double v_dw_corr_72309 = v_dw_72307 / y_56531;
                double sqrt_res_72310 = futrts_sqrt64(v_dw_corr_72309);
                double y_72311 = 1.0e-8 + sqrt_res_72310;
                double y_72312 = m_dw_corr_72308 / y_72311;
                double y_72313 = 3.0e-4 * y_72312;
                double new_w_72314 = x_72293 - y_72313;
                
                ((double *) mem_110459.mem)[i_86626] = new_w_72314;
                ((double *) mem_110461.mem)[i_86626] = m_dw_72303;
                ((double *) mem_110463.mem)[i_86626] = v_dw_72307;
            }
            if (memblock_alloc(ctx, &mem_110495, (int64_t) 1024,
                               "mem_110495")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_110497, (int64_t) 1024,
                               "mem_110497")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_110499, (int64_t) 1024,
                               "mem_110499")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_110501, (int64_t) 262144,
                               "mem_110501")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_110503, (int64_t) 262144,
                               "mem_110503")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_110505, (int64_t) 262144,
                               "mem_110505")) {
                err = 1;
                goto cleanup;
            }
            for (int32_t i_86879 = 0; i_86879 < 128; i_86879++) {
                int64_t i_86656 = sext_i32_i64(i_86879);
                double x_72182 = ((double *) mem_param_97235.mem)[i_86656];
                double x_72183 = ((double *) mem_param_97248.mem)[i_86656];
                double x_72184 = ((double *) mem_param_96955.mem)[i_86656];
                double x_72185 = ((double *) mem_98233)[i_86656];
                int64_t binop_x_87690 = (int64_t) 784 * i_86656;
                double defunc_0_f_res_84224;
                double redout_86632 = 0.0;
                
                for (int32_t i_86886 = 0; i_86886 < 28; i_86886++) {
                    int64_t i_86633 = sext_i32_i64(i_86886);
                    int64_t binop_y_87691 = (int64_t) 28 * i_86633;
                    int64_t binop_x_87692 = binop_x_87690 + binop_y_87691;
                    double defunc_0_f_res_84223;
                    double redout_86630 = 0.0;
                    
                    for (int32_t i_86894 = 0; i_86894 < 28; i_86894++) {
                        int64_t i_86631 = sext_i32_i64(i_86894);
                        int64_t binop_x_87693 = i_86631 + binop_x_87692;
                        int64_t new_index_87694 = squot64(binop_x_87693,
                                                          (int64_t) 784);
                        int64_t binop_y_87704 = (int64_t) 784 * new_index_87694;
                        int64_t new_index_87705 = binop_x_87693 - binop_y_87704;
                        double x_82482 =
                               ((double *) mem_105294)[new_index_87694 *
                                                       (int64_t) 784 +
                                                       new_index_87705];
                        double defunc_1_op_res_82481 = x_82482 + redout_86630;
                        double redout_tmp_114532 = defunc_1_op_res_82481;
                        
                        redout_86630 = redout_tmp_114532;
                    }
                    defunc_0_f_res_84223 = redout_86630;
                    
                    double defunc_1_op_res_72200 = defunc_0_f_res_84223 +
                           redout_86632;
                    double redout_tmp_114531 = defunc_1_op_res_72200;
                    
                    redout_86632 = redout_tmp_114531;
                }
                defunc_0_f_res_84224 = redout_86632;
                
                bool cond_72203 = 0.0 < x_72185;
                double defunc_1_f_res_72204;
                
                if (cond_72203 == 1) {
                    defunc_1_f_res_72204 = defunc_0_f_res_84224;
                } else {
                    defunc_1_f_res_72204 = 0.0;
                }
                for (int32_t i_86887 = 0; i_86887 < 256; i_86887++) {
                    int64_t i_86640 = sext_i32_i64(i_86887);
                    bool index_concat_cmp_86889 = sle64((int64_t) 128, i_86640);
                    double index_concat_branch_86893;
                    
                    if (index_concat_cmp_86889 == 1) {
                        int64_t index_concat_i_86890 = sub64(i_86640,
                                                             (int64_t) 128);
                        double index_concat_86891 =
                               ((double *) mem_97692)[index_concat_i_86890];
                        
                        index_concat_branch_86893 = index_concat_86891;
                    } else {
                        double index_concat_86892 =
                               ((double *) mem_97690)[i_86640];
                        
                        index_concat_branch_86893 = index_concat_86892;
                    }
                    
                    double x_82457 = ((double *) mem_param_97230.mem)[i_86656 *
                                                                      (int64_t) 256 +
                                                                      i_86640];
                    double x_82458 = ((double *) mem_param_97243.mem)[i_86656 *
                                                                      (int64_t) 256 +
                                                                      i_86640];
                    double x_82459 = ((double *) mem_param_96950.mem)[i_86656 *
                                                                      (int64_t) 256 +
                                                                      i_86640];
                    double defunc_0_f_res_82460 = defunc_1_f_res_72204 *
                           index_concat_branch_86893;
                    double x_82462 = 0.9 * x_82457;
                    double y_82463 = 9.999999999999998e-2 *
                           defunc_0_f_res_82460;
                    double m_dw_82464 = x_82462 + y_82463;
                    double x_82465 = 0.999 * x_82458;
                    double y_82466 = fpow64(defunc_0_f_res_82460, 2.0);
                    double y_82467 = 1.0000000000000009e-3 * y_82466;
                    double v_dw_82468 = x_82465 + y_82467;
                    double m_dw_corr_82469 = m_dw_82464 / y_56527;
                    double v_dw_corr_82470 = v_dw_82468 / y_56531;
                    double sqrt_res_82471 = futrts_sqrt64(v_dw_corr_82470);
                    double y_82472 = 1.0e-8 + sqrt_res_82471;
                    double y_82473 = m_dw_corr_82469 / y_82472;
                    double y_82474 = 3.0e-4 * y_82473;
                    double new_w_82475 = x_82459 - y_82474;
                    
                    ((double *) mem_110501.mem)[i_86656 * (int64_t) 256 +
                                                i_86640] = new_w_82475;
                    ((double *) mem_110503.mem)[i_86656 * (int64_t) 256 +
                                                i_86640] = m_dw_82464;
                    ((double *) mem_110505.mem)[i_86656 * (int64_t) 256 +
                                                i_86640] = v_dw_82468;
                }
                
                double x_72235 = 0.9 * x_72182;
                double y_72236 = 9.999999999999998e-2 * defunc_1_f_res_72204;
                double m_dw_72237 = x_72235 + y_72236;
                double x_72238 = 0.999 * x_72183;
                double y_72239 = fpow64(defunc_1_f_res_72204, 2.0);
                double y_72240 = 1.0000000000000009e-3 * y_72239;
                double v_dw_72241 = x_72238 + y_72240;
                double m_dw_corr_72242 = m_dw_72237 / y_56527;
                double v_dw_corr_72243 = v_dw_72241 / y_56531;
                double sqrt_res_72244 = futrts_sqrt64(v_dw_corr_72243);
                double y_72245 = 1.0e-8 + sqrt_res_72244;
                double y_72246 = m_dw_corr_72242 / y_72245;
                double y_72247 = 3.0e-4 * y_72246;
                double new_w_72248 = x_72184 - y_72247;
                
                ((double *) mem_110495.mem)[i_86656] = new_w_72248;
                ((double *) mem_110497.mem)[i_86656] = m_dw_72237;
                ((double *) mem_110499.mem)[i_86656] = v_dw_72241;
            }
            if (memblock_alloc(ctx, &mem_110651, (int64_t) 1024,
                               "mem_110651")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_110653, (int64_t) 1024,
                               "mem_110653")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_110655, (int64_t) 1024,
                               "mem_110655")) {
                err = 1;
                goto cleanup;
            }
            for (int32_t i_86880 = 0; i_86880 < 128; i_86880++) {
                int64_t i_86671 = sext_i32_i64(i_86880);
                double x_71803 = ((double *) mem_param_97203.mem)[i_86671];
                double x_71804 = ((double *) mem_param_97222.mem)[i_86671];
                double x_71805 = ((double *) mem_param_96942.mem)[i_86671];
                int64_t binop_x_87662 = (int64_t) 784 * i_86671;
                double defunc_2_reduce_res_84228;
                double redout_86663 = 0.0;
                
                for (int32_t i_86885 = 0; i_86885 < 784; i_86885++) {
                    int64_t i_86664 = sext_i32_i64(i_86885);
                    int64_t binop_x_87663 = i_86664 + binop_x_87662;
                    int64_t new_index_87664 = squot64(binop_x_87663,
                                                      (int64_t) 784);
                    int64_t binop_y_87670 = (int64_t) 784 * new_index_87664;
                    int64_t binop_x_87671 = binop_x_87663 - binop_y_87670;
                    int64_t new_index_87672 = squot64(binop_x_87671,
                                                      (int64_t) 28);
                    int64_t binop_y_87688 = (int64_t) 28 * new_index_87672;
                    int64_t new_index_87689 = binop_x_87671 - binop_y_87688;
                    double x_71811 = ((double *) mem_105564)[new_index_87664 *
                                                             (int64_t) 784 +
                                                             new_index_87672 *
                                                             (int64_t) 28 +
                                                             new_index_87689];
                    double defunc_1_op_res_71810 = x_71811 + redout_86663;
                    double redout_tmp_114539 = defunc_1_op_res_71810;
                    
                    redout_86663 = redout_tmp_114539;
                }
                defunc_2_reduce_res_84228 = redout_86663;
                
                double x_71813 = 0.9 * x_71803;
                double y_71814 = 9.999999999999998e-2 *
                       defunc_2_reduce_res_84228;
                double m_dw_71815 = x_71813 + y_71814;
                double x_71816 = 0.999 * x_71804;
                double y_71817 = fpow64(defunc_2_reduce_res_84228, 2.0);
                double y_71818 = 1.0000000000000009e-3 * y_71817;
                double v_dw_71819 = x_71816 + y_71818;
                double m_dw_corr_71820 = m_dw_71815 / y_56527;
                double v_dw_corr_71821 = v_dw_71819 / y_56531;
                double sqrt_res_71822 = futrts_sqrt64(v_dw_corr_71821);
                double y_71823 = 1.0e-8 + sqrt_res_71822;
                double y_71824 = m_dw_corr_71820 / y_71823;
                double y_71825 = 3.0e-4 * y_71824;
                double new_w_71826 = x_71805 - y_71825;
                
                ((double *) mem_110651.mem)[i_86671] = new_w_71826;
                ((double *) mem_110653.mem)[i_86671] = m_dw_71815;
                ((double *) mem_110655.mem)[i_86671] = v_dw_71819;
            }
            if (memblock_alloc(ctx, &mem_110687, (int64_t) 4608,
                               "mem_110687")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_110689, (int64_t) 4608,
                               "mem_110689")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_110691, (int64_t) 4608,
                               "mem_110691")) {
                err = 1;
                goto cleanup;
            }
            for (int32_t i_86881 = 0; i_86881 < 64; i_86881++) {
                int64_t i_86701 = sext_i32_i64(i_86881);
                
                for (int32_t i_86883 = 0; i_86883 < 3; i_86883++) {
                    int64_t i_86691 = sext_i32_i64(i_86883);
                    
                    for (int32_t i_86884 = 0; i_86884 < 3; i_86884++) {
                        int64_t i_86681 = sext_i32_i64(i_86884);
                        double x_56512 =
                               ((double *) mem_param_97160.mem)[i_86701 *
                                                                (int64_t) 9 +
                                                                i_86691 *
                                                                (int64_t) 3 +
                                                                i_86681];
                        double x_56513 =
                               ((double *) mem_param_97179.mem)[i_86701 *
                                                                (int64_t) 9 +
                                                                i_86691 *
                                                                (int64_t) 3 +
                                                                i_86681];
                        double x_56514 = ((double *) mem_105848)[i_86701 *
                                                                 (int64_t) 9 +
                                                                 i_86691 *
                                                                 (int64_t) 3 +
                                                                 i_86681];
                        double x_56515 =
                               ((double *) mem_param_96918.mem)[i_86701 *
                                                                (int64_t) 9 +
                                                                i_86691 *
                                                                (int64_t) 3 +
                                                                i_86681];
                        double x_56516 = 0.9 * x_56512;
                        double y_56518 = 9.999999999999998e-2 * x_56514;
                        double m_dw_56519 = x_56516 + y_56518;
                        double x_56520 = 0.999 * x_56513;
                        double y_56522 = fpow64(x_56514, 2.0);
                        double y_56523 = 1.0000000000000009e-3 * y_56522;
                        double v_dw_56524 = x_56520 + y_56523;
                        double m_dw_corr_56528 = m_dw_56519 / y_56527;
                        double v_dw_corr_56532 = v_dw_56524 / y_56531;
                        double sqrt_res_56533 = futrts_sqrt64(v_dw_corr_56532);
                        double y_56534 = 1.0e-8 + sqrt_res_56533;
                        double y_56535 = m_dw_corr_56528 / y_56534;
                        double y_56536 = 3.0e-4 * y_56535;
                        double new_w_56537 = x_56515 - y_56536;
                        
                        ((double *) mem_110735)[i_86691 * (int64_t) 3 +
                                                i_86681] = new_w_56537;
                        ((double *) mem_110737)[i_86691 * (int64_t) 3 +
                                                i_86681] = m_dw_56519;
                        ((double *) mem_110739)[i_86691 * (int64_t) 3 +
                                                i_86681] = v_dw_56524;
                    }
                }
                for (int64_t i_114549 = 0; i_114549 < (int64_t) 1; i_114549++) {
                    if ((int64_t) 72 > 0)
                        memmove(mem_110855 + i_114549 * (int64_t) 9 *
                                (int64_t) 8, mem_110735 + (int64_t) 0,
                                (int64_t) 72);
                }
                for (int64_t i_114550 = 0; i_114550 < (int64_t) 1; i_114550++) {
                    if ((int64_t) 72 > 0)
                        memmove(mem_110857 + i_114550 * (int64_t) 9 *
                                (int64_t) 8, mem_110737 + (int64_t) 0,
                                (int64_t) 72);
                }
                for (int64_t i_114551 = 0; i_114551 < (int64_t) 1; i_114551++) {
                    if ((int64_t) 72 > 0)
                        memmove(mem_110859 + i_114551 * (int64_t) 9 *
                                (int64_t) 8, mem_110739 + (int64_t) 0,
                                (int64_t) 72);
                }
                if ((int64_t) 72 > 0)
                    memmove(mem_110687.mem + i_86701 * (int64_t) 9 *
                            (int64_t) 8, mem_110855 + (int64_t) 0,
                            (int64_t) 72);
                if ((int64_t) 72 > 0)
                    memmove(mem_110689.mem + i_86701 * (int64_t) 9 *
                            (int64_t) 8, mem_110857 + (int64_t) 0,
                            (int64_t) 72);
                if ((int64_t) 72 > 0)
                    memmove(mem_110691.mem + i_86701 * (int64_t) 9 *
                            (int64_t) 8, mem_110859 + (int64_t) 0,
                            (int64_t) 72);
            }
            for (int32_t i_86882 = 0; i_86882 < 64; i_86882++) {
                int64_t i_86711 = sext_i32_i64(i_86882);
                double x_transformed_row_56768 =
                       ((double *) mem_param_97606.mem)[i_86711];
                double bs_transformed_row_transformed_row_56770 =
                       ((double *) mem_param_97625.mem)[i_86711];
                double cs_transformed_row_transformed_row_56772 =
                       ((double *) mem_105862)[i_86711];
                double ds_transformed_row_transformed_row_56774 =
                       ((double *) mem_param_97141.mem)[i_86711];
                double x_56624 = 0.9 * x_transformed_row_56768;
                double y_56626 = 9.999999999999998e-2 *
                       cs_transformed_row_transformed_row_56772;
                double m_dw_56627 = x_56624 + y_56626;
                double x_56628 = 0.999 *
                       bs_transformed_row_transformed_row_56770;
                double y_56630 =
                       fpow64(cs_transformed_row_transformed_row_56772, 2.0);
                double y_56631 = 1.0000000000000009e-3 * y_56630;
                double v_dw_56632 = x_56628 + y_56631;
                double m_dw_corr_56636 = m_dw_56627 / y_56527;
                double v_dw_corr_56640 = v_dw_56632 / y_56531;
                double sqrt_res_56641 = futrts_sqrt64(v_dw_corr_56640);
                double y_56642 = 1.0e-8 + sqrt_res_56641;
                double y_56643 = m_dw_corr_56636 / y_56642;
                double y_56644 = 3.0e-4 * y_56643;
                double new_w_56645 = ds_transformed_row_transformed_row_56774 -
                       y_56644;
                
                for (int64_t i_114555 = 0; i_114555 < (int64_t) 1; i_114555++) {
                    for (int64_t i_114556 = 0; i_114556 < (int64_t) 1;
                         i_114556++) {
                        ((double *) mem_110942)[i_114555 + i_114556] =
                            new_w_56645;
                    }
                }
                for (int64_t i_114557 = 0; i_114557 < (int64_t) 1; i_114557++) {
                    for (int64_t i_114558 = 0; i_114558 < (int64_t) 1;
                         i_114558++) {
                        ((double *) mem_110944)[i_114557 + i_114558] =
                            m_dw_56627;
                    }
                }
                for (int64_t i_114559 = 0; i_114559 < (int64_t) 1; i_114559++) {
                    for (int64_t i_114560 = 0; i_114560 < (int64_t) 1;
                         i_114560++) {
                        ((double *) mem_110946)[i_114559 + i_114560] =
                            v_dw_56632;
                    }
                }
                if ((int64_t) 8 > 0)
                    memmove(mem_110903 + i_86711 * (int64_t) 8, mem_110942 +
                            (int64_t) 0, (int64_t) 8);
                if ((int64_t) 8 > 0)
                    memmove(mem_110905 + i_86711 * (int64_t) 8, mem_110944 +
                            (int64_t) 0, (int64_t) 8);
                if ((int64_t) 8 > 0)
                    memmove(mem_110907 + i_86711 * (int64_t) 8, mem_110946 +
                            (int64_t) 0, (int64_t) 8);
            }
            if (memblock_alloc(ctx, &mem_110981, (int64_t) 512, "mem_110981")) {
                err = 1;
                goto cleanup;
            }
            for (int64_t i_114561 = 0; i_114561 < (int64_t) 1; i_114561++) {
                for (int64_t i_114562 = 0; i_114562 < (int64_t) 64;
                     i_114562++) {
                    for (int64_t i_114563 = 0; i_114563 < (int64_t) 1;
                         i_114563++) {
                        for (int64_t i_114564 = 0; i_114564 < (int64_t) 1;
                             i_114564++) {
                            double tmp_114565 =
                                   ((double *) mem_110903)[i_114562 + i_114563 +
                                                           i_114564];
                            
                            ((double *) mem_110981.mem)[i_114561 *
                                                        (int64_t) 64 +
                                                        (i_114562 + i_114563 +
                                                         i_114564)] =
                                tmp_114565;
                        }
                    }
                }
            }
            if (memblock_alloc(ctx, &mem_110983, (int64_t) 512, "mem_110983")) {
                err = 1;
                goto cleanup;
            }
            for (int64_t i_114566 = 0; i_114566 < (int64_t) 1; i_114566++) {
                for (int64_t i_114567 = 0; i_114567 < (int64_t) 64;
                     i_114567++) {
                    for (int64_t i_114568 = 0; i_114568 < (int64_t) 1;
                         i_114568++) {
                        for (int64_t i_114569 = 0; i_114569 < (int64_t) 1;
                             i_114569++) {
                            double tmp_114570 =
                                   ((double *) mem_110905)[i_114567 + i_114568 +
                                                           i_114569];
                            
                            ((double *) mem_110983.mem)[i_114566 *
                                                        (int64_t) 64 +
                                                        (i_114567 + i_114568 +
                                                         i_114569)] =
                                tmp_114570;
                        }
                    }
                }
            }
            if (memblock_alloc(ctx, &mem_110985, (int64_t) 512, "mem_110985")) {
                err = 1;
                goto cleanup;
            }
            for (int64_t i_114571 = 0; i_114571 < (int64_t) 1; i_114571++) {
                for (int64_t i_114572 = 0; i_114572 < (int64_t) 64;
                     i_114572++) {
                    for (int64_t i_114573 = 0; i_114573 < (int64_t) 1;
                         i_114573++) {
                        for (int64_t i_114574 = 0; i_114574 < (int64_t) 1;
                             i_114574++) {
                            double tmp_114575 =
                                   ((double *) mem_110907)[i_114572 + i_114573 +
                                                           i_114574];
                            
                            ((double *) mem_110985.mem)[i_114571 *
                                                        (int64_t) 64 +
                                                        (i_114572 + i_114573 +
                                                         i_114574)] =
                                tmp_114575;
                        }
                    }
                }
            }
            
            double x_56653 = ((double *) mem_param_97611.mem)[(int64_t) 0];
            double x_56654 = ((double *) mem_param_97630.mem)[(int64_t) 0];
            double x_56657 = 0.9 * x_56653;
            double y_56659 = 9.999999999999998e-2 * defunc_2_reduce_res_84467;
            double m_dw_56660 = x_56657 + y_56659;
            double x_56661 = 0.999 * x_56654;
            double y_56663 = fpow64(defunc_2_reduce_res_84467, 2.0);
            double y_56664 = 1.0000000000000009e-3 * y_56663;
            double v_dw_56665 = x_56661 + y_56664;
            double m_dw_corr_56669 = m_dw_56660 / y_56527;
            double v_dw_corr_56673 = v_dw_56665 / y_56531;
            double sqrt_res_56674 = futrts_sqrt64(v_dw_corr_56673);
            double y_56675 = 1.0e-8 + sqrt_res_56674;
            double y_56676 = m_dw_corr_56669 / y_56675;
            double y_56677 = 3.0e-4 * y_56676;
            double new_w_56678 = x_56114 - y_56677;
            
            if (memblock_alloc(ctx, &mem_110987, (int64_t) 8, "mem_110987")) {
                err = 1;
                goto cleanup;
            }
            for (int64_t i_114576 = 0; i_114576 < (int64_t) 1; i_114576++) {
                ((double *) mem_110987.mem)[i_114576] = new_w_56678;
            }
            if (memblock_alloc(ctx, &mem_110989, (int64_t) 8, "mem_110989")) {
                err = 1;
                goto cleanup;
            }
            for (int64_t i_114577 = 0; i_114577 < (int64_t) 1; i_114577++) {
                ((double *) mem_110989.mem)[i_114577] = m_dw_56660;
            }
            if (memblock_alloc(ctx, &mem_110991, (int64_t) 8, "mem_110991")) {
                err = 1;
                goto cleanup;
            }
            for (int64_t i_114578 = 0; i_114578 < (int64_t) 1; i_114578++) {
                ((double *) mem_110991.mem)[i_114578] = v_dw_56665;
            }
            
            double loopres_54863 = cum_loss__54549 + mse_loss_img_res_54681;
            
            if (memblock_set(ctx, &mem_param_tmp_113735, &mem_110687,
                             "mem_110687") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113736, &mem_105782,
                             "mem_105782") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113737, &mem_107171,
                             "mem_107171") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113738, &mem_110651,
                             "mem_110651") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113739, &mem_110501,
                             "mem_110501") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113740, &mem_110495,
                             "mem_110495") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113741, &mem_107177,
                             "mem_107177") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113742, &mem_110459,
                             "mem_110459") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113743, &mem_109287,
                             "mem_109287") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113744, &mem_110423,
                             "mem_110423") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113745, &mem_110273,
                             "mem_110273") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113746, &mem_110267,
                             "mem_110267") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113747, &mem_109293,
                             "mem_109293") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113748, &mem_110231,
                             "mem_110231") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113749, &mem_107183,
                             "mem_107183") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113750, &mem_109251,
                             "mem_109251") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113751, &mem_109101,
                             "mem_109101") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113752, &mem_109095,
                             "mem_109095") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113753, &mem_107189,
                             "mem_107189") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113754, &mem_109059,
                             "mem_109059") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113755, &mem_105850,
                             "mem_105850") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113756, &mem_107135,
                             "mem_107135") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113757, &mem_106985,
                             "mem_106985") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113758, &mem_106979,
                             "mem_106979") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113759, &mem_105856,
                             "mem_105856") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113760, &mem_106943,
                             "mem_106943") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113761, &mem_110981,
                             "mem_110981") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113762, &mem_110987,
                             "mem_110987") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113763, &mem_110689,
                             "mem_110689") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113764, &mem_105784,
                             "mem_105784") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113765, &mem_110691,
                             "mem_110691") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113766, &mem_105786,
                             "mem_105786") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113767, &mem_107173,
                             "mem_107173") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113768, &mem_110653,
                             "mem_110653") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113769, &mem_107175,
                             "mem_107175") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113770, &mem_110655,
                             "mem_110655") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113771, &mem_110503,
                             "mem_110503") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113772, &mem_110497,
                             "mem_110497") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113773, &mem_110505,
                             "mem_110505") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113774, &mem_110499,
                             "mem_110499") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113775, &mem_107179,
                             "mem_107179") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113776, &mem_110461,
                             "mem_110461") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113777, &mem_107181,
                             "mem_107181") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113778, &mem_110463,
                             "mem_110463") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113779, &mem_109289,
                             "mem_109289") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113780, &mem_110425,
                             "mem_110425") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113781, &mem_109291,
                             "mem_109291") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113782, &mem_110427,
                             "mem_110427") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113783, &mem_110275,
                             "mem_110275") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113784, &mem_110269,
                             "mem_110269") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113785, &mem_110277,
                             "mem_110277") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113786, &mem_110271,
                             "mem_110271") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113787, &mem_109295,
                             "mem_109295") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113788, &mem_110233,
                             "mem_110233") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113789, &mem_109297,
                             "mem_109297") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113790, &mem_110235,
                             "mem_110235") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113791, &mem_107185,
                             "mem_107185") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113792, &mem_109253,
                             "mem_109253") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113793, &mem_107187,
                             "mem_107187") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113794, &mem_109255,
                             "mem_109255") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113795, &mem_109103,
                             "mem_109103") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113796, &mem_109097,
                             "mem_109097") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113797, &mem_109105,
                             "mem_109105") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113798, &mem_109099,
                             "mem_109099") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113799, &mem_107191,
                             "mem_107191") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113800, &mem_109061,
                             "mem_109061") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113801, &mem_107193,
                             "mem_107193") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113802, &mem_109063,
                             "mem_109063") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113803, &mem_105852,
                             "mem_105852") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113804, &mem_107137,
                             "mem_107137") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113805, &mem_105854,
                             "mem_105854") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113806, &mem_107139,
                             "mem_107139") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113807, &mem_106987,
                             "mem_106987") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113808, &mem_106981,
                             "mem_106981") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113809, &mem_106989,
                             "mem_106989") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113810, &mem_106983,
                             "mem_106983") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113811, &mem_105858,
                             "mem_105858") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113812, &mem_106945,
                             "mem_106945") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113813, &mem_105860,
                             "mem_105860") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113814, &mem_106947,
                             "mem_106947") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113815, &mem_110983,
                             "mem_110983") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113816, &mem_110989,
                             "mem_110989") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113817, &mem_110985,
                             "mem_110985") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_113818, &mem_110991,
                             "mem_110991") != 0)
                return 1;
            
            double cum_loss__tmp_113903 = loopres_54863;
            
            if (memblock_set(ctx, &mem_param_96918, &mem_param_tmp_113735,
                             "mem_param_tmp_113735") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_96923, &mem_param_tmp_113736,
                             "mem_param_tmp_113736") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_96937, &mem_param_tmp_113737,
                             "mem_param_tmp_113737") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_96942, &mem_param_tmp_113738,
                             "mem_param_tmp_113738") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_96950, &mem_param_tmp_113739,
                             "mem_param_tmp_113739") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_96955, &mem_param_tmp_113740,
                             "mem_param_tmp_113740") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_96969, &mem_param_tmp_113741,
                             "mem_param_tmp_113741") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_96974, &mem_param_tmp_113742,
                             "mem_param_tmp_113742") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_96988, &mem_param_tmp_113743,
                             "mem_param_tmp_113743") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_96993, &mem_param_tmp_113744,
                             "mem_param_tmp_113744") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97001, &mem_param_tmp_113745,
                             "mem_param_tmp_113745") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97006, &mem_param_tmp_113746,
                             "mem_param_tmp_113746") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97020, &mem_param_tmp_113747,
                             "mem_param_tmp_113747") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97025, &mem_param_tmp_113748,
                             "mem_param_tmp_113748") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97039, &mem_param_tmp_113749,
                             "mem_param_tmp_113749") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97044, &mem_param_tmp_113750,
                             "mem_param_tmp_113750") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97052, &mem_param_tmp_113751,
                             "mem_param_tmp_113751") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97057, &mem_param_tmp_113752,
                             "mem_param_tmp_113752") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97071, &mem_param_tmp_113753,
                             "mem_param_tmp_113753") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97076, &mem_param_tmp_113754,
                             "mem_param_tmp_113754") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97090, &mem_param_tmp_113755,
                             "mem_param_tmp_113755") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97095, &mem_param_tmp_113756,
                             "mem_param_tmp_113756") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97103, &mem_param_tmp_113757,
                             "mem_param_tmp_113757") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97108, &mem_param_tmp_113758,
                             "mem_param_tmp_113758") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97122, &mem_param_tmp_113759,
                             "mem_param_tmp_113759") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97127, &mem_param_tmp_113760,
                             "mem_param_tmp_113760") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97141, &mem_param_tmp_113761,
                             "mem_param_tmp_113761") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97146, &mem_param_tmp_113762,
                             "mem_param_tmp_113762") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97160, &mem_param_tmp_113763,
                             "mem_param_tmp_113763") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97165, &mem_param_tmp_113764,
                             "mem_param_tmp_113764") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97179, &mem_param_tmp_113765,
                             "mem_param_tmp_113765") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97184, &mem_param_tmp_113766,
                             "mem_param_tmp_113766") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97198, &mem_param_tmp_113767,
                             "mem_param_tmp_113767") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97203, &mem_param_tmp_113768,
                             "mem_param_tmp_113768") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97217, &mem_param_tmp_113769,
                             "mem_param_tmp_113769") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97222, &mem_param_tmp_113770,
                             "mem_param_tmp_113770") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97230, &mem_param_tmp_113771,
                             "mem_param_tmp_113771") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97235, &mem_param_tmp_113772,
                             "mem_param_tmp_113772") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97243, &mem_param_tmp_113773,
                             "mem_param_tmp_113773") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97248, &mem_param_tmp_113774,
                             "mem_param_tmp_113774") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97262, &mem_param_tmp_113775,
                             "mem_param_tmp_113775") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97267, &mem_param_tmp_113776,
                             "mem_param_tmp_113776") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97281, &mem_param_tmp_113777,
                             "mem_param_tmp_113777") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97286, &mem_param_tmp_113778,
                             "mem_param_tmp_113778") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97300, &mem_param_tmp_113779,
                             "mem_param_tmp_113779") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97305, &mem_param_tmp_113780,
                             "mem_param_tmp_113780") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97319, &mem_param_tmp_113781,
                             "mem_param_tmp_113781") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97324, &mem_param_tmp_113782,
                             "mem_param_tmp_113782") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97332, &mem_param_tmp_113783,
                             "mem_param_tmp_113783") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97337, &mem_param_tmp_113784,
                             "mem_param_tmp_113784") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97345, &mem_param_tmp_113785,
                             "mem_param_tmp_113785") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97350, &mem_param_tmp_113786,
                             "mem_param_tmp_113786") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97364, &mem_param_tmp_113787,
                             "mem_param_tmp_113787") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97369, &mem_param_tmp_113788,
                             "mem_param_tmp_113788") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97383, &mem_param_tmp_113789,
                             "mem_param_tmp_113789") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97388, &mem_param_tmp_113790,
                             "mem_param_tmp_113790") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97402, &mem_param_tmp_113791,
                             "mem_param_tmp_113791") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97407, &mem_param_tmp_113792,
                             "mem_param_tmp_113792") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97421, &mem_param_tmp_113793,
                             "mem_param_tmp_113793") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97426, &mem_param_tmp_113794,
                             "mem_param_tmp_113794") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97434, &mem_param_tmp_113795,
                             "mem_param_tmp_113795") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97439, &mem_param_tmp_113796,
                             "mem_param_tmp_113796") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97447, &mem_param_tmp_113797,
                             "mem_param_tmp_113797") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97452, &mem_param_tmp_113798,
                             "mem_param_tmp_113798") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97466, &mem_param_tmp_113799,
                             "mem_param_tmp_113799") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97471, &mem_param_tmp_113800,
                             "mem_param_tmp_113800") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97485, &mem_param_tmp_113801,
                             "mem_param_tmp_113801") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97490, &mem_param_tmp_113802,
                             "mem_param_tmp_113802") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97504, &mem_param_tmp_113803,
                             "mem_param_tmp_113803") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97509, &mem_param_tmp_113804,
                             "mem_param_tmp_113804") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97523, &mem_param_tmp_113805,
                             "mem_param_tmp_113805") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97528, &mem_param_tmp_113806,
                             "mem_param_tmp_113806") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97536, &mem_param_tmp_113807,
                             "mem_param_tmp_113807") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97541, &mem_param_tmp_113808,
                             "mem_param_tmp_113808") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97549, &mem_param_tmp_113809,
                             "mem_param_tmp_113809") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97554, &mem_param_tmp_113810,
                             "mem_param_tmp_113810") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97568, &mem_param_tmp_113811,
                             "mem_param_tmp_113811") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97573, &mem_param_tmp_113812,
                             "mem_param_tmp_113812") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97587, &mem_param_tmp_113813,
                             "mem_param_tmp_113813") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97592, &mem_param_tmp_113814,
                             "mem_param_tmp_113814") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97606, &mem_param_tmp_113815,
                             "mem_param_tmp_113815") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97611, &mem_param_tmp_113816,
                             "mem_param_tmp_113816") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97625, &mem_param_tmp_113817,
                             "mem_param_tmp_113817") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_97630, &mem_param_tmp_113818,
                             "mem_param_tmp_113818") != 0)
                return 1;
            cum_loss__54549 = cum_loss__tmp_113903;
        }
        if (memblock_set(ctx, &ext_mem_111717, &mem_param_96918,
                         "mem_param_96918") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111716, &mem_param_96923,
                         "mem_param_96923") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111715, &mem_param_96937,
                         "mem_param_96937") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111714, &mem_param_96942,
                         "mem_param_96942") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111713, &mem_param_96950,
                         "mem_param_96950") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111712, &mem_param_96955,
                         "mem_param_96955") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111711, &mem_param_96969,
                         "mem_param_96969") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111710, &mem_param_96974,
                         "mem_param_96974") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111709, &mem_param_96988,
                         "mem_param_96988") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111708, &mem_param_96993,
                         "mem_param_96993") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111707, &mem_param_97001,
                         "mem_param_97001") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111706, &mem_param_97006,
                         "mem_param_97006") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111705, &mem_param_97020,
                         "mem_param_97020") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111704, &mem_param_97025,
                         "mem_param_97025") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111703, &mem_param_97039,
                         "mem_param_97039") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111702, &mem_param_97044,
                         "mem_param_97044") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111701, &mem_param_97052,
                         "mem_param_97052") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111700, &mem_param_97057,
                         "mem_param_97057") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111699, &mem_param_97071,
                         "mem_param_97071") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111698, &mem_param_97076,
                         "mem_param_97076") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111697, &mem_param_97090,
                         "mem_param_97090") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111696, &mem_param_97095,
                         "mem_param_97095") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111695, &mem_param_97103,
                         "mem_param_97103") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111694, &mem_param_97108,
                         "mem_param_97108") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111693, &mem_param_97122,
                         "mem_param_97122") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111692, &mem_param_97127,
                         "mem_param_97127") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111691, &mem_param_97141,
                         "mem_param_97141") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111690, &mem_param_97146,
                         "mem_param_97146") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111689, &mem_param_97160,
                         "mem_param_97160") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111688, &mem_param_97165,
                         "mem_param_97165") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111687, &mem_param_97179,
                         "mem_param_97179") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111686, &mem_param_97184,
                         "mem_param_97184") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111685, &mem_param_97198,
                         "mem_param_97198") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111684, &mem_param_97203,
                         "mem_param_97203") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111683, &mem_param_97217,
                         "mem_param_97217") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111682, &mem_param_97222,
                         "mem_param_97222") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111681, &mem_param_97230,
                         "mem_param_97230") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111680, &mem_param_97235,
                         "mem_param_97235") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111679, &mem_param_97243,
                         "mem_param_97243") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111678, &mem_param_97248,
                         "mem_param_97248") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111677, &mem_param_97262,
                         "mem_param_97262") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111676, &mem_param_97267,
                         "mem_param_97267") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111675, &mem_param_97281,
                         "mem_param_97281") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111674, &mem_param_97286,
                         "mem_param_97286") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111673, &mem_param_97300,
                         "mem_param_97300") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111672, &mem_param_97305,
                         "mem_param_97305") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111671, &mem_param_97319,
                         "mem_param_97319") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111670, &mem_param_97324,
                         "mem_param_97324") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111669, &mem_param_97332,
                         "mem_param_97332") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111668, &mem_param_97337,
                         "mem_param_97337") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111667, &mem_param_97345,
                         "mem_param_97345") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111666, &mem_param_97350,
                         "mem_param_97350") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111665, &mem_param_97364,
                         "mem_param_97364") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111664, &mem_param_97369,
                         "mem_param_97369") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111663, &mem_param_97383,
                         "mem_param_97383") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111662, &mem_param_97388,
                         "mem_param_97388") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111661, &mem_param_97402,
                         "mem_param_97402") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111660, &mem_param_97407,
                         "mem_param_97407") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111659, &mem_param_97421,
                         "mem_param_97421") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111658, &mem_param_97426,
                         "mem_param_97426") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111657, &mem_param_97434,
                         "mem_param_97434") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111656, &mem_param_97439,
                         "mem_param_97439") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111655, &mem_param_97447,
                         "mem_param_97447") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111654, &mem_param_97452,
                         "mem_param_97452") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111653, &mem_param_97466,
                         "mem_param_97466") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111652, &mem_param_97471,
                         "mem_param_97471") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111651, &mem_param_97485,
                         "mem_param_97485") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111650, &mem_param_97490,
                         "mem_param_97490") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111649, &mem_param_97504,
                         "mem_param_97504") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111648, &mem_param_97509,
                         "mem_param_97509") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111647, &mem_param_97523,
                         "mem_param_97523") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111646, &mem_param_97528,
                         "mem_param_97528") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111645, &mem_param_97536,
                         "mem_param_97536") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111644, &mem_param_97541,
                         "mem_param_97541") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111643, &mem_param_97549,
                         "mem_param_97549") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111642, &mem_param_97554,
                         "mem_param_97554") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111641, &mem_param_97568,
                         "mem_param_97568") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111640, &mem_param_97573,
                         "mem_param_97573") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111639, &mem_param_97587,
                         "mem_param_97587") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111638, &mem_param_97592,
                         "mem_param_97592") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111637, &mem_param_97606,
                         "mem_param_97606") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111636, &mem_param_97611,
                         "mem_param_97611") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111635, &mem_param_97625,
                         "mem_param_97625") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_111634, &mem_param_97630,
                         "mem_param_97630") != 0)
            return 1;
        loopres_54463 = cum_loss__54549;
        
        double avg_loss_54864 = loopres_54463 / i64_res_54176;
        
        for (int64_t i_114579 = 0; i_114579 < (int64_t) 1; i_114579++) {
            ((double *) mem_111719)[i_114579] = avg_loss_54864;
        }
        
        int64_t conc_tmp_54866 = (int64_t) 1 + loopz2088U_54292;
        int64_t binop_y_111720 = (int64_t) 8 * conc_tmp_54866;
        int64_t bytes_111721 = smax64((int64_t) 0, binop_y_111720);
        
        if (memblock_alloc(ctx, &mem_111722, bytes_111721, "mem_111722")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t tmp_offs_114580 = (int64_t) 0;
        
        if (loopz2088U_54292 * (int64_t) 8 > 0)
            memmove(mem_111722.mem + tmp_offs_114580 * (int64_t) 8,
                    mem_param_96904.mem + (int64_t) 0, loopz2088U_54292 *
                    (int64_t) 8);
        tmp_offs_114580 += loopz2088U_54292;
        if ((int64_t) 8 > 0)
            memmove(mem_111722.mem + tmp_offs_114580 * (int64_t) 8, mem_111719 +
                    (int64_t) 0, (int64_t) 8);
        tmp_offs_114580 += (int64_t) 1;
        if (memblock_set(ctx, &mem_param_tmp_113562, &ext_mem_111717,
                         "ext_mem_111717") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113563, &ext_mem_111716,
                         "ext_mem_111716") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113564, &ext_mem_111715,
                         "ext_mem_111715") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113565, &ext_mem_111714,
                         "ext_mem_111714") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113566, &ext_mem_111713,
                         "ext_mem_111713") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113567, &ext_mem_111712,
                         "ext_mem_111712") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113568, &ext_mem_111711,
                         "ext_mem_111711") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113569, &ext_mem_111710,
                         "ext_mem_111710") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113570, &ext_mem_111709,
                         "ext_mem_111709") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113571, &ext_mem_111708,
                         "ext_mem_111708") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113572, &ext_mem_111707,
                         "ext_mem_111707") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113573, &ext_mem_111706,
                         "ext_mem_111706") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113574, &ext_mem_111705,
                         "ext_mem_111705") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113575, &ext_mem_111704,
                         "ext_mem_111704") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113576, &ext_mem_111703,
                         "ext_mem_111703") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113577, &ext_mem_111702,
                         "ext_mem_111702") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113578, &ext_mem_111701,
                         "ext_mem_111701") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113579, &ext_mem_111700,
                         "ext_mem_111700") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113580, &ext_mem_111699,
                         "ext_mem_111699") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113581, &ext_mem_111698,
                         "ext_mem_111698") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113582, &ext_mem_111697,
                         "ext_mem_111697") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113583, &ext_mem_111696,
                         "ext_mem_111696") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113584, &ext_mem_111695,
                         "ext_mem_111695") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113585, &ext_mem_111694,
                         "ext_mem_111694") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113586, &ext_mem_111693,
                         "ext_mem_111693") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113587, &ext_mem_111692,
                         "ext_mem_111692") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113588, &ext_mem_111691,
                         "ext_mem_111691") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113589, &ext_mem_111690,
                         "ext_mem_111690") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113590, &ext_mem_111689,
                         "ext_mem_111689") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113591, &ext_mem_111688,
                         "ext_mem_111688") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113592, &ext_mem_111687,
                         "ext_mem_111687") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113593, &ext_mem_111686,
                         "ext_mem_111686") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113594, &ext_mem_111685,
                         "ext_mem_111685") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113595, &ext_mem_111684,
                         "ext_mem_111684") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113596, &ext_mem_111683,
                         "ext_mem_111683") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113597, &ext_mem_111682,
                         "ext_mem_111682") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113598, &ext_mem_111681,
                         "ext_mem_111681") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113599, &ext_mem_111680,
                         "ext_mem_111680") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113600, &ext_mem_111679,
                         "ext_mem_111679") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113601, &ext_mem_111678,
                         "ext_mem_111678") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113602, &ext_mem_111677,
                         "ext_mem_111677") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113603, &ext_mem_111676,
                         "ext_mem_111676") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113604, &ext_mem_111675,
                         "ext_mem_111675") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113605, &ext_mem_111674,
                         "ext_mem_111674") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113606, &ext_mem_111673,
                         "ext_mem_111673") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113607, &ext_mem_111672,
                         "ext_mem_111672") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113608, &ext_mem_111671,
                         "ext_mem_111671") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113609, &ext_mem_111670,
                         "ext_mem_111670") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113610, &ext_mem_111669,
                         "ext_mem_111669") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113611, &ext_mem_111668,
                         "ext_mem_111668") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113612, &ext_mem_111667,
                         "ext_mem_111667") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113613, &ext_mem_111666,
                         "ext_mem_111666") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113614, &ext_mem_111665,
                         "ext_mem_111665") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113615, &ext_mem_111664,
                         "ext_mem_111664") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113616, &ext_mem_111663,
                         "ext_mem_111663") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113617, &ext_mem_111662,
                         "ext_mem_111662") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113618, &ext_mem_111661,
                         "ext_mem_111661") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113619, &ext_mem_111660,
                         "ext_mem_111660") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113620, &ext_mem_111659,
                         "ext_mem_111659") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113621, &ext_mem_111658,
                         "ext_mem_111658") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113622, &ext_mem_111657,
                         "ext_mem_111657") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113623, &ext_mem_111656,
                         "ext_mem_111656") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113624, &ext_mem_111655,
                         "ext_mem_111655") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113625, &ext_mem_111654,
                         "ext_mem_111654") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113626, &ext_mem_111653,
                         "ext_mem_111653") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113627, &ext_mem_111652,
                         "ext_mem_111652") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113628, &ext_mem_111651,
                         "ext_mem_111651") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113629, &ext_mem_111650,
                         "ext_mem_111650") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113630, &ext_mem_111649,
                         "ext_mem_111649") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113631, &ext_mem_111648,
                         "ext_mem_111648") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113632, &ext_mem_111647,
                         "ext_mem_111647") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113633, &ext_mem_111646,
                         "ext_mem_111646") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113634, &ext_mem_111645,
                         "ext_mem_111645") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113635, &ext_mem_111644,
                         "ext_mem_111644") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113636, &ext_mem_111643,
                         "ext_mem_111643") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113637, &ext_mem_111642,
                         "ext_mem_111642") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113638, &ext_mem_111641,
                         "ext_mem_111641") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113639, &ext_mem_111640,
                         "ext_mem_111640") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113640, &ext_mem_111639,
                         "ext_mem_111639") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113641, &ext_mem_111638,
                         "ext_mem_111638") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113642, &ext_mem_111637,
                         "ext_mem_111637") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113643, &ext_mem_111636,
                         "ext_mem_111636") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113644, &ext_mem_111635,
                         "ext_mem_111635") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113645, &ext_mem_111634,
                         "ext_mem_111634") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_113646, &mem_111722,
                         "mem_111722") != 0)
            return 1;
        
        int64_t ctx_param_ext_tmp_113647 = conc_tmp_54866;
        int64_t ctx_param_ext_tmp_113648 = conc_tmp_54866;
        int64_t loopz2088U_tmp_113649 = conc_tmp_54866;
        
        if (memblock_set(ctx, &mem_param_96148, &mem_param_tmp_113562,
                         "mem_param_tmp_113562") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96153, &mem_param_tmp_113563,
                         "mem_param_tmp_113563") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96170, &mem_param_tmp_113564,
                         "mem_param_tmp_113564") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96175, &mem_param_tmp_113565,
                         "mem_param_tmp_113565") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96186, &mem_param_tmp_113566,
                         "mem_param_tmp_113566") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96191, &mem_param_tmp_113567,
                         "mem_param_tmp_113567") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96208, &mem_param_tmp_113568,
                         "mem_param_tmp_113568") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96213, &mem_param_tmp_113569,
                         "mem_param_tmp_113569") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96230, &mem_param_tmp_113570,
                         "mem_param_tmp_113570") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96235, &mem_param_tmp_113571,
                         "mem_param_tmp_113571") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96246, &mem_param_tmp_113572,
                         "mem_param_tmp_113572") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96251, &mem_param_tmp_113573,
                         "mem_param_tmp_113573") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96268, &mem_param_tmp_113574,
                         "mem_param_tmp_113574") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96273, &mem_param_tmp_113575,
                         "mem_param_tmp_113575") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96290, &mem_param_tmp_113576,
                         "mem_param_tmp_113576") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96295, &mem_param_tmp_113577,
                         "mem_param_tmp_113577") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96306, &mem_param_tmp_113578,
                         "mem_param_tmp_113578") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96311, &mem_param_tmp_113579,
                         "mem_param_tmp_113579") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96328, &mem_param_tmp_113580,
                         "mem_param_tmp_113580") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96333, &mem_param_tmp_113581,
                         "mem_param_tmp_113581") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96350, &mem_param_tmp_113582,
                         "mem_param_tmp_113582") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96355, &mem_param_tmp_113583,
                         "mem_param_tmp_113583") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96366, &mem_param_tmp_113584,
                         "mem_param_tmp_113584") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96371, &mem_param_tmp_113585,
                         "mem_param_tmp_113585") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96388, &mem_param_tmp_113586,
                         "mem_param_tmp_113586") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96393, &mem_param_tmp_113587,
                         "mem_param_tmp_113587") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96410, &mem_param_tmp_113588,
                         "mem_param_tmp_113588") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96415, &mem_param_tmp_113589,
                         "mem_param_tmp_113589") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96429, &mem_param_tmp_113590,
                         "mem_param_tmp_113590") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96434, &mem_param_tmp_113591,
                         "mem_param_tmp_113591") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96448, &mem_param_tmp_113592,
                         "mem_param_tmp_113592") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96453, &mem_param_tmp_113593,
                         "mem_param_tmp_113593") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96467, &mem_param_tmp_113594,
                         "mem_param_tmp_113594") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96472, &mem_param_tmp_113595,
                         "mem_param_tmp_113595") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96486, &mem_param_tmp_113596,
                         "mem_param_tmp_113596") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96491, &mem_param_tmp_113597,
                         "mem_param_tmp_113597") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96499, &mem_param_tmp_113598,
                         "mem_param_tmp_113598") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96504, &mem_param_tmp_113599,
                         "mem_param_tmp_113599") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96512, &mem_param_tmp_113600,
                         "mem_param_tmp_113600") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96517, &mem_param_tmp_113601,
                         "mem_param_tmp_113601") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96531, &mem_param_tmp_113602,
                         "mem_param_tmp_113602") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96536, &mem_param_tmp_113603,
                         "mem_param_tmp_113603") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96550, &mem_param_tmp_113604,
                         "mem_param_tmp_113604") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96555, &mem_param_tmp_113605,
                         "mem_param_tmp_113605") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96569, &mem_param_tmp_113606,
                         "mem_param_tmp_113606") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96574, &mem_param_tmp_113607,
                         "mem_param_tmp_113607") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96588, &mem_param_tmp_113608,
                         "mem_param_tmp_113608") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96593, &mem_param_tmp_113609,
                         "mem_param_tmp_113609") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96601, &mem_param_tmp_113610,
                         "mem_param_tmp_113610") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96606, &mem_param_tmp_113611,
                         "mem_param_tmp_113611") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96614, &mem_param_tmp_113612,
                         "mem_param_tmp_113612") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96619, &mem_param_tmp_113613,
                         "mem_param_tmp_113613") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96633, &mem_param_tmp_113614,
                         "mem_param_tmp_113614") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96638, &mem_param_tmp_113615,
                         "mem_param_tmp_113615") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96652, &mem_param_tmp_113616,
                         "mem_param_tmp_113616") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96657, &mem_param_tmp_113617,
                         "mem_param_tmp_113617") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96671, &mem_param_tmp_113618,
                         "mem_param_tmp_113618") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96676, &mem_param_tmp_113619,
                         "mem_param_tmp_113619") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96690, &mem_param_tmp_113620,
                         "mem_param_tmp_113620") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96695, &mem_param_tmp_113621,
                         "mem_param_tmp_113621") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96703, &mem_param_tmp_113622,
                         "mem_param_tmp_113622") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96708, &mem_param_tmp_113623,
                         "mem_param_tmp_113623") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96716, &mem_param_tmp_113624,
                         "mem_param_tmp_113624") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96721, &mem_param_tmp_113625,
                         "mem_param_tmp_113625") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96735, &mem_param_tmp_113626,
                         "mem_param_tmp_113626") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96740, &mem_param_tmp_113627,
                         "mem_param_tmp_113627") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96754, &mem_param_tmp_113628,
                         "mem_param_tmp_113628") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96759, &mem_param_tmp_113629,
                         "mem_param_tmp_113629") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96773, &mem_param_tmp_113630,
                         "mem_param_tmp_113630") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96778, &mem_param_tmp_113631,
                         "mem_param_tmp_113631") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96792, &mem_param_tmp_113632,
                         "mem_param_tmp_113632") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96797, &mem_param_tmp_113633,
                         "mem_param_tmp_113633") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96805, &mem_param_tmp_113634,
                         "mem_param_tmp_113634") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96810, &mem_param_tmp_113635,
                         "mem_param_tmp_113635") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96818, &mem_param_tmp_113636,
                         "mem_param_tmp_113636") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96823, &mem_param_tmp_113637,
                         "mem_param_tmp_113637") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96837, &mem_param_tmp_113638,
                         "mem_param_tmp_113638") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96842, &mem_param_tmp_113639,
                         "mem_param_tmp_113639") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96856, &mem_param_tmp_113640,
                         "mem_param_tmp_113640") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96861, &mem_param_tmp_113641,
                         "mem_param_tmp_113641") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96875, &mem_param_tmp_113642,
                         "mem_param_tmp_113642") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96880, &mem_param_tmp_113643,
                         "mem_param_tmp_113643") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96894, &mem_param_tmp_113644,
                         "mem_param_tmp_113644") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96899, &mem_param_tmp_113645,
                         "mem_param_tmp_113645") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_96904, &mem_param_tmp_113646,
                         "mem_param_tmp_113646") != 0)
            return 1;
        ctx_param_ext_96902 = ctx_param_ext_tmp_113647;
        ctx_param_ext_96903 = ctx_param_ext_tmp_113648;
        loopz2088U_54292 = loopz2088U_tmp_113649;
    }
    if (memblock_set(ctx, &ext_mem_112453, &mem_param_96148,
                     "mem_param_96148") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112452, &mem_param_96153,
                     "mem_param_96153") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112451, &mem_param_96170,
                     "mem_param_96170") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112450, &mem_param_96175,
                     "mem_param_96175") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112449, &mem_param_96186,
                     "mem_param_96186") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112448, &mem_param_96191,
                     "mem_param_96191") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112447, &mem_param_96208,
                     "mem_param_96208") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112446, &mem_param_96213,
                     "mem_param_96213") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112445, &mem_param_96230,
                     "mem_param_96230") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112444, &mem_param_96235,
                     "mem_param_96235") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112443, &mem_param_96246,
                     "mem_param_96246") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112442, &mem_param_96251,
                     "mem_param_96251") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112441, &mem_param_96268,
                     "mem_param_96268") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112440, &mem_param_96273,
                     "mem_param_96273") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112439, &mem_param_96290,
                     "mem_param_96290") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112438, &mem_param_96295,
                     "mem_param_96295") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112437, &mem_param_96306,
                     "mem_param_96306") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112436, &mem_param_96311,
                     "mem_param_96311") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112435, &mem_param_96328,
                     "mem_param_96328") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112434, &mem_param_96333,
                     "mem_param_96333") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112433, &mem_param_96350,
                     "mem_param_96350") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112432, &mem_param_96355,
                     "mem_param_96355") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112431, &mem_param_96366,
                     "mem_param_96366") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112430, &mem_param_96371,
                     "mem_param_96371") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112429, &mem_param_96388,
                     "mem_param_96388") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112428, &mem_param_96393,
                     "mem_param_96393") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112427, &mem_param_96410,
                     "mem_param_96410") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112426, &mem_param_96415,
                     "mem_param_96415") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112425, &mem_param_96429,
                     "mem_param_96429") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112424, &mem_param_96434,
                     "mem_param_96434") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112423, &mem_param_96448,
                     "mem_param_96448") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112422, &mem_param_96453,
                     "mem_param_96453") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112421, &mem_param_96467,
                     "mem_param_96467") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112420, &mem_param_96472,
                     "mem_param_96472") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112419, &mem_param_96486,
                     "mem_param_96486") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112418, &mem_param_96491,
                     "mem_param_96491") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112417, &mem_param_96499,
                     "mem_param_96499") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112416, &mem_param_96504,
                     "mem_param_96504") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112415, &mem_param_96512,
                     "mem_param_96512") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112414, &mem_param_96517,
                     "mem_param_96517") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112413, &mem_param_96531,
                     "mem_param_96531") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112412, &mem_param_96536,
                     "mem_param_96536") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112411, &mem_param_96550,
                     "mem_param_96550") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112410, &mem_param_96555,
                     "mem_param_96555") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112409, &mem_param_96569,
                     "mem_param_96569") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112408, &mem_param_96574,
                     "mem_param_96574") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112407, &mem_param_96588,
                     "mem_param_96588") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112406, &mem_param_96593,
                     "mem_param_96593") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112405, &mem_param_96601,
                     "mem_param_96601") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112404, &mem_param_96606,
                     "mem_param_96606") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112403, &mem_param_96614,
                     "mem_param_96614") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112402, &mem_param_96619,
                     "mem_param_96619") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112401, &mem_param_96633,
                     "mem_param_96633") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112400, &mem_param_96638,
                     "mem_param_96638") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112399, &mem_param_96652,
                     "mem_param_96652") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112398, &mem_param_96657,
                     "mem_param_96657") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112397, &mem_param_96671,
                     "mem_param_96671") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112396, &mem_param_96676,
                     "mem_param_96676") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112395, &mem_param_96690,
                     "mem_param_96690") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112394, &mem_param_96695,
                     "mem_param_96695") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112393, &mem_param_96703,
                     "mem_param_96703") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112392, &mem_param_96708,
                     "mem_param_96708") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112391, &mem_param_96716,
                     "mem_param_96716") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112390, &mem_param_96721,
                     "mem_param_96721") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112389, &mem_param_96735,
                     "mem_param_96735") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112388, &mem_param_96740,
                     "mem_param_96740") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112387, &mem_param_96754,
                     "mem_param_96754") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112386, &mem_param_96759,
                     "mem_param_96759") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112385, &mem_param_96773,
                     "mem_param_96773") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112384, &mem_param_96778,
                     "mem_param_96778") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112383, &mem_param_96792,
                     "mem_param_96792") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112382, &mem_param_96797,
                     "mem_param_96797") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112381, &mem_param_96805,
                     "mem_param_96805") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112380, &mem_param_96810,
                     "mem_param_96810") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112379, &mem_param_96818,
                     "mem_param_96818") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112378, &mem_param_96823,
                     "mem_param_96823") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112377, &mem_param_96837,
                     "mem_param_96837") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112376, &mem_param_96842,
                     "mem_param_96842") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112375, &mem_param_96856,
                     "mem_param_96856") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112374, &mem_param_96861,
                     "mem_param_96861") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112373, &mem_param_96875,
                     "mem_param_96875") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112372, &mem_param_96880,
                     "mem_param_96880") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112371, &mem_param_96894,
                     "mem_param_96894") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112370, &mem_param_96899,
                     "mem_param_96899") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_112369, &mem_param_96904,
                     "mem_param_96904") != 0)
        return 1;
    ext_111724 = ctx_param_ext_96902;
    ext_111723 = ctx_param_ext_96903;
    train_unet_res_54205 = loopz2088U_54292;
    if (memblock_unref(ctx, &mem_96131, "mem_96131") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_96133, "mem_96133") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_96155, "mem_96155") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_96177, "mem_96177") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_96193, "mem_96193") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_96215, "mem_96215") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_96237, "mem_96237") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_96253, "mem_96253") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_96275, "mem_96275") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_96297, "mem_96297") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_96313, "mem_96313") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_96335, "mem_96335") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_96357, "mem_96357") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_96373, "mem_96373") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_96395, "mem_96395") != 0)
        return 1;
    
    int64_t binop_y_112454 = (int64_t) 8 * train_unet_res_54205;
    int64_t bytes_112455 = smax64((int64_t) 0, binop_y_112454);
    
    if (memblock_alloc(ctx, &mem_112456, bytes_112455, "mem_112456")) {
        err = 1;
        goto cleanup;
    }
    if (train_unet_res_54205 * (int64_t) 8 > 0)
        memmove(mem_112456.mem + (int64_t) 0, ext_mem_112369.mem + (int64_t) 0,
                train_unet_res_54205 * (int64_t) 8);
    if (memblock_unref(ctx, &ext_mem_112369, "ext_mem_112369") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_113560, &mem_112456, "mem_112456") != 0)
        return 1;
    prim_out_113561 = train_unet_res_54205;
    (*mem_out_p_114811).references = NULL;
    if (memblock_set(ctx, &*mem_out_p_114811, &mem_out_113560,
                     "mem_out_113560") != 0)
        return 1;
    *out_prim_out_114812 = prim_out_113561;
    
  cleanup:
    {
        free(mem_97633);
        free(mem_97647);
        free(mem_97690);
        free(mem_97692);
        free(mem_97716);
        free(mem_97720);
        free(mem_97806);
        free(mem_97811);
        free(mem_97872);
        free(mem_97915);
        free(mem_97999);
        free(mem_98051);
        free(mem_98091);
        free(mem_98175);
        free(mem_98205);
        free(mem_98207);
        free(mem_98229);
        free(mem_98231);
        free(mem_98233);
        free(mem_98235);
        free(mem_98493);
        free(mem_98545);
        free(mem_98585);
        free(mem_98669);
        free(mem_98699);
        free(mem_98701);
        free(mem_98723);
        free(mem_98725);
        free(mem_98891);
        free(mem_98943);
        free(mem_98983);
        free(mem_99067);
        free(mem_99097);
        free(mem_99099);
        free(mem_99121);
        free(mem_99123);
        free(mem_99125);
        free(mem_99127);
        free(mem_99385);
        free(mem_99437);
        free(mem_99477);
        free(mem_99561);
        free(mem_99591);
        free(mem_99593);
        free(mem_99615);
        free(mem_99699);
        free(mem_99783);
        free(mem_99835);
        free(mem_99875);
        free(mem_99959);
        free(mem_99989);
        free(mem_99991);
        free(mem_100013);
        free(mem_100015);
        free(mem_100017);
        free(mem_100019);
        free(mem_100277);
        free(mem_100329);
        free(mem_100369);
        free(mem_100453);
        free(mem_100483);
        free(mem_100485);
        free(mem_100507);
        free(mem_100591);
        free(mem_100675);
        free(mem_100727);
        free(mem_100767);
        free(mem_100851);
        free(mem_100881);
        free(mem_100883);
        free(mem_100905);
        free(mem_100907);
        free(mem_100909);
        free(mem_100911);
        free(mem_101169);
        free(mem_101221);
        free(mem_101261);
        free(mem_101345);
        free(mem_101375);
        free(mem_101377);
        free(mem_101399);
        free(mem_101483);
        free(mem_101535);
        free(mem_101549);
        free(mem_101560);
        free(mem_101582);
        free(mem_101587);
        free(mem_101616);
        free(mem_101650);
        free(mem_101707);
        free(mem_101750);
        free(mem_101752);
        free(mem_101810);
        free(mem_101812);
        free(mem_101834);
        free(mem_101978);
        free(mem_101980);
        free(mem_102146);
        free(mem_102198);
        free(mem_102238);
        free(mem_102240);
        free(mem_102298);
        free(mem_102300);
        free(mem_102322);
        free(mem_102466);
        free(mem_102468);
        free(mem_102634);
        free(mem_102686);
        free(mem_102726);
        free(mem_102728);
        free(mem_102786);
        free(mem_102788);
        free(mem_102810);
        free(mem_102954);
        free(mem_102956);
        free(mem_103122);
        free(mem_103174);
        free(mem_103214);
        free(mem_103216);
        free(mem_103274);
        free(mem_103276);
        free(mem_103298);
        free(mem_103442);
        free(mem_103444);
        free(mem_103610);
        free(mem_103662);
        free(mem_103702);
        free(mem_103786);
        free(mem_103788);
        free(mem_103846);
        free(mem_103848);
        free(mem_103870);
        free(mem_104014);
        free(mem_104016);
        free(mem_104182);
        free(mem_104234);
        free(mem_104274);
        free(mem_104276);
        free(mem_104334);
        free(mem_104336);
        free(mem_104358);
        free(mem_104502);
        free(mem_104504);
        free(mem_104670);
        free(mem_104722);
        free(mem_104762);
        free(mem_104846);
        free(mem_104848);
        free(mem_104906);
        free(mem_104908);
        free(mem_104930);
        free(mem_105074);
        free(mem_105076);
        free(mem_105242);
        free(mem_105294);
        free(mem_105334);
        free(mem_105336);
        free(mem_105394);
        free(mem_105396);
        free(mem_105418);
        free(mem_105562);
        free(mem_105564);
        free(mem_105730);
        free(mem_105788);
        free(mem_105813);
        free(mem_105848);
        free(mem_105862);
        free(mem_105976);
        free(mem_106006);
        free(mem_106039);
        free(mem_106053);
        free(mem_106103);
        free(mem_106485);
        free(mem_106820);
        free(mem_106832);
        free(mem_107459);
        free(mem_107461);
        free(mem_108175);
        free(mem_108557);
        free(mem_109431);
        free(mem_109813);
        free(mem_110735);
        free(mem_110737);
        free(mem_110739);
        free(mem_110855);
        free(mem_110857);
        free(mem_110859);
        free(mem_110903);
        free(mem_110905);
        free(mem_110907);
        free(mem_110942);
        free(mem_110944);
        free(mem_110946);
        free(mem_111719);
        if (memblock_unref(ctx, &mem_112456, "mem_112456") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113646,
                           "mem_param_tmp_113646") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113645,
                           "mem_param_tmp_113645") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113644,
                           "mem_param_tmp_113644") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113643,
                           "mem_param_tmp_113643") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113642,
                           "mem_param_tmp_113642") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113641,
                           "mem_param_tmp_113641") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113640,
                           "mem_param_tmp_113640") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113639,
                           "mem_param_tmp_113639") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113638,
                           "mem_param_tmp_113638") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113637,
                           "mem_param_tmp_113637") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113636,
                           "mem_param_tmp_113636") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113635,
                           "mem_param_tmp_113635") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113634,
                           "mem_param_tmp_113634") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113633,
                           "mem_param_tmp_113633") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113632,
                           "mem_param_tmp_113632") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113631,
                           "mem_param_tmp_113631") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113630,
                           "mem_param_tmp_113630") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113629,
                           "mem_param_tmp_113629") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113628,
                           "mem_param_tmp_113628") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113627,
                           "mem_param_tmp_113627") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113626,
                           "mem_param_tmp_113626") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113625,
                           "mem_param_tmp_113625") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113624,
                           "mem_param_tmp_113624") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113623,
                           "mem_param_tmp_113623") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113622,
                           "mem_param_tmp_113622") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113621,
                           "mem_param_tmp_113621") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113620,
                           "mem_param_tmp_113620") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113619,
                           "mem_param_tmp_113619") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113618,
                           "mem_param_tmp_113618") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113617,
                           "mem_param_tmp_113617") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113616,
                           "mem_param_tmp_113616") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113615,
                           "mem_param_tmp_113615") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113614,
                           "mem_param_tmp_113614") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113613,
                           "mem_param_tmp_113613") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113612,
                           "mem_param_tmp_113612") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113611,
                           "mem_param_tmp_113611") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113610,
                           "mem_param_tmp_113610") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113609,
                           "mem_param_tmp_113609") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113608,
                           "mem_param_tmp_113608") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113607,
                           "mem_param_tmp_113607") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113606,
                           "mem_param_tmp_113606") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113605,
                           "mem_param_tmp_113605") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113604,
                           "mem_param_tmp_113604") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113603,
                           "mem_param_tmp_113603") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113602,
                           "mem_param_tmp_113602") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113601,
                           "mem_param_tmp_113601") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113600,
                           "mem_param_tmp_113600") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113599,
                           "mem_param_tmp_113599") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113598,
                           "mem_param_tmp_113598") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113597,
                           "mem_param_tmp_113597") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113596,
                           "mem_param_tmp_113596") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113595,
                           "mem_param_tmp_113595") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113594,
                           "mem_param_tmp_113594") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113593,
                           "mem_param_tmp_113593") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113592,
                           "mem_param_tmp_113592") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113591,
                           "mem_param_tmp_113591") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113590,
                           "mem_param_tmp_113590") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113589,
                           "mem_param_tmp_113589") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113588,
                           "mem_param_tmp_113588") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113587,
                           "mem_param_tmp_113587") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113586,
                           "mem_param_tmp_113586") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113585,
                           "mem_param_tmp_113585") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113584,
                           "mem_param_tmp_113584") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113583,
                           "mem_param_tmp_113583") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113582,
                           "mem_param_tmp_113582") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113581,
                           "mem_param_tmp_113581") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113580,
                           "mem_param_tmp_113580") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113579,
                           "mem_param_tmp_113579") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113578,
                           "mem_param_tmp_113578") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113577,
                           "mem_param_tmp_113577") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113576,
                           "mem_param_tmp_113576") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113575,
                           "mem_param_tmp_113575") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113574,
                           "mem_param_tmp_113574") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113573,
                           "mem_param_tmp_113573") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113572,
                           "mem_param_tmp_113572") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113571,
                           "mem_param_tmp_113571") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113570,
                           "mem_param_tmp_113570") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113569,
                           "mem_param_tmp_113569") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113568,
                           "mem_param_tmp_113568") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113567,
                           "mem_param_tmp_113567") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113566,
                           "mem_param_tmp_113566") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113565,
                           "mem_param_tmp_113565") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113564,
                           "mem_param_tmp_113564") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113563,
                           "mem_param_tmp_113563") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113562,
                           "mem_param_tmp_113562") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_111722, "mem_111722") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113818,
                           "mem_param_tmp_113818") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113817,
                           "mem_param_tmp_113817") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113816,
                           "mem_param_tmp_113816") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113815,
                           "mem_param_tmp_113815") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113814,
                           "mem_param_tmp_113814") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113813,
                           "mem_param_tmp_113813") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113812,
                           "mem_param_tmp_113812") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113811,
                           "mem_param_tmp_113811") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113810,
                           "mem_param_tmp_113810") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113809,
                           "mem_param_tmp_113809") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113808,
                           "mem_param_tmp_113808") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113807,
                           "mem_param_tmp_113807") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113806,
                           "mem_param_tmp_113806") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113805,
                           "mem_param_tmp_113805") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113804,
                           "mem_param_tmp_113804") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113803,
                           "mem_param_tmp_113803") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113802,
                           "mem_param_tmp_113802") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113801,
                           "mem_param_tmp_113801") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113800,
                           "mem_param_tmp_113800") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113799,
                           "mem_param_tmp_113799") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113798,
                           "mem_param_tmp_113798") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113797,
                           "mem_param_tmp_113797") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113796,
                           "mem_param_tmp_113796") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113795,
                           "mem_param_tmp_113795") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113794,
                           "mem_param_tmp_113794") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113793,
                           "mem_param_tmp_113793") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113792,
                           "mem_param_tmp_113792") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113791,
                           "mem_param_tmp_113791") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113790,
                           "mem_param_tmp_113790") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113789,
                           "mem_param_tmp_113789") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113788,
                           "mem_param_tmp_113788") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113787,
                           "mem_param_tmp_113787") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113786,
                           "mem_param_tmp_113786") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113785,
                           "mem_param_tmp_113785") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113784,
                           "mem_param_tmp_113784") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113783,
                           "mem_param_tmp_113783") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113782,
                           "mem_param_tmp_113782") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113781,
                           "mem_param_tmp_113781") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113780,
                           "mem_param_tmp_113780") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113779,
                           "mem_param_tmp_113779") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113778,
                           "mem_param_tmp_113778") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113777,
                           "mem_param_tmp_113777") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113776,
                           "mem_param_tmp_113776") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113775,
                           "mem_param_tmp_113775") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113774,
                           "mem_param_tmp_113774") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113773,
                           "mem_param_tmp_113773") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113772,
                           "mem_param_tmp_113772") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113771,
                           "mem_param_tmp_113771") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113770,
                           "mem_param_tmp_113770") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113769,
                           "mem_param_tmp_113769") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113768,
                           "mem_param_tmp_113768") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113767,
                           "mem_param_tmp_113767") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113766,
                           "mem_param_tmp_113766") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113765,
                           "mem_param_tmp_113765") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113764,
                           "mem_param_tmp_113764") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113763,
                           "mem_param_tmp_113763") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113762,
                           "mem_param_tmp_113762") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113761,
                           "mem_param_tmp_113761") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113760,
                           "mem_param_tmp_113760") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113759,
                           "mem_param_tmp_113759") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113758,
                           "mem_param_tmp_113758") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113757,
                           "mem_param_tmp_113757") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113756,
                           "mem_param_tmp_113756") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113755,
                           "mem_param_tmp_113755") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113754,
                           "mem_param_tmp_113754") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113753,
                           "mem_param_tmp_113753") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113752,
                           "mem_param_tmp_113752") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113751,
                           "mem_param_tmp_113751") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113750,
                           "mem_param_tmp_113750") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113749,
                           "mem_param_tmp_113749") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113748,
                           "mem_param_tmp_113748") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113747,
                           "mem_param_tmp_113747") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113746,
                           "mem_param_tmp_113746") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113745,
                           "mem_param_tmp_113745") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113744,
                           "mem_param_tmp_113744") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113743,
                           "mem_param_tmp_113743") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113742,
                           "mem_param_tmp_113742") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113741,
                           "mem_param_tmp_113741") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113740,
                           "mem_param_tmp_113740") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113739,
                           "mem_param_tmp_113739") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113738,
                           "mem_param_tmp_113738") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113737,
                           "mem_param_tmp_113737") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113736,
                           "mem_param_tmp_113736") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_113735,
                           "mem_param_tmp_113735") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_110991, "mem_110991") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_110989, "mem_110989") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_110987, "mem_110987") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_110985, "mem_110985") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_110983, "mem_110983") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_110981, "mem_110981") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_110691, "mem_110691") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_110689, "mem_110689") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_110687, "mem_110687") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_110655, "mem_110655") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_110653, "mem_110653") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_110651, "mem_110651") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_110505, "mem_110505") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_110503, "mem_110503") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_110501, "mem_110501") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_110499, "mem_110499") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_110497, "mem_110497") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_110495, "mem_110495") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_110463, "mem_110463") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_110461, "mem_110461") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_110459, "mem_110459") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_110427, "mem_110427") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_110425, "mem_110425") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_110423, "mem_110423") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_110277, "mem_110277") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_110275, "mem_110275") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_110273, "mem_110273") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_110271, "mem_110271") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_110269, "mem_110269") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_110267, "mem_110267") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_110235, "mem_110235") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_110233, "mem_110233") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_110231, "mem_110231") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_109297, "mem_109297") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_109295, "mem_109295") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_109293, "mem_109293") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_109291, "mem_109291") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_109289, "mem_109289") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_109287, "mem_109287") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_109255, "mem_109255") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_109253, "mem_109253") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_109251, "mem_109251") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_109105, "mem_109105") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_109103, "mem_109103") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_109101, "mem_109101") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_109099, "mem_109099") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_109097, "mem_109097") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_109095, "mem_109095") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_109063, "mem_109063") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_109061, "mem_109061") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_109059, "mem_109059") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_107193, "mem_107193") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_107191, "mem_107191") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_107189, "mem_107189") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_107187, "mem_107187") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_107185, "mem_107185") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_107183, "mem_107183") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_107181, "mem_107181") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_107179, "mem_107179") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_107177, "mem_107177") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_107175, "mem_107175") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_107173, "mem_107173") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_107171, "mem_107171") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_107139, "mem_107139") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_107137, "mem_107137") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_107135, "mem_107135") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_106989, "mem_106989") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_106987, "mem_106987") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_106985, "mem_106985") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_106983, "mem_106983") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_106981, "mem_106981") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_106979, "mem_106979") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_106947, "mem_106947") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_106945, "mem_106945") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_106943, "mem_106943") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_105860, "mem_105860") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_105858, "mem_105858") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_105856, "mem_105856") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_105854, "mem_105854") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_105852, "mem_105852") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_105850, "mem_105850") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_105786, "mem_105786") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_105784, "mem_105784") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_105782, "mem_105782") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97630, "mem_param_97630") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97625, "mem_param_97625") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97611, "mem_param_97611") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97606, "mem_param_97606") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97592, "mem_param_97592") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97587, "mem_param_97587") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97573, "mem_param_97573") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97568, "mem_param_97568") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97554, "mem_param_97554") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97549, "mem_param_97549") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97541, "mem_param_97541") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97536, "mem_param_97536") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97528, "mem_param_97528") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97523, "mem_param_97523") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97509, "mem_param_97509") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97504, "mem_param_97504") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97490, "mem_param_97490") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97485, "mem_param_97485") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97471, "mem_param_97471") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97466, "mem_param_97466") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97452, "mem_param_97452") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97447, "mem_param_97447") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97439, "mem_param_97439") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97434, "mem_param_97434") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97426, "mem_param_97426") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97421, "mem_param_97421") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97407, "mem_param_97407") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97402, "mem_param_97402") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97388, "mem_param_97388") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97383, "mem_param_97383") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97369, "mem_param_97369") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97364, "mem_param_97364") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97350, "mem_param_97350") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97345, "mem_param_97345") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97337, "mem_param_97337") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97332, "mem_param_97332") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97324, "mem_param_97324") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97319, "mem_param_97319") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97305, "mem_param_97305") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97300, "mem_param_97300") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97286, "mem_param_97286") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97281, "mem_param_97281") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97267, "mem_param_97267") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97262, "mem_param_97262") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97248, "mem_param_97248") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97243, "mem_param_97243") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97235, "mem_param_97235") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97230, "mem_param_97230") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97222, "mem_param_97222") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97217, "mem_param_97217") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97203, "mem_param_97203") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97198, "mem_param_97198") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97184, "mem_param_97184") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97179, "mem_param_97179") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97165, "mem_param_97165") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97160, "mem_param_97160") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97146, "mem_param_97146") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97141, "mem_param_97141") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97127, "mem_param_97127") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97122, "mem_param_97122") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97108, "mem_param_97108") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97103, "mem_param_97103") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97095, "mem_param_97095") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97090, "mem_param_97090") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97076, "mem_param_97076") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97071, "mem_param_97071") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97057, "mem_param_97057") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97052, "mem_param_97052") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97044, "mem_param_97044") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97039, "mem_param_97039") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97025, "mem_param_97025") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97020, "mem_param_97020") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97006, "mem_param_97006") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_97001, "mem_param_97001") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96993, "mem_param_96993") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96988, "mem_param_96988") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96974, "mem_param_96974") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96969, "mem_param_96969") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96955, "mem_param_96955") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96950, "mem_param_96950") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96942, "mem_param_96942") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96937, "mem_param_96937") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96923, "mem_param_96923") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96918, "mem_param_96918") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111634, "ext_mem_111634") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111635, "ext_mem_111635") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111636, "ext_mem_111636") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111637, "ext_mem_111637") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111638, "ext_mem_111638") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111639, "ext_mem_111639") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111640, "ext_mem_111640") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111641, "ext_mem_111641") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111642, "ext_mem_111642") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111643, "ext_mem_111643") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111644, "ext_mem_111644") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111645, "ext_mem_111645") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111646, "ext_mem_111646") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111647, "ext_mem_111647") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111648, "ext_mem_111648") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111649, "ext_mem_111649") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111650, "ext_mem_111650") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111651, "ext_mem_111651") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111652, "ext_mem_111652") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111653, "ext_mem_111653") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111654, "ext_mem_111654") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111655, "ext_mem_111655") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111656, "ext_mem_111656") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111657, "ext_mem_111657") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111658, "ext_mem_111658") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111659, "ext_mem_111659") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111660, "ext_mem_111660") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111661, "ext_mem_111661") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111662, "ext_mem_111662") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111663, "ext_mem_111663") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111664, "ext_mem_111664") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111665, "ext_mem_111665") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111666, "ext_mem_111666") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111667, "ext_mem_111667") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111668, "ext_mem_111668") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111669, "ext_mem_111669") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111670, "ext_mem_111670") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111671, "ext_mem_111671") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111672, "ext_mem_111672") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111673, "ext_mem_111673") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111674, "ext_mem_111674") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111675, "ext_mem_111675") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111676, "ext_mem_111676") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111677, "ext_mem_111677") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111678, "ext_mem_111678") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111679, "ext_mem_111679") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111680, "ext_mem_111680") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111681, "ext_mem_111681") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111682, "ext_mem_111682") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111683, "ext_mem_111683") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111684, "ext_mem_111684") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111685, "ext_mem_111685") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111686, "ext_mem_111686") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111687, "ext_mem_111687") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111688, "ext_mem_111688") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111689, "ext_mem_111689") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111690, "ext_mem_111690") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111691, "ext_mem_111691") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111692, "ext_mem_111692") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111693, "ext_mem_111693") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111694, "ext_mem_111694") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111695, "ext_mem_111695") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111696, "ext_mem_111696") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111697, "ext_mem_111697") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111698, "ext_mem_111698") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111699, "ext_mem_111699") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111700, "ext_mem_111700") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111701, "ext_mem_111701") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111702, "ext_mem_111702") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111703, "ext_mem_111703") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111704, "ext_mem_111704") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111705, "ext_mem_111705") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111706, "ext_mem_111706") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111707, "ext_mem_111707") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111708, "ext_mem_111708") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111709, "ext_mem_111709") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111710, "ext_mem_111710") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111711, "ext_mem_111711") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111712, "ext_mem_111712") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111713, "ext_mem_111713") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111714, "ext_mem_111714") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111715, "ext_mem_111715") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111716, "ext_mem_111716") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_111717, "ext_mem_111717") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96904, "mem_param_96904") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96899, "mem_param_96899") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96894, "mem_param_96894") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96880, "mem_param_96880") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96875, "mem_param_96875") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96861, "mem_param_96861") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96856, "mem_param_96856") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96842, "mem_param_96842") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96837, "mem_param_96837") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96823, "mem_param_96823") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96818, "mem_param_96818") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96810, "mem_param_96810") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96805, "mem_param_96805") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96797, "mem_param_96797") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96792, "mem_param_96792") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96778, "mem_param_96778") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96773, "mem_param_96773") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96759, "mem_param_96759") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96754, "mem_param_96754") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96740, "mem_param_96740") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96735, "mem_param_96735") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96721, "mem_param_96721") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96716, "mem_param_96716") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96708, "mem_param_96708") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96703, "mem_param_96703") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96695, "mem_param_96695") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96690, "mem_param_96690") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96676, "mem_param_96676") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96671, "mem_param_96671") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96657, "mem_param_96657") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96652, "mem_param_96652") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96638, "mem_param_96638") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96633, "mem_param_96633") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96619, "mem_param_96619") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96614, "mem_param_96614") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96606, "mem_param_96606") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96601, "mem_param_96601") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96593, "mem_param_96593") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96588, "mem_param_96588") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96574, "mem_param_96574") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96569, "mem_param_96569") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96555, "mem_param_96555") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96550, "mem_param_96550") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96536, "mem_param_96536") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96531, "mem_param_96531") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96517, "mem_param_96517") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96512, "mem_param_96512") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96504, "mem_param_96504") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96499, "mem_param_96499") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96491, "mem_param_96491") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96486, "mem_param_96486") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96472, "mem_param_96472") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96467, "mem_param_96467") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96453, "mem_param_96453") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96448, "mem_param_96448") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96434, "mem_param_96434") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96429, "mem_param_96429") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96415, "mem_param_96415") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96410, "mem_param_96410") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96393, "mem_param_96393") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96388, "mem_param_96388") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96371, "mem_param_96371") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96366, "mem_param_96366") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96355, "mem_param_96355") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96350, "mem_param_96350") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96333, "mem_param_96333") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96328, "mem_param_96328") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96311, "mem_param_96311") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96306, "mem_param_96306") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96295, "mem_param_96295") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96290, "mem_param_96290") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96273, "mem_param_96273") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96268, "mem_param_96268") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96251, "mem_param_96251") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96246, "mem_param_96246") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96235, "mem_param_96235") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96230, "mem_param_96230") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96213, "mem_param_96213") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96208, "mem_param_96208") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96191, "mem_param_96191") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96186, "mem_param_96186") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96175, "mem_param_96175") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96170, "mem_param_96170") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96153, "mem_param_96153") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_96148, "mem_param_96148") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112369, "ext_mem_112369") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112370, "ext_mem_112370") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112371, "ext_mem_112371") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112372, "ext_mem_112372") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112373, "ext_mem_112373") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112374, "ext_mem_112374") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112375, "ext_mem_112375") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112376, "ext_mem_112376") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112377, "ext_mem_112377") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112378, "ext_mem_112378") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112379, "ext_mem_112379") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112380, "ext_mem_112380") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112381, "ext_mem_112381") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112382, "ext_mem_112382") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112383, "ext_mem_112383") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112384, "ext_mem_112384") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112385, "ext_mem_112385") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112386, "ext_mem_112386") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112387, "ext_mem_112387") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112388, "ext_mem_112388") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112389, "ext_mem_112389") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112390, "ext_mem_112390") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112391, "ext_mem_112391") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112392, "ext_mem_112392") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112393, "ext_mem_112393") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112394, "ext_mem_112394") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112395, "ext_mem_112395") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112396, "ext_mem_112396") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112397, "ext_mem_112397") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112398, "ext_mem_112398") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112399, "ext_mem_112399") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112400, "ext_mem_112400") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112401, "ext_mem_112401") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112402, "ext_mem_112402") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112403, "ext_mem_112403") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112404, "ext_mem_112404") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112405, "ext_mem_112405") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112406, "ext_mem_112406") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112407, "ext_mem_112407") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112408, "ext_mem_112408") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112409, "ext_mem_112409") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112410, "ext_mem_112410") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112411, "ext_mem_112411") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112412, "ext_mem_112412") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112413, "ext_mem_112413") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112414, "ext_mem_112414") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112415, "ext_mem_112415") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112416, "ext_mem_112416") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112417, "ext_mem_112417") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112418, "ext_mem_112418") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112419, "ext_mem_112419") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112420, "ext_mem_112420") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112421, "ext_mem_112421") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112422, "ext_mem_112422") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112423, "ext_mem_112423") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112424, "ext_mem_112424") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112425, "ext_mem_112425") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112426, "ext_mem_112426") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112427, "ext_mem_112427") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112428, "ext_mem_112428") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112429, "ext_mem_112429") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112430, "ext_mem_112430") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112431, "ext_mem_112431") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112432, "ext_mem_112432") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112433, "ext_mem_112433") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112434, "ext_mem_112434") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112435, "ext_mem_112435") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112436, "ext_mem_112436") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112437, "ext_mem_112437") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112438, "ext_mem_112438") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112439, "ext_mem_112439") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112440, "ext_mem_112440") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112441, "ext_mem_112441") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112442, "ext_mem_112442") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112443, "ext_mem_112443") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112444, "ext_mem_112444") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112445, "ext_mem_112445") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112446, "ext_mem_112446") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112447, "ext_mem_112447") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112448, "ext_mem_112448") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112449, "ext_mem_112449") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112450, "ext_mem_112450") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112451, "ext_mem_112451") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112452, "ext_mem_112452") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_112453, "ext_mem_112453") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_96395, "mem_96395") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_96373, "mem_96373") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_96357, "mem_96357") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_96335, "mem_96335") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_96313, "mem_96313") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_96297, "mem_96297") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_96275, "mem_96275") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_96253, "mem_96253") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_96237, "mem_96237") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_96215, "mem_96215") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_96193, "mem_96193") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_96177, "mem_96177") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_96155, "mem_96155") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_96133, "mem_96133") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_96131, "mem_96131") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_113560, "mem_out_113560") != 0)
            return 1;
    }
    return err;
}

int futhark_entry_diffusion_sample(struct futhark_context *ctx,
                                   struct futhark_f64_3d **out0, const
                                   int64_t in0, const
                                   struct futhark_f64_1d *in1, const
                                   struct futhark_f64_1d *in2, const
                                   struct futhark_f64_1d *in3, const
                                   int32_t in4, const int32_t in5, const
                                   int64_t in6)
{
    int64_t dz2082U_51162;
    int64_t num_imgs_51163;
    int32_t x_seed_51167;
    int32_t eps_seed_51168;
    int64_t denoise_steps_51169;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_113560;
    
    mem_out_113560.references = NULL;
    
    struct memblock alpha_bar_mem_96128;
    
    alpha_bar_mem_96128.references = NULL;
    
    struct memblock alpha_mem_96127;
    
    alpha_mem_96127.references = NULL;
    
    struct memblock beta_mem_96126;
    
    beta_mem_96126.references = NULL;
    num_imgs_51163 = in0;
    beta_mem_96126 = in1->mem;
    dz2082U_51162 = in1->shape[0];
    alpha_mem_96127 = in2->mem;
    dz2082U_51162 = in2->shape[0];
    alpha_bar_mem_96128 = in3->mem;
    dz2082U_51162 = in3->shape[0];
    x_seed_51167 = in4;
    eps_seed_51168 = in5;
    denoise_steps_51169 = in6;
    if (!(dz2082U_51162 == in1->shape[0] && (dz2082U_51162 == in2->shape[0] &&
                                             dz2082U_51162 == in3->shape[0]))) {
        ret = 1;
        set_error(ctx,
                  msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_diffusion_sample(ctx, &mem_out_113560,
                                            beta_mem_96126, alpha_mem_96127,
                                            alpha_bar_mem_96128, dz2082U_51162,
                                            num_imgs_51163, x_seed_51167,
                                            eps_seed_51168,
                                            denoise_steps_51169);
        if (ret == 0) {
            struct memblock mem_95769 = ctx->constants.mem_95769;
            struct memblock mem_95781 = ctx->constants.mem_95781;
            struct memblock mem_95783 = ctx->constants.mem_95783;
            struct memblock mem_95785 = ctx->constants.mem_95785;
            struct memblock mem_95787 = ctx->constants.mem_95787;
            struct memblock mem_95789 = ctx->constants.mem_95789;
            struct memblock mem_95841 = ctx->constants.mem_95841;
            struct memblock mem_95853 = ctx->constants.mem_95853;
            struct memblock mem_95855 = ctx->constants.mem_95855;
            struct memblock mem_95857 = ctx->constants.mem_95857;
            struct memblock mem_95859 = ctx->constants.mem_95859;
            struct memblock mem_95861 = ctx->constants.mem_95861;
            struct memblock mem_95863 = ctx->constants.mem_95863;
            struct memblock mem_95925 = ctx->constants.mem_95925;
            struct memblock mem_95927 = ctx->constants.mem_95927;
            struct memblock mem_95949 = ctx->constants.mem_95949;
            struct memblock mem_95951 = ctx->constants.mem_95951;
            struct memblock mem_95953 = ctx->constants.mem_95953;
            struct memblock mem_95985 = ctx->constants.mem_95985;
            struct memblock mem_95997 = ctx->constants.mem_95997;
            struct memblock mem_95999 = ctx->constants.mem_95999;
            struct memblock mem_96001 = ctx->constants.mem_96001;
            struct memblock mem_96033 = ctx->constants.mem_96033;
            struct memblock mem_96045 = ctx->constants.mem_96045;
            struct memblock mem_96047 = ctx->constants.mem_96047;
            struct memblock mem_96069 = ctx->constants.mem_96069;
            struct memblock mem_96081 = ctx->constants.mem_96081;
            double zp_res_61110 = ctx->constants.zp_res_61110;
            struct memblock mem_96093 = ctx->constants.mem_96093;
            struct memblock mem_96095 = ctx->constants.mem_96095;
            struct memblock mem_96097 = ctx->constants.mem_96097;
            struct memblock mem_96099 = ctx->constants.mem_96099;
            struct memblock mem_96101 = ctx->constants.mem_96101;
            struct memblock mem_96103 = ctx->constants.mem_96103;
            struct memblock mem_96105 = ctx->constants.mem_96105;
            struct memblock mem_96107 = ctx->constants.mem_96107;
            struct memblock mem_96109 = ctx->constants.mem_96109;
            struct memblock mem_96111 = ctx->constants.mem_96111;
            struct memblock mem_96113 = ctx->constants.mem_96113;
            struct memblock mem_96115 = ctx->constants.mem_96115;
            struct memblock mem_96117 = ctx->constants.mem_96117;
            struct memblock mem_96119 = ctx->constants.mem_96119;
            struct memblock mem_96121 = ctx->constants.mem_96121;
            struct memblock mem_96123 = ctx->constants.mem_96123;
            struct memblock mem_96125 = ctx->constants.mem_96125;
            
            assert((*out0 =
                    (struct futhark_f64_3d *) malloc(sizeof(struct futhark_f64_3d))) !=
                NULL);
            (*out0)->mem = mem_out_113560;
            (*out0)->shape[0] = num_imgs_51163;
            (*out0)->shape[1] = (int64_t) 28;
            (*out0)->shape[2] = (int64_t) 28;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_diffusion_train(struct futhark_context *ctx,
                                  struct futhark_f64_1d **out0, const
                                  struct futhark_f64_3d *in0, const
                                  struct futhark_f64_1d *in1, const int64_t in2,
                                  const struct futhark_i32_2d *in3, const
                                  struct futhark_i32_2d *in4)
{
    int64_t l_49204;
    int64_t m_49205;
    int64_t n_49206;
    int64_t dz2080U_49207;
    int64_t epochs_49210;
    int64_t prim_out_113561;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_113560;
    
    mem_out_113560.references = NULL;
    
    struct memblock noise_seeds_mem_96129;
    
    noise_seeds_mem_96129.references = NULL;
    
    struct memblock time_seeds_mem_96128;
    
    time_seeds_mem_96128.references = NULL;
    
    struct memblock alpha_bar_mem_96127;
    
    alpha_bar_mem_96127.references = NULL;
    
    struct memblock images_mem_96126;
    
    images_mem_96126.references = NULL;
    images_mem_96126 = in0->mem;
    l_49204 = in0->shape[0];
    m_49205 = in0->shape[1];
    n_49206 = in0->shape[2];
    alpha_bar_mem_96127 = in1->mem;
    dz2080U_49207 = in1->shape[0];
    epochs_49210 = in2;
    time_seeds_mem_96128 = in3->mem;
    l_49204 = in3->shape[1];
    noise_seeds_mem_96129 = in4->mem;
    l_49204 = in4->shape[1];
    if (!((l_49204 == in0->shape[0] && (m_49205 == in0->shape[1] && n_49206 ==
                                        in0->shape[2])) && (dz2080U_49207 ==
                                                            in1->shape[0] &&
                                                            ((epochs_49210 ==
                                                              in3->shape[0] &&
                                                              l_49204 ==
                                                              in3->shape[1]) &&
                                                             (epochs_49210 ==
                                                              in4->shape[0] &&
                                                              l_49204 ==
                                                              in4->shape[1]))))) {
        ret = 1;
        set_error(ctx,
                  msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_diffusion_train(ctx, &mem_out_113560,
                                           &prim_out_113561, images_mem_96126,
                                           alpha_bar_mem_96127,
                                           time_seeds_mem_96128,
                                           noise_seeds_mem_96129, l_49204,
                                           m_49205, n_49206, dz2080U_49207,
                                           epochs_49210);
        if (ret == 0) {
            struct memblock mem_95769 = ctx->constants.mem_95769;
            struct memblock mem_95781 = ctx->constants.mem_95781;
            struct memblock mem_95783 = ctx->constants.mem_95783;
            struct memblock mem_95785 = ctx->constants.mem_95785;
            struct memblock mem_95787 = ctx->constants.mem_95787;
            struct memblock mem_95789 = ctx->constants.mem_95789;
            struct memblock mem_95841 = ctx->constants.mem_95841;
            struct memblock mem_95853 = ctx->constants.mem_95853;
            struct memblock mem_95855 = ctx->constants.mem_95855;
            struct memblock mem_95857 = ctx->constants.mem_95857;
            struct memblock mem_95859 = ctx->constants.mem_95859;
            struct memblock mem_95861 = ctx->constants.mem_95861;
            struct memblock mem_95863 = ctx->constants.mem_95863;
            struct memblock mem_95925 = ctx->constants.mem_95925;
            struct memblock mem_95927 = ctx->constants.mem_95927;
            struct memblock mem_95949 = ctx->constants.mem_95949;
            struct memblock mem_95951 = ctx->constants.mem_95951;
            struct memblock mem_95953 = ctx->constants.mem_95953;
            struct memblock mem_95985 = ctx->constants.mem_95985;
            struct memblock mem_95997 = ctx->constants.mem_95997;
            struct memblock mem_95999 = ctx->constants.mem_95999;
            struct memblock mem_96001 = ctx->constants.mem_96001;
            struct memblock mem_96033 = ctx->constants.mem_96033;
            struct memblock mem_96045 = ctx->constants.mem_96045;
            struct memblock mem_96047 = ctx->constants.mem_96047;
            struct memblock mem_96069 = ctx->constants.mem_96069;
            struct memblock mem_96081 = ctx->constants.mem_96081;
            double zp_res_61110 = ctx->constants.zp_res_61110;
            struct memblock mem_96093 = ctx->constants.mem_96093;
            struct memblock mem_96095 = ctx->constants.mem_96095;
            struct memblock mem_96097 = ctx->constants.mem_96097;
            struct memblock mem_96099 = ctx->constants.mem_96099;
            struct memblock mem_96101 = ctx->constants.mem_96101;
            struct memblock mem_96103 = ctx->constants.mem_96103;
            struct memblock mem_96105 = ctx->constants.mem_96105;
            struct memblock mem_96107 = ctx->constants.mem_96107;
            struct memblock mem_96109 = ctx->constants.mem_96109;
            struct memblock mem_96111 = ctx->constants.mem_96111;
            struct memblock mem_96113 = ctx->constants.mem_96113;
            struct memblock mem_96115 = ctx->constants.mem_96115;
            struct memblock mem_96117 = ctx->constants.mem_96117;
            struct memblock mem_96119 = ctx->constants.mem_96119;
            struct memblock mem_96121 = ctx->constants.mem_96121;
            struct memblock mem_96123 = ctx->constants.mem_96123;
            struct memblock mem_96125 = ctx->constants.mem_96125;
            
            assert((*out0 =
                    (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) !=
                NULL);
            (*out0)->mem = mem_out_113560;
            (*out0)->shape[0] = prim_out_113561;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
  
